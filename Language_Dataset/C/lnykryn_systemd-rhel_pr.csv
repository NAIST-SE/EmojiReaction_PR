lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,9,2016-02-29T15:42:40Z,2016-03-01T14:18:47Z,2016-03-01T14:18:47Z,MERGED,True,28,19,1,https://github.com/msekletar,"Revert original NPIV support patch, instead use patch from #2731",2,[],https://github.com/lnykryn/systemd-rhel/pull/9,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/9,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,10,2016-03-10T14:51:43Z,2016-03-10T14:52:00Z,2016-03-10T14:52:00Z,MERGED,True,446,120,32,https://github.com/lnykryn,Staging,30,[],https://github.com/lnykryn/systemd-rhel/pull/10,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/10,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,11,2016-03-15T17:42:32Z,2016-03-15T17:50:40Z,2016-03-15T17:50:40Z,MERGED,True,6,0,1,https://github.com/msekletar,path_id: reintroduce by-path links for virtio block devices,1,[],https://github.com/lnykryn/systemd-rhel/pull/11,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/11,"Enumeration of virtio buses is global and hence
non-deterministic. However, we are guaranteed there is never going to be
more than one virtio bus per parent PCI device. While populating
ID_PATH we simply skip virtio part of the syspath and we extend the path
using the sysname of the parent PCI device.
With this patch udev creates following by-path links for virtio-blk
device /dev/vda which contains two partitions.
ls -l /dev/disk/by-path/
total 0
lrwxrwxrwx 1 root root  9 Feb  9 10:47 virtio-pci-0000:00:05.0 -> ../../vda
lrwxrwxrwx 1 root root 10 Feb  9 10:47 virtio-pci-0000:00:05.0-part1 -> ../../vda1
lrwxrwxrwx 1 root root 10 Feb  9 10:47 virtio-pci-0000:00:05.0-part2 -> ../../vda2
See:
http://lists.linuxfoundation.org/pipermail/virtualization/2015-August/030328.html
Fixes #2501
Cherry-picked from: f073b1b
Resolves: #952567","Enumeration of virtio buses is global and hence
non-deterministic. However, we are guaranteed there is never going to be
more than one virtio bus per parent PCI device. While populating
ID_PATH we simply skip virtio part of the syspath and we extend the path
using the sysname of the parent PCI device.
With this patch udev creates following by-path links for virtio-blk
device /dev/vda which contains two partitions.
ls -l /dev/disk/by-path/
total 0
lrwxrwxrwx 1 root root  9 Feb  9 10:47 virtio-pci-0000:00:05.0 -> ../../vda
lrwxrwxrwx 1 root root 10 Feb  9 10:47 virtio-pci-0000:00:05.0-part1 -> ../../vda1
lrwxrwxrwx 1 root root 10 Feb  9 10:47 virtio-pci-0000:00:05.0-part2 -> ../../vda2
See:
http://lists.linuxfoundation.org/pipermail/virtualization/2015-August/030328.html
Fixes #2501
Cherry-picked from: f073b1b
Resolves: #952567",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,12,2016-03-16T09:23:17Z,2016-03-16T09:25:37Z,2016-03-16T09:25:38Z,MERGED,True,18,10,3,https://github.com/msekletar,Fixes for #1292447,2,[],https://github.com/lnykryn/systemd-rhel/pull/12,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/12,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,13,2016-03-17T10:07:56Z,2016-03-17T14:43:58Z,2016-03-17T14:43:58Z,CLOSED,False,2008,924,23,https://github.com/msekletar,Enable unit files via symlinks in /usr,2,[],https://github.com/lnykryn/systemd-rhel/pull/13,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/13,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,13,2016-03-17T10:07:56Z,2016-03-17T14:43:58Z,2016-03-17T14:43:58Z,CLOSED,False,2008,924,23,https://github.com/msekletar,Enable unit files via symlinks in /usr,2,[],https://github.com/lnykryn/systemd-rhel/pull/13,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/13#issuecomment-197909391,,"Merged to staging
2723780
0e6ec33",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,14,2016-03-23T12:11:34Z,2016-04-04T06:23:03Z,2018-12-04T13:16:36Z,MERGED,True,76,39,2,https://github.com/lnykryn,Bz1296288,2,[],https://github.com/lnykryn/systemd-rhel/pull/14,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/14,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,15,2016-04-08T15:07:00Z,2016-04-21T08:49:29Z,2016-04-26T17:42:09Z,CLOSED,False,100,6,6,https://github.com/lnykryn,Bz1305279,2,[],https://github.com/lnykryn/systemd-rhel/pull/15,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/15,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,15,2016-04-08T15:07:00Z,2016-04-21T08:49:29Z,2016-04-26T17:42:09Z,CLOSED,False,100,6,6,https://github.com/lnykryn,Bz1305279,2,[],https://github.com/lnykryn/systemd-rhel/pull/15,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/15#issuecomment-212817090,,cherry-picked to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,16,2016-04-28T11:08:45Z,2016-04-28T11:15:33Z,2016-04-28T11:15:33Z,MERGED,True,18,10,3,https://github.com/msekletar,Bz1331339,2,[],https://github.com/lnykryn/systemd-rhel/pull/16,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/16,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,17,2016-04-28T14:11:06Z,2016-04-29T14:10:06Z,2016-04-29T14:10:06Z,CLOSED,False,1,1,1,https://github.com/msekletar,tests: fix make check failure,1,['bug'],https://github.com/lnykryn/systemd-rhel/pull/17,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/17,"Don't call abort() on success. Actually rm_rf_dangerous() returns 0 if
all went well.
Related: #1159308","Don't call abort() on success. Actually rm_rf_dangerous() returns 0 if
all went well.
Related: #1159308",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,17,2016-04-28T14:11:06Z,2016-04-29T14:10:06Z,2016-04-29T14:10:06Z,CLOSED,False,1,1,1,https://github.com/msekletar,tests: fix make check failure,1,['bug'],https://github.com/lnykryn/systemd-rhel/pull/17,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/17#issuecomment-215728389,"Don't call abort() on success. Actually rm_rf_dangerous() returns 0 if
all went well.
Related: #1159308",merged,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,18,2016-04-29T15:47:16Z,2016-05-05T10:32:33Z,2016-05-05T10:32:33Z,CLOSED,False,17,13,9,https://github.com/msekletar,Backport bunch of fixes for memory leaks,10,[],https://github.com/lnykryn/systemd-rhel/pull/18,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/18,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,18,2016-04-29T15:47:16Z,2016-05-05T10:32:33Z,2016-05-05T10:32:33Z,CLOSED,False,17,13,9,https://github.com/msekletar,Backport bunch of fixes for memory leaks,10,[],https://github.com/lnykryn/systemd-rhel/pull/18,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/18#issuecomment-217120836,,rebased and merged,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,19,2016-05-10T11:44:04Z,2016-06-08T08:26:07Z,2016-06-08T08:26:07Z,CLOSED,False,203,65,9,https://github.com/lnykryn,Bz1305608,2,[],https://github.com/lnykryn/systemd-rhel/pull/19,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/19,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,19,2016-05-10T11:44:04Z,2016-06-08T08:26:07Z,2016-06-08T08:26:07Z,CLOSED,False,203,65,9,https://github.com/lnykryn,Bz1305608,2,[],https://github.com/lnykryn/systemd-rhel/pull/19,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/19#issuecomment-218137439,,Looks good to me.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,19,2016-05-10T11:44:04Z,2016-06-08T08:26:07Z,2016-06-08T08:26:07Z,CLOSED,False,203,65,9,https://github.com/lnykryn,Bz1305608,2,[],https://github.com/lnykryn/systemd-rhel/pull/19,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/19#issuecomment-224522400,,merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,20,2016-05-20T10:43:29Z,2016-06-09T08:12:47Z,2016-06-09T08:12:47Z,CLOSED,False,17,2,2,https://github.com/jsynacek,myhostname: fix timeout if ipv6 is disabled,1,[],https://github.com/lnykryn/systemd-rhel/pull/20,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/20,Resolves: #1330973,Resolves: #1330973,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,20,2016-05-20T10:43:29Z,2016-06-09T08:12:47Z,2016-06-09T08:12:47Z,CLOSED,False,17,2,2,https://github.com/jsynacek,myhostname: fix timeout if ipv6 is disabled,1,[],https://github.com/lnykryn/systemd-rhel/pull/20,https://github.com/teg,2,https://github.com/lnykryn/systemd-rhel/pull/20#issuecomment-220620974,Resolves: #1330973,"This appears to be a bug in sd-netlink, though I was unable to figure it out by staring at the code. I would expect in this case to get a NLMSG_ERR as reply to the request with errorcode EOPNOTSUPP. From your report it appears this is somehow getting dropped, but it is not clear to me why. If you are able to trace socket_read_message() on an affected system it would be very helpful.
Might it be that we get NLM_F_MULTI without a corresponding NLMSG_DONE in the error case? My understanding is that this should not happen, but that's the only thing I could think of.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,20,2016-05-20T10:43:29Z,2016-06-09T08:12:47Z,2016-06-09T08:12:47Z,CLOSED,False,17,2,2,https://github.com/jsynacek,myhostname: fix timeout if ipv6 is disabled,1,[],https://github.com/lnykryn/systemd-rhel/pull/20,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/20#issuecomment-224828241,Resolves: #1330973,merged to staging as rhel-only patch,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,21,2016-05-23T12:52:08Z,2016-06-08T08:29:22Z,2016-06-08T08:29:22Z,CLOSED,False,2,1,1,https://github.com/jsynacek,Teach bus_append_unit_property_assignment() about 'Delegate' property,1,[],https://github.com/lnykryn/systemd-rhel/pull/21,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/21,"""Cherry-picked"" from ea1a971.
Resolves: #1337922","""Cherry-picked"" from ea1a971.
Resolves: #1337922",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,21,2016-05-23T12:52:08Z,2016-06-08T08:29:22Z,2016-06-08T08:29:22Z,CLOSED,False,2,1,1,https://github.com/jsynacek,Teach bus_append_unit_property_assignment() about 'Delegate' property,1,[],https://github.com/lnykryn/systemd-rhel/pull/21,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/21#issuecomment-224523162,"""Cherry-picked"" from ea1a971.
Resolves: #1337922",merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,22,2016-05-27T13:49:42Z,2016-06-09T08:16:08Z,2016-06-09T08:16:08Z,CLOSED,False,0,68,3,https://github.com/msekletar,readahead: do not increase nr_requests for root fs block device,1,[],https://github.com/lnykryn/systemd-rhel/pull/22,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/22,"Having nr_requests can cause system lockups. Arguably, this should get
fixed somehow in kernel. For now we just stop changing the
value.
Note that not bumping a value may cause that posix_fadvise call
will block in case there is no room in a request queue.
See: http://article.gmane.org/gmane.linux.kernel/1072356
RHEL-only
Resolves: #1314559","Having nr_requests can cause system lockups. Arguably, this should get
fixed somehow in kernel. For now we just stop changing the
value.
Note that not bumping a value may cause that posix_fadvise call
will block in case there is no room in a request queue.
See: http://article.gmane.org/gmane.linux.kernel/1072356
RHEL-only
Resolves: #1314559",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,22,2016-05-27T13:49:42Z,2016-06-09T08:16:08Z,2016-06-09T08:16:08Z,CLOSED,False,0,68,3,https://github.com/msekletar,readahead: do not increase nr_requests for root fs block device,1,[],https://github.com/lnykryn/systemd-rhel/pull/22,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/22#issuecomment-224828937,"Having nr_requests can cause system lockups. Arguably, this should get
fixed somehow in kernel. For now we just stop changing the
value.
Note that not bumping a value may cause that posix_fadvise call
will block in case there is no room in a request queue.
See: http://article.gmane.org/gmane.linux.kernel/1072356
RHEL-only
Resolves: #1314559",pushed to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,23,2016-05-31T12:35:23Z,2016-06-08T13:43:39Z,2016-06-08T13:43:39Z,CLOSED,False,107,28,7,https://github.com/jsynacek,add REMOTE_ADDR and REMOTE_PORT for Accept=yes,1,[],https://github.com/lnykryn/systemd-rhel/pull/23,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/23,"Cherry-picked from: 3b1c524
Resolves: #1341154","Cherry-picked from: 3b1c524
Resolves: #1341154",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,23,2016-05-31T12:35:23Z,2016-06-08T13:43:39Z,2016-06-08T13:43:39Z,CLOSED,False,107,28,7,https://github.com/jsynacek,add REMOTE_ADDR and REMOTE_PORT for Accept=yes,1,[],https://github.com/lnykryn/systemd-rhel/pull/23,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/23#issuecomment-224592746,"Cherry-picked from: 3b1c524
Resolves: #1341154",merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,24,2016-05-31T14:16:39Z,2016-06-06T13:48:25Z,2016-06-06T13:48:25Z,CLOSED,False,28,25,6,https://github.com/msekletar,core: don't log job status message in case job was effectively NOP (#…,1,[],https://github.com/lnykryn/systemd-rhel/pull/24,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/24,"…3199)
We currently generate log message about unit being started even when
unit was started already and job didn't do anything. This is because job
was requested explicitly and hence became anchor job of the transaction
thus we could not eliminate it. That is fine but, let's not pollute
journal with useless log messages.
$ systemctl start systemd-resolved
$ systemctl start systemd-resolved
$ systemctl start systemd-resolved
Current state:
$ journalctl -u systemd-resolved | grep Started
May 05 15:31:42 rawhide systemd[1]: Started Network Name Resolution.
May 05 15:31:59 rawhide systemd[1]: Started Network Name Resolution.
May 05 15:32:01 rawhide systemd[1]: Started Network Name Resolution.
After patch applied:
$ journalctl -u systemd-resolved | grep Started
May 05 16:42:12 rawhide systemd[1]: Started Network Name Resolution.
Fixes #1723
Cherry-picked from: 833f92a
Resolves: #1280014","…3199)
We currently generate log message about unit being started even when
unit was started already and job didn't do anything. This is because job
was requested explicitly and hence became anchor job of the transaction
thus we could not eliminate it. That is fine but, let's not pollute
journal with useless log messages.
$ systemctl start systemd-resolved
$ systemctl start systemd-resolved
$ systemctl start systemd-resolved
Current state:
$ journalctl -u systemd-resolved | grep Started
May 05 15:31:42 rawhide systemd[1]: Started Network Name Resolution.
May 05 15:31:59 rawhide systemd[1]: Started Network Name Resolution.
May 05 15:32:01 rawhide systemd[1]: Started Network Name Resolution.
After patch applied:
$ journalctl -u systemd-resolved | grep Started
May 05 16:42:12 rawhide systemd[1]: Started Network Name Resolution.
Fixes #1723
Cherry-picked from: 833f92a
Resolves: #1280014",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,24,2016-05-31T14:16:39Z,2016-06-06T13:48:25Z,2016-06-06T13:48:25Z,CLOSED,False,28,25,6,https://github.com/msekletar,core: don't log job status message in case job was effectively NOP (#…,1,[],https://github.com/lnykryn/systemd-rhel/pull/24,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/24#issuecomment-223964003,"…3199)
We currently generate log message about unit being started even when
unit was started already and job didn't do anything. This is because job
was requested explicitly and hence became anchor job of the transaction
thus we could not eliminate it. That is fine but, let's not pollute
journal with useless log messages.
$ systemctl start systemd-resolved
$ systemctl start systemd-resolved
$ systemctl start systemd-resolved
Current state:
$ journalctl -u systemd-resolved | grep Started
May 05 15:31:42 rawhide systemd[1]: Started Network Name Resolution.
May 05 15:31:59 rawhide systemd[1]: Started Network Name Resolution.
May 05 15:32:01 rawhide systemd[1]: Started Network Name Resolution.
After patch applied:
$ journalctl -u systemd-resolved | grep Started
May 05 16:42:12 rawhide systemd[1]: Started Network Name Resolution.
Fixes #1723
Cherry-picked from: 833f92a
Resolves: #1280014",merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,25,2016-06-06T11:43:31Z,2016-06-06T13:43:16Z,2016-06-06T13:43:16Z,CLOSED,False,0,6,1,https://github.com/jsynacek,mount: remove obsolete -n,1,[],https://github.com/lnykryn/systemd-rhel/pull/25,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/25,"It seems that systemd still uses legacy -n option. The option has been
originally designed to avoid write to /etc/mtab during boot when root
FS is not ready or read-only.
This is not necessary for long time, because /etc/mtab is not a real
file (it's symlink) and write to the file is impossible. All utils
should be able to detect the symlink and ignore mtab. This concept is
supported for very long time before systemd.
The userspase mount options are currently maintained by libmount
(mount(8) and mount.nfs) in /run/mount) which is tmpfs initialized
during early boot.
(cherry picked from commit 6f20f85)
Resolves: #1339721","It seems that systemd still uses legacy -n option. The option has been
originally designed to avoid write to /etc/mtab during boot when root
FS is not ready or read-only.
This is not necessary for long time, because /etc/mtab is not a real
file (it's symlink) and write to the file is impossible. All utils
should be able to detect the symlink and ignore mtab. This concept is
supported for very long time before systemd.
The userspase mount options are currently maintained by libmount
(mount(8) and mount.nfs) in /run/mount) which is tmpfs initialized
during early boot.
(cherry picked from commit 6f20f85)
Resolves: #1339721",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,25,2016-06-06T11:43:31Z,2016-06-06T13:43:16Z,2016-06-06T13:43:16Z,CLOSED,False,0,6,1,https://github.com/jsynacek,mount: remove obsolete -n,1,[],https://github.com/lnykryn/systemd-rhel/pull/25,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/25#issuecomment-223962505,"It seems that systemd still uses legacy -n option. The option has been
originally designed to avoid write to /etc/mtab during boot when root
FS is not ready or read-only.
This is not necessary for long time, because /etc/mtab is not a real
file (it's symlink) and write to the file is impossible. All utils
should be able to detect the symlink and ignore mtab. This concept is
supported for very long time before systemd.
The userspase mount options are currently maintained by libmount
(mount(8) and mount.nfs) in /run/mount) which is tmpfs initialized
during early boot.
(cherry picked from commit 6f20f85)
Resolves: #1339721",cherry-picked to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,26,2016-06-07T11:02:11Z,2016-06-08T13:35:49Z,2016-06-08T13:35:49Z,CLOSED,False,6,4,1,https://github.com/jsynacek,sd-netlink: fix deep recursion in message destruction,1,[],https://github.com/lnykryn/systemd-rhel/pull/26,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/26,"On larger systems we might very well see messages with thousands of parts.
When we free them, we must avoid recursing into each part, otherwise we
very likely get stack overflows.
Fix sd_netlink_message_unref() to use an iterative approach rather than
recursion (also avoid tail-recursion in case it is not optimized by the
compiler).
(cherry picked from commit 82e4eda)
Resolves: #1330593","On larger systems we might very well see messages with thousands of parts.
When we free them, we must avoid recursing into each part, otherwise we
very likely get stack overflows.
Fix sd_netlink_message_unref() to use an iterative approach rather than
recursion (also avoid tail-recursion in case it is not optimized by the
compiler).
(cherry picked from commit 82e4eda)
Resolves: #1330593",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,26,2016-06-07T11:02:11Z,2016-06-08T13:35:49Z,2016-06-08T13:35:49Z,CLOSED,False,6,4,1,https://github.com/jsynacek,sd-netlink: fix deep recursion in message destruction,1,[],https://github.com/lnykryn/systemd-rhel/pull/26,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/26#issuecomment-224590457,"On larger systems we might very well see messages with thousands of parts.
When we free them, we must avoid recursing into each part, otherwise we
very likely get stack overflows.
Fix sd_netlink_message_unref() to use an iterative approach rather than
recursion (also avoid tail-recursion in case it is not optimized by the
compiler).
(cherry picked from commit 82e4eda)
Resolves: #1330593",merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,27,2016-06-09T07:31:25Z,2016-06-09T08:07:51Z,2016-06-09T08:07:51Z,MERGED,True,9,1,2,https://github.com/jsynacek,Bz1343904,2,[],https://github.com/lnykryn/systemd-rhel/pull/27,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/27,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,28,2016-06-13T11:56:00Z,2016-07-12T12:45:39Z,2016-07-12T12:45:39Z,CLOSED,False,89,38,1,https://github.com/jsynacek,systemctl: return diffrent error code if service exist or not (#3385),3,[],https://github.com/lnykryn/systemd-rhel/pull/28,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/28,"Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
(cherry picked from commit ca473d5)
Resolves: #1047466","Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
(cherry picked from commit ca473d5)
Resolves: #1047466",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,28,2016-06-13T11:56:00Z,2016-07-12T12:45:39Z,2016-07-12T12:45:39Z,CLOSED,False,89,38,1,https://github.com/jsynacek,systemctl: return diffrent error code if service exist or not (#3385),3,[],https://github.com/lnykryn/systemd-rhel/pull/28,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/28#issuecomment-226122615,"Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
(cherry picked from commit ca473d5)
Resolves: #1047466",I have force-pushed the branch and added f0871b9 and 3b12454.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,28,2016-06-13T11:56:00Z,2016-07-12T12:45:39Z,2016-07-12T12:45:39Z,CLOSED,False,89,38,1,https://github.com/jsynacek,systemctl: return diffrent error code if service exist or not (#3385),3,[],https://github.com/lnykryn/systemd-rhel/pull/28,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/28#issuecomment-232036174,"Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
(cherry picked from commit ca473d5)
Resolves: #1047466",Reviewed and pushed to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,29,2016-06-22T11:26:37Z,2016-06-22T11:42:34Z,2016-06-22T11:42:34Z,MERGED,True,7,2,2,https://github.com/jsynacek,hwdb: selinuxify a bit (#3460),1,[],https://github.com/lnykryn/systemd-rhel/pull/29,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/29,"-bash-4.3# rm /etc/udev/hwdb.bin
-bash-4.3# systemd-hwdb update
-bash-4.3# ls -Z /etc/udev/hwdb.bin
system_u:object_r:systemd_hwdb_etc_t:s0 /etc/udev/hwdb.bin
Fixes: #3458
(cherry picked from commit ea68351)
Resolves: #1343648","-bash-4.3# rm /etc/udev/hwdb.bin
-bash-4.3# systemd-hwdb update
-bash-4.3# ls -Z /etc/udev/hwdb.bin
system_u:object_r:systemd_hwdb_etc_t:s0 /etc/udev/hwdb.bin
Fixes: #3458
(cherry picked from commit ea68351)
Resolves: #1343648",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,30,2016-07-06T10:36:16Z,2016-07-06T21:53:33Z,2016-07-06T21:53:33Z,CLOSED,False,2,0,1,https://github.com/msekletar,systemctl: return diffrent error code if service exist or not,1,[],https://github.com/lnykryn/systemd-rhel/pull/30,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/30,"Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
Cherry-picked from: 10b5871372c23f9572642f88816f7f3198cb91ac
Resolves: #1256858","Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
Cherry-picked from: 10b5871372c23f9572642f88816f7f3198cb91ac
Resolves: #1256858",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,30,2016-07-06T10:36:16Z,2016-07-06T21:53:33Z,2016-07-06T21:53:33Z,CLOSED,False,2,0,1,https://github.com/msekletar,systemctl: return diffrent error code if service exist or not,1,[],https://github.com/lnykryn/systemd-rhel/pull/30,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/30#issuecomment-230918783,"Before:
[sus@maximus bz-1256858]$ systemctl status rsyslog.service;echo $?
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 26min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
[sus@maximus bz-1256858]$ systemctl status hello.service;echo $?
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
3
After:
$ ./systemctl status hello.service;echo $?
Failed to dump process list, ignoring: Access denied
● hello.service
Loaded: not-found (Reason: No such file or directory)
Active: inactive (dead)
4
[sus@maximus bz-1256858]$  ./systemctl status rsyslog.service;echo $?
Failed to dump process list, ignoring: Access denied
● rsyslog.service - System Logging Service
Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled; vendor
preset: enabled)
Drop-In: /etc/systemd/system/rsyslog.service.d
└─50-CPUShares.conf
Active: inactive (dead) since Mon 2016-05-30 11:54:25 IST; 2h 24min ago
Docs: man:rsyslogd(8)
http://www.rsyslog.com/doc/
Process: 1159 ExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS (code=exited,
status=0/SUCCESS)
Main PID: 1159 (code=exited, status=0/SUCCESS)
May 30 11:07:50 maximus systemd[1]: Starting System Logging Service...
May 30 11:07:50 maximus systemd[1]: Started System Logging Service.
May 30 11:54:25 maximus systemd[1]: Stopping System Logging Service...
May 30 11:54:25 maximus systemd[1]: Stopped System Logging Service.
3
Fixes: 1092
Cherry-picked from: 10b5871372c23f9572642f88816f7f3198cb91ac
Resolves: #1256858",Duplicate of pull request 28,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,31,2016-07-06T10:38:17Z,2016-07-12T12:50:48Z,2016-07-12T12:50:48Z,CLOSED,False,159,125,4,https://github.com/msekletar,Bz1350232,8,[],https://github.com/lnykryn/systemd-rhel/pull/31,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/31,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,31,2016-07-06T10:38:17Z,2016-07-12T12:50:48Z,2016-07-12T12:50:48Z,CLOSED,False,159,125,4,https://github.com/msekletar,Bz1350232,8,[],https://github.com/lnykryn/systemd-rhel/pull/31,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/31#issuecomment-232037371,,"Seems to work fine, merged to staging.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,32,2016-07-08T13:27:56Z,2016-07-12T12:52:01Z,2018-12-04T13:16:37Z,CLOSED,False,29,4,5,https://github.com/msekletar,Bz1342173,3,[],https://github.com/lnykryn/systemd-rhel/pull/32,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/32,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,32,2016-07-08T13:27:56Z,2016-07-12T12:52:01Z,2018-12-04T13:16:37Z,CLOSED,False,29,4,5,https://github.com/msekletar,Bz1342173,3,[],https://github.com/lnykryn/systemd-rhel/pull/32,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/32#issuecomment-232037658,,"Seems to work fine, merged to staging",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,33,2016-07-08T14:31:10Z,2016-07-11T12:56:31Z,2018-12-04T13:16:37Z,CLOSED,False,5,2,2,https://github.com/msekletar,udevadm: explicitly relabel /etc/udev/hwdb.bin after rename,1,[],https://github.com/lnykryn/systemd-rhel/pull/33,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/33,"This is basically the same change as ea68351.
Cherry-picked from: 4f43161e909cb420aafbc4bebce4361b17b80fdd
Related: #1350756","This is basically the same change as ea68351.
Cherry-picked from: 4f43161e909cb420aafbc4bebce4361b17b80fdd
Related: #1350756",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,33,2016-07-08T14:31:10Z,2016-07-11T12:56:31Z,2018-12-04T13:16:37Z,CLOSED,False,5,2,2,https://github.com/msekletar,udevadm: explicitly relabel /etc/udev/hwdb.bin after rename,1,[],https://github.com/lnykryn/systemd-rhel/pull/33,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/33#issuecomment-231726227,"This is basically the same change as ea68351.
Cherry-picked from: 4f43161e909cb420aafbc4bebce4361b17b80fdd
Related: #1350756",Looks good to me. Merged to staging.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,34,2016-07-11T10:26:31Z,2016-07-12T12:54:09Z,2016-07-12T12:54:09Z,CLOSED,False,948,87,14,https://github.com/msekletar,Bz1351415,6,[],https://github.com/lnykryn/systemd-rhel/pull/34,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/34,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,34,2016-07-11T10:26:31Z,2016-07-12T12:54:09Z,2016-07-12T12:54:09Z,CLOSED,False,948,87,14,https://github.com/msekletar,Bz1351415,6,[],https://github.com/lnykryn/systemd-rhel/pull/34,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/34#issuecomment-232038162,,"Did not hit any regressions, merged to staging.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,35,2016-07-12T08:25:17Z,2016-07-12T13:23:04Z,2016-07-12T13:23:04Z,CLOSED,False,5,3,1,https://github.com/msekletar,install: fix disable via unit file path,1,[],https://github.com/lnykryn/systemd-rhel/pull/35,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/35,"Drop the check for unit file name validity. install_info_add does that
anyway. Also pass NULL in place of name argument to install_info_add if
we are dealing with path to a unit file. install_info_add will figure
out a name from a path and it will correctly populate
UnitFileInstallInfo with both name and path. Then in
unit_file_search called from install_info_traverse we can take a
shortcut and attempt to load unit file directly.
Cherry-picked from: 4dfbf0b176ff0e8a352617eba5e79065ee477969
Resolves: #1348208","Drop the check for unit file name validity. install_info_add does that
anyway. Also pass NULL in place of name argument to install_info_add if
we are dealing with path to a unit file. install_info_add will figure
out a name from a path and it will correctly populate
UnitFileInstallInfo with both name and path. Then in
unit_file_search called from install_info_traverse we can take a
shortcut and attempt to load unit file directly.
Cherry-picked from: 4dfbf0b176ff0e8a352617eba5e79065ee477969
Resolves: #1348208",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,35,2016-07-12T08:25:17Z,2016-07-12T13:23:04Z,2016-07-12T13:23:04Z,CLOSED,False,5,3,1,https://github.com/msekletar,install: fix disable via unit file path,1,[],https://github.com/lnykryn/systemd-rhel/pull/35,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/35#issuecomment-232045415,"Drop the check for unit file name validity. install_info_add does that
anyway. Also pass NULL in place of name argument to install_info_add if
we are dealing with path to a unit file. install_info_add will figure
out a name from a path and it will correctly populate
UnitFileInstallInfo with both name and path. Then in
unit_file_search called from install_info_traverse we can take a
shortcut and attempt to load unit file directly.
Cherry-picked from: 4dfbf0b176ff0e8a352617eba5e79065ee477969
Resolves: #1348208",Looks fine. Merged to staging.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,36,2016-07-13T12:03:35Z,2016-07-25T14:26:27Z,2016-07-25T14:26:27Z,CLOSED,False,127,90,13,https://github.com/jsynacek,Bz1267707,3,[],https://github.com/lnykryn/systemd-rhel/pull/36,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/36,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,36,2016-07-13T12:03:35Z,2016-07-25T14:26:27Z,2016-07-25T14:26:27Z,CLOSED,False,127,90,13,https://github.com/jsynacek,Bz1267707,3,[],https://github.com/lnykryn/systemd-rhel/pull/36,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/36#issuecomment-234968556,,Looks good to me and seems to work. Merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,37,2016-07-14T12:32:49Z,2017-04-18T15:27:00Z,2017-04-18T15:27:00Z,MERGED,True,599,54,30,https://github.com/msekletar,Introduce support for pids cgroup controller via TaskMax and UserTasksMax options (#1337244),4,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/37,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/37,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,37,2016-07-14T12:32:49Z,2017-04-18T15:27:00Z,2017-04-18T15:27:00Z,MERGED,True,599,54,30,https://github.com/msekletar,Introduce support for pids cgroup controller via TaskMax and UserTasksMax options (#1337244),4,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/37,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/37#issuecomment-250466818,,We need to check usertasksmax for logind.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,37,2016-07-14T12:32:49Z,2017-04-18T15:27:00Z,2017-04-18T15:27:00Z,MERGED,True,599,54,30,https://github.com/msekletar,Introduce support for pids cgroup controller via TaskMax and UserTasksMax options (#1337244),4,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/37,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/37#issuecomment-270959672,,I backported support for UserTasksMax option in logind. We necessarily don't need that functionality but it is closely related and makes TaksMax option more useful.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,37,2016-07-14T12:32:49Z,2017-04-18T15:27:00Z,2017-04-18T15:27:00Z,MERGED,True,599,54,30,https://github.com/msekletar,Introduce support for pids cgroup controller via TaskMax and UserTasksMax options (#1337244),4,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/37,https://github.com/lnykryn,4,https://github.com/lnykryn/systemd-rhel/pull/37#issuecomment-294881188,,Seems to work fine.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,38,2016-07-18T06:25:08Z,2016-07-18T06:53:38Z,2018-12-04T13:16:37Z,MERGED,True,90,1,8,https://github.com/lnykryn,manager: don't skip sigchld handler for main and control pid for serv…,1,[],https://github.com/lnykryn/systemd-rhel/pull/38,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/38,"…ices (#3738)
During stop when service has one ""regular"" pid one main pid and one
control pid and the sighld for the regular one is processed first the
unit_tidy_watch_pids will skip the main and control pid and does not
remove them from u->pids(). But then we skip the sigchld event because we
already did one in the iteration and there are two pids in u->pids.
v2: Use general unit_main_pid() and unit_control_pid() instead of
reaching directly to service structure.
Cherry-picked from: ccc2c98
Parts of code from: 291d565
Resolves: #1342173","…ices (#3738)
During stop when service has one ""regular"" pid one main pid and one
control pid and the sighld for the regular one is processed first the
unit_tidy_watch_pids will skip the main and control pid and does not
remove them from u->pids(). But then we skip the sigchld event because we
already did one in the iteration and there are two pids in u->pids.
v2: Use general unit_main_pid() and unit_control_pid() instead of
reaching directly to service structure.
Cherry-picked from: ccc2c98
Parts of code from: 291d565
Resolves: #1342173",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,39,2016-07-29T13:09:48Z,2016-08-04T08:12:24Z,2016-08-04T08:12:25Z,MERGED,True,36,0,4,https://github.com/jsynacek,tests: fix personality tests on ppc64 and aarch64,1,[],https://github.com/lnykryn/systemd-rhel/pull/39,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/39,Resolves: #1361049,Resolves: #1361049,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,40,2016-08-09T08:40:20Z,2016-08-09T13:34:13Z,2016-08-09T13:34:13Z,CLOSED,False,32,5,2,https://github.com/msekletar,Revert of previous commit + current patch from upstream for rhbz#1348208,2,[],https://github.com/lnykryn/systemd-rhel/pull/40,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/40,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,40,2016-08-09T08:40:20Z,2016-08-09T13:34:13Z,2016-08-09T13:34:13Z,CLOSED,False,32,5,2,https://github.com/msekletar,Revert of previous commit + current patch from upstream for rhbz#1348208,2,[],https://github.com/lnykryn/systemd-rhel/pull/40,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/40#issuecomment-238554139,,merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,41,2016-08-09T11:07:49Z,2016-08-09T13:34:19Z,2016-08-09T13:34:19Z,CLOSED,False,1,1,1,https://github.com/msekletar,install: do not crash when processing empty (masked) unit file,1,[],https://github.com/lnykryn/systemd-rhel/pull/41,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/41,Related: #1159308,Related: #1159308,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,41,2016-08-09T11:07:49Z,2016-08-09T13:34:19Z,2016-08-09T13:34:19Z,CLOSED,False,1,1,1,https://github.com/msekletar,install: do not crash when processing empty (masked) unit file,1,[],https://github.com/lnykryn/systemd-rhel/pull/41,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/41#issuecomment-238554166,Related: #1159308,merged to staging,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,42,2016-08-09T14:40:41Z,2016-08-10T14:19:27Z,2016-08-10T14:19:27Z,CLOSED,False,1,1,1,https://github.com/msekletar,udev/path_id: correct segmentation fault due to missing NULL check,1,[],https://github.com/lnykryn/systemd-rhel/pull/42,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/42,"Running ""udevadm test-builtin path_id /sys/devices/platform/"" results
in a segmentation fault.
The problem is that udev_device_get_subsystem(dev) might return NULL
in a streq() call.  Solve this problem by using streq_ptr() instead.
Cherry-picked from: 5181ab9
Resolves: #1365556","Running ""udevadm test-builtin path_id /sys/devices/platform/"" results
in a segmentation fault.
The problem is that udev_device_get_subsystem(dev) might return NULL
in a streq() call.  Solve this problem by using streq_ptr() instead.
Cherry-picked from: 5181ab9
Resolves: #1365556",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,42,2016-08-09T14:40:41Z,2016-08-10T14:19:27Z,2016-08-10T14:19:27Z,CLOSED,False,1,1,1,https://github.com/msekletar,udev/path_id: correct segmentation fault due to missing NULL check,1,[],https://github.com/lnykryn/systemd-rhel/pull/42,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/42#issuecomment-238881205,"Running ""udevadm test-builtin path_id /sys/devices/platform/"" results
in a segmentation fault.
The problem is that udev_device_get_subsystem(dev) might return NULL
in a streq() call.  Solve this problem by using streq_ptr() instead.
Cherry-picked from: 5181ab9
Resolves: #1365556",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,43,2016-08-10T14:07:08Z,2016-08-10T14:15:39Z,2018-12-04T13:16:38Z,MERGED,True,35,4,1,https://github.com/lnykryn,tmpfiles: enforce ordering when executing lines,1,[],https://github.com/lnykryn/systemd-rhel/pull/43,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/43,"Always create files first, and then adjust their ACLs, xattrs, file
attributes, never the opposite. Previously the order was not
deterministic, thus possibly first adjusting ACLs/xattrs/file
attributes before actually creating the items.
Cherry-picked from: 17493fa
Resolves: #1365870","Always create files first, and then adjust their ACLs, xattrs, file
attributes, never the opposite. Previously the order was not
deterministic, thus possibly first adjusting ACLs/xattrs/file
attributes before actually creating the items.
Cherry-picked from: 17493fa
Resolves: #1365870",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,43,2016-08-10T14:07:08Z,2016-08-10T14:15:39Z,2018-12-04T13:16:38Z,MERGED,True,35,4,1,https://github.com/lnykryn,tmpfiles: enforce ordering when executing lines,1,[],https://github.com/lnykryn/systemd-rhel/pull/43,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/43#issuecomment-238880065,"Always create files first, and then adjust their ACLs, xattrs, file
attributes, never the opposite. Previously the order was not
deterministic, thus possibly first adjusting ACLs/xattrs/file
attributes before actually creating the items.
Cherry-picked from: 17493fa
Resolves: #1365870",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,44,2016-08-10T14:42:22Z,2016-08-19T08:03:15Z,2016-08-19T08:03:18Z,MERGED,True,29,22,4,https://github.com/jsynacek,Bz1256858 additional fix,2,[],https://github.com/lnykryn/systemd-rhel/pull/44,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/44,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,44,2016-08-10T14:42:22Z,2016-08-19T08:03:15Z,2016-08-19T08:03:18Z,MERGED,True,29,22,4,https://github.com/jsynacek,Bz1256858 additional fix,2,[],https://github.com/lnykryn/systemd-rhel/pull/44,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/44#issuecomment-240954433,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,45,2016-08-18T12:27:26Z,2016-08-18T12:51:19Z,2018-12-04T13:16:37Z,MERGED,True,1,0,1,https://github.com/lnykryn,rules: load sg driver also when scsi_target appears,1,[],https://github.com/lnykryn/systemd-rhel/pull/45,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/45,Resolves: #1322773,Resolves: #1322773,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,45,2016-08-18T12:27:26Z,2016-08-18T12:51:19Z,2018-12-04T13:16:37Z,MERGED,True,1,0,1,https://github.com/lnykryn,rules: load sg driver also when scsi_target appears,1,[],https://github.com/lnykryn/systemd-rhel/pull/45,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/45#issuecomment-240709100,Resolves: #1322773,LGTM as a temporary workaround.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,46,2016-08-22T07:22:54Z,2016-08-22T07:54:00Z,2016-08-22T07:54:00Z,MERGED,True,5,2,3,https://github.com/msekletar,Bz1368373,3,[],https://github.com/lnykryn/systemd-rhel/pull/46,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/46,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,46,2016-08-22T07:22:54Z,2016-08-22T07:54:00Z,2016-08-22T07:54:00Z,MERGED,True,5,2,3,https://github.com/msekletar,Bz1368373,3,[],https://github.com/lnykryn/systemd-rhel/pull/46,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/46#issuecomment-241338412,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,47,2016-08-22T07:23:15Z,2016-08-22T07:53:43Z,2016-08-22T07:53:45Z,MERGED,True,17,13,9,https://github.com/msekletar,Bz1368374,10,[],https://github.com/lnykryn/systemd-rhel/pull/47,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/47,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,47,2016-08-22T07:23:15Z,2016-08-22T07:53:43Z,2016-08-22T07:53:45Z,MERGED,True,17,13,9,https://github.com/msekletar,Bz1368374,10,[],https://github.com/lnykryn/systemd-rhel/pull/47,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/47#issuecomment-241338377,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,48,2016-08-25T15:41:14Z,2016-08-29T10:29:08Z,2016-08-29T10:29:08Z,CLOSED,False,1,0,1,https://github.com/msekletar,units: remove udev control socket when systemd stops the socket unit,1,[],https://github.com/lnykryn/systemd-rhel/pull/48,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/48,"Mere presence of the socket in the filesystem makes
udev_queue_get_udev_is_active() return that udev is running. Note that,
udev on exit doesn't unlink control socket nor does systemd. Thus socket
stays around even when both daemon and socket are stopped. This causes
problems for cryptsetup because when it detects running udev it launches
synchronous operations that really require udev. This in turn may
cause blocking and subsequent timeout in systemd-cryptsetup on reboot
while machine is in a state that udev and its control socket units are
stopped, e.g. emergency mode.
Fixes #2477
Cherry-picked from: a2de10775194edec51b1e88d20a380724a3dc716
Resolves: #1366575","Mere presence of the socket in the filesystem makes
udev_queue_get_udev_is_active() return that udev is running. Note that,
udev on exit doesn't unlink control socket nor does systemd. Thus socket
stays around even when both daemon and socket are stopped. This causes
problems for cryptsetup because when it detects running udev it launches
synchronous operations that really require udev. This in turn may
cause blocking and subsequent timeout in systemd-cryptsetup on reboot
while machine is in a state that udev and its control socket units are
stopped, e.g. emergency mode.
Fixes #2477
Cherry-picked from: a2de10775194edec51b1e88d20a380724a3dc716
Resolves: #1366575",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,48,2016-08-25T15:41:14Z,2016-08-29T10:29:08Z,2016-08-29T10:29:08Z,CLOSED,False,1,0,1,https://github.com/msekletar,units: remove udev control socket when systemd stops the socket unit,1,[],https://github.com/lnykryn/systemd-rhel/pull/48,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/48#issuecomment-243089207,"Mere presence of the socket in the filesystem makes
udev_queue_get_udev_is_active() return that udev is running. Note that,
udev on exit doesn't unlink control socket nor does systemd. Thus socket
stays around even when both daemon and socket are stopped. This causes
problems for cryptsetup because when it detects running udev it launches
synchronous operations that really require udev. This in turn may
cause blocking and subsequent timeout in systemd-cryptsetup on reboot
while machine is in a state that udev and its control socket units are
stopped, e.g. emergency mode.
Fixes #2477
Cherry-picked from: a2de10775194edec51b1e88d20a380724a3dc716
Resolves: #1366575",-> #49,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,49,2016-08-29T10:28:51Z,2016-08-29T12:49:21Z,2016-08-29T12:49:21Z,MERGED,True,1,0,1,https://github.com/msekletar,units: remove udev control socket when systemd stops the socket unit,1,[],https://github.com/lnykryn/systemd-rhel/pull/49,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/49,"Mere presence of the socket in the filesystem makes
udev_queue_get_udev_is_active() return that udev is running. Note that,
udev on exit doesn't unlink control socket nor does systemd. Thus socket
stays around even when both daemon and socket are stopped. This causes
problems for cryptsetup because when it detects running udev it launches
synchronous operations that really require udev. This in turn may
cause blocking and subsequent timeout in systemd-cryptsetup on reboot
while machine is in a state that udev and its control socket units are
stopped, e.g. emergency mode.
Fixes #2477
Cherry-picked from: a2de10775194edec51b1e88d20a380724a3dc716
Resolves: #1370133","Mere presence of the socket in the filesystem makes
udev_queue_get_udev_is_active() return that udev is running. Note that,
udev on exit doesn't unlink control socket nor does systemd. Thus socket
stays around even when both daemon and socket are stopped. This causes
problems for cryptsetup because when it detects running udev it launches
synchronous operations that really require udev. This in turn may
cause blocking and subsequent timeout in systemd-cryptsetup on reboot
while machine is in a state that udev and its control socket units are
stopped, e.g. emergency mode.
Fixes #2477
Cherry-picked from: a2de10775194edec51b1e88d20a380724a3dc716
Resolves: #1370133",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,49,2016-08-29T10:28:51Z,2016-08-29T12:49:21Z,2016-08-29T12:49:21Z,MERGED,True,1,0,1,https://github.com/msekletar,units: remove udev control socket when systemd stops the socket unit,1,[],https://github.com/lnykryn/systemd-rhel/pull/49,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/49#issuecomment-243105533,"Mere presence of the socket in the filesystem makes
udev_queue_get_udev_is_active() return that udev is running. Note that,
udev on exit doesn't unlink control socket nor does systemd. Thus socket
stays around even when both daemon and socket are stopped. This causes
problems for cryptsetup because when it detects running udev it launches
synchronous operations that really require udev. This in turn may
cause blocking and subsequent timeout in systemd-cryptsetup on reboot
while machine is in a state that udev and its control socket units are
stopped, e.g. emergency mode.
Fixes #2477
Cherry-picked from: a2de10775194edec51b1e88d20a380724a3dc716
Resolves: #1370133",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,50,2016-08-29T10:30:21Z,2016-08-29T12:48:48Z,2016-08-31T08:41:15Z,MERGED,True,436,367,49,https://github.com/msekletar,Bz1318994 (journald backports) ,19,[],https://github.com/lnykryn/systemd-rhel/pull/50,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/50,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,50,2016-08-29T10:30:21Z,2016-08-29T12:48:48Z,2016-08-31T08:41:15Z,MERGED,True,436,367,49,https://github.com/msekletar,Bz1318994 (journald backports) ,19,[],https://github.com/lnykryn/systemd-rhel/pull/50,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/50#issuecomment-243114273,,"Tested in 1minute tip, It looks that the patch set does not break anything.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,51,2016-09-01T08:43:09Z,2016-09-05T13:50:12Z,2018-12-04T13:16:38Z,MERGED,True,0,1,1,https://github.com/lnykryn,logind: don't assert if the slice is missing,1,[],https://github.com/lnykryn/systemd-rhel/pull/51,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/51,"After all, we don't actually really need the slice to work, it's just
nice to have it.
Cherry-picked from: 3859948
Resolves: #1371437","After all, we don't actually really need the slice to work, it's just
nice to have it.
Cherry-picked from: 3859948
Resolves: #1371437",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,52,2016-09-01T08:44:14Z,2016-09-05T13:50:08Z,2018-12-04T13:16:38Z,MERGED,True,13,1,2,https://github.com/lnykryn,core: enable transient unit support for slice units,1,[],https://github.com/lnykryn/systemd-rhel/pull/52,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/52,"Cherry-picked from: 17f62e9
Resolves: #1370299","Cherry-picked from: 17f62e9
Resolves: #1370299",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,53,2016-09-01T08:46:15Z,2016-09-05T13:46:52Z,2018-12-04T13:16:38Z,MERGED,True,2,2,1,https://github.com/lnykryn,sd-bus: bump message queue size,1,[],https://github.com/lnykryn/systemd-rhel/pull/53,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/53,"Let's bump it further, as this the current limit turns out to be problematic
IRL. Let's bump it to more than twice what we know of is needed.
Fixes: #4068
Cherry-picked from: 5ddda46
Resolves: #1371205","Let's bump it further, as this the current limit turns out to be problematic
IRL. Let's bump it to more than twice what we know of is needed.
Fixes: #4068
Cherry-picked from: 5ddda46
Resolves: #1371205",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,54,2016-09-01T08:47:40Z,2016-09-05T13:48:47Z,2018-12-04T13:16:36Z,MERGED,True,1,1,1,https://github.com/lnykryn,install: fix disable when /etc/systemd/system is a symlink,1,[],https://github.com/lnykryn/systemd-rhel/pull/54,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/54,"Cherry-picked from: 67852d0
Resolves: #1285996","Cherry-picked from: 67852d0
Resolves: #1285996",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,55,2016-09-05T11:12:46Z,2016-09-05T13:42:37Z,2016-09-05T13:42:42Z,MERGED,True,10,0,1,https://github.com/msekletar,Bz1274651,3,[],https://github.com/lnykryn/systemd-rhel/pull/55,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/55,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,55,2016-09-05T11:12:46Z,2016-09-05T13:42:37Z,2016-09-05T13:42:42Z,MERGED,True,10,0,1,https://github.com/msekletar,Bz1274651,3,[],https://github.com/lnykryn/systemd-rhel/pull/55,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/55#issuecomment-244749976,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,56,2016-09-05T12:42:27Z,2016-12-09T12:29:57Z,2018-12-04T13:16:39Z,MERGED,True,1,1,1,https://github.com/lnykryn,unit: don't add Requires for tmp.mount (#1372249),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/56,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/56,"rhel-only
Resolves: #1372249","rhel-only
Resolves: #1372249",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,56,2016-09-05T12:42:27Z,2016-12-09T12:29:57Z,2018-12-04T13:16:39Z,MERGED,True,1,1,1,https://github.com/lnykryn,unit: don't add Requires for tmp.mount (#1372249),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/56,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/56#issuecomment-244740092,"rhel-only
Resolves: #1372249","I propose we check fragment path instead of unit id, to make sure we really apply this special case only for tmp.mount unit provided by systemd package.
Check would look like this,
if (m->fragment_path && !streq(m->fragment_path, ""/usr/lib/systemd/system/tmp.mount""))",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,56,2016-09-05T12:42:27Z,2016-12-09T12:29:57Z,2018-12-04T13:16:39Z,MERGED,True,1,1,1,https://github.com/lnykryn,unit: don't add Requires for tmp.mount (#1372249),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/56,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/56#issuecomment-266003075,"rhel-only
Resolves: #1372249","I propose we check fragment path instead of unit id, to make sure we really apply this special case only for tmp.mount unit provided by systemd package.

Let's merge this fix as proposed by this PR. If that proves to be problematic we can then come up with some more elaborate check.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,57,2016-09-13T11:13:45Z,2016-09-13T11:27:08Z,2016-09-13T11:27:08Z,MERGED,True,17,16,2,https://github.com/msekletar,"systemctl,pid1: do not warn about missing install info with ""preset""",1,[],https://github.com/lnykryn/systemd-rhel/pull/57,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/57,"When ""preset"" was executed for a unit without install info, we'd warn similarly
as for ""enable"" and ""disable"". But ""preset"" is usually called for all units,
because the preset files are provided by the distribution, and the units are under
control of individual programs, and it's reasonable to call ""preset"" for all units
rather then try to do it only for the ones that can be installed.
We also don't warn about missing info for ""preset-all"". Thus it seems reasonable
to silently ignore units w/o install info when presetting.
(In addition, when more than one unit was specified, we'd issue the warning
only if none of them had install info. But this is probably something to fix
for enable/disable too.)
Cherry-picked from: 3920737
Resolves: #1373950","When ""preset"" was executed for a unit without install info, we'd warn similarly
as for ""enable"" and ""disable"". But ""preset"" is usually called for all units,
because the preset files are provided by the distribution, and the units are under
control of individual programs, and it's reasonable to call ""preset"" for all units
rather then try to do it only for the ones that can be installed.
We also don't warn about missing info for ""preset-all"". Thus it seems reasonable
to silently ignore units w/o install info when presetting.
(In addition, when more than one unit was specified, we'd issue the warning
only if none of them had install info. But this is probably something to fix
for enable/disable too.)
Cherry-picked from: 3920737
Resolves: #1373950",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,57,2016-09-13T11:13:45Z,2016-09-13T11:27:08Z,2016-09-13T11:27:08Z,MERGED,True,17,16,2,https://github.com/msekletar,"systemctl,pid1: do not warn about missing install info with ""preset""",1,[],https://github.com/lnykryn/systemd-rhel/pull/57,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/57#issuecomment-246652232,"When ""preset"" was executed for a unit without install info, we'd warn similarly
as for ""enable"" and ""disable"". But ""preset"" is usually called for all units,
because the preset files are provided by the distribution, and the units are under
control of individual programs, and it's reasonable to call ""preset"" for all units
rather then try to do it only for the ones that can be installed.
We also don't warn about missing info for ""preset-all"". Thus it seems reasonable
to silently ignore units w/o install info when presetting.
(In addition, when more than one unit was specified, we'd issue the warning
only if none of them had install info. But this is probably something to fix
for enable/disable too.)
Cherry-picked from: 3920737
Resolves: #1373950",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,58,2016-09-13T11:13:53Z,2016-09-13T11:14:27Z,2016-09-13T11:14:27Z,CLOSED,False,21,5,1,https://github.com/msekletar,Bz1375097,2,[],https://github.com/lnykryn/systemd-rhel/pull/58,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/58,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,59,2016-09-13T11:18:46Z,2016-09-13T11:27:47Z,2016-09-13T11:27:47Z,MERGED,True,67,19,5,https://github.com/msekletar,Bz1375097,3,[],https://github.com/lnykryn/systemd-rhel/pull/59,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/59,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,59,2016-09-13T11:18:46Z,2016-09-13T11:27:47Z,2016-09-13T11:27:47Z,MERGED,True,67,19,5,https://github.com/msekletar,Bz1375097,3,[],https://github.com/lnykryn/systemd-rhel/pull/59,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/59#issuecomment-246652367,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,60,2016-09-13T11:19:11Z,2016-09-13T11:28:20Z,2018-12-04T13:16:38Z,MERGED,True,1,1,1,https://github.com/lnykryn,40-redhat.rules: don't hoplug memory on s390x,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/60,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/60,Resolves: #1370161,Resolves: #1370161,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,61,2016-09-29T13:05:21Z,2016-09-29T14:38:18Z,2017-02-27T14:12:25Z,MERGED,True,1,1,1,https://github.com/msekletar,40-redhat.rules: disable auto-online of hot-plugged memory on IBM z Systems,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/61,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/61,Related: #1375603,Related: #1375603,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,62,2016-10-17T06:34:28Z,2016-10-21T15:16:04Z,2018-12-04T13:16:39Z,MERGED,True,15,0,3,https://github.com/lnykryn,virt: add possibility to skip the check for chroot,1,[],https://github.com/lnykryn/systemd-rhel/pull/62,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/62,"Cherry-picked from: 08a28ee
Resolves: #1379852","Cherry-picked from: 08a28ee
Resolves: #1379852",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,62,2016-10-17T06:34:28Z,2016-10-21T15:16:04Z,2018-12-04T13:16:39Z,MERGED,True,15,0,3,https://github.com/lnykryn,virt: add possibility to skip the check for chroot,1,[],https://github.com/lnykryn/systemd-rhel/pull/62,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/62#issuecomment-254410742,"Cherry-picked from: 08a28ee
Resolves: #1379852",Looks ok to me.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,63,2016-11-01T11:36:00Z,2016-12-09T12:22:05Z,2018-12-04T13:16:39Z,MERGED,True,5,1,1,https://github.com/lnykryn,Recognise Lustre as a remote file system (#4530) (#1390542),1,[],https://github.com/lnykryn/systemd-rhel/pull/63,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/63,"Lustre is also a remote file system that wants the network to be up before it is mounted.
Cherry-picked from: 67ae436
Resolves: #1390542","Lustre is also a remote file system that wants the network to be up before it is mounted.
Cherry-picked from: 67ae436
Resolves: #1390542",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,63,2016-11-01T11:36:00Z,2016-12-09T12:22:05Z,2018-12-04T13:16:39Z,MERGED,True,5,1,1,https://github.com/lnykryn,Recognise Lustre as a remote file system (#4530) (#1390542),1,[],https://github.com/lnykryn/systemd-rhel/pull/63,https://github.com/blaskovic,2,https://github.com/lnykryn/systemd-rhel/pull/63#issuecomment-259938113,"Lustre is also a remote file system that wants the network to be up before it is mounted.
Cherry-picked from: 67ae436
Resolves: #1390542","@lnykryn And what are the others? pvfs2 and ocfs2.
Is it necessary for bug 1390542 to be fixed?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,63,2016-11-01T11:36:00Z,2016-12-09T12:22:05Z,2018-12-04T13:16:39Z,MERGED,True,5,1,1,https://github.com/lnykryn,Recognise Lustre as a remote file system (#4530) (#1390542),1,[],https://github.com/lnykryn/systemd-rhel/pull/63,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/63#issuecomment-259939040,"Lustre is also a remote file system that wants the network to be up before it is mounted.
Cherry-picked from: 67ae436
Resolves: #1390542","It is not necessary, but why not backport it as well?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,65,2016-11-10T10:14:28Z,2016-11-10T13:06:27Z,2018-12-04T13:16:40Z,MERGED,True,9,13,2,https://github.com/lnykryn,pid1: process zero-length notification messages,1,"['rhel-7.1', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/65,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/65,Resolves:#1393420,Resolves:#1393420,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,65,2016-11-10T10:14:28Z,2016-11-10T13:06:27Z,2018-12-04T13:16:40Z,MERGED,True,9,13,2,https://github.com/lnykryn,pid1: process zero-length notification messages,1,"['rhel-7.1', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/65,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/65#issuecomment-259661354,Resolves:#1393420,Looks ok to me.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,66,2016-11-10T12:38:53Z,2016-12-09T12:18:29Z,2018-12-04T13:16:36Z,MERGED,True,9,0,2,https://github.com/lnykryn,Bz1298355,2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/66,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/66,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,66,2016-11-10T12:38:53Z,2016-12-09T12:18:29Z,2018-12-04T13:16:36Z,MERGED,True,9,0,2,https://github.com/lnykryn,Bz1298355,2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/66,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/66#issuecomment-259693970,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,67,2016-11-18T14:47:04Z,2016-11-29T09:41:15Z,2016-11-29T09:41:15Z,MERGED,True,5,1,2,https://github.com/msekletar,load-fragment: fix parsing values in bytes and prevent returning -ERANGE incorrectly (#1396277),1,"['bug', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/67,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/67,"We didn't port our code base to use uint64_t instead of off_t as
upstream did. RLIMIT_INIFINITY is -1ULL and if we cast to off_t (64 bit
signed int on arches we support) then we get -1 and that is always
smaller than correct value returned by parse_size().
To make code changes as minimal as possible (i.e. not port everything
to uint64_t) let's cast off_t to uint64_t and not the other way
around.","We didn't port our code base to use uint64_t instead of off_t as
upstream did. RLIMIT_INIFINITY is -1ULL and if we cast to off_t (64 bit
signed int on arches we support) then we get -1 and that is always
smaller than correct value returned by parse_size().
To make code changes as minimal as possible (i.e. not port everything
to uint64_t) let's cast off_t to uint64_t and not the other way
around.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,67,2016-11-18T14:47:04Z,2016-11-29T09:41:15Z,2016-11-29T09:41:15Z,MERGED,True,5,1,2,https://github.com/msekletar,load-fragment: fix parsing values in bytes and prevent returning -ERANGE incorrectly (#1396277),1,"['bug', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/67,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/67#issuecomment-261862150,"We didn't port our code base to use uint64_t instead of off_t as
upstream did. RLIMIT_INIFINITY is -1ULL and if we cast to off_t (64 bit
signed int on arches we support) then we get -1 and that is always
smaller than correct value returned by parse_size().
To make code changes as minimal as possible (i.e. not port everything
to uint64_t) let's cast off_t to uint64_t and not the other way
around.",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,68,2016-11-18T15:27:38Z,2016-11-22T11:34:28Z,2017-01-25T14:41:16Z,MERGED,True,2,4,1,https://github.com/msekletar,manager: do not produce extraneous log message on EAGAIN (#1395676),1,"['bug', 'rhel-7.2', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/68,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/68,"Once we process notification we start new iteration of for loop and if
no new notification message is queued then recvmsg returns EAGAIN. That
is expected and we should only log about errors other than EAGAIN and
EINTR.
RHEL-only
Resolves: #1395676","Once we process notification we start new iteration of for loop and if
no new notification message is queued then recvmsg returns EAGAIN. That
is expected and we should only log about errors other than EAGAIN and
EINTR.
RHEL-only
Resolves: #1395676",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,68,2016-11-18T15:27:38Z,2016-11-22T11:34:28Z,2017-01-25T14:41:16Z,MERGED,True,2,4,1,https://github.com/msekletar,manager: do not produce extraneous log message on EAGAIN (#1395676),1,"['bug', 'rhel-7.2', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/68,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/68#issuecomment-261862310,"Once we process notification we start new iteration of for loop and if
no new notification message is queued then recvmsg returns EAGAIN. That
is expected and we should only log about errors other than EAGAIN and
EINTR.
RHEL-only
Resolves: #1395676",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,68,2016-11-18T15:27:38Z,2016-11-22T11:34:28Z,2017-01-25T14:41:16Z,MERGED,True,2,4,1,https://github.com/msekletar,manager: do not produce extraneous log message on EAGAIN (#1395676),1,"['bug', 'rhel-7.2', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/68,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/68#issuecomment-261981546,"Once we process notification we start new iteration of for loop and if
no new notification message is queued then recvmsg returns EAGAIN. That
is expected and we should only log about errors other than EAGAIN and
EINTR.
RHEL-only
Resolves: #1395676","Is it fine that we will swap also break and continue with this change?

Maybe we should break unconditionally.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,69,2016-11-18T15:36:40Z,2016-11-29T09:41:20Z,2016-11-29T09:41:20Z,MERGED,True,1,1,1,https://github.com/msekletar,core: fix assertion check (#1396312),1,"['bug', 'merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/69,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/69,"Fixes: #2632
Cherry-picked from: 3f51aec
Resolves: #1396312","Fixes: #2632
Cherry-picked from: 3f51aec
Resolves: #1396312",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,69,2016-11-18T15:36:40Z,2016-11-29T09:41:20Z,2016-11-29T09:41:20Z,MERGED,True,1,1,1,https://github.com/msekletar,core: fix assertion check (#1396312),1,"['bug', 'merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/69,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/69#issuecomment-261862436,"Fixes: #2632
Cherry-picked from: 3f51aec
Resolves: #1396312",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,70,2016-12-09T14:07:19Z,2016-12-11T12:25:23Z,2018-12-04T13:16:40Z,MERGED,True,2,0,1,https://github.com/lnykryn,core: return 0 from device_serialize() (bz1403249),1,['sanity-only'],https://github.com/lnykryn/systemd-rhel/pull/70,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/70,"Fixes:
CC       src/core/libsystemd_core_la-device.lo
src/core/device.c: In function 'device_serialize':
src/core/device.c:169:1: warning: control reaches end of non-void function [-Wreturn-type]
}
^
Cherry-picked from: 0108f6e
Resolves: #1403249","Fixes:
CC       src/core/libsystemd_core_la-device.lo
src/core/device.c: In function 'device_serialize':
src/core/device.c:169:1: warning: control reaches end of non-void function [-Wreturn-type]
}
^
Cherry-picked from: 0108f6e
Resolves: #1403249",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,71,2016-12-13T13:27:01Z,2016-12-13T13:38:33Z,2018-12-04T13:16:40Z,MERGED,True,1,0,1,https://github.com/lnykryn,mtd_probe: include stdint bz1404251,1,['sanity-only'],https://github.com/lnykryn/systemd-rhel/pull/71,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/71,Resolves: #1404251,Resolves: #1404251,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,71,2016-12-13T13:27:01Z,2016-12-13T13:38:33Z,2018-12-04T13:16:40Z,MERGED,True,1,0,1,https://github.com/lnykryn,mtd_probe: include stdint bz1404251,1,['sanity-only'],https://github.com/lnykryn/systemd-rhel/pull/71,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/71#issuecomment-266740361,Resolves: #1404251,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,72,2017-01-03T11:40:33Z,2017-01-16T11:23:34Z,2018-12-04T13:16:40Z,MERGED,True,5,3,1,https://github.com/lnykryn,Bug 1409586 - Cannot modify CapabilityBoundingSet in drop-in file,2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/72,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/72,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,72,2017-01-03T11:40:33Z,2017-01-16T11:23:34Z,2018-12-04T13:16:40Z,MERGED,True,5,3,1,https://github.com/lnykryn,Bug 1409586 - Cannot modify CapabilityBoundingSet in drop-in file,2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/72,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/72#issuecomment-270112006,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,73,2017-01-03T13:51:32Z,2017-01-16T11:24:59Z,2018-12-04T13:16:40Z,MERGED,True,81,3,5,https://github.com/lnykryn,(rhbz 1409588) core: make parsing of RLIMIT_NICE aware of actual nice levels,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/73,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/73,"RHEL-only
(most of code taken from 2985700)
Resolves: #1409588","RHEL-only
(most of code taken from 2985700)
Resolves: #1409588",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,73,2017-01-03T13:51:32Z,2017-01-16T11:24:59Z,2018-12-04T13:16:40Z,MERGED,True,81,3,5,https://github.com/lnykryn,(rhbz 1409588) core: make parsing of RLIMIT_NICE aware of actual nice levels,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/73,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/73#issuecomment-270368659,"RHEL-only
(most of code taken from 2985700)
Resolves: #1409588",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,74,2017-01-03T15:40:22Z,2017-01-12T10:55:49Z,2018-12-04T13:16:38Z,MERGED,True,104,85,19,https://github.com/lnykryn,Add possibility to define action taken upon hitting Ctrl-Alt-Delete (#1353028),3,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/74,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/74,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,74,2017-01-03T15:40:22Z,2017-01-12T10:55:49Z,2018-12-04T13:16:38Z,MERGED,True,104,85,19,https://github.com/lnykryn,Add possibility to define action taken upon hitting Ctrl-Alt-Delete (#1353028),3,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/74,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/74#issuecomment-270961041,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,75,2017-01-04T11:45:29Z,2017-01-12T09:54:35Z,2017-01-25T14:36:51Z,MERGED,True,6,0,1,https://github.com/msekletar,sd-journal: properly export has_{persistent|runtime}_files() (#1409527),1,"['bug', 'merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/75,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/75,"Cherry-picked from: 9a07f77
Resolves: #1409527","Cherry-picked from: 9a07f77
Resolves: #1409527",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,76,2017-01-06T11:25:29Z,2017-01-12T09:52:04Z,2017-02-06T08:34:40Z,MERGED,True,2,2,2,https://github.com/msekletar,tests: fix failure of test-execute if /dev/mem is not available (#1410056),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/76,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/76,"/dev/mem isn't necessarily available. Recently, I've encountered arm64
systems that didn't provide raw memory access via /dev/mem. Instead,
let's use /dev/kmsg since we don't support systems w/o it anyway.
Cherry-picked from: 01349f5
Resolves: #1410056","/dev/mem isn't necessarily available. Recently, I've encountered arm64
systems that didn't provide raw memory access via /dev/mem. Instead,
let's use /dev/kmsg since we don't support systems w/o it anyway.
Cherry-picked from: 01349f5
Resolves: #1410056",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,77,2017-01-06T16:46:31Z,2017-01-16T11:22:16Z,2017-01-16T11:22:16Z,MERGED,True,9,0,1,https://github.com/msekletar,udev/path_id: introduce support for NVMe devices (#1373150),1,['enhancement'],https://github.com/lnykryn/systemd-rhel/pull/77,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/77,"This appends the nvme name and namespace identifier attribute the the
PCI path for by-path links. Symlinks like the following are now present:
lrwxrwxrwx. 1 root root 13 Sep 16 12:12 pci-0000:01:00.0-nvme-1 -> ../../nvme0n1
lrwxrwxrwx. 1 root root 15 Sep 16 12:12 pci-0000:01:00.0-nvme-1-part1 -> ../../nvme0n1p1
Cc: Michal Sekletar sekletar.m@gmail.com
Signed-off-by: Keith Busch keith.busch@intel.com
Cherry-picked from: b4c6f71
Resolves: #1373150","This appends the nvme name and namespace identifier attribute the the
PCI path for by-path links. Symlinks like the following are now present:
lrwxrwxrwx. 1 root root 13 Sep 16 12:12 pci-0000:01:00.0-nvme-1 -> ../../nvme0n1
lrwxrwxrwx. 1 root root 15 Sep 16 12:12 pci-0000:01:00.0-nvme-1-part1 -> ../../nvme0n1p1
Cc: Michal Sekletar sekletar.m@gmail.com
Signed-off-by: Keith Busch keith.busch@intel.com
Cherry-picked from: b4c6f71
Resolves: #1373150",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,78,2017-01-13T07:19:41Z,2017-01-16T11:37:23Z,2017-01-25T14:26:15Z,MERGED,True,12,4,1,https://github.com/jsynacek,Bz1409997 unmask fix,3,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/78,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/78,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,79,2017-01-17T15:46:37Z,2017-02-07T09:58:21Z,2017-02-21T15:03:24Z,MERGED,True,279,129,9,https://github.com/jsynacek,Bz1413041 is enabled,2,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/79,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/79,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,80,2017-01-19T09:35:06Z,2017-02-06T15:31:31Z,2018-12-04T13:16:39Z,MERGED,True,18,6,1,https://github.com/lnykryn,(rhbz#1392426) udev: net_id: add support for phys_port_name attribute (#4506),1,[],https://github.com/lnykryn/systemd-rhel/pull/80,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/80,"Switch drivers uses phys_port_name attribute to pass front panel port
name to user. Use it to generate netdev names.
Signed-off-by: Jiri Pirko jiri@mellanox.com
Cherry-picked from: 4887b65
Resolves: #1392426","Switch drivers uses phys_port_name attribute to pass front panel port
name to user. Use it to generate netdev names.
Signed-off-by: Jiri Pirko jiri@mellanox.com
Cherry-picked from: 4887b65
Resolves: #1392426",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,80,2017-01-19T09:35:06Z,2017-02-06T15:31:31Z,2018-12-04T13:16:39Z,MERGED,True,18,6,1,https://github.com/lnykryn,(rhbz#1392426) udev: net_id: add support for phys_port_name attribute (#4506),1,[],https://github.com/lnykryn/systemd-rhel/pull/80,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/80#issuecomment-273743368,"Switch drivers uses phys_port_name attribute to pass front panel port
name to user. Use it to generate netdev names.
Signed-off-by: Jiri Pirko jiri@mellanox.com
Cherry-picked from: 4887b65
Resolves: #1392426","LGTM. I don't think there's anything to exhaustively review about this patch. It probably should be exhaustively tested, though.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,81,2017-01-23T11:45:51Z,2017-01-25T09:30:53Z,2017-02-20T11:53:38Z,MERGED,True,1,1,1,https://github.com/jsynacek,(bz#1413964) systemctl: fix 'is-enabled' exit status on failure when executed in c…,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/81,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/81,"…hroot (#4773)
(cherry picked from commit c5024cd)
Resolves: #1413964","…hroot (#4773)
(cherry picked from commit c5024cd)
Resolves: #1413964",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,82,2017-01-24T10:08:42Z,2017-01-25T09:14:29Z,2017-02-07T09:04:43Z,MERGED,True,2,2,2,https://github.com/jsynacek,core: improve error message when RefuseManualStart(Stop) is hit (#5132) (rhbz#1026648),1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/82,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/82,"(cherry picked from commit 7e974e8)
Resolves: #1026648","(cherry picked from commit 7e974e8)
Resolves: #1026648",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,83,2017-01-24T14:56:31Z,2017-02-06T15:27:01Z,2018-12-04T13:16:41Z,MERGED,True,2,1,1,https://github.com/lnykryn,(#1416062) basic: fix touch() creating files with 07777 mode,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/83,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/83,"mode_t is unsigned, so MODE_INVALID < 0 can never be true.
This fixes a possible DoS where any user could fill /run by writing to
a world-writable /run/systemd/show-status.
Cherry-picked from: 06eeacb
Resolves: #1416062","mode_t is unsigned, so MODE_INVALID < 0 can never be true.
This fixes a possible DoS where any user could fill /run by writing to
a world-writable /run/systemd/show-status.
Cherry-picked from: 06eeacb
Resolves: #1416062",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,83,2017-01-24T14:56:31Z,2017-02-06T15:27:01Z,2018-12-04T13:16:41Z,MERGED,True,2,1,1,https://github.com/lnykryn,(#1416062) basic: fix touch() creating files with 07777 mode,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/83,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/83#issuecomment-274827368,"mode_t is unsigned, so MODE_INVALID < 0 can never be true.
This fixes a possible DoS where any user could fill /run by writing to
a world-writable /run/systemd/show-status.
Cherry-picked from: 06eeacb
Resolves: #1416062","Better safe than sorry, I agree. LGTM.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,83,2017-01-24T14:56:31Z,2017-02-06T15:27:01Z,2018-12-04T13:16:41Z,MERGED,True,2,1,1,https://github.com/lnykryn,(#1416062) basic: fix touch() creating files with 07777 mode,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/83,https://github.com/blaskovic,3,https://github.com/lnykryn/systemd-rhel/pull/83#issuecomment-283331336,"mode_t is unsigned, so MODE_INVALID < 0 can never be true.
This fixes a possible DoS where any user could fill /run by writing to
a world-writable /run/systemd/show-status.
Cherry-picked from: 06eeacb
Resolves: #1416062","I cannot see this issue covered in unit tests. I think this is great candidate for it.
Preferably extend test/test-conf-files.c (line ~31) to try more modes and check mode of created files too.",True,{'THUMBS_UP': ['https://github.com/mrc0mmand']}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,83,2017-01-24T14:56:31Z,2017-02-06T15:27:01Z,2018-12-04T13:16:41Z,MERGED,True,2,1,1,https://github.com/lnykryn,(#1416062) basic: fix touch() creating files with 07777 mode,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/83,https://github.com/jsynacek,4,https://github.com/lnykryn/systemd-rhel/pull/83#issuecomment-283354455,"mode_t is unsigned, so MODE_INVALID < 0 can never be true.
This fixes a possible DoS where any user could fill /run by writing to
a world-writable /run/systemd/show-status.
Cherry-picked from: 06eeacb
Resolves: #1416062",That's because this commit was proactive. The original upstream bug from which the commit originated cannot be reproduced in RHEL7.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,83,2017-01-24T14:56:31Z,2017-02-06T15:27:01Z,2018-12-04T13:16:41Z,MERGED,True,2,1,1,https://github.com/lnykryn,(#1416062) basic: fix touch() creating files with 07777 mode,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/83,https://github.com/blaskovic,5,https://github.com/lnykryn/systemd-rhel/pull/83#issuecomment-283356410,"mode_t is unsigned, so MODE_INVALID < 0 can never be true.
This fixes a possible DoS where any user could fill /run by writing to
a world-writable /run/systemd/show-status.
Cherry-picked from: 06eeacb
Resolves: #1416062","Well, it could be reproduced in unit test by calling touch_file() directly (as we do already).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,84,2017-01-25T07:40:32Z,2017-02-06T11:09:01Z,2017-02-06T11:09:01Z,MERGED,True,1,1,1,https://github.com/jsynacek,random-seed: raise POOL_SIZE_MIN to 1024 (#1386824),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/84,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/84,Resolves: #1386824,Resolves: #1386824,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,85,2017-01-26T09:21:12Z,2017-02-06T14:55:55Z,2017-02-27T14:46:14Z,MERGED,True,1,1,1,https://github.com/jsynacek,bash-completion: add support for --now (#5155) (rhbz#1351806),1,"['merge-ready', 'sanity-only']",https://github.com/lnykryn/systemd-rhel/pull/85,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/85,"(cherry picked from commit 0067c7b)
Resolves: #1351806","(cherry picked from commit 0067c7b)
Resolves: #1351806",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,86,2017-02-02T11:19:00Z,2017-02-06T11:08:16Z,2017-02-06T11:08:16Z,MERGED,True,2,1,1,https://github.com/jsynacek,man: document that the automatic journal limits are capped to 4G by d…,1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/86,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/86,"…efault
(cherry picked from commit 3225266)
Resolves: #1418547","…efault
(cherry picked from commit 3225266)
Resolves: #1418547",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,88,2017-02-07T11:59:02Z,2017-02-20T11:04:44Z,2017-03-02T10:58:48Z,MERGED,True,8,2,1,https://github.com/jsynacek,(#1361601) udev: inform systemd how many workers we can potentially spawn (#4036),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/88,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/88,"(cherry picked from commit 1ef72b5)
Resolves: #1361601","(cherry picked from commit 1ef72b5)
Resolves: #1361601",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,89,2017-02-08T09:16:12Z,2017-02-20T12:14:27Z,2017-02-21T15:01:06Z,MERGED,True,269,28,8,https://github.com/jsynacek,(#1354410) RFE: add idle timeout,2,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/89,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/89,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,89,2017-02-08T09:16:12Z,2017-02-20T12:14:27Z,2017-02-21T15:01:06Z,MERGED,True,269,28,8,https://github.com/jsynacek,(#1354410) RFE: add idle timeout,2,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/89,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/89#issuecomment-281064338,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,90,2017-02-09T11:36:59Z,2017-02-20T11:03:26Z,2017-02-20T11:03:26Z,MERGED,True,12,8,1,https://github.com/jsynacek,(#1417459) systemctl: make sure that --now is carried out (#5209),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/90,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/90,"When services are already enabled/disabled/masked, make sure
that --now still enforces start/stop.
(cherry picked from commit 6bc3069)
Resolves: #1417459","When services are already enabled/disabled/masked, make sure
that --now still enforces start/stop.
(cherry picked from commit 6bc3069)
Resolves: #1417459",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,91,2017-02-10T07:31:49Z,2017-02-10T09:00:41Z,2017-02-27T14:10:59Z,MERGED,True,4,1,1,https://github.com/msekletar,udev: fix crash with invalid udev.log-priority (#1245293),1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/91,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/91,"Fixes: https://bugzilla.redhat.com/show_bug.cgi?id=1245293
Conflicts:
src/udev/udevd.c
Cherry-picked from: e00f5bd
Resolves: #1245293","Fixes: https://bugzilla.redhat.com/show_bug.cgi?id=1245293
Conflicts:
src/udev/udevd.c
Cherry-picked from: e00f5bd
Resolves: #1245293",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,92,2017-02-13T13:47:05Z,2017-02-20T10:55:39Z,2018-12-04T13:16:41Z,MERGED,True,9,1,1,https://github.com/lnykryn,(#1421658) core: if the start command vanishes during runtime don't hit an assert,1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/92,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/92,"This can happen when the configuration is changed and reloaded while we are
executing a service. Let's not hit an assert in this case.
Fixes: #4444
Cherry-picked from: 47fffb3
Resolves: #1421658","This can happen when the configuration is changed and reloaded while we are
executing a service. Let's not hit an assert in this case.
Fixes: #4444
Cherry-picked from: 47fffb3
Resolves: #1421658",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,92,2017-02-13T13:47:05Z,2017-02-20T10:55:39Z,2018-12-04T13:16:41Z,MERGED,True,9,1,1,https://github.com/lnykryn,(#1421658) core: if the start command vanishes during runtime don't hit an assert,1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/92,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/92#issuecomment-279397958,"This can happen when the configuration is changed and reloaded while we are
executing a service. Let's not hit an assert in this case.
Fixes: #4444
Cherry-picked from: 47fffb3
Resolves: #1421658",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,93,2017-02-13T16:25:08Z,2017-02-13T16:26:57Z,2017-02-23T10:46:36Z,CLOSED,False,9,1,1,https://github.com/msekletar,core: if the start command vanishes during runtime don't hit an assert (#1421658),1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/93,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/93,"This can happen when the configuration is changed and reloaded while we are
executing a service. Let's not hit an assert in this case.
Fixes: #4444
Cherry-picked from: 47fffb3
Resolves: #1421658","This can happen when the configuration is changed and reloaded while we are
executing a service. Let's not hit an assert in this case.
Fixes: #4444
Cherry-picked from: 47fffb3
Resolves: #1421658",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,93,2017-02-13T16:25:08Z,2017-02-13T16:26:57Z,2017-02-23T10:46:36Z,CLOSED,False,9,1,1,https://github.com/msekletar,core: if the start command vanishes during runtime don't hit an assert (#1421658),1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/93,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/93#issuecomment-279442777,"This can happen when the configuration is changed and reloaded while we are
executing a service. Let's not hit an assert in this case.
Fixes: #4444
Cherry-picked from: 47fffb3
Resolves: #1421658",Same as #92,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,94,2017-02-13T16:29:14Z,2017-02-20T10:45:07Z,2017-02-20T10:45:07Z,MERGED,True,129,23,4,https://github.com/msekletar,ProtectHome option doesn't work when service runs in chroot (#1421181),2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/94,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/94,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,94,2017-02-13T16:29:14Z,2017-02-20T10:45:07Z,2017-02-20T10:45:07Z,MERGED,True,129,23,4,https://github.com/msekletar,ProtectHome option doesn't work when service runs in chroot (#1421181),2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/94,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/94#issuecomment-279953600,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,95,2017-02-15T08:39:28Z,2017-02-20T12:15:44Z,2017-02-20T12:15:45Z,MERGED,True,305,4427,29,https://github.com/jsynacek,(#1317518) remove bus-proxyd,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/95,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/95,"As kdbus won't land in the anticipated way, the bus-proxy is not needed in
its current form. It can be resurrected at any time thanks to the history,
but for now, let's remove it from the sources. If we'll have a similar tool
in the future, it will look quite differently anyway.
Note that stdio-bridge is still available. It was restored from a version
prior to f252ff1, and refactored to make use of the current APIs.
(cherry picked from commit 798c486)
Resolves: #1317518","As kdbus won't land in the anticipated way, the bus-proxy is not needed in
its current form. It can be resurrected at any time thanks to the history,
but for now, let's remove it from the sources. If we'll have a similar tool
in the future, it will look quite differently anyway.
Note that stdio-bridge is still available. It was restored from a version
prior to f252ff1, and refactored to make use of the current APIs.
(cherry picked from commit 798c486)
Resolves: #1317518",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,95,2017-02-15T08:39:28Z,2017-02-20T12:15:44Z,2017-02-20T12:15:45Z,MERGED,True,305,4427,29,https://github.com/jsynacek,(#1317518) remove bus-proxyd,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/95,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/95#issuecomment-281064554,"As kdbus won't land in the anticipated way, the bus-proxy is not needed in
its current form. It can be resurrected at any time thanks to the history,
but for now, let's remove it from the sources. If we'll have a similar tool
in the future, it will look quite differently anyway.
Note that stdio-bridge is still available. It was restored from a version
prior to f252ff1, and refactored to make use of the current APIs.
(cherry picked from commit 798c486)
Resolves: #1317518",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,96,2017-02-27T12:32:02Z,2017-03-20T14:14:22Z,2017-03-20T14:14:22Z,MERGED,True,3,1,1,https://github.com/jsynacek,Bz1413477 mute hotkey,2,"['merge-ready', 'sanity-only']",https://github.com/lnykryn/systemd-rhel/pull/96,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/96,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,97,2017-03-02T08:41:24Z,2017-03-20T14:13:51Z,2018-12-04T13:16:41Z,MERGED,True,11,3,1,https://github.com/lnykryn,load-fragment: resolve specifiers in RuntimeDirectory,1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/97,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/97,"Cherry-picked from: 9b5864d
Resolves: #1428110","Cherry-picked from: 9b5864d
Resolves: #1428110",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,97,2017-03-02T08:41:24Z,2017-03-20T14:13:51Z,2018-12-04T13:16:41Z,MERGED,True,11,3,1,https://github.com/lnykryn,load-fragment: resolve specifiers in RuntimeDirectory,1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/97,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/97#issuecomment-284738792,"Cherry-picked from: 9b5864d
Resolves: #1428110",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,98,2017-03-07T08:21:20Z,2017-03-20T14:11:05Z,2017-03-20T14:11:05Z,MERGED,True,258,4,17,https://github.com/jsynacek,Bz1426214 passenvironment,3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/98,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/98,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,99,2017-03-14T11:28:12Z,2017-04-10T13:30:53Z,2017-04-26T09:17:47Z,MERGED,True,60,28,2,https://github.com/msekletar,udev/path_id: improve and enhance bus detection for Linux on z Systems (#1274401),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/99,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/99,"Improve and enhance the path_id udev builtin to correctly handle bus'
available on Linux on z Systems (s390).
Previously, the CCW bus and, in particular, any FCP devices on it, have
been treated separately.  This commit integrates the CCW bus into the
device chain loop.  FCP devices and their associated SCSI disks are now
handled through the common SCSI handling functions in path_id.
This implies also a change in the naming of the symbolic links created
by udev.  So any backports of this commit to existing Linux distribution
must be done with care.  If a backport is required, a udev rule must be
created to also create the ""old-style"" symbolic links.
Apart from the CCW bus, this commit adds bus support for the:

ccwgroup bus which manages network devices, and
ap bus which manages cryptographic adapters
iucv bus which manages IUCV devices on z/VM

Cherry-picked from: e7eb5a8
Resolves: #1274401","Improve and enhance the path_id udev builtin to correctly handle bus'
available on Linux on z Systems (s390).
Previously, the CCW bus and, in particular, any FCP devices on it, have
been treated separately.  This commit integrates the CCW bus into the
device chain loop.  FCP devices and their associated SCSI disks are now
handled through the common SCSI handling functions in path_id.
This implies also a change in the naming of the symbolic links created
by udev.  So any backports of this commit to existing Linux distribution
must be done with care.  If a backport is required, a udev rule must be
created to also create the ""old-style"" symbolic links.
Apart from the CCW bus, this commit adds bus support for the:

ccwgroup bus which manages network devices, and
ap bus which manages cryptographic adapters
iucv bus which manages IUCV devices on z/VM

Cherry-picked from: e7eb5a8
Resolves: #1274401",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,100,2017-03-20T12:57:27Z,2017-04-10T13:34:44Z,2018-12-04T13:16:39Z,MERGED,True,507,87,25,https://github.com/lnykryn,Bz1387398,7,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/100,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/100,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,101,2017-03-23T09:41:45Z,2017-04-10T14:59:10Z,2017-04-10T14:59:10Z,MERGED,True,2,2,1,https://github.com/jsynacek,Install: correctly report symlink creations,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/101,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/101,"All callers of create_symlink(), such as install_info_symlink_wants(), expect
that to return > 0 if it actually did something, and then return that number.
unit_file_enable() uses that to determine if any action was done
(carries_install_info != 0) and if not, show a ""The unit files have no
[Install] section"" warning.
Return 1 instead of 0 in the two code paths of create_symlink() when the link
was created or replaced with a new value.
This fixes getting a bogus ""No [Install] section"" warning when enabling a unit
with full path, like ""systemctl enable /some/path/myunit.service"".
(cherry picked from commit 3de1521)
Resolves: #1435098","All callers of create_symlink(), such as install_info_symlink_wants(), expect
that to return > 0 if it actually did something, and then return that number.
unit_file_enable() uses that to determine if any action was done
(carries_install_info != 0) and if not, show a ""The unit files have no
[Install] section"" warning.
Return 1 instead of 0 in the two code paths of create_symlink() when the link
was created or replaced with a new value.
This fixes getting a bogus ""No [Install] section"" warning when enabling a unit
with full path, like ""systemctl enable /some/path/myunit.service"".
(cherry picked from commit 3de1521)
Resolves: #1435098",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,102,2017-04-04T11:19:11Z,2017-04-10T14:58:49Z,2018-12-04T13:16:41Z,MERGED,True,3,0,1,https://github.com/lnykryn,sysv-generator: Provides: $network should also pull network.target to…,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/102,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/102,"… transaction (#5652)
network.target should be pulled in to the transaction
by the unit that provides network services, but currently
for initscripts it only pulls in network-online.target.
Cherry-picked from: bd9ad4f
Resolves: #1438749","… transaction (#5652)
network.target should be pulled in to the transaction
by the unit that provides network services, but currently
for initscripts it only pulls in network-online.target.
Cherry-picked from: bd9ad4f
Resolves: #1438749",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,102,2017-04-04T11:19:11Z,2017-04-10T14:58:49Z,2018-12-04T13:16:41Z,MERGED,True,3,0,1,https://github.com/lnykryn,sysv-generator: Provides: $network should also pull network.target to…,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/102,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/102#issuecomment-291481864,"… transaction (#5652)
network.target should be pulled in to the transaction
by the unit that provides network services, but currently
for initscripts it only pulls in network-online.target.
Cherry-picked from: bd9ad4f
Resolves: #1438749",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,103,2017-04-05T06:45:08Z,2017-04-10T14:58:15Z,2017-04-10T14:58:15Z,MERGED,True,11,12,1,https://github.com/jsynacek,(bz#1433687) namespace: don't fail on masked mounts,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/103,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/103,"Before this patch, a service file with ReadWriteDirectories=/file...
could fail if the file exists but is not a mountpoint, despite being
listed in /proc/self/mountinfo. It could happen with masked mounts.
(cherry picked from commit 98df808)
Resolves: #1433687","Before this patch, a service file with ReadWriteDirectories=/file...
could fail if the file exists but is not a mountpoint, despite being
listed in /proc/self/mountinfo. It could happen with masked mounts.
(cherry picked from commit 98df808)
Resolves: #1433687",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,105,2017-04-11T13:16:47Z,2017-04-11T13:30:10Z,2018-12-04T13:16:35Z,MERGED,True,2,6,1,https://github.com/lnykryn,rules/40-redhat.rules: rules should be on one line,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/105,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/105,Related: #1274401,Related: #1274401,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,105,2017-04-11T13:16:47Z,2017-04-11T13:30:10Z,2018-12-04T13:16:35Z,MERGED,True,2,6,1,https://github.com/lnykryn,rules/40-redhat.rules: rules should be on one line,1,['has-test'],https://github.com/lnykryn/systemd-rhel/pull/105,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/105#issuecomment-293263115,Related: #1274401,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,106,2017-04-11T13:47:42Z,2017-04-11T15:54:55Z,2017-04-12T04:55:16Z,MERGED,True,23,37,2,https://github.com/jsynacek,tmpfiles: add new 'e' action which cleans up a dir without creating it,1,[],https://github.com/lnykryn/systemd-rhel/pull/106,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/106,"I wanted to add a config line that would empty a directory
without creating it if doesn't exist. Existing actions don't allow
this.
v2: properly add 'e' to needs_glob() and takes_ownership()
(cherry picked from commit df8dee8)
Resolves: #1225739","I wanted to add a config line that would empty a directory
without creating it if doesn't exist. Existing actions don't allow
this.
v2: properly add 'e' to needs_glob() and takes_ownership()
(cherry picked from commit df8dee8)
Resolves: #1225739",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,106,2017-04-11T13:47:42Z,2017-04-11T15:54:55Z,2017-04-12T04:55:16Z,MERGED,True,23,37,2,https://github.com/jsynacek,tmpfiles: add new 'e' action which cleans up a dir without creating it,1,[],https://github.com/lnykryn/systemd-rhel/pull/106,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/106#issuecomment-293274023,"I wanted to add a config line that would empty a directory
without creating it if doesn't exist. Existing actions don't allow
this.
v2: properly add 'e' to needs_glob() and takes_ownership()
(cherry picked from commit df8dee8)
Resolves: #1225739",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,107,2017-04-11T14:31:29Z,2017-04-11T15:56:15Z,2018-12-04T13:16:41Z,MERGED,True,1,1,1,https://github.com/lnykryn,util:bind_remount_recursive(): handle return 0 of set_consume(),1,[],https://github.com/lnykryn/systemd-rhel/pull/107,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/107,"set_consume() does not return -EEXIST, but 0, in case the key is already
in the Set.
Cherry-picked from: 85d834a
Resolves: #1433687","set_consume() does not return -EEXIST, but 0, in case the key is already
in the Set.
Cherry-picked from: 85d834a
Resolves: #1433687",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,107,2017-04-11T14:31:29Z,2017-04-11T15:56:15Z,2018-12-04T13:16:41Z,MERGED,True,1,1,1,https://github.com/lnykryn,util:bind_remount_recursive(): handle return 0 of set_consume(),1,[],https://github.com/lnykryn/systemd-rhel/pull/107,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/107#issuecomment-293286071,"set_consume() does not return -EEXIST, but 0, in case the key is already
in the Set.
Cherry-picked from: 85d834a
Resolves: #1433687","LGTM
But I don't understand why we check for -EEXISTS when set_put() can't really return that error.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,108,2017-04-18T15:49:57Z,2017-04-19T11:20:15Z,2017-04-19T11:20:15Z,MERGED,True,35,45,4,https://github.com/msekletar,"core: when propagating restart requests due to deps, downgrade restart to try-restart (#1436021)",2,[],https://github.com/lnykryn/systemd-rhel/pull/108,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/108,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,109,2017-04-20T09:27:44Z,2017-05-02T09:50:38Z,2017-05-02T09:50:38Z,MERGED,True,66,0,3,https://github.com/msekletar,core: manager: add some missing dbus properties (#1427927),2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/109,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/109,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,109,2017-04-20T09:27:44Z,2017-05-02T09:50:38Z,2017-05-02T09:50:38Z,MERGED,True,66,0,3,https://github.com/msekletar,core: manager: add some missing dbus properties (#1427927),2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/109,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/109#issuecomment-296954198,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,109,2017-04-20T09:27:44Z,2017-05-02T09:50:38Z,2017-05-02T09:50:38Z,MERGED,True,66,0,3,https://github.com/msekletar,core: manager: add some missing dbus properties (#1427927),2,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/109,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/109#issuecomment-297693351,,Note that this PR is already (at least partially covered) by dbus API test suite.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,110,2017-04-21T14:41:10Z,2017-04-25T14:59:24Z,2018-12-04T13:19:15Z,MERGED,True,16,0,2,https://github.com/lnykryn,tests: set tasks_max to infinity,1,[],https://github.com/lnykryn/systemd-rhel/pull/110,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/110,"rhel-only
(upstream does the same but the code there is quite different)
Related: #1337244","rhel-only
(upstream does the same but the code there is quite different)
Related: #1337244",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,110,2017-04-21T14:41:10Z,2017-04-25T14:59:24Z,2018-12-04T13:19:15Z,MERGED,True,16,0,2,https://github.com/lnykryn,tests: set tasks_max to infinity,1,[],https://github.com/lnykryn/systemd-rhel/pull/110,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/110#issuecomment-296954381,"rhel-only
(upstream does the same but the code there is quite different)
Related: #1337244",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,111,2017-04-25T13:15:38Z,2017-05-02T09:47:08Z,2018-02-12T18:30:30Z,MERGED,True,3,2,1,https://github.com/msekletar,load-fragment: don't print error about incorrect syntax when IPv6 is disabled (#1377055),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/111,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/111,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,111,2017-04-25T13:15:38Z,2017-05-02T09:47:08Z,2018-02-12T18:30:30Z,MERGED,True,3,2,1,https://github.com/msekletar,load-fragment: don't print error about incorrect syntax when IPv6 is disabled (#1377055),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/111,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/111#issuecomment-297261356,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,112,2017-04-27T11:49:12Z,2017-05-02T09:46:36Z,2018-02-12T18:30:30Z,MERGED,True,1,0,1,https://github.com/msekletar,sd-journal: return SD_JOURNAL_INVALIDATE only if journal files were actually deleted/moved (#1446140),1,['waiting-for-ci'],https://github.com/lnykryn/systemd-rhel/pull/112,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/112,"When caller invokes sd_journal_open() we usually open at least one
directory with journal files. add_root_directory() function increments
current_invalidate_counter. After sd_journal_open() returns
current_invalidate_counter != last_invalidate_counter.
After caller waits for journal events (e.g. waits for new messages in
journal) then it usually calls sd_journal_process(). However, on first
call to sd_journal_process(), function determine_change() returns
SD_JOURNAL_INVALIDATE even though no journal files were
deleted/moved. This is because current_invalidate_counter !=
last_invalidate_counter.
After the fix we make sure counters has the same value before we begin
processing inotify events.
(cherry picked from commit f934644)
Resolves: #1446140","When caller invokes sd_journal_open() we usually open at least one
directory with journal files. add_root_directory() function increments
current_invalidate_counter. After sd_journal_open() returns
current_invalidate_counter != last_invalidate_counter.
After caller waits for journal events (e.g. waits for new messages in
journal) then it usually calls sd_journal_process(). However, on first
call to sd_journal_process(), function determine_change() returns
SD_JOURNAL_INVALIDATE even though no journal files were
deleted/moved. This is because current_invalidate_counter !=
last_invalidate_counter.
After the fix we make sure counters has the same value before we begin
processing inotify events.
(cherry picked from commit f934644)
Resolves: #1446140",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,113,2017-04-28T06:56:07Z,2017-05-02T09:44:01Z,2018-02-12T18:30:30Z,MERGED,True,8,1,1,https://github.com/msekletar,Avoid forever loop for journalctl --list-boots command (#1294516),1,['waiting-for-ci'],https://github.com/lnykryn/systemd-rhel/pull/113,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/113,"When date is changed in system to future and normal user logs to new
journal file, and then date is changed back to present time, the
""journalctl --list-boot"" command goes to forever loop. This commit tries
to fix this problem by checking first the boot id list if the found boot
id was already in that list. If it is found, then stopping the boot id
find loop.
(cherry picked from commit ec02a6c)
Conflicts:
src/journal/journalctl.c
Related: #1294516","When date is changed in system to future and normal user logs to new
journal file, and then date is changed back to present time, the
""journalctl --list-boot"" command goes to forever loop. This commit tries
to fix this problem by checking first the boot id list if the found boot
id was already in that list. If it is found, then stopping the boot id
find loop.
(cherry picked from commit ec02a6c)
Conflicts:
src/journal/journalctl.c
Related: #1294516",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,114,2017-04-28T13:23:22Z,2017-04-28T14:08:47Z,2017-04-28T14:08:52Z,CLOSED,False,2,0,1,https://github.com/msekletar,readahead: don't collect readahead profile when rootfs is read-only (#1268349),1,[],https://github.com/lnykryn/systemd-rhel/pull/114,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/114,"We wouldn't be able write the pack file, so don't bother collecting data
either.
RHEL-only
Resolves: #1268349","We wouldn't be able write the pack file, so don't bother collecting data
either.
RHEL-only
Resolves: #1268349",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,114,2017-04-28T13:23:22Z,2017-04-28T14:08:47Z,2017-04-28T14:08:52Z,CLOSED,False,2,0,1,https://github.com/msekletar,readahead: don't collect readahead profile when rootfs is read-only (#1268349),1,[],https://github.com/lnykryn/systemd-rhel/pull/114,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/114#issuecomment-298007772,"We wouldn't be able write the pack file, so don't bother collecting data
either.
RHEL-only
Resolves: #1268349","Lukas pointed out that adding condition doesn't cut it, because we need to check the condition after rootfs was remounted. However we can't simply add After=systemd-remount-fs.service, because that would introduce circular dependency.
We need to figure out something else.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,115,2017-04-28T13:32:10Z,2017-05-02T10:31:37Z,2018-12-04T13:16:42Z,MERGED,True,0,2,1,https://github.com/lnykryn,fstab-generator: remove bogus condition (#1446171),1,[],https://github.com/lnykryn/systemd-rhel/pull/115,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/115,"The sysroot mount is already taken care of by the add_sysroot_mount function. With this condition left in, we can get something like this:
initrd-root-fs.target.requires
`-- usr.mount -> /run/systemd/generator/usr.mount
in the main system (i.e., not in the initramfs). In the initramfs, the previous condition already kicks in.
Cherry-picked from: ce3f6d8
Resolves: #1446171","The sysroot mount is already taken care of by the add_sysroot_mount function. With this condition left in, we can get something like this:
initrd-root-fs.target.requires
`-- usr.mount -> /run/systemd/generator/usr.mount
in the main system (i.e., not in the initramfs). In the initramfs, the previous condition already kicks in.
Cherry-picked from: ce3f6d8
Resolves: #1446171",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,116,2017-05-04T10:44:37Z,2017-09-07T08:15:54Z,2017-09-07T08:15:55Z,MERGED,True,4,6,1,https://github.com/jsynacek,(bz#1444824) myhostname: don't return any ipv6 entries when ipv6 is disabled,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/116,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/116,"This commit amends the rhel-only 6e5117b.
Resolves: #1444824","This commit amends the rhel-only 6e5117b.
Resolves: #1444824",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,116,2017-05-04T10:44:37Z,2017-09-07T08:15:54Z,2017-09-07T08:15:55Z,MERGED,True,4,6,1,https://github.com/jsynacek,(bz#1444824) myhostname: don't return any ipv6 entries when ipv6 is disabled,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/116,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/116#issuecomment-323055490,"This commit amends the rhel-only 6e5117b.
Resolves: #1444824",looks good to me,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,117,2017-05-04T12:06:16Z,2017-09-07T08:15:45Z,2017-09-07T08:15:46Z,MERGED,True,3,12,3,https://github.com/jsynacek,(#1447937) compile with -Werror,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/117,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/117,"The maybe-uninitialized flag has to be disabled, because gcc on RHEL7
reports tons of obvious false-positive warnings when variables are
wrapped with cleanup.
Also, LTO is better to be disabled. According to gcc folks, it makes
debugging really hard and is not really recommended on RHEL7. Plus it
makes the compilation fail with
In function '__ppoll_alias',
inlined from 'bus_poll' at src/libsystemd/sd-bus/sd-bus.c:2822:11:
/usr/include/bits/poll2.h:71:9: warning: call to '__ppoll_chk_warn' declared with attribute warning: ppoll called with fds buffer too small file nfds entries
return __ppoll_chk (__fds, __nfds, __timeout, __ss, __bos (__fds));
That is also a gcc bug, already fixed in the gcc upstream
(https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61886).
Resolves: #1447937","The maybe-uninitialized flag has to be disabled, because gcc on RHEL7
reports tons of obvious false-positive warnings when variables are
wrapped with cleanup.
Also, LTO is better to be disabled. According to gcc folks, it makes
debugging really hard and is not really recommended on RHEL7. Plus it
makes the compilation fail with
In function '__ppoll_alias',
inlined from 'bus_poll' at src/libsystemd/sd-bus/sd-bus.c:2822:11:
/usr/include/bits/poll2.h:71:9: warning: call to '__ppoll_chk_warn' declared with attribute warning: ppoll called with fds buffer too small file nfds entries
return __ppoll_chk (__fds, __nfds, __timeout, __ss, __bos (__fds));
That is also a gcc bug, already fixed in the gcc upstream
(https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61886).
Resolves: #1447937",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,118,2017-05-04T15:34:50Z,2017-05-30T11:17:24Z,2017-05-30T11:17:24Z,MERGED,True,3,0,1,https://github.com/msekletar,readahead-collect: don't print warning message when handling symlink (#1387095),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/118,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/118,"Since we call open() with O_NOFOLLOW we can't really open symlinks (we
would need to add O_PATH and we don't want that). Let's shortcut things
and return immediately, but don't treat this as an error.
Resolves: #1387095","Since we call open() with O_NOFOLLOW we can't really open symlinks (we
would need to add O_PATH and we don't want that). Let's shortcut things
and return immediately, but don't treat this as an error.
Resolves: #1387095",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,119,2017-05-05T11:44:28Z,2017-09-07T08:22:33Z,2018-12-04T13:16:41Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1437114) core:execute: fix fork() fail handling in exec_spawn(),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/119,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/119,"If pid < 0 after fork(), 0 is always returned because r =
exec_context_load_environment() has exited successfully.

This will make the caller of exec_spawn() not able to handle
the fork() error case and make systemd abort assert() possibly.

Cherry-picked from:
Resolves: #","If pid < 0 after fork(), 0 is always returned because r =
exec_context_load_environment() has exited successfully.

This will make the caller of exec_spawn() not able to handle
the fork() error case and make systemd abort assert() possibly.

Cherry-picked from:
Resolves: #",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,119,2017-05-05T11:44:28Z,2017-09-07T08:22:33Z,2018-12-04T13:16:41Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1437114) core:execute: fix fork() fail handling in exec_spawn(),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/119,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/119#issuecomment-299452470,"If pid < 0 after fork(), 0 is always returned because r =
exec_context_load_environment() has exited successfully.

This will make the caller of exec_spawn() not able to handle
the fork() error case and make systemd abort assert() possibly.

Cherry-picked from:
Resolves: #",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,120,2017-05-09T10:11:31Z,2017-05-30T11:17:45Z,2017-05-30T11:17:45Z,MERGED,True,5,1,1,https://github.com/jsynacek,Bz1411199 tmpfiles journal,3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/120,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/120,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,121,2017-05-11T15:27:11Z,2017-05-30T11:18:23Z,2017-05-30T11:18:23Z,MERGED,True,10,10,1,https://github.com/msekletar,sysctl: configure kernel parameters in the order they occur in each sysctl configuration files (#1382244),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/121,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/121,"Currently, systemd-sysctl command configures kernel parameters in each sysctl
configuration files in random order due to characteristics of iterator of
Hashmap.
However, kernel parameters need to be configured in the order they occur in
each sysctl configuration files.


For example, consider fs.suid_coredump and kernel.core_pattern. If
fs.suid_coredump=2 is configured before kernel.core_pattern= whose default
value is ""core"", then kernel outputs the following message:
Unsafe core_pattern used with suid_dumpable=2. Pipe handler or fully qualified core dump path required.

Note that the security issue mentioned in this message has already been fixed
on recent kernels, so this is just a warning message on such kernels. But
it's still confusing to users that this message is output on some boot and
not output on another boot.


I don't know but there could be other kernel parameters that are significant
in the order they are configured.


The legacy sysctl command configures kernel parameters in the order they
occur in each sysctl configuration files. Although I didn't find any official
specification explaining this behavior of sysctl command, I don't think there
is any meaningful reason to change this behavior, in particular, to the
random one.


This commit does the change by simply using OrderedHashmap instead of
Hashmap.
(cherry picked from commit 886cf98)
Resolves: #1382244","Currently, systemd-sysctl command configures kernel parameters in each sysctl
configuration files in random order due to characteristics of iterator of
Hashmap.
However, kernel parameters need to be configured in the order they occur in
each sysctl configuration files.


For example, consider fs.suid_coredump and kernel.core_pattern. If
fs.suid_coredump=2 is configured before kernel.core_pattern= whose default
value is ""core"", then kernel outputs the following message:
Unsafe core_pattern used with suid_dumpable=2. Pipe handler or fully qualified core dump path required.

Note that the security issue mentioned in this message has already been fixed
on recent kernels, so this is just a warning message on such kernels. But
it's still confusing to users that this message is output on some boot and
not output on another boot.


I don't know but there could be other kernel parameters that are significant
in the order they are configured.


The legacy sysctl command configures kernel parameters in the order they
occur in each sysctl configuration files. Although I didn't find any official
specification explaining this behavior of sysctl command, I don't think there
is any meaningful reason to change this behavior, in particular, to the
random one.


This commit does the change by simply using OrderedHashmap instead of
Hashmap.
(cherry picked from commit 886cf98)
Resolves: #1382244",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,122,2017-05-16T14:40:53Z,2017-05-30T11:18:33Z,2017-05-30T11:18:33Z,MERGED,True,0,1,1,https://github.com/msekletar,units: drop explicit NotifyAccess setting from journald's unit file (#1444356),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/122,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/122,"systemd-journald service consists of only single process and that is the
MainPID. Make unit file shorter and drop NotifyAccess=all since it is
not useful in such case.
https://lists.freedesktop.org/archives/systemd-devel/2017-April/038667.html
(cherry picked from commit 6f0e6bd)
Resolves: #1444356","systemd-journald service consists of only single process and that is the
MainPID. Make unit file shorter and drop NotifyAccess=all since it is
not useful in such case.
https://lists.freedesktop.org/archives/systemd-devel/2017-April/038667.html
(cherry picked from commit 6f0e6bd)
Resolves: #1444356",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,123,2017-05-16T14:44:29Z,2017-05-18T11:02:11Z,2017-05-18T11:02:11Z,CLOSED,False,0,1,1,https://github.com/msekletar,units: drop explicit NotifyAccess setting from journald's unit file,1,['rhel-7.3'],https://github.com/lnykryn/systemd-rhel/pull/123,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/123,"systemd-journald service consists of only single process and that is the
MainPID. Make unit file shorter and drop NotifyAccess=all since it is
not useful in such case.
https://lists.freedesktop.org/archives/systemd-devel/2017-April/038667.html
(cherry picked from commit 6f0e6bd)
Resolves: #1444356","systemd-journald service consists of only single process and that is the
MainPID. Make unit file shorter and drop NotifyAccess=all since it is
not useful in such case.
https://lists.freedesktop.org/archives/systemd-devel/2017-April/038667.html
(cherry picked from commit 6f0e6bd)
Resolves: #1444356",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,123,2017-05-16T14:44:29Z,2017-05-18T11:02:11Z,2017-05-18T11:02:11Z,CLOSED,False,0,1,1,https://github.com/msekletar,units: drop explicit NotifyAccess setting from journald's unit file,1,['rhel-7.3'],https://github.com/lnykryn/systemd-rhel/pull/123,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/123#issuecomment-302372535,"systemd-journald service consists of only single process and that is the
MainPID. Make unit file shorter and drop NotifyAccess=all since it is
not useful in such case.
https://lists.freedesktop.org/archives/systemd-devel/2017-April/038667.html
(cherry picked from commit 6f0e6bd)
Resolves: #1444356",We don't need to backport this to RHEL-7.3 anymore.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,124,2017-05-29T11:02:24Z,2017-05-30T11:18:47Z,2018-12-04T13:16:39Z,MERGED,True,4,3,2,https://github.com/lnykryn,Bz1381743,2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/124,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/124,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,124,2017-05-29T11:02:24Z,2017-05-30T11:18:47Z,2018-12-04T13:16:39Z,MERGED,True,4,3,2,https://github.com/lnykryn,Bz1381743,2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/124,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/124#issuecomment-304636849,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,125,2017-06-12T12:53:19Z,2017-06-12T14:58:08Z,2017-06-12T14:58:14Z,MERGED,True,5,3,3,https://github.com/msekletar,rules: move cpu hotplug rule to separate file (#1266322),1,[],https://github.com/lnykryn/systemd-rhel/pull/125,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/125,"In kdump initrd we don't want to automatically bring online all
available CPUs. Hence, kdump maintainers can easily mask the rule by
placing symlink to /dev/null with the same name in /etc/udev/rules.d
RHEL-only
Related: #1266322
[msekleta: note that this is just part of the fix for #1266322, in
order to fix the bug it is necessary to actually mask the newly added
rule when generating kdump initrd]","In kdump initrd we don't want to automatically bring online all
available CPUs. Hence, kdump maintainers can easily mask the rule by
placing symlink to /dev/null with the same name in /etc/udev/rules.d
RHEL-only
Related: #1266322
[msekleta: note that this is just part of the fix for #1266322, in
order to fix the bug it is necessary to actually mask the newly added
rule when generating kdump initrd]",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,125,2017-06-12T12:53:19Z,2017-06-12T14:58:08Z,2017-06-12T14:58:14Z,MERGED,True,5,3,3,https://github.com/msekletar,rules: move cpu hotplug rule to separate file (#1266322),1,[],https://github.com/lnykryn/systemd-rhel/pull/125,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/125#issuecomment-307815420,"In kdump initrd we don't want to automatically bring online all
available CPUs. Hence, kdump maintainers can easily mask the rule by
placing symlink to /dev/null with the same name in /etc/udev/rules.d
RHEL-only
Related: #1266322
[msekleta: note that this is just part of the fix for #1266322, in
order to fix the bug it is necessary to actually mask the newly added
rule when generating kdump initrd]",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,126,2017-07-27T14:03:20Z,2017-07-27T14:07:46Z,2017-07-27T14:07:47Z,MERGED,True,19,8,2,https://github.com/msekletar,Fix how we generate root image for TEST-* tests (#1475870),2,[],https://github.com/lnykryn/systemd-rhel/pull/126,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/126,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,127,2017-08-09T11:44:25Z,2017-09-12T13:20:17Z,2017-09-12T13:20:17Z,MERGED,True,242,62,12,https://github.com/jsynacek,"(#1472439) path-util: make use of ""mnt_id"" field exported in /proc/self/fdinfo/<fd>",1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/127,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/127,"This commit is not a backport of a specific commit. It includes parts of
several upstream commits (3f72b42,
5d40903 and others).
The main goal was to bring path_is_mount_point() up to date, which meant
introducing fd_fdinfo_mnt_id() and fd_is_mount_point(). These were
needed mainly because we need to determine mount points based on
/proc/self/fdinfo/ in containers. Also, there are more places in the
code where checks for mount points are performed, which would benefit from
this fix as well. Additionally, corresponding tests has been added.
Resolves: #1472439","This commit is not a backport of a specific commit. It includes parts of
several upstream commits (3f72b42,
5d40903 and others).
The main goal was to bring path_is_mount_point() up to date, which meant
introducing fd_fdinfo_mnt_id() and fd_is_mount_point(). These were
needed mainly because we need to determine mount points based on
/proc/self/fdinfo/ in containers. Also, there are more places in the
code where checks for mount points are performed, which would benefit from
this fix as well. Additionally, corresponding tests has been added.
Resolves: #1472439",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,128,2017-08-15T10:31:26Z,2017-08-15T10:36:41Z,2018-12-04T13:19:15Z,MERGED,True,6,18,1,https://github.com/lnykryn," #1477285 Revert ""udev: net_id: add support for phys_port_name attribute (#4506)""",1,[],https://github.com/lnykryn/systemd-rhel/pull/128,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/128,"This reverts commit 192545b.
This caused change of the names for sfc driver.
Resolves: #1477285","This reverts commit 192545b.
This caused change of the names for sfc driver.
Resolves: #1477285",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,128,2017-08-15T10:31:26Z,2017-08-15T10:36:41Z,2018-12-04T13:19:15Z,MERGED,True,6,18,1,https://github.com/lnykryn," #1477285 Revert ""udev: net_id: add support for phys_port_name attribute (#4506)""",1,[],https://github.com/lnykryn/systemd-rhel/pull/128,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/128#issuecomment-322434868,"This reverts commit 192545b.
This caused change of the names for sfc driver.
Resolves: #1477285",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,129,2017-08-15T11:57:32Z,2017-09-07T08:15:26Z,2017-09-07T08:15:27Z,MERGED,True,5,1,1,https://github.com/jsynacek,(#1306539) udev: ignore SIGCHLD from unexpected processes (#1306539),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/129,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/129,"RHEL-only
Author: grzegorz.halat@motorolasolutions.com
Resolves: #1306539","RHEL-only
Author: grzegorz.halat@motorolasolutions.com
Resolves: #1306539",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,129,2017-08-15T11:57:32Z,2017-09-07T08:15:26Z,2017-09-07T08:15:27Z,MERGED,True,5,1,1,https://github.com/jsynacek,(#1306539) udev: ignore SIGCHLD from unexpected processes (#1306539),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/129,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/129#issuecomment-327187074,"RHEL-only
Author: grzegorz.halat@motorolasolutions.com
Resolves: #1306539",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,130,2017-08-17T13:09:04Z,2017-08-17T13:15:50Z,2017-08-17T13:15:50Z,CLOSED,False,296,13,5,https://github.com/jrybar-rh,nspawn: new option to start as PID2,1,[],https://github.com/lnykryn/systemd-rhel/pull/130,https://github.com/jrybar-rh,1,https://github.com/lnykryn/systemd-rhel/pull/130,"Cherry-picked from: 7732f92
Resolves: rhbz#1417387","Cherry-picked from: 7732f92
Resolves: rhbz#1417387",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,131,2017-08-17T13:22:27Z,2017-09-07T13:53:04Z,2017-09-07T13:53:04Z,MERGED,True,328,13,5,https://github.com/jrybar-rh,(#1417387) nspawn: new option to start as PID2,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/131,https://github.com/jrybar-rh,1,https://github.com/lnykryn/systemd-rhel/pull/131,"Cherry-picked from: 7732f92
Resolves: #1417387","Cherry-picked from: 7732f92
Resolves: #1417387",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,132,2017-08-18T08:46:23Z,2017-09-07T13:52:54Z,2017-09-07T13:52:54Z,MERGED,True,16,3,3,https://github.com/jsynacek,(#1420505) log: never log into foreign fd #2 in PID 1 or its pre-execve() children,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/132,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/132,"(cherry picked from commit 48a601f)
Resolves: #1420505","(cherry picked from commit 48a601f)
Resolves: #1420505",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,133,2017-08-24T15:22:52Z,2017-09-12T13:17:55Z,2017-09-12T13:17:55Z,MERGED,True,23,9,3,https://github.com/msekletar,journald: don't flush to /var/log/journal before we get asked to (#1364092),3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/133,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/133,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,133,2017-08-24T15:22:52Z,2017-09-12T13:17:55Z,2017-09-12T13:17:55Z,MERGED,True,23,9,3,https://github.com/msekletar,journald: don't flush to /var/log/journal before we get asked to (#1364092),3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/133,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/133#issuecomment-328460271,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,134,2017-08-25T11:29:46Z,2017-09-07T08:14:09Z,2017-09-07T08:14:09Z,MERGED,True,1,1,1,https://github.com/msekletar,sysctl: fix uninitialized variable (#1485121),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/134,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/134,"RHEL-only
Reported-by: HATAYAMA Daisuke d.hatayama@jp.fujitsu.com
Resolves: #1485121","RHEL-only
Reported-by: HATAYAMA Daisuke d.hatayama@jp.fujitsu.com
Resolves: #1485121",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,135,2017-08-28T07:45:22Z,2017-09-12T14:28:11Z,2017-09-12T14:28:11Z,MERGED,True,341,60,4,https://github.com/msekletar,Revert Revert journald: allow restarting journald without losing stream connections (#1359939),2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/135,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/135,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,136,2017-08-28T08:03:30Z,2017-09-07T08:10:59Z,2017-09-07T08:10:59Z,MERGED,True,5,1,1,https://github.com/msekletar,core: unset sysfs path after transition to dead state (#1408916),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/136,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/136,"Device is gone and most likely it will get garbage collected. However in
cases when it doesn't get gc'ed (because it is referenced by some
other unit, e.g. mount from fstab) we need to unset sysfs. This is
because when device appears next time, possibly, with different sysfs
path we need to update the sysfs path. Current code could end up caching
stale sysfs path forever.
In reality this is not a problem for normal disks (unless you swap them
during system runtime). However this issue causes failures to mount
filesystems on LVM where sysfs path depends on activation
order (i.e. logical volumes from volume group that is activated first
get assigned lower dm-X numbers and corresponding syspaths).
Fixes #6126
(cherry picked from commit 0e139cac0318de09e6f4c1a4fc61388f7e541ebd)
Resolves: #1408916","Device is gone and most likely it will get garbage collected. However in
cases when it doesn't get gc'ed (because it is referenced by some
other unit, e.g. mount from fstab) we need to unset sysfs. This is
because when device appears next time, possibly, with different sysfs
path we need to update the sysfs path. Current code could end up caching
stale sysfs path forever.
In reality this is not a problem for normal disks (unless you swap them
during system runtime). However this issue causes failures to mount
filesystems on LVM where sysfs path depends on activation
order (i.e. logical volumes from volume group that is activated first
get assigned lower dm-X numbers and corresponding syspaths).
Fixes #6126
(cherry picked from commit 0e139cac0318de09e6f4c1a4fc61388f7e541ebd)
Resolves: #1408916",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,137,2017-09-06T12:36:19Z,2017-09-07T13:52:38Z,2017-09-07T13:52:38Z,MERGED,True,28,4,7,https://github.com/msekletar,units: introduce getty-pre.target (#1173080),2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/137,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/137,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,138,2017-09-06T13:24:25Z,2017-09-07T13:52:29Z,2017-09-07T13:52:29Z,MERGED,True,14,2,1,https://github.com/msekletar,"tmpfiles: with ""e"" don't attempt to set permissions when file doesn't exist (#1445732)",1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/138,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/138,"tmpfiles.d option ""e"" when run through systemd-tmpfiles --create should
apply configured permissions (uid,gid) only to already existing
files. When file doesn't exist we bail out with error. Instead we should
silently ignore non-existing files.
$ useradd test
$ cat /etc/tmpfiles.d/foobar.conf
e /tmp/test - test test 1d
$ ls -l /tmp/test
ls: cannot access '/tmp/test': No such file or directory
Before:
$ systemd-tmpfiles --create /etc/tmpfiles.d/foobar.conf
Adjusting owner and mode for /tmp/test failed: No such file or directory
$ echo $?
1
After:
$ systemd-tmpfiles --create /etc/tmpfiles.d/foobar.conf
$ echo $?
0
(cherry picked from commit 3caf791a1702c97b99d2647c9d465af404f2913d)
Conflicts:
src/tmpfiles/tmpfiles.c
Resolves: #1445732","tmpfiles.d option ""e"" when run through systemd-tmpfiles --create should
apply configured permissions (uid,gid) only to already existing
files. When file doesn't exist we bail out with error. Instead we should
silently ignore non-existing files.
$ useradd test
$ cat /etc/tmpfiles.d/foobar.conf
e /tmp/test - test test 1d
$ ls -l /tmp/test
ls: cannot access '/tmp/test': No such file or directory
Before:
$ systemd-tmpfiles --create /etc/tmpfiles.d/foobar.conf
Adjusting owner and mode for /tmp/test failed: No such file or directory
$ echo $?
1
After:
$ systemd-tmpfiles --create /etc/tmpfiles.d/foobar.conf
$ echo $?
0
(cherry picked from commit 3caf791a1702c97b99d2647c9d465af404f2913d)
Conflicts:
src/tmpfiles/tmpfiles.c
Resolves: #1445732",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,139,2017-09-06T17:23:49Z,2017-09-12T14:40:10Z,2017-09-12T14:40:10Z,MERGED,True,302,59,6,https://github.com/msekletar,"journal: don't force FS_NOCOW_FL on new journal files, but warn if it is missing (#1299714)",7,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/139,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/139,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,139,2017-09-06T17:23:49Z,2017-09-12T14:40:10Z,2017-09-12T14:40:10Z,MERGED,True,302,59,6,https://github.com/msekletar,"journal: don't force FS_NOCOW_FL on new journal files, but warn if it is missing (#1299714)",7,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/139,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/139#issuecomment-327557431,,"I've put the note to the commit, but copying here just to make sure it is not missed,
[msekleta: note that this is strictly speaking incomplete because we
don't have the second change that applies NO_COW flag on
/var/log/journal via tmpfiles. But this is fine since BTRFS support was
dropped from RHEL. End result is that we get rid of the warning on
non-BTRFS filesystems, and possibly get different warning on BTRFS, but
no one is running BTRFS on RHEL-7 anyway. Well, except maybe Facebook,
but they also run new systemd version that sets up NO_COW via tmpfiles]",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,139,2017-09-06T17:23:49Z,2017-09-12T14:40:10Z,2017-09-12T14:40:10Z,MERGED,True,302,59,6,https://github.com/msekletar,"journal: don't force FS_NOCOW_FL on new journal files, but warn if it is missing (#1299714)",7,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/139,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/139#issuecomment-327820175,,"I've pushed the new version that also adds ability to set file attributes via tmpfiles and introduces such tmpfiles snippet for journald log directory so NOCOW attribute is properly set and we don't introduce performance regression on BTRFS.
Although, original issue is about extra warning message that can be fixed just by decreasing log level I think that file attribute support in tmpfiles is useful on its own.
Note that this backport is quite big. Code compiles fine and passes our internal test for tmpfiles, but I didn't review static analysis results yet, so please don't merge it just yet.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,140,2017-09-07T13:50:10Z,2017-09-07T13:52:18Z,2017-09-07T13:53:44Z,MERGED,True,5,5,3,https://github.com/jsynacek,(#1447937) Fix compilation on s390 and ppc64le when -Werror is enabled,3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/140,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/140,Related: #1447937,Related: #1447937,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,141,2017-09-14T12:40:53Z,2017-09-25T10:33:36Z,2018-12-04T13:16:39Z,MERGED,True,106,15,9,https://github.com/lnykryn,(#1384014) add remote-cryptsetup.target and remote-cryptsetup-pre.target ,4,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/141,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/141,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,141,2017-09-14T12:40:53Z,2017-09-25T10:33:36Z,2018-12-04T13:16:39Z,MERGED,True,106,15,9,https://github.com/lnykryn,(#1384014) add remote-cryptsetup.target and remote-cryptsetup-pre.target ,4,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/141,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/141#issuecomment-329792671,,"There's never enough reviews, so... LGTM.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,142,2017-09-19T10:43:20Z,2017-10-02T08:51:08Z,2017-10-02T08:51:08Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1493047) core/namespace: Protect /usr instead of /home with ProtectSystem=yes,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/142,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/142,"A small typo in ee818b8 caused /home to be put in read-only instead of
/usr when ProtectSystem was enabled (ie: not set to ""no"").
(cherry picked from commit d38e01d)
Resolves: #1493047","A small typo in ee818b8 caused /home to be put in read-only instead of
/usr when ProtectSystem was enabled (ie: not set to ""no"").
(cherry picked from commit d38e01d)
Resolves: #1493047",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,143,2017-09-21T08:01:49Z,2017-09-25T10:33:25Z,2017-09-26T09:58:08Z,MERGED,True,310,0,1,https://github.com/jsynacek,(#1178929) document exit codes,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/143,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/143,"I didn't include systemd/systemd@0460aa5, since it doesn't apply to our code base.","I didn't include systemd/systemd@0460aa5, since it doesn't apply to our code base.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,143,2017-09-21T08:01:49Z,2017-09-25T10:33:25Z,2017-09-26T09:58:08Z,MERGED,True,310,0,1,https://github.com/jsynacek,(#1178929) document exit codes,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/143,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/143#issuecomment-331377041,"I didn't include systemd/systemd@0460aa5, since it doesn't apply to our code base.",Fixed.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,144,2017-09-21T13:58:35Z,2017-09-25T10:33:15Z,2018-02-12T18:30:30Z,MERGED,True,6,3,1,https://github.com/msekletar,manager: when reexecuting try to connect to bus only when dbus.service is around (#1465737),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/144,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/144,"Trying to connect otherwise is pointless, because if socket isn't around
we won't connect. However, when dbus.socket is present we attempt to
connect. That attempt can't succeed because we are then supposed
to activate dbus.service as a response to connection from
us. This results in deadlock.
Fixes #6303
(cherry picked from commit 5463fa0)
Resolves: #1465737","Trying to connect otherwise is pointless, because if socket isn't around
we won't connect. However, when dbus.socket is present we attempt to
connect. That attempt can't succeed because we are then supposed
to activate dbus.service as a response to connection from
us. This results in deadlock.
Fixes #6303
(cherry picked from commit 5463fa0)
Resolves: #1465737",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,145,2017-09-21T14:08:34Z,2017-09-25T10:33:00Z,2017-09-25T10:33:01Z,MERGED,True,2,2,1,https://github.com/msekletar,device: make sure to remove all device units sharing the same sysfs path  (#1408916),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/145,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/145,"When a device is unplugged all device units sharing the same sysfs path
pointing to that device are supposed to be removed.
However it didn't work since while iterating the device unit list containing
all the relevant units, each unit was removed during each iteration of
LIST_FOREACH. However LIST_FOREACH doesn't support this use case and
LIST_FOREACH_SAFE must be use instead.
(cherry picked from commit cc0df6c)
Related: #1408916","When a device is unplugged all device units sharing the same sysfs path
pointing to that device are supposed to be removed.
However it didn't work since while iterating the device unit list containing
all the relevant units, each unit was removed during each iteration of
LIST_FOREACH. However LIST_FOREACH doesn't support this use case and
LIST_FOREACH_SAFE must be use instead.
(cherry picked from commit cc0df6c)
Related: #1408916",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,146,2017-09-22T10:31:36Z,2017-11-23T12:07:14Z,2018-02-12T18:30:30Z,MERGED,True,205,158,9,https://github.com/jrybar-rh,(#1302305) cgroup resource property setting ignored if einval,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/146,https://github.com/jrybar-rh,1,https://github.com/lnykryn/systemd-rhel/pull/146,"Resolves: rhbz#1302305
Cherry-picked from: d53d947","Resolves: rhbz#1302305
Cherry-picked from: d53d947",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,147,2017-09-25T09:59:33Z,2017-10-02T08:50:56Z,2017-10-02T08:50:56Z,MERGED,True,2,1,1,https://github.com/jsynacek,(#1494610) Support 'rdma' as a ListenNetlink= argument,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/147,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/147,"NETLINK_RDMA has been in the kernel since v3.0.
(cherry-picked from commit 5570d7f)
Resolves: #1494610","NETLINK_RDMA has been in the kernel since v3.0.
(cherry-picked from commit 5570d7f)
Resolves: #1494610",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,148,2017-09-26T07:54:40Z,2017-10-06T14:20:20Z,2018-02-12T18:30:30Z,MERGED,True,235,49,4,https://github.com/jsynacek,"(#1472439) path-util: make use of ""mnt_id"" field exported in /proc/self/fdinfo/<fd>",1,"['merge-ready', 'needs-exhaustive-review']",https://github.com/lnykryn/systemd-rhel/pull/148,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/148,"This commit is not a backport of a specific commit. It includes parts of
several upstream commits (3f72b42,
5d40903 and others).
The main goal was to bring path_is_mount_point() up to date, which meant
introducing fd_fdinfo_mnt_id() and fd_is_mount_point(). These were
needed mainly because we need to determine mount points based on
/proc/self/fdinfo/ in containers. Also, there are more places in the
code where checks for mount points are performed, which would benefit from
this fix as well. Additionally, corresponding tests has been added.
Resolves: #1472439","This commit is not a backport of a specific commit. It includes parts of
several upstream commits (3f72b42,
5d40903 and others).
The main goal was to bring path_is_mount_point() up to date, which meant
introducing fd_fdinfo_mnt_id() and fd_is_mount_point(). These were
needed mainly because we need to determine mount points based on
/proc/self/fdinfo/ in containers. Also, there are more places in the
code where checks for mount points are performed, which would benefit from
this fix as well. Additionally, corresponding tests has been added.
Resolves: #1472439",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,149,2017-09-27T07:07:26Z,2017-10-08T06:10:15Z,2018-02-12T18:30:30Z,MERGED,True,425,80,7,https://github.com/jsynacek,(#1493976) implement cpuaffinity range parsing,2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/149,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/149,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,150,2017-09-29T12:26:05Z,2017-10-02T08:52:01Z,2017-10-02T08:52:01Z,MERGED,True,5,4,2,https://github.com/msekletar,udev: Use parent bus id for virtio disk builtin path-id (#1496697),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/150,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/150,"The builtin path id for virtio block devices has been changed
to use the bus id without a prefix ""virtio-pci"" to be
compatible with all virtio transport types.
In order to not break existing setups, the by-path symlinks for
virtio block devices on the PCI bus are reintroduced by udev rules.
The virtio-pci symlinks are considered to be deprecated and
should be replaced by the native PCI symlinks.
Example output for a virtio disk in PCI slot 7:
$ ls  /dev/disk/by-path
pci-0000:00:07.0
pci-0000:00:07.0-part1
virtio-pci-0000:00:07.0
virtio-pci-0000:00:07.0-part1
See also
[1] https://lists.freedesktop.org/archives/systemd-devel/2017-February/038326.html
[2] https://lists.freedesktop.org/archives/systemd-devel/2017-March/038397.html
This reverts f073b1b but keeps the same symlinks for compatibility.
(cherry picked from commit fb92fbb)
Resolves: #1496697","The builtin path id for virtio block devices has been changed
to use the bus id without a prefix ""virtio-pci"" to be
compatible with all virtio transport types.
In order to not break existing setups, the by-path symlinks for
virtio block devices on the PCI bus are reintroduced by udev rules.
The virtio-pci symlinks are considered to be deprecated and
should be replaced by the native PCI symlinks.
Example output for a virtio disk in PCI slot 7:
$ ls  /dev/disk/by-path
pci-0000:00:07.0
pci-0000:00:07.0-part1
virtio-pci-0000:00:07.0
virtio-pci-0000:00:07.0-part1
See also
[1] https://lists.freedesktop.org/archives/systemd-devel/2017-February/038326.html
[2] https://lists.freedesktop.org/archives/systemd-devel/2017-March/038397.html
This reverts f073b1b but keeps the same symlinks for compatibility.
(cherry picked from commit fb92fbb)
Resolves: #1496697",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,150,2017-09-29T12:26:05Z,2017-10-02T08:52:01Z,2017-10-02T08:52:01Z,MERGED,True,5,4,2,https://github.com/msekletar,udev: Use parent bus id for virtio disk builtin path-id (#1496697),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/150,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/150#issuecomment-333120669,"The builtin path id for virtio block devices has been changed
to use the bus id without a prefix ""virtio-pci"" to be
compatible with all virtio transport types.
In order to not break existing setups, the by-path symlinks for
virtio block devices on the PCI bus are reintroduced by udev rules.
The virtio-pci symlinks are considered to be deprecated and
should be replaced by the native PCI symlinks.
Example output for a virtio disk in PCI slot 7:
$ ls  /dev/disk/by-path
pci-0000:00:07.0
pci-0000:00:07.0-part1
virtio-pci-0000:00:07.0
virtio-pci-0000:00:07.0-part1
See also
[1] https://lists.freedesktop.org/archives/systemd-devel/2017-February/038326.html
[2] https://lists.freedesktop.org/archives/systemd-devel/2017-March/038397.html
This reverts f073b1b but keeps the same symlinks for compatibility.
(cherry picked from commit fb92fbb)
Resolves: #1496697",LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,151,2017-10-02T09:57:04Z,2017-10-04T11:00:12Z,2017-10-04T11:00:12Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1476910) scsi_id: add missing options to getopt_long() (#6501),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/151,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/151,"(cherry picked from commit ebc6f34)
Resolves: #1476910","(cherry picked from commit ebc6f34)
Resolves: #1476910",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,152,2017-10-02T12:45:42Z,2017-10-03T08:40:11Z,2017-10-03T08:40:11Z,MERGED,True,40,33,4,https://github.com/msekletar,Fix make check on machines with disabled IPv6 (#1497639),2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/152,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/152,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,152,2017-10-02T12:45:42Z,2017-10-03T08:40:11Z,2017-10-03T08:40:11Z,MERGED,True,40,33,4,https://github.com/msekletar,Fix make check on machines with disabled IPv6 (#1497639),2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/152,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/152#issuecomment-333741876,,LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,153,2017-10-02T14:29:04Z,2017-11-09T15:20:14Z,2018-02-12T18:30:31Z,MERGED,True,406,16,3,https://github.com/msekletar,"service: serialize information about currently executing command (#1404657, #1471230)",4,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/153,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/153,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,153,2017-10-02T14:29:04Z,2017-11-09T15:20:14Z,2018-02-12T18:30:31Z,MERGED,True,406,16,3,https://github.com/msekletar,"service: serialize information about currently executing command (#1404657, #1471230)",4,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/153,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/153#issuecomment-343186313,,Failing checks seems to be unreleated,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,154,2017-10-04T14:48:55Z,2017-10-30T09:30:39Z,2018-02-12T18:30:31Z,MERGED,True,50,24,1,https://github.com/msekletar,"automount: if an automount unit is masked, don't react to activation anymore (#1498318)",1,"['merge-ready', 'needs-exhaustive-review']",https://github.com/lnykryn/systemd-rhel/pull/154,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/154,"Otherwise we'll hit an assert sooner or later.
This requires us to initialize ->where even if we come back in ""masked""
mode, as otherwise we don't know how to operate on the automount and
detach it.
Fixes: #5441
(cherry picked from commit e350ca3)
Resolves: #1498318","Otherwise we'll hit an assert sooner or later.
This requires us to initialize ->where even if we come back in ""masked""
mode, as otherwise we don't know how to operate on the automount and
detach it.
Fixes: #5441
(cherry picked from commit e350ca3)
Resolves: #1498318",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,155,2017-10-05T15:14:03Z,2017-10-06T11:50:08Z,2018-02-12T18:30:31Z,MERGED,True,30,9,1,https://github.com/kyle-walker,"(#1312002)  shutdown: don't remount,ro network filesystems. (#6588)",3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/155,https://github.com/kyle-walker,1,https://github.com/lnykryn/systemd-rhel/pull/155,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,156,2017-10-08T08:04:52Z,2017-11-07T12:40:14Z,2018-02-12T18:30:31Z,MERGED,True,209,20,7,https://github.com/msekletar,journald: make maximum size of stream log lines configurable and bump it to 48K (#1442262),1,"['merge-ready', 'needs-exhaustive-review', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/156,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/156,"This adds a new setting LineMax= to journald.conf, and sets it by
default to 48K. When we convert stream-based stdout/stderr logging into
record-based log entries, read up to the specified amount of bytes
before forcing a line-break.
This also makes three related changes:


When a NUL byte is read we'll not recognize this as alternative line
break, instead of silently dropping everything after it. (see #4863)


The reason for a line-break is now encoded in the log record, if it
wasn't a plain newline. Specifically, we distuingish ""nul"",
""line-max"" and ""eof"", for line breaks due to NUL byte, due to the
maximum line length as configured with LineMax= or due to end of
stream. This data is stored in the new implicit _LINE_BREAK= field.
It's not synthesized for plain \n line breaks.


A randomized 128bit ID is assigned to each log stream.


With these three changes in place it's (mostly) possible to reconstruct
the original byte streams from log data, as (most) of the context of
the conversion from the byte stream to log records is saved now. (So,
the only bits we still drop are empty lines. Which might be something to
look into in a future change, and which is outside of the scope of this
work)
Fixes: https://bugs.freedesktop.org/show_bug.cgi?id=86465
See: #4863
Replaces: #4875
(cherry picked from commit ec20fe5)
Resolves: #1442262
[msekleta: I had to manually rewrite upstream commit, because git
did very poor job merging old and new code and identified a lot of merge
conflicts in a code that was totally unrelated.]","This adds a new setting LineMax= to journald.conf, and sets it by
default to 48K. When we convert stream-based stdout/stderr logging into
record-based log entries, read up to the specified amount of bytes
before forcing a line-break.
This also makes three related changes:


When a NUL byte is read we'll not recognize this as alternative line
break, instead of silently dropping everything after it. (see #4863)


The reason for a line-break is now encoded in the log record, if it
wasn't a plain newline. Specifically, we distuingish ""nul"",
""line-max"" and ""eof"", for line breaks due to NUL byte, due to the
maximum line length as configured with LineMax= or due to end of
stream. This data is stored in the new implicit _LINE_BREAK= field.
It's not synthesized for plain \n line breaks.


A randomized 128bit ID is assigned to each log stream.


With these three changes in place it's (mostly) possible to reconstruct
the original byte streams from log data, as (most) of the context of
the conversion from the byte stream to log records is saved now. (So,
the only bits we still drop are empty lines. Which might be something to
look into in a future change, and which is outside of the scope of this
work)
Fixes: https://bugs.freedesktop.org/show_bug.cgi?id=86465
See: #4863
Replaces: #4875
(cherry picked from commit ec20fe5)
Resolves: #1442262
[msekleta: I had to manually rewrite upstream commit, because git
did very poor job merging old and new code and identified a lot of merge
conflicts in a code that was totally unrelated.]",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,157,2017-10-10T01:26:15Z,2017-10-22T15:25:00Z,2018-02-12T18:30:31Z,MERGED,True,592,69,4,https://github.com/whot,(#1500119) sync 60-evdev.hwdb with systemd v235,6,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/157,https://github.com/whot,1,https://github.com/lnykryn/systemd-rhel/pull/157,"Only the last two commits are the interesting ones, the first 4 are preparation work so that the last two can go in without rewriting the patches.
Notable differences to upstream: the 60-keyboard.hwdb/rules files are left in place to avoid any potential breakage with any customer hwdb files that are currently in place. Upstream merged those into the evdev rules and changed the hwdb prefix from keyboard to evdev, here there are still separate hwdb files with the keyboard prefix being left as-is.","Only the last two commits are the interesting ones, the first 4 are preparation work so that the last two can go in without rewriting the patches.
Notable differences to upstream: the 60-keyboard.hwdb/rules files are left in place to avoid any potential breakage with any customer hwdb files that are currently in place. Upstream merged those into the evdev rules and changed the hwdb prefix from keyboard to evdev, here there are still separate hwdb files with the keyboard prefix being left as-is.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,157,2017-10-10T01:26:15Z,2017-10-22T15:25:00Z,2018-02-12T18:30:31Z,MERGED,True,592,69,4,https://github.com/whot,(#1500119) sync 60-evdev.hwdb with systemd v235,6,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/157,https://github.com/whot,2,https://github.com/lnykryn/systemd-rhel/pull/157#issuecomment-335421033,"Only the last two commits are the interesting ones, the first 4 are preparation work so that the last two can go in without rewriting the patches.
Notable differences to upstream: the 60-keyboard.hwdb/rules files are left in place to avoid any potential breakage with any customer hwdb files that are currently in place. Upstream merged those into the evdev rules and changed the hwdb prefix from keyboard to evdev, here there are still separate hwdb files with the keyboard prefix being left as-is.","yep, on my t450 here. evdev hwdb applies as expected after installing",True,{'THUMBS_UP': ['https://github.com/jsynacek']}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,158,2017-10-10T08:16:05Z,2017-10-30T09:30:23Z,2018-02-12T18:30:31Z,MERGED,True,117,103,1,https://github.com/jsynacek,(#1493846) journal rotation and ENOSPC,2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/158,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/158,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,159,2017-10-13T08:38:26Z,2017-10-22T14:45:46Z,2018-12-04T13:16:42Z,MERGED,True,30,0,1,https://github.com/lnykryn,(#1501017) journald: never accept fds from file systems with mandatory locking e…,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/159,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/159,"…nabled
This is pretty much a work-around for a security vulnerability in
kernels that allow unprivileged user namespaces.
Fixes #1822.
Cherry-picked from: 1e603a4
Resolves: #1501017","…nabled
This is pretty much a work-around for a security vulnerability in
kernels that allow unprivileged user namespaces.
Fixes #1822.
Cherry-picked from: 1e603a4
Resolves: #1501017",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,160,2017-10-13T11:34:58Z,2017-10-13T11:40:09Z,2018-12-04T13:19:15Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1472439) test-path-util: force rm_rf,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/160,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/160,"On rhel we don't have tmpfs in /tmp, so simple rm_rf will
refuse to remove the test directory.
RHEL-only
Related: #1472439","On rhel we don't have tmpfs in /tmp, so simple rm_rf will
refuse to remove the test directory.
RHEL-only
Related: #1472439",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,162,2017-10-17T07:20:34Z,2017-10-22T14:44:53Z,2017-10-22T14:44:53Z,MERGED,True,26,10,4,https://github.com/msekletar,mount: make sure we unmount tmpfs mounts before we deactivate swaps (#1437518),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/162,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/162,"In the past we introduced this property just for tmp.mount. However on
todays systems usually there are many more tmpfs mounts. Most notably
mounts backing XDG_RUNTIME_DIR for each user.
Let's generalize what we already have for tmp.mount and implement the
ordering After=swap.target for all tmpfs based mounts.
(cherry picked from commit fab35af)
Conflicts:
src/core/mount.h
Resolves: #1437518","In the past we introduced this property just for tmp.mount. However on
todays systems usually there are many more tmpfs mounts. Most notably
mounts backing XDG_RUNTIME_DIR for each user.
Let's generalize what we already have for tmp.mount and implement the
ordering After=swap.target for all tmpfs based mounts.
(cherry picked from commit fab35af)
Conflicts:
src/core/mount.h
Resolves: #1437518",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,163,2017-10-18T13:08:49Z,2017-10-22T14:43:58Z,2018-12-04T13:16:43Z,MERGED,True,1,0,1,https://github.com/lnykryn,(#1503253) Export NVMe WWID udev attribute,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/163,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/163,"We need this for multipath support without relying on NVMe to SCSI
translations.
Signed-off-by: Keith Busch keith.busch@intel.com
Cherry-picked from: 5c1be4f
Resolves: #1503253","We need this for multipath support without relying on NVMe to SCSI
translations.
Signed-off-by: Keith Busch keith.busch@intel.com
Cherry-picked from: 5c1be4f
Resolves: #1503253",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,164,2017-10-23T13:35:58Z,2017-11-06T12:30:26Z,2018-12-04T13:16:43Z,MERGED,True,8,1,1,https://github.com/lnykryn,(#1505385) journal-remote: make --url option support arbitrary url,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/164,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/164,"Currently, --url option supports the only form like http(s)://some.host:19531.
This commit adds support to call systemd-journal-remote as follwos:
systemd-journal-remote --url='http://some.host:19531'
systemd-journal-remote --url='http://some.host:19531/'
systemd-journal-remote --url='http://some.host:19531/entries'
systemd-journal-remote --url='http://some.host:19531/entries?boot&follow'
The first three example result the same and retrieve all entries.
The last example retrieves only current boot entries and wait new events.
Cherry-picked from: b68f6b0
Resolves: #1505385","Currently, --url option supports the only form like http(s)://some.host:19531.
This commit adds support to call systemd-journal-remote as follwos:
systemd-journal-remote --url='http://some.host:19531'
systemd-journal-remote --url='http://some.host:19531/'
systemd-journal-remote --url='http://some.host:19531/entries'
systemd-journal-remote --url='http://some.host:19531/entries?boot&follow'
The first three example result the same and retrieve all entries.
The last example retrieves only current boot entries and wait new events.
Cherry-picked from: b68f6b0
Resolves: #1505385",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,165,2017-10-24T12:47:26Z,2017-11-13T14:20:14Z,2017-11-13T14:20:14Z,MERGED,True,26,25,2,https://github.com/jsynacek,(#1503942) timedatectl: stop using xstrftime,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/165,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/165,"When using strftime in arbitrary locales, we cannot really say how big the
buffer should be. Let's make the buffer ""large"", which will work fine pretty
much always, and just print n/a if the timestamp does not fit. strftime returns
0 if the buffer is too small and a NUL-terminated string otherwise, so we
can drop the size specifications in string formatting.
$ export LANG=fa_IR.UTF-8
$ date
چهارشنبه ۱۸ اكتبر ۱۷، ساعت ۱۰:۵۴:۲۴ (+0330)
$ timedatectl
Assertion 'xstrftime: a[] must be big enough' failed at ../src/timedate/timedatectl.c:105, function print_status_info(). Aborting.
now:
$ timedatectl
Local time: چهارشنبه 2017-10-18 16:29:40 CEST
Universal time: چهارشنبه 2017-10-18 14:29:40 UTC
RTC time: چهارشنبه 2017-10-18 14:29:40
…
(cherry picked from commit 14ce0c2)
Resolves: #1503942","When using strftime in arbitrary locales, we cannot really say how big the
buffer should be. Let's make the buffer ""large"", which will work fine pretty
much always, and just print n/a if the timestamp does not fit. strftime returns
0 if the buffer is too small and a NUL-terminated string otherwise, so we
can drop the size specifications in string formatting.
$ export LANG=fa_IR.UTF-8
$ date
چهارشنبه ۱۸ اكتبر ۱۷، ساعت ۱۰:۵۴:۲۴ (+0330)
$ timedatectl
Assertion 'xstrftime: a[] must be big enough' failed at ../src/timedate/timedatectl.c:105, function print_status_info(). Aborting.
now:
$ timedatectl
Local time: چهارشنبه 2017-10-18 16:29:40 CEST
Universal time: چهارشنبه 2017-10-18 14:29:40 UTC
RTC time: چهارشنبه 2017-10-18 14:29:40
…
(cherry picked from commit 14ce0c2)
Resolves: #1503942",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,166,2017-10-30T08:46:53Z,2017-10-31T09:30:09Z,2018-12-04T13:16:42Z,MERGED,True,25,36,7,https://github.com/lnykryn,(#1477757) replace remote-cryptsetup-pre.target with remote-fs-pre.target,4,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/166,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/166,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,167,2017-10-31T12:08:40Z,2017-11-01T14:24:32Z,2018-12-04T13:16:42Z,MERGED,True,1,3,1,https://github.com/lnykryn,(#1477757) cryptsetup-generator: use after free,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/167,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/167,"rhel-only
Related: #1477757","rhel-only
Related: #1477757",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,168,2017-11-01T16:42:04Z,2017-11-06T12:30:10Z,2017-11-06T12:30:10Z,MERGED,True,1,1,1,https://github.com/msekletar,manager: fix connecting to bus when dbus is actually around (#1465737),1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/168,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/168,"manager_connect_bus() is called before manager_coldplug(). As a last
thing in service_coldplug() we set service state to
s->deserialized_state, and thus before we do that all services are
inactive and try_connect always evaluates to false. To fix that we must
look at deserialized state instead of current unit state.
Fixes #7146
(cherry picked from commit 41dfa61)
Related: #1465737","manager_connect_bus() is called before manager_coldplug(). As a last
thing in service_coldplug() we set service state to
s->deserialized_state, and thus before we do that all services are
inactive and try_connect always evaluates to false. To fix that we must
look at deserialized state instead of current unit state.
Fixes #7146
(cherry picked from commit 41dfa61)
Related: #1465737",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,169,2017-11-13T13:55:47Z,2017-11-16T12:50:22Z,2017-11-16T12:50:22Z,MERGED,True,10,17,3,https://github.com/jrybar-rh,(#1431687) journal: Add support to read lz4 compressed journals,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/169,https://github.com/jrybar-rh,1,https://github.com/lnykryn/systemd-rhel/pull/169,"Functionality already in codebase, but deactivated in RHEL
Changed calling of LZ4 functions due to deprecation of the originals.
Resolves: rhbz#1431687
changes to .spec file:
@@ -552,6 +553,7 @@ BuildRequires:  libblkid-devel
BuildRequires:  xz-devel
BuildRequires:  zlib-devel
BuildRequires:  bzip2-devel
+BuildRequires:  lz4-devel
BuildRequires:  libidn-devel
BuildRequires:  libcurl-devel
BuildRequires:  kmod-devel
@@ -742,6 +744,7 @@ CONFIGURE_OPTS=(
--enable-compat-libs
--disable-sysusers
--disable-ldconfig

--enable-lz4
%ifarch s390 s390x ppc %{power64} aarch64
--disable-lto
%endif","Functionality already in codebase, but deactivated in RHEL
Changed calling of LZ4 functions due to deprecation of the originals.
Resolves: rhbz#1431687
changes to .spec file:
@@ -552,6 +553,7 @@ BuildRequires:  libblkid-devel
BuildRequires:  xz-devel
BuildRequires:  zlib-devel
BuildRequires:  bzip2-devel
+BuildRequires:  lz4-devel
BuildRequires:  libidn-devel
BuildRequires:  libcurl-devel
BuildRequires:  kmod-devel
@@ -742,6 +744,7 @@ CONFIGURE_OPTS=(
--enable-compat-libs
--disable-sysusers
--disable-ldconfig

--enable-lz4
%ifarch s390 s390x ppc %{power64} aarch64
--disable-lto
%endif",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,170,2017-11-14T16:55:30Z,2017-11-23T14:02:46Z,2017-11-23T14:02:46Z,MERGED,True,176,157,4,https://github.com/msekletar,"journalctl: continue operation, even if we run into an invalid file (#1465759)",5,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/170,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/170,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,171,2017-11-21T09:51:35Z,2017-11-23T14:02:36Z,2017-11-23T14:02:36Z,MERGED,True,7,2,1,https://github.com/jsynacek,(#1515130) man: fix description of --force in halt(8) (#7392),1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/171,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/171,"https://bugzilla.redhat.com/show_bug.cgi?id=1449751
(cherry picked from commit 5d9adb5)
Resolves: #1515130","https://bugzilla.redhat.com/show_bug.cgi?id=1449751
(cherry picked from commit 5d9adb5)
Resolves: #1515130",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,172,2017-11-21T12:04:39Z,2017-11-23T11:10:14Z,2017-11-23T11:10:14Z,MERGED,True,201,22,6,https://github.com/jsynacek,(#1511565) journald: never block when sending messages on NOTIFY_SOCKET socket,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/172,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/172,"Otherwise we might run into deadlocks, when journald blocks on the
notify socket on PID 1, and PID 1 blocks on IPC to dbus-daemon and
dbus-daemon blocks on logging to journald. Break this cycle by making
sure that journald never ever blocks on PID 1.
Note that this change disables support for event loop watchdog support,
as these messages are sent in blocking style by sd-event. That should
not be a big loss though, as people reported frequent problems with the
watchdog hitting journald on excessively slow IO.
Fixes: #1505.
(cherry-picked from commit e22aa3d)
Resolves: #1511565","Otherwise we might run into deadlocks, when journald blocks on the
notify socket on PID 1, and PID 1 blocks on IPC to dbus-daemon and
dbus-daemon blocks on logging to journald. Break this cycle by making
sure that journald never ever blocks on PID 1.
Note that this change disables support for event loop watchdog support,
as these messages are sent in blocking style by sd-event. That should
not be a big loss though, as people reported frequent problems with the
watchdog hitting journald on excessively slow IO.
Fixes: #1505.
(cherry-picked from commit e22aa3d)
Resolves: #1511565",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,172,2017-11-21T12:04:39Z,2017-11-23T11:10:14Z,2017-11-23T11:10:14Z,MERGED,True,201,22,6,https://github.com/jsynacek,(#1511565) journald: never block when sending messages on NOTIFY_SOCKET socket,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/172,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/172#issuecomment-346311406,"Otherwise we might run into deadlocks, when journald blocks on the
notify socket on PID 1, and PID 1 blocks on IPC to dbus-daemon and
dbus-daemon blocks on logging to journald. Break this cycle by making
sure that journald never ever blocks on PID 1.
Note that this change disables support for event loop watchdog support,
as these messages are sent in blocking style by sd-event. That should
not be a big loss though, as people reported frequent problems with the
watchdog hitting journald on excessively slow IO.
Fixes: #1505.
(cherry-picked from commit e22aa3d)
Resolves: #1511565","Note: This commit does not help with the journald sigabrts, as is evident from the recent-ish Fedora bug reports. That also confirms my suspicion that those aborts were not caused by heavy IO, as it is very unlikely that the system gets IO starved for 3 minutes on modern hardware.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,172,2017-11-21T12:04:39Z,2017-11-23T11:10:14Z,2017-11-23T11:10:14Z,MERGED,True,201,22,6,https://github.com/jsynacek,(#1511565) journald: never block when sending messages on NOTIFY_SOCKET socket,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/172,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/172#issuecomment-346333738,"Otherwise we might run into deadlocks, when journald blocks on the
notify socket on PID 1, and PID 1 blocks on IPC to dbus-daemon and
dbus-daemon blocks on logging to journald. Break this cycle by making
sure that journald never ever blocks on PID 1.
Note that this change disables support for event loop watchdog support,
as these messages are sent in blocking style by sd-event. That should
not be a big loss though, as people reported frequent problems with the
watchdog hitting journald on excessively slow IO.
Fixes: #1505.
(cherry-picked from commit e22aa3d)
Resolves: #1511565","Note: This commit does not help with the journald sigabrts, as is evident from the recent-ish Fedora bug reports. That also confirms my suspicion that those aborts were not caused by heavy IO, as it is very unlikely that the system gets IO starved for 3 minutes on modern hardware.

It would be interesting to have a systemd version in Fedora with only this commit. Because this commit disables watchdog support for journald and hence every SIGABRT crash would indicate an actual bug. AFAICT, we never had such version in Fedora for significant period of time, because this commit was quickly followed by 119e965 which reintroduced watchdog support.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,173,2017-11-22T14:07:06Z,2017-11-23T12:06:53Z,2017-11-23T12:06:53Z,MERGED,True,66,10,3,https://github.com/msekletar,journal: restore watchdog support (#1511565),1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/173,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/173,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,174,2017-11-23T11:10:41Z,2017-11-23T14:02:24Z,2017-11-23T14:02:24Z,MERGED,True,366,31,9,https://github.com/jsynacek,(#1503106) input line length,9,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/174,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/174,"Upstream commit set:
https://github.com/systemd/systemd/pull/6891/commits","Upstream commit set:
https://github.com/systemd/systemd/pull/6891/commits",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,175,2017-11-24T09:44:21Z,2017-11-24T09:46:11Z,2017-11-24T09:46:11Z,MERGED,True,1,1,1,https://github.com/msekletar,journald: fix accuracy of watchdog timer event (#1511565),1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/175,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/175,"Adding 3/4th of the watchdog frequency as accuracy on top of 1/2 of the
watchdog frequency means we might end up at 5/4th of the frequency which
means we might miss the message from time to time.
Maybe fixes #1804
(cherry picked from commit 4de2402)
Related: #1511565","Adding 3/4th of the watchdog frequency as accuracy on top of 1/2 of the
watchdog frequency means we might end up at 5/4th of the frequency which
means we might miss the message from time to time.
Maybe fixes #1804
(cherry picked from commit 4de2402)
Related: #1511565",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,176,2017-12-04T09:01:28Z,2017-12-04T13:00:22Z,2018-12-04T13:16:42Z,MERGED,True,6,2,1,https://github.com/lnykryn,(#1489095) shared/dropin: ignore ENAMETOOLONG when checking drop-in directories …,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/176,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/176,"…(#7525)
This usually happens for device units with long
path in /sys. But users can't even create such drop-ins,
so lets just ignore the error here.
Fixes #6867
Cherry-picked from: dfeec91
Resolves: #1489095","…(#7525)
This usually happens for device units with long
path in /sys. But users can't even create such drop-ins,
so lets just ignore the error here.
Fixes #6867
Cherry-picked from: dfeec91
Resolves: #1489095",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,177,2017-12-04T10:31:48Z,2017-12-04T13:00:09Z,2018-12-04T13:16:36Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1302305) core: fix the reversed sanity check when setting StartupBlockIOWeight…,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/177,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/177,"… over dbus
bus_cgroup_set_property() was rejecting if the input value was in range.
Reverse it.
Cherry-picked from: 6fb0926
Resolves: #1302305-one-more-backport","… over dbus
bus_cgroup_set_property() was rejecting if the input value was in range.
Reverse it.
Cherry-picked from: 6fb0926
Resolves: #1302305-one-more-backport",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,178,2017-12-14T09:54:36Z,2017-12-14T11:18:55Z,2017-12-14T11:18:55Z,MERGED,True,8,34,2,https://github.com/msekletar,Fix unlocking of encrypted image files using systemd-cryptsetup and clevis (#1511043),3,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/178,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/178,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,181,2018-01-09T12:01:22Z,2018-01-09T13:22:33Z,2018-12-04T13:16:43Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1532586) shared/cgroup-utils: _CGROUP_CONTROLLER_MASK_ALL does not cover CGROU…,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/181,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/181,"…P_PIDS
7d44d0d added a CGROUP_PIDS but
did not bump _CGROUP_CONTROLLER_MASK_ALL.
RHEL-only
Resolves: #1532586
Fixes #180","…P_PIDS
7d44d0d added a CGROUP_PIDS but
did not bump _CGROUP_CONTROLLER_MASK_ALL.
RHEL-only
Resolves: #1532586
Fixes #180",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,182,2018-01-17T08:45:12Z,2018-01-17T09:17:05Z,2018-01-17T09:17:06Z,MERGED,True,16,12,1,https://github.com/jsynacek,( #1535135) automount: ack automount requests even when already mounted,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/182,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/182,"If a process accesses an autofs filesystem while systemd is in the
middle of starting the mount unit on top of it, it is possible for the
autofs_ptype_missing_direct request from the kernel to be received after
the mount unit has been fully started:
systemd forks and execs mount             ...
...                     access autofs, blocks
mount exits                               ...
systemd receives SIGCHLD                  ...
...                     kernel sends request
systemd receives request                  ...
systemd needs to respond to this request, otherwise the kernel will
continue to block access to the mount point.
(cherry picked from commit e7d54bf)
Resolves: #1535135","If a process accesses an autofs filesystem while systemd is in the
middle of starting the mount unit on top of it, it is possible for the
autofs_ptype_missing_direct request from the kernel to be received after
the mount unit has been fully started:
systemd forks and execs mount             ...
...                     access autofs, blocks
mount exits                               ...
systemd receives SIGCHLD                  ...
...                     kernel sends request
systemd receives request                  ...
systemd needs to respond to this request, otherwise the kernel will
continue to block access to the mount point.
(cherry picked from commit e7d54bf)
Resolves: #1535135",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/chenglin130,1,https://github.com/lnykryn/systemd-rhel/pull/183,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.","fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-358595930,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.",What upstream issue/patch does this backport?,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-358654154,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.",systemd/systemd#7921,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/msekletar,4,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-358654662,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.","This is a good catch. I think we even have a bug about this.
https://bugzilla.redhat.com/show_bug.cgi?id=1439989",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/msekletar,5,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-359062373,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.",@lnykryn  btw CI failure is sort of expected because this PR is against 7.4 branch which doesn't have a fix for the automount related crash. Running the test for that bug on unpatched build killed the machine and aborted CI run,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/msekletar,6,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-359062766,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.","@chenglin130 can you please resubmit the PR but this time aginst ""staging"" branch? This is a branch where we queue patches for the next minor release of RHEL/CentOS. Your change needs to land there first.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/chenglin130,7,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-359161183,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.","@msekletar Thank U very much. The PR has been resubmited against ""staging"" branch.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,183,2018-01-18T05:56:57Z,2018-01-23T08:07:06Z,2018-01-23T08:07:06Z,CLOSED,False,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path,1,[],https://github.com/lnykryn/systemd-rhel/pull/183,https://github.com/msekletar,8,https://github.com/lnykryn/systemd-rhel/pull/183#issuecomment-359708429,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.",Closed in favor of #186,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,184,2018-01-18T12:13:44Z,2018-01-23T08:30:16Z,2018-01-23T08:30:16Z,MERGED,True,72,0,1,https://github.com/jsynacek,"(#1529633) udev: net_id add support for platform bus (ACPI, mostly arm64) devices",1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/184,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/184,"(cherry picked from commit c20e6de)
Note: There is RHEL-only code in the patch. After some discussion,
we only want to rename Hisilicon Network Subsystem (HNS) devices.
Resolves: #1529633","(cherry picked from commit c20e6de)
Note: There is RHEL-only code in the patch. After some discussion,
we only want to rename Hisilicon Network Subsystem (HNS) devices.
Resolves: #1529633",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,185,2018-01-19T11:56:49Z,2018-06-19T13:41:24Z,2018-06-19T13:41:24Z,MERGED,True,0,1,1,https://github.com/msekletar,units: don't put udev to its own mount namespace with slave propagation (#1432211),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/185,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/185,"Change in upstream was done mostly for political reasons to discourage
people from doing mounts in udev rules. RHEL is very bad place for
such experiments. Revert to default we shipped with RHEL-7 GA.
RHEL-only
Resolves: #1432211","Change in upstream was done mostly for political reasons to discourage
people from doing mounts in udev rules. RHEL is very bad place for
such experiments. Revert to default we shipped with RHEL-7 GA.
RHEL-only
Resolves: #1432211",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,1,https://github.com/lnykryn/systemd-rhel/pull/186,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,2,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-359647128,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","@msekletar
Is there anything should I do about this PR?
Should I close the PR #183 (rhel-7.4 branch)?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-359709269,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534",I closed the old PR. Right now there is nothing you should do. Once the fix is merged upstream then we can proceed with this one.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,4,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-360701953,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","@msekletar
I found no this problem in lastest systemd after a commit at 2016-4-7.
the key change is adding ""unit_load_fragment()"" in scope_load(), as this PR does.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,5,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-360702861,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","""core: rework how transient unit files and property drop-ins work"" at 2016-4-7.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,6,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-361812575,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","@msekletar
After too much change，the upstream systemd has no this problem. But this problem has been existed and reproduced in rhel.  And add ""unit_load_fragment()"" in scope_load() can solve the problem.
Please reappraise this PR.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,7,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-361850754,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","In unit_load_fragmen(),  better modify ""if (u->transient && u->fragment_path) ""  to ""if (u->transient) "" as upstream systemd latest code do.
No matter which one，it always works in rhel",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,8,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-369444644,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","@msekletar
any new progress?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/msekletar,9,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-369550519,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","In unit_load_fragmen(), better modify ""if (u->transient && u->fragment_path) "" to ""if (u->transient) "" as upstream systemd latest code do.

Are you really sure that w/o  && u->fragment_path part, the code would work the same? To me it seems like we would then end up in the current situation. IOW, we would call unit_load_fragment(), but that would return early (even for the first time) w/o actually loading anything so u->fragment_path would stay unset.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/msekletar,10,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-369574821,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","I filled the bug about this issue,
https://bugzilla.redhat.com/show_bug.cgi?id=1550534
I am fine with merging the patch as it is. But before we do that we need to reference the bug in the commit message. Can you please amend the commit and add Resolves: #1550534 to the commit message? Thanks!",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,11,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-369870826,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","@msekletar
in a daemon-reload case, when u->fragment_path = NULL, at the same time always u->transient = 0. so it can still work normally, but not easy to read.
But, in upstream systemd, there is a new ""transient"" type scope unit named ""init.scope"", which have no a stub unit file.  In ""init.scope"" case, before call unit_load_fragment(), u->transient will be set 1.
so , ""No matter which one，it always works in rhel"". because now there's no ""init.scope"" in rhel.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/msekletar,12,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-370149682,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","in a daemon-reload case, when u->fragment_path = NULL, at the same time always u->transient = 0. so it can still work normally, but not easy to read.

OK, I wasn't aware that u->transient == 0 at that time.  Now it makes sense.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,186,2018-01-20T10:04:05Z,2018-06-19T13:01:20Z,2018-06-19T13:01:20Z,MERGED,True,9,0,2,https://github.com/chenglin130,core:scope: fix missing fragment_path (#1550534),1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/186,https://github.com/chenglin130,13,https://github.com/lnykryn/systemd-rhel/pull/186#issuecomment-370285316,"fragment_path in struct unit is a record of unit file, which will
be deleted (unlink) in unit_free().
After a daemon-reload process, the u->fragment_path of scope unit
will be missing (NULL). Then, the discarded session scope unit file
will be redundant until reboot.
Steps to Reproduce problem:

ssh access and login
systemctl daemon-reload
ssh logout
discarded session-xxx.scope file will be found in /run/systemd/system/

So in a daemon-reload case, scope_load() need unit_load_fragment() to reload
u->fragment_path.
Resolves: #1550534","@msekletar
Should I remove ""&& u->fragment_path"", or accept it ?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,187,2018-01-29T15:36:21Z,2018-06-14T13:10:18Z,2018-12-04T13:16:43Z,CLOSED,False,44,0,1,https://github.com/lnykryn,"tmpfiles: refuse to chown()/chmod() files which are hardlinked, unles…",1,"['needs-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/187,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/187,"…s protected_hardlinks sysctl is on
Let's add some extra safety.
Fixes: #7736
Cherry-picked from: 5579f85
Resolves: #1539758","…s protected_hardlinks sysctl is on
Let's add some extra safety.
Fixes: #7736
Cherry-picked from: 5579f85
Resolves: #1539758",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,187,2018-01-29T15:36:21Z,2018-06-14T13:10:18Z,2018-12-04T13:16:43Z,CLOSED,False,44,0,1,https://github.com/lnykryn,"tmpfiles: refuse to chown()/chmod() files which are hardlinked, unles…",1,"['needs-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/187,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/187#issuecomment-361565843,"…s protected_hardlinks sysctl is on
Let's add some extra safety.
Fixes: #7736
Cherry-picked from: 5579f85
Resolves: #1539758","Note: changing bug ID from BZ#1539758 (CLOSED WONTFIX) to BZ#1535135 (POST, RHEL 7.5+).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,187,2018-01-29T15:36:21Z,2018-06-14T13:10:18Z,2018-12-04T13:16:43Z,CLOSED,False,44,0,1,https://github.com/lnykryn,"tmpfiles: refuse to chown()/chmod() files which are hardlinked, unles…",1,"['needs-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/187,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/187#issuecomment-363074979,"…s protected_hardlinks sysctl is on
Let's add some extra safety.
Fixes: #7736
Cherry-picked from: 5579f85
Resolves: #1539758",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,187,2018-01-29T15:36:21Z,2018-06-14T13:10:18Z,2018-12-04T13:16:43Z,CLOSED,False,44,0,1,https://github.com/lnykryn,"tmpfiles: refuse to chown()/chmod() files which are hardlinked, unles…",1,"['needs-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/187,https://github.com/lnykryn,4,https://github.com/lnykryn/systemd-rhel/pull/187#issuecomment-397290350,"…s protected_hardlinks sysctl is on
Let's add some extra safety.
Fixes: #7736
Cherry-picked from: 5579f85
Resolves: #1539758",Not needed in el7,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,188,2018-01-30T11:57:02Z,2018-02-05T17:20:28Z,2018-02-05T17:20:28Z,MERGED,True,1,1,1,https://github.com/mrc0mmand,(#1501017) journald-native: Fix typo in MANDLOCK message,1,"['merge-ready', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/188,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/188,"Cherry-picked from: 1dc52f5
Resolves: #1501017","Cherry-picked from: 1dc52f5
Resolves: #1501017",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,189,2018-01-30T12:17:28Z,2018-06-20T08:51:20Z,2018-06-20T08:51:20Z,MERGED,True,170,225,11,https://github.com/msekletar,"Fix incorrect ordering of ""started"" and ""starting"" messages (#1506256)",9,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/189,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/189,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,190,2018-01-30T12:38:46Z,2018-02-06T14:26:32Z,2018-02-06T14:26:33Z,MERGED,True,4,11,1,https://github.com/jsynacek,(#1537147) bus-util.c: fix TasksMax= property assignment,1,"['merge-ready', 'ci-waive', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/190,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/190,"Also, with the current code structure, it's not possible to also set
the TasksMaxScale= in the same if branch, simply because how the
sd_bus_message_append() is used. In src/systemctl/systemctl.c, the
message container is already open in set_property().
Resolves: #1537147","Also, with the current code structure, it's not possible to also set
the TasksMaxScale= in the same if branch, simply because how the
sd_bus_message_append() is used. In src/systemctl/systemctl.c, the
message container is already open in set_property().
Resolves: #1537147",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,190,2018-01-30T12:38:46Z,2018-02-06T14:26:32Z,2018-02-06T14:26:33Z,MERGED,True,4,11,1,https://github.com/jsynacek,(#1537147) bus-util.c: fix TasksMax= property assignment,1,"['merge-ready', 'ci-waive', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/190,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/190#issuecomment-363075543,"Also, with the current code structure, it's not possible to also set
the TasksMaxScale= in the same if branch, simply because how the
sd_bus_message_append() is used. In src/systemctl/systemctl.c, the
message container is already open in set_property().
Resolves: #1537147",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,191,2018-02-02T09:48:28Z,2018-02-06T14:26:20Z,2018-02-06T14:26:20Z,MERGED,True,17,29,1,https://github.com/msekletar,dbus: propagate errors from bus_init_system() and bus_init_api() (#1541061),1,"['merge-ready', 'ci-waive', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/191,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/191,"The aim of this change is to make sure that we properly log about all
D-Bus connection problems. After all, we only ever attempt to get on the
bus if dbus-daemon is around, so any failure in the process should be
treated as an error.
bus_init_system() is only called from bus_init() and in
bus_init() we have a bool flag which governs whether we should attempt
to connect to the system bus or not.
Hence if we are in bus_init_system() then it is clear we got called from
a context where connection to the bus is actually required and therefore
shouldn't be treated as the ""best effort"" type of operation. Same
applies to bus_init_api().
We make use of those error codes in bus_init() and log high level
message that informs admin about what is going on (and is easy to spot
and makes sense to an end user).
Also ""retrying later"" bit is actually a lie. We won't retry unless we
are explicitly told to reconnect via SIGUSR1 or re-executed. This is
because bus_init() is always called from the context where dbus-daemon
is already around and hence bus_init() won't be called again from
unit_notify().
Fixes #7782
(cherry picked from commit dc7118b)
Resolves: #1541061","The aim of this change is to make sure that we properly log about all
D-Bus connection problems. After all, we only ever attempt to get on the
bus if dbus-daemon is around, so any failure in the process should be
treated as an error.
bus_init_system() is only called from bus_init() and in
bus_init() we have a bool flag which governs whether we should attempt
to connect to the system bus or not.
Hence if we are in bus_init_system() then it is clear we got called from
a context where connection to the bus is actually required and therefore
shouldn't be treated as the ""best effort"" type of operation. Same
applies to bus_init_api().
We make use of those error codes in bus_init() and log high level
message that informs admin about what is going on (and is easy to spot
and makes sense to an end user).
Also ""retrying later"" bit is actually a lie. We won't retry unless we
are explicitly told to reconnect via SIGUSR1 or re-executed. This is
because bus_init() is always called from the context where dbus-daemon
is already around and hence bus_init() won't be called again from
unit_notify().
Fixes #7782
(cherry picked from commit dc7118b)
Resolves: #1541061",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,192,2018-02-02T09:50:28Z,2018-02-06T14:26:07Z,2018-02-06T14:26:07Z,MERGED,True,11,0,1,https://github.com/msekletar,process-util: make our freeze() routine do something useful (#1540941),1,"['merge-ready', 'ci-waive', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/192,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/192,"When we crash we freeze() our-self (or possibly we reboot the machine if
that is configured). However, calling pause() is very unhelpful thing to
do. We should at least continue to do what init systems being doing
since 70's and that is reaping zombies. Otherwise zombies start to
accumulate on the system which is a very bad thing. As that can prevent
admin from taking manual steps to reboot the machine in somewhat
graceful manner (e.g. manually stopping services, unmounting data
volumes  and calling reboot -f).
Fixes #7783
(cherry picked from commit 8647283)
Resolves: #1540941","When we crash we freeze() our-self (or possibly we reboot the machine if
that is configured). However, calling pause() is very unhelpful thing to
do. We should at least continue to do what init systems being doing
since 70's and that is reaping zombies. Otherwise zombies start to
accumulate on the system which is a very bad thing. As that can prevent
admin from taking manual steps to reboot the machine in somewhat
graceful manner (e.g. manually stopping services, unmounting data
volumes  and calling reboot -f).
Fixes #7783
(cherry picked from commit 8647283)
Resolves: #1540941",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,193,2018-02-06T16:23:13Z,2018-06-20T11:20:58Z,2018-06-20T11:20:59Z,MERGED,True,23,2,5,https://github.com/msekletar,"mount: add new LazyUnmount= setting for mount units, mapping to umount(8)'s ""-l"" switch (#1497264)",1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/193,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/193,"(cherry-picked commit from e520950)
Resolves: #1497264","(cherry-picked commit from e520950)
Resolves: #1497264",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,194,2018-02-07T13:15:58Z,2018-02-07T14:10:20Z,2018-12-04T13:16:43Z,MERGED,True,20,0,2,https://github.com/lnykryn,(#1542391) core: Let two more booleans survive a daemon-reload,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/194,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/194,"Without the boolean bus_name_good services as well as cgroup_realized
for units a unit of Type=dbus and ExecReload sending SIGHUP to $MAINPID
will be terminated if systemd will be daemon reloaded.
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746151
https://bugs.freedesktop.org/show_bug.cgi?id=78311
https://bugzilla.opensuse.org/show_bug.cgi?id=934077
Cherry-picked from: de1d4f9
Resolves: #1542391","Without the boolean bus_name_good services as well as cgroup_realized
for units a unit of Type=dbus and ExecReload sending SIGHUP to $MAINPID
will be terminated if systemd will be daemon reloaded.
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746151
https://bugs.freedesktop.org/show_bug.cgi?id=78311
https://bugzilla.opensuse.org/show_bug.cgi?id=934077
Cherry-picked from: de1d4f9
Resolves: #1542391",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,195,2018-02-07T13:38:59Z,2018-02-07T14:10:09Z,2018-02-07T14:10:09Z,MERGED,True,25,22,1,https://github.com/msekletar,sparse: avoid clash with __bitwise and __force from 4.10 linux/types.h (#1447937),1,"['merge-ready', 'ci-waive', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/195,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/195,"It also used __bitwise and __force. It seems easier to rename
our versions since they are local to this one single header.
Also, undefine them afteerwards, so that we don't pollute the
preprocessor macro namespace.
(cherry picked from commit dc66f33)
Related: #1447937","It also used __bitwise and __force. It seems easier to rename
our versions since they are local to this one single header.
Also, undefine them afteerwards, so that we don't pollute the
preprocessor macro namespace.
(cherry picked from commit dc66f33)
Related: #1447937",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,196,2018-02-15T08:22:40Z,2018-02-20T15:40:11Z,2018-02-20T15:40:11Z,MERGED,True,248,51,6,https://github.com/msekletar, sd-journal: properly handle inotify queue overflow (#1540538),4,"['merge-ready', 'ci-waive', 'rhel-7.4', 'rhel-7.5']",https://github.com/lnykryn/systemd-rhel/pull/196,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/196,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,197,2018-02-16T09:07:43Z,2018-02-19T15:20:08Z,2018-02-19T15:20:08Z,MERGED,True,62,11,3,https://github.com/jsynacek,(#1545676) core: don't choke if a unit another unit triggers vanishes during reload,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/197,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/197,"Fixes: #1981
(cherry picked from e903182)
Resolves: #1545676","Fixes: #1981
(cherry picked from e903182)
Resolves: #1545676",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,198,2018-02-26T13:01:28Z,2018-06-12T13:01:21Z,2018-12-04T13:16:43Z,MERGED,True,1,1,1,https://github.com/lnykryn,"(#1549119) timer: we already got the trigger before, no need to call UNIT_TRIGGE…",1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/198,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/198,"…R again
In d7b2f6e we forgot to replace this occurence.
rhel-only
Resolves: #1549119","…R again
In d7b2f6e we forgot to replace this occurence.
rhel-only
Resolves: #1549119",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,198,2018-02-26T13:01:28Z,2018-06-12T13:01:21Z,2018-12-04T13:16:43Z,MERGED,True,1,1,1,https://github.com/lnykryn,"(#1549119) timer: we already got the trigger before, no need to call UNIT_TRIGGE…",1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/198,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/198#issuecomment-396579155,"…R again
In d7b2f6e we forgot to replace this occurence.
rhel-only
Resolves: #1549119","[CI] Expected fail, CI ran before #201 was merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,199,2018-03-07T17:47:03Z,2018-06-12T13:21:28Z,2018-06-12T13:21:28Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1552712) man/udevadm: correctly show the short version of --exit,1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/199,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/199,Resolves: #1552712,Resolves: #1552712,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,199,2018-03-07T17:47:03Z,2018-06-12T13:21:28Z,2018-06-12T13:21:28Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1552712) man/udevadm: correctly show the short version of --exit,1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/199,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/199#issuecomment-396583918,Resolves: #1552712,"[CI] Expected fail, CI ran before #201 was merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,200,2018-03-23T10:24:24Z,2018-06-12T13:21:14Z,2018-06-12T13:21:15Z,MERGED,True,0,6,1,https://github.com/jsynacek,(#1553076) man/udevadm: remove superfluous --version from subcommand,1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/200,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/200,"Resolves: #1553076
Upstream commit: systemd/systemd@ca69df7","Resolves: #1553076
Upstream commit: systemd/systemd@ca69df7",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,200,2018-03-23T10:24:24Z,2018-06-12T13:21:14Z,2018-06-12T13:21:15Z,MERGED,True,0,6,1,https://github.com/jsynacek,(#1553076) man/udevadm: remove superfluous --version from subcommand,1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/200,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/200#issuecomment-396585255,"Resolves: #1553076
Upstream commit: systemd/systemd@ca69df7","[CI] Expected fail, CI ran before #201 was merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,201,2018-03-27T09:07:17Z,2018-06-04T08:00:59Z,2018-06-04T08:00:59Z,MERGED,True,8,4,1,https://github.com/msekletar,tmpfiles: don't skip cleanup of read-only root owned files if TMPFILES_AGE_ALL is set (#1533638),1,"['merge-ready', 'has-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/201,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/201,Resolves: #1533638,Resolves: #1533638,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,202,2018-04-24T09:14:26Z,2018-05-15T08:24:20Z,2018-05-15T08:24:20Z,CLOSED,False,92,17,8,https://github.com/jsynacek,core: introduce MemorySwapMax= (#1566177),1,[],https://github.com/lnykryn/systemd-rhel/pull/202,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/202,"Similar to MemoryLimit=, MemorySwapMax= limits swap usage. This controls
controls ""memory.memsw.limit_in_bytes"" attribute in the cgroup hierarchy.
Resolves: #1566177
jsynacek: This still needs to be forward ported to upstream.","Similar to MemoryLimit=, MemorySwapMax= limits swap usage. This controls
controls ""memory.memsw.limit_in_bytes"" attribute in the cgroup hierarchy.
Resolves: #1566177
jsynacek: This still needs to be forward ported to upstream.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,202,2018-04-24T09:14:26Z,2018-05-15T08:24:20Z,2018-05-15T08:24:20Z,CLOSED,False,92,17,8,https://github.com/jsynacek,core: introduce MemorySwapMax= (#1566177),1,[],https://github.com/lnykryn/systemd-rhel/pull/202,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/202#issuecomment-384249892,"Similar to MemoryLimit=, MemorySwapMax= limits swap usage. This controls
controls ""memory.memsw.limit_in_bytes"" attribute in the cgroup hierarchy.
Resolves: #1566177
jsynacek: This still needs to be forward ported to upstream.","For the upstream discussion, see systemd/systemd#8814.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,202,2018-04-24T09:14:26Z,2018-05-15T08:24:20Z,2018-05-15T08:24:20Z,CLOSED,False,92,17,8,https://github.com/jsynacek,core: introduce MemorySwapMax= (#1566177),1,[],https://github.com/lnykryn/systemd-rhel/pull/202,https://github.com/jsynacek,3,https://github.com/lnykryn/systemd-rhel/pull/202#issuecomment-389085392,"Similar to MemoryLimit=, MemorySwapMax= limits swap usage. This controls
controls ""memory.memsw.limit_in_bytes"" attribute in the cgroup hierarchy.
Resolves: #1566177
jsynacek: This still needs to be forward ported to upstream.","Honestly, I am not sure how I feel about this, because it seems to me that in the current form this PR brings substantial inconsistency wrt. upstream behaviour.

I agree about this. Since upstream doesn't seem to be happy about implementing this, and I absolutely understand that, let's not do this.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,203,2018-04-27T07:02:38Z,2018-06-12T13:21:01Z,2018-06-12T13:21:01Z,MERGED,True,5,5,5,https://github.com/jsynacek,(#1572244) doc: fix links to binfmt_misc kernel documentation,1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/203,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/203,Resolves: #1572244,Resolves: #1572244,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,203,2018-04-27T07:02:38Z,2018-06-12T13:21:01Z,2018-06-12T13:21:01Z,MERGED,True,5,5,5,https://github.com/jsynacek,(#1572244) doc: fix links to binfmt_misc kernel documentation,1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/203,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/203#issuecomment-396586329,Resolves: #1572244,"[CI] Expected fail, CI ran before #201 was merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,204,2018-05-03T10:57:22Z,2018-06-18T11:30:52Z,2018-06-18T11:30:52Z,MERGED,True,14,6,1,https://github.com/jsynacek,(#1573838) cryptsetup: support LUKS2 on-disk format,1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/204,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/204,"Allow cryptsetup utility to activate LUKS2 devices (with appropriate
libcryptsetup)
The change itself doesn't enforce new libcryptsetup 2.x and is backward
compatible with versions 1.x
(cherry-picked from commit b3b4eba)
Resolves: #1573838","Allow cryptsetup utility to activate LUKS2 devices (with appropriate
libcryptsetup)
The change itself doesn't enforce new libcryptsetup 2.x and is backward
compatible with versions 1.x
(cherry-picked from commit b3b4eba)
Resolves: #1573838",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,204,2018-05-03T10:57:22Z,2018-06-18T11:30:52Z,2018-06-18T11:30:52Z,MERGED,True,14,6,1,https://github.com/jsynacek,(#1573838) cryptsetup: support LUKS2 on-disk format,1,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/204,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/204#issuecomment-398023777,"Allow cryptsetup utility to activate LUKS2 devices (with appropriate
libcryptsetup)
The change itself doesn't enforce new libcryptsetup 2.x and is backward
compatible with versions 1.x
(cherry-picked from commit b3b4eba)
Resolves: #1573838","[CI] Expected fail, CI ran before #201 was merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,205,2018-05-14T16:33:05Z,2018-06-14T07:52:49Z,2018-06-18T16:12:36Z,MERGED,True,292,12,7,https://github.com/dtardon,(#1446095) systemd-analyze: make dump work for large # of units,3,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/205,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/205,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,205,2018-05-14T16:33:05Z,2018-06-14T07:52:49Z,2018-06-18T16:12:36Z,MERGED,True,292,12,7,https://github.com/dtardon,(#1446095) systemd-analyze: make dump work for large # of units,3,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/205,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/205#issuecomment-396530416,,"Note for future CI fails - this test adds a new DBus method DumpByFileDescriptor, so until it's merged the Sanity/dbus-interfaces test will fail in other PRs.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,205,2018-05-14T16:33:05Z,2018-06-14T07:52:49Z,2018-06-18T16:12:36Z,MERGED,True,292,12,7,https://github.com/dtardon,(#1446095) systemd-analyze: make dump work for large # of units,3,"['merge-ready', 'has-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/205,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/205#issuecomment-396925608,,"Not ready, still needs a review.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,206,2018-05-21T06:01:35Z,2018-06-21T10:11:55Z,2018-06-21T11:54:43Z,MERGED,True,60,5,4,https://github.com/dtardon,(#1351793) fix race between daemon-reload and other commands,1,"['merge-ready', 'needs-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/206,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/206,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,207,2018-05-28T08:18:52Z,2018-06-21T10:11:36Z,2018-07-03T12:08:19Z,MERGED,True,34,1,1,https://github.com/dtardon,(#1316278) fix SELinux labels in cgroup filesystem root directory,2,"['merge-ready', 'has-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/207,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/207,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,208,2018-05-28T09:55:19Z,2018-06-21T10:11:22Z,2018-07-03T13:48:47Z,MERGED,True,66,10,3,https://github.com/jsynacek,(#1436004) tmpfiles: use safe_glob(),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/208,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/208,"This filters out ""."" and "".."" from glob results. Fixes #5655 and #5644.
Any judgements on whether the path is ""safe"" are removed. We will not remove
""/"" under any name (including ""/../"" and such), but we will remove stuff that
is specified using paths that include ""//"", ""/./"" and ""/../"". Such paths can be
created when joining strings automatically, or for other reasons, and people
generally know what "".."" and ""."" is.
Tests are added to make sure that the helper functions behave as expected.
Original commit: 84e72b5
Resolves: #1436004","This filters out ""."" and "".."" from glob results. Fixes #5655 and #5644.
Any judgements on whether the path is ""safe"" are removed. We will not remove
""/"" under any name (including ""/../"" and such), but we will remove stuff that
is specified using paths that include ""//"", ""/./"" and ""/../"". Such paths can be
created when joining strings automatically, or for other reasons, and people
generally know what "".."" and ""."" is.
Tests are added to make sure that the helper functions behave as expected.
Original commit: 84e72b5
Resolves: #1436004",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,209,2018-05-28T11:26:03Z,2018-06-20T08:50:38Z,2018-06-20T08:50:38Z,MERGED,True,14,1,4,https://github.com/jsynacek,"(#1191920) core: make sure ""systemctl reload-or-try-restart is actually a noop i…",1,"['merge-ready', 'has-test', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/209,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/209,"…f a unit is not running
This makes sure we follow the same basic logic for try-restart if we have a try-reload.
Fixes #688
(cherry picked from commit 3282591)
Resolves: #1191920","…f a unit is not running
This makes sure we follow the same basic logic for try-restart if we have a try-reload.
Fixes #688
(cherry picked from commit 3282591)
Resolves: #1191920",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,209,2018-05-28T11:26:03Z,2018-06-20T08:50:38Z,2018-06-20T08:50:38Z,MERGED,True,14,1,4,https://github.com/jsynacek,"(#1191920) core: make sure ""systemctl reload-or-try-restart is actually a noop i…",1,"['merge-ready', 'has-test', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/209,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/209#issuecomment-398375717,"…f a unit is not running
This makes sure we follow the same basic logic for try-restart if we have a try-reload.
Fixes #688
(cherry picked from commit 3282591)
Resolves: #1191920","[CI] Expected fail, CI ran before #201 was merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,210,2018-06-06T10:36:44Z,2018-06-13T12:50:24Z,2018-07-04T11:45:15Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1587906) core/timer: downgrade message about random time addition,1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/210,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/210,"This seems like something that shouldn't be higher then debug level, even
if it does not get emitted too often.
Fixes #5228.
(cherry picked from commit 382852f)
Resolves: #1587906","This seems like something that shouldn't be higher then debug level, even
if it does not get emitted too often.
Fixes #5228.
(cherry picked from commit 382852f)
Resolves: #1587906",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,211,2018-06-13T12:46:38Z,2018-06-19T14:00:34Z,2018-06-19T14:00:34Z,MERGED,True,7,0,2,https://github.com/msekletar,rules: disable support for Lenovo IR cameras (#1540418),1,"['merge-ready', 'sanity-only', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/211,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/211,Resolves: #1540418,Resolves: #1540418,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,212,2018-06-13T14:33:44Z,2018-06-21T10:11:08Z,2018-07-16T12:37:50Z,MERGED,True,27,16,3,https://github.com/msekletar,journal: forward messages from /dev/log unmodified to syslog.socket (#1409659),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/212,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/212,"(cherry picked from commit bb3ff70)
Resolves: #1409659","(cherry picked from commit bb3ff70)
Resolves: #1409659",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,213,2018-06-18T15:26:11Z,2018-06-21T10:10:53Z,2018-07-03T11:31:33Z,MERGED,True,6,6,1,https://github.com/dtardon,(#1247963) journal: fix HMAC calculation when appending a data object,1,"['merge-ready', 'has-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/213,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/213,"Since commit 5996c7c (v190 !), the
calculation of the HMAC is broken because the hash for a data object
including a field is done in the wrong order: the field object is
hashed before the data object is.
However during verification, the hash is done in the opposite order as
objects are scanned sequentially.
(cherry picked from commit 33685a5)","Since commit 5996c7c (v190 !), the
calculation of the HMAC is broken because the hash for a data object
including a field is done in the wrong order: the field object is
hashed before the data object is.
However during verification, the hash is done in the opposite order as
objects are scanned sequentially.
(cherry picked from commit 33685a5)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,214,2018-06-19T12:23:42Z,2018-06-21T10:12:36Z,2018-07-17T10:05:02Z,MERGED,True,64,30,4,https://github.com/msekletar,core: delay adding target dependencies until all units are loaded and aliases resolved (#1368856),1,"['merge-ready', 'has-test']",https://github.com/lnykryn/systemd-rhel/pull/214,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/214,"Currently we add target dependencies while we are loading units. This
can create ordering loops even if configuration doesn't contain any
loop. Take for example following configuration,
$ systemctl get-default
multi-user.target
$ cat /etc/systemd/system/test.service
[Unit]
After=default.target
[Service]
ExecStart=/bin/true
[Install]
WantedBy=multi-user.target
If we encounter such unit file early during manager start-up (e.g. load
queue is dispatched while enumerating devices due to SYSTEMD_WANTS in
udev rules) we would add stub unit default.target and we order it Before
test.service. At the same time we add implicit Before to
multi-user.target. Later we merge two units and we create ordering cycle
in the process.
To fix the issue we will now never add any target dependencies until we
loaded all the unit files and resolved all the aliases.
(cherry picked from commit 1949655)
Resolves: #1368856","Currently we add target dependencies while we are loading units. This
can create ordering loops even if configuration doesn't contain any
loop. Take for example following configuration,
$ systemctl get-default
multi-user.target
$ cat /etc/systemd/system/test.service
[Unit]
After=default.target
[Service]
ExecStart=/bin/true
[Install]
WantedBy=multi-user.target
If we encounter such unit file early during manager start-up (e.g. load
queue is dispatched while enumerating devices due to SYSTEMD_WANTS in
udev rules) we would add stub unit default.target and we order it Before
test.service. At the same time we add implicit Before to
multi-user.target. Later we merge two units and we create ordering cycle
in the process.
To fix the issue we will now never add any target dependencies until we
loaded all the unit files and resolved all the aliases.
(cherry picked from commit 1949655)
Resolves: #1368856",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,215,2018-06-20T09:02:28Z,2018-06-25T10:57:28Z,2018-06-25T10:57:28Z,MERGED,True,281,26,6,https://github.com/msekletar,core: Implement timeout based umount/remount limit,3,['rhel-7.5'],https://github.com/lnykryn/systemd-rhel/pull/215,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/215,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,216,2018-06-20T12:25:03Z,2018-06-21T10:10:31Z,2018-06-21T10:30:01Z,MERGED,True,282,26,6,https://github.com/msekletar,core: Implement timeout based umount/remount limit (#1571098),3,"['merge-ready', 'needs-test', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/216,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/216,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,217,2018-06-20T15:36:29Z,2018-06-21T10:10:17Z,2018-06-21T10:10:17Z,MERGED,True,4,2,1,https://github.com/msekletar,rules: Add MODEL_ID for NVMe device (#1397264),1,"['merge-ready', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/217,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/217,"To mimic MODEL_ID variable built for ATA and SCSI devices, add rules
to add MODEL_ID variable for NVMe devices.
TEST: Check on a system with NVMe device that MODEL_ID variable is
present:
udevadm info --query=all -n /dev/nvme0n1p1 | grep ID_MODEL
and
udevadm info --query=all -n /dev/nvme0n1p1 | grep ID_MODEL
return:
E: ID_MODEL=SAMSUNG...
(cherry picked from commit e2c2d70)
Resolves: #1397264","To mimic MODEL_ID variable built for ATA and SCSI devices, add rules
to add MODEL_ID variable for NVMe devices.
TEST: Check on a system with NVMe device that MODEL_ID variable is
present:
udevadm info --query=all -n /dev/nvme0n1p1 | grep ID_MODEL
and
udevadm info --query=all -n /dev/nvme0n1p1 | grep ID_MODEL
return:
E: ID_MODEL=SAMSUNG...
(cherry picked from commit e2c2d70)
Resolves: #1397264",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,218,2018-06-22T11:12:38Z,2018-06-28T07:20:15Z,2018-06-28T07:20:15Z,MERGED,True,6,6,1,https://github.com/jsynacek,(#1305509) man: correct the meaning of TimeoutStopSec=,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/218,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/218,"Fixes: #9325
(cherry picked from commit 9a6da35)
Resolves: #1305509","Fixes: #9325
(cherry picked from commit 9a6da35)
Resolves: #1305509",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,218,2018-06-22T11:12:38Z,2018-06-28T07:20:15Z,2018-06-28T07:20:15Z,MERGED,True,6,6,1,https://github.com/jsynacek,(#1305509) man: correct the meaning of TimeoutStopSec=,1,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/218,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/218#issuecomment-400937139,"Fixes: #9325
(cherry picked from commit 9a6da35)
Resolves: #1305509","Change in man-page, we don't need CI here.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,219,2018-07-04T06:25:51Z,2018-07-25T12:01:01Z,2018-07-26T08:46:51Z,MERGED,True,5,4,1,https://github.com/dtardon,(#1596241) automount: handle state changes of the corresponding mount unit corre…,1,"['merge-ready', 'needs-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/219,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/219,"…ctly
The expire timeout must be started/stopped if the corresponding mount unit
changes its state, e.g. it is started via local-fs.target or stopped by a
manual umount.
(cherry picked from commit 3dbadf9)","…ctly
The expire timeout must be started/stopped if the corresponding mount unit
changes its state, e.g. it is started via local-fs.target or stopped by a
manual umount.
(cherry picked from commit 3dbadf9)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,219,2018-07-04T06:25:51Z,2018-07-25T12:01:01Z,2018-07-26T08:46:51Z,MERGED,True,5,4,1,https://github.com/dtardon,(#1596241) automount: handle state changes of the corresponding mount unit corre…,1,"['merge-ready', 'needs-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/219,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/219#issuecomment-402378368,"…ctly
The expire timeout must be started/stopped if the corresponding mount unit
changes its state, e.g. it is started via local-fs.target or stopped by a
manual umount.
(cherry picked from commit 3dbadf9)","The commit message misses ""Resolves:..."" in it. Otherwise, looks good to me.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,219,2018-07-04T06:25:51Z,2018-07-25T12:01:01Z,2018-07-26T08:46:51Z,MERGED,True,5,4,1,https://github.com/dtardon,(#1596241) automount: handle state changes of the corresponding mount unit corre…,1,"['merge-ready', 'needs-test', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/219,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/219#issuecomment-407072809,"…ctly
The expire timeout must be started/stopped if the corresponding mount unit
changes its state, e.g. it is started via local-fs.target or stopped by a
manual umount.
(cherry picked from commit 3dbadf9)",LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,220,2018-07-16T09:01:18Z,2018-07-25T12:00:47Z,2018-07-25T12:00:47Z,MERGED,True,2,2,1,https://github.com/jsynacek,(#1582383) rpm: fix %systemd_user_post() macro.,2,"['merge-ready', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/220,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/220,"Escape ""--user"" and ""--global"" arguments with ""\"" since rpm treats
arguments starting with ""-"" as macro options which causes ""Unknown
option"" rpm error.
Use %{expand:...} to force expansion of the inner macro. Otherwise %{?}
is recursively defined as ""--user --global {%?}"" which causes
""Too many levels of recursion in macro expansion"" rpm error.
Thanks to Michael Mráka for helping me fix the above issues.
(cherry picked from commit e67ba78)
Resolves: #1582383","Escape ""--user"" and ""--global"" arguments with ""\"" since rpm treats
arguments starting with ""-"" as macro options which causes ""Unknown
option"" rpm error.
Use %{expand:...} to force expansion of the inner macro. Otherwise %{?}
is recursively defined as ""--user --global {%?}"" which causes
""Too many levels of recursion in macro expansion"" rpm error.
Thanks to Michael Mráka for helping me fix the above issues.
(cherry picked from commit e67ba78)
Resolves: #1582383",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,221,2018-07-17T12:19:09Z,2018-07-25T12:03:22Z,2018-07-25T12:03:22Z,MERGED,True,7,1,1,https://github.com/jsynacek,(#1601794) man: document that SIGCONT always follows SIGTERM,1,"['merge-ready', 'sanity-only', 'ci-waive']",https://github.com/lnykryn/systemd-rhel/pull/221,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/221,"As requested in #199.
(cherry picked from commit e8c5393)
Resolves: #1601794","As requested in #199.
(cherry picked from commit e8c5393)
Resolves: #1601794",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,222,2018-07-18T12:45:49Z,2018-07-25T12:00:24Z,2018-07-25T12:00:24Z,MERGED,True,3,0,2,https://github.com/msekletar,rules: disable support for Dell IR cameras (#1591316),1,"['merge-ready', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/222,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/222,Resolves: #1591316,Resolves: #1591316,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,223,2018-07-20T08:36:13Z,2018-07-25T10:50:30Z,2018-07-25T10:50:30Z,MERGED,True,1,1,1,https://github.com/msekletar,rules: mark hotplugged memory as movable (#1563532),1,"['merge-ready', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/223,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/223,"Otherwise the kernel is free to use to memory block also for storing
non-movable memory (any other memory except anonymous memory allocations
and page cache). If user later wants to hot unplug the memory the kernel
will return error in case that some non-movable memory has been place to
the memory block.
Marking hot plugged memory blocks as movable seems to be better
default. Users with specific needs are free to override this udev rule.
Resolves: #1563532","Otherwise the kernel is free to use to memory block also for storing
non-movable memory (any other memory except anonymous memory allocations
and page cache). If user later wants to hot unplug the memory the kernel
will return error in case that some non-movable memory has been place to
the memory block.
Marking hot plugged memory blocks as movable seems to be better
default. Users with specific needs are free to override this udev rule.
Resolves: #1563532",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,224,2018-07-20T09:14:36Z,2018-07-25T11:00:27Z,2018-07-25T11:00:28Z,MERGED,True,3,0,1,https://github.com/msekletar,udev: add ID_INPUT_SWITCH for devices with switch capability (#1597240),1,"['merge-ready', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/224,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/224,"(cherry picked from commit 64083a6)
Resolves: #1597240","(cherry picked from commit 64083a6)
Resolves: #1597240",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,225,2018-07-23T15:48:31Z,2018-07-25T12:10:15Z,2018-07-25T12:10:15Z,MERGED,True,15,0,2,https://github.com/msekletar,rules: add udev rule that automatically offline HW attached to ACPI container (#1597958),1,"['merge-ready', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/225,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/225,Resolves: #1597958,Resolves: #1597958,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,225,2018-07-23T15:48:31Z,2018-07-25T12:10:15Z,2018-07-25T12:10:15Z,MERGED,True,15,0,2,https://github.com/msekletar,rules: add udev rule that automatically offline HW attached to ACPI container (#1597958),1,"['merge-ready', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/225,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/225#issuecomment-407732996,Resolves: #1597958,Rebased against latest staging branch.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,226,2018-08-16T09:02:22Z,2018-08-16T10:55:15Z,2018-12-04T13:16:44Z,CLOSED,False,1,1,1,https://github.com/msekletar,"Revert ""rules: mark hotplugged memory as movable""",1,['rhel-7.6'],https://github.com/lnykryn/systemd-rhel/pull/226,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/226,"This reverts commit 7431c55.
Resolves: #1614686","This reverts commit 7431c55.
Resolves: #1614686",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,227,2018-08-16T11:58:27Z,2018-08-17T13:22:25Z,2018-12-04T13:16:44Z,MERGED,True,8,1,1,https://github.com/msekletar, rules: implement new memory hotplug policy (#1612896),2,"['merge-ready', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/227,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/227,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,228,2018-08-17T13:13:21Z,2018-08-17T13:23:28Z,2018-12-04T13:16:43Z,MERGED,True,0,15,2,https://github.com/msekletar,"(#1597958) Revert ""rules: add udev rule that automatically offline HW attached to ACPI container""",1,"['merge-ready', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/228,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/228,"This reverts commit 6bc676b.
Related: #1597958","This reverts commit 6bc676b.
Related: #1597958",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,229,2018-08-27T10:43:08Z,2019-02-27T14:31:55Z,2019-02-27T14:31:55Z,MERGED,True,28,20,2,https://github.com/jsynacek,(#1620110) tmpfiles: change ownership of symlinks too,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/229,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/229,"Ownership is supported for symlinks, too, only file modes are not.
Support that too.
Fixes: #7509
(cherry picked from commit 51207ca)
Resolves: #1620110","Ownership is supported for symlinks, too, only file modes are not.
Support that too.
Fixes: #7509
(cherry picked from commit 51207ca)
Resolves: #1620110",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,230,2018-09-03T08:03:49Z,2019-02-11T09:44:19Z,2019-02-11T09:44:19Z,MERGED,True,2,1,1,https://github.com/jsynacek,(#1619543) journald: fixed assertion failure when system journal rotation fails,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/230,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/230,"(cherry picked from commit fd790d6)
Resolves: #1619543","(cherry picked from commit fd790d6)
Resolves: #1619543",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,231,2018-09-06T15:47:42Z,2018-09-07T07:40:15Z,2018-09-07T07:40:15Z,MERGED,True,156,11,3,https://github.com/msekletar, cryptsetup-generator: introduce basic keydev support (#1619743),4,"['merge-ready', 'ci-waive', 'rhel-7.6']",https://github.com/lnykryn/systemd-rhel/pull/231,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/231,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,232,2018-10-02T10:58:22Z,2019-02-11T09:44:06Z,2019-02-11T09:44:06Z,MERGED,True,2,2,1,https://github.com/jsynacek,(#1631625) shorten hostname before checking for trailing dot,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/232,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/232,"Shortening can lead to a hostname that has a trailing dot.
Therefore it should be done before checking from trailing dots.
(cherry picked from commit 46e1a22)
Resolves: #1631625","Shortening can lead to a hostname that has a trailing dot.
Therefore it should be done before checking from trailing dots.
(cherry picked from commit 46e1a22)
Resolves: #1631625",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,233,2018-10-11T06:42:20Z,2019-01-28T14:52:17Z,2019-01-28T14:52:17Z,MERGED,True,32,8,1,https://github.com/jsynacek,(#1631531) detect-virt: do not try to read all of /proc/cpuinfo,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/233,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/233,"Quoting #10074:

detect_vm_uml() reads /proc/cpuinfo with read_full_file()
read_full_file() has a file max limit size of READ_FULL_BYTES_MAX=(4U1024U1024U)
Unfortunately, the size of my /proc/cpuinfo is bigger, approximately:
echo $(( 4* $(cat /proc/cpuinfo | wc -c)))
9918072
This causes read_full_file() to fail and the Condition test fallout.

Let's just read line by line until we find an intersting line. This also
helps if not running under UML, because we avoid reading as much data.
(cherry picked from commit 6058516)
Resolves: #1631531","Quoting #10074:

detect_vm_uml() reads /proc/cpuinfo with read_full_file()
read_full_file() has a file max limit size of READ_FULL_BYTES_MAX=(4U1024U1024U)
Unfortunately, the size of my /proc/cpuinfo is bigger, approximately:
echo $(( 4* $(cat /proc/cpuinfo | wc -c)))
9918072
This causes read_full_file() to fail and the Condition test fallout.

Let's just read line by line until we find an intersting line. This also
helps if not running under UML, because we avoid reading as much data.
(cherry picked from commit 6058516)
Resolves: #1631531",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,234,2018-10-15T16:00:20Z,2018-10-16T11:00:45Z,2018-10-16T13:16:41Z,MERGED,True,17,6,5,https://github.com/dtardon,bz1602706,4,[],https://github.com/lnykryn/systemd-rhel/pull/234,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/234,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,235,2018-10-22T10:17:02Z,2019-03-28T05:41:46Z,2019-03-28T05:41:46Z,MERGED,True,14,1,1,https://github.com/jsynacek,(#1361893) journald: respect KeepFree= as well as MaxUse= values,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/235,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/235,Resolves: #1361893,Resolves: #1361893,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,235,2018-10-22T10:17:02Z,2019-03-28T05:41:46Z,2019-03-28T05:41:46Z,MERGED,True,14,1,1,https://github.com/jsynacek,(#1361893) journald: respect KeepFree= as well as MaxUse= values,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/235,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/235#issuecomment-477067551,Resolves: #1361893,Could you force-push this PR so the new set of CIs gets triggered?,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,236,2018-10-31T13:04:42Z,2018-12-06T08:05:24Z,2018-12-06T08:05:24Z,MERGED,True,33,32,2,https://github.com/jsynacek,sd-bus: unify three code-paths which free struct bus_container (#1635435),2,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/236,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/236,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,237,2018-11-01T13:29:01Z,2018-11-26T09:07:42Z,2018-11-26T09:07:43Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1641581) dhcp6: make sure we have enough space for the DHCP6 option header,1,"['merge-ready', 'ci-waive', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/237,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/237,"Fixes a vulnerability originally discovered by Felix Wilhelm from Google.
(cherry picked from commit 01ca2053bbea09f35b958c8cc7631e15469acb79)
Resolves: CVE-2018-15688","Fixes a vulnerability originally discovered by Felix Wilhelm from Google.
(cherry picked from commit 01ca2053bbea09f35b958c8cc7631e15469acb79)
Resolves: CVE-2018-15688",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,238,2018-11-02T09:56:10Z,2019-02-11T09:43:44Z,2019-02-11T09:43:44Z,MERGED,True,43,41,5,https://github.com/jsynacek,"(#1641566) core: when deserializing state always use read_line(…, LONG_LINE_MAX, …)",2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/238,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/238,"This should be much better than fgets(), as we can read substantially
longer lines and overly long lines result in proper errors.
Fixes a vulnerability discovered by Jann Horn at Google.
(cherry picked from commit 8948b34)
Resolves: CVE-2018-15686
[jsynacek] There were more commits in the pull request of which the cherry
picked commit was a part of, see
https://github.com/systemd/systemd/pull/10519/commits.
I decided not to backport any of the remaining ones, because they were
mostly irrelevant to the actual fix.","This should be much better than fgets(), as we can read substantially
longer lines and overly long lines result in proper errors.
Fixes a vulnerability discovered by Jann Horn at Google.
(cherry picked from commit 8948b34)
Resolves: CVE-2018-15686
[jsynacek] There were more commits in the pull request of which the cherry
picked commit was a part of, see
https://github.com/systemd/systemd/pull/10519/commits.
I decided not to backport any of the remaining ones, because they were
mostly irrelevant to the actual fix.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,238,2018-11-02T09:56:10Z,2019-02-11T09:43:44Z,2019-02-11T09:43:44Z,MERGED,True,43,41,5,https://github.com/jsynacek,"(#1641566) core: when deserializing state always use read_line(…, LONG_LINE_MAX, …)",2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/238,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/238#issuecomment-444031537,"This should be much better than fgets(), as we can read substantially
longer lines and overly long lines result in proper errors.
Fixes a vulnerability discovered by Jann Horn at Google.
(cherry picked from commit 8948b34)
Resolves: CVE-2018-15686
[jsynacek] There were more commits in the pull request of which the cherry
picked commit was a part of, see
https://github.com/systemd/systemd/pull/10519/commits.
I decided not to backport any of the remaining ones, because they were
mostly irrelevant to the actual fix.",v2.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,239,2018-11-06T13:59:42Z,2018-12-06T08:04:57Z,2018-12-06T08:04:57Z,MERGED,True,28,10,1,https://github.com/msekletar,detect-virt: do not try to read all of /proc/cpuinfo (#1631532),1,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/239,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/239,"Quoting systemd/systemd#10074:

detect_vm_uml() reads /proc/cpuinfo with read_full_file()
read_full_file() has a file max limit size of READ_FULL_BYTES_MAX=(4U1024U1024U)
Unfortunately, the size of my /proc/cpuinfo is bigger, approximately:
echo $(( 4* $(cat /proc/cpuinfo | wc -c)))
9918072
This causes read_full_file() to fail and the Condition test fallout.

Let's just read line by line until we find an intersting line. This also
helps if not running under UML, because we avoid reading as much data.
(cherry picked from commit 6058516)
Resolves: #1631532","Quoting systemd/systemd#10074:

detect_vm_uml() reads /proc/cpuinfo with read_full_file()
read_full_file() has a file max limit size of READ_FULL_BYTES_MAX=(4U1024U1024U)
Unfortunately, the size of my /proc/cpuinfo is bigger, approximately:
echo $(( 4* $(cat /proc/cpuinfo | wc -c)))
9918072
This causes read_full_file() to fail and the Condition test fallout.

Let's just read line by line until we find an intersting line. This also
helps if not running under UML, because we avoid reading as much data.
(cherry picked from commit 6058516)
Resolves: #1631532",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,240,2018-11-06T14:12:12Z,2018-12-06T08:04:40Z,2018-12-06T08:04:40Z,MERGED,True,0,3,1,https://github.com/msekletar,"Revert ""sysctl.d: request ECN on both in and outgoing connections"" (#1619790)",1,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/240,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/240,"Turning on ECN still causes slow or broken network on linux. Our tcp
is not yet ready for wide spread use of ECN.
This reverts commit 919472741dba6ad0a3f6c2b76d390a02d0e2fdc3.
(cherry picked from commit 1e190df)
Resolves: #1619790","Turning on ECN still causes slow or broken network on linux. Our tcp
is not yet ready for wide spread use of ECN.
This reverts commit 919472741dba6ad0a3f6c2b76d390a02d0e2fdc3.
(cherry picked from commit 1e190df)
Resolves: #1619790",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,241,2018-11-06T16:04:37Z,2018-12-04T12:21:24Z,2018-12-04T12:21:24Z,MERGED,True,23,10,4,https://github.com/msekletar,debug-generator: introduce rd.* version of all options (#1643429),2,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/241,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/241,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,242,2018-11-15T18:09:28Z,2019-03-04T13:21:25Z,2019-03-04T13:21:25Z,MERGED,True,7,2,2,https://github.com/kyle-walker,"(#1628575) Backport shared/install: allow ""enable"" on linked unit files",1,"['merge-ready', 'ci-waive', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/242,https://github.com/kyle-walker,1,https://github.com/lnykryn/systemd-rhel/pull/242,"(cherry-picked from commit f777b43)
Resolves: #1628575","(cherry-picked from commit f777b43)
Resolves: #1628575",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,242,2018-11-15T18:09:28Z,2019-03-04T13:21:25Z,2019-03-04T13:21:25Z,MERGED,True,7,2,2,https://github.com/kyle-walker,"(#1628575) Backport shared/install: allow ""enable"" on linked unit files",1,"['merge-ready', 'ci-waive', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/242,https://github.com/kyle-walker,2,https://github.com/lnykryn/systemd-rhel/pull/242#issuecomment-439933865,"(cherry-picked from commit f777b43)
Resolves: #1628575","@msekletar
Sorry about that! Let me know if the new revision works for the automation side :)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,243,2018-11-19T15:33:38Z,2019-02-11T09:43:22Z,2019-02-11T12:29:56Z,MERGED,True,2,0,1,https://github.com/dtardon,(#1651257) set automount state to waiting when the mount is stopped,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/243,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/243,Resolves: #1651257,Resolves: #1651257,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,243,2018-11-19T15:33:38Z,2019-02-11T09:43:22Z,2019-02-11T12:29:56Z,MERGED,True,2,0,1,https://github.com/dtardon,(#1651257) set automount state to waiting when the mount is stopped,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/243,https://github.com/dtardon,2,https://github.com/lnykryn/systemd-rhel/pull/243#issuecomment-439937333,Resolves: #1651257,Note: this was fixed upstream as a part of a much bigger change: systemd/systemd@fae03ed,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,244,2018-11-26T13:47:10Z,2018-12-04T13:16:44Z,2019-01-02T09:14:28Z,CLOSED,False,1,1,1,https://github.com/lnykryn,(#1624919) unit: don't add Requires for tmp.mount,1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/244,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/244,"rhel-only
Resolves: #1624919","rhel-only
Resolves: #1624919",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,245,2018-11-28T19:11:00Z,2018-12-04T12:20:40Z,2018-12-04T13:21:56Z,MERGED,True,53,40,5,https://github.com/dtardon,(#1647359) avoid daemon-reload race,3,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/245,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/245,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,246,2018-11-28T19:40:11Z,2019-02-11T09:43:09Z,2019-02-11T12:23:59Z,MERGED,True,3,16,1,https://github.com/dtardon,"(#1643172) Revert ""bus: when dumping string property values escape the chars we …",1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/246,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/246,"…use as end-of-line and end-of-item marks""
This reverts commit 27e9c5a.
Property values already use escaping, so escaping them a second time is
confusing. It also should be mostly unnecessary: we take care to make property
values only contains strings which (after the initial escaping) are printable
and parseable without any futher escaping.
Before revert:
$ systemctl list-dependencies 'dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device'
dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device
● ├─dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.swap
● └─systemd-cryptsetup@luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.service
$ systemctl show -p Wants,Requires 'dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device'
Requires=systemd-cryptsetup@luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.service
Wants=dev-mapper-luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.swap
Difference between systemctl show before revert and now:
-Slice=system-systemd\x5cx2dcryptsetup.slice
+Slice=system-systemd\x2dcryptsetup.slice
-Id=systemd-cryptsetup@luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.service
+Id=systemd-cryptsetup@luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.service
-Names=systemd-cryptsetup@luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.service
+Names=systemd-cryptsetup@luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.service
-Requires=system-systemd\x5cx2dcryptsetup.slice
+Requires=system-systemd\x2dcryptsetup.slice
-BindsTo=dev-mapper-luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device dev-disk-by\x5cx2duuid-8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device
+BindsTo=dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device dev-disk-by\x2duuid-8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device
-RequiredBy=dev-mapper-luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device cryptsetup.target
+RequiredBy=dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device cryptsetup.target
-WantedBy=dev-disk-by\x5cx2duuid-8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device
+WantedBy=dev-disk-by\x2duuid-8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device
(cherry picked from commit 3dfbc96)
Resolves: #1643172","…use as end-of-line and end-of-item marks""
This reverts commit 27e9c5a.
Property values already use escaping, so escaping them a second time is
confusing. It also should be mostly unnecessary: we take care to make property
values only contains strings which (after the initial escaping) are printable
and parseable without any futher escaping.
Before revert:
$ systemctl list-dependencies 'dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device'
dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device
● ├─dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.swap
● └─systemd-cryptsetup@luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.service
$ systemctl show -p Wants,Requires 'dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device'
Requires=systemd-cryptsetup@luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.service
Wants=dev-mapper-luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.swap
Difference between systemctl show before revert and now:
-Slice=system-systemd\x5cx2dcryptsetup.slice
+Slice=system-systemd\x2dcryptsetup.slice
-Id=systemd-cryptsetup@luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.service
+Id=systemd-cryptsetup@luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.service
-Names=systemd-cryptsetup@luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.service
+Names=systemd-cryptsetup@luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.service
-Requires=system-systemd\x5cx2dcryptsetup.slice
+Requires=system-systemd\x2dcryptsetup.slice
-BindsTo=dev-mapper-luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device dev-disk-by\x5cx2duuid-8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device
+BindsTo=dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device dev-disk-by\x2duuid-8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device
-RequiredBy=dev-mapper-luks\x5cx2d8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device cryptsetup.target
+RequiredBy=dev-mapper-luks\x2d8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device cryptsetup.target
-WantedBy=dev-disk-by\x5cx2duuid-8db85dcf\x5cx2d6230\x5cx2d4e88\x5cx2d940d\x5cx2dba176d062b31.device
+WantedBy=dev-disk-by\x2duuid-8db85dcf\x2d6230\x2d4e88\x2d940d\x2dba176d062b31.device
(cherry picked from commit 3dfbc96)
Resolves: #1643172",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,247,2018-12-03T16:03:30Z,2018-12-04T12:40:27Z,2018-12-04T12:40:28Z,MERGED,True,246,81,3,https://github.com/msekletar, chown-recursive: let's rework the recursive logic to use O_PATH (#1643368),4,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/247,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/247,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,248,2018-12-03T16:06:52Z,2018-12-04T12:16:12Z,2018-12-04T12:16:12Z,MERGED,True,1,1,1,https://github.com/msekletar,dhcp6: make sure we have enough space for the DHCP6 option header (#1643363),1,['merge-ready'],https://github.com/lnykryn/systemd-rhel/pull/248,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/248,"Fixes a vulnerability originally discovered by Felix Wilhelm from
Google.
CVE-2018-15688
LP: #1795921
https://bugzilla.redhat.com/show_bug.cgi?id=1639067
(cherry-picked from commit 4dac5ea)
Resolves: #1643363","Fixes a vulnerability originally discovered by Felix Wilhelm from
Google.
CVE-2018-15688
LP: #1795921
https://bugzilla.redhat.com/show_bug.cgi?id=1639067
(cherry-picked from commit 4dac5ea)
Resolves: #1643363",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,249,2018-12-04T11:56:23Z,2019-02-11T09:42:54Z,2019-02-11T09:42:54Z,MERGED,True,6,0,2,https://github.com/msekletar,bus-message: do not crash on message with a string of zero length (#1643396),1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/249,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/249,"We'd calculate the ""real"" length of the string as 'item_size - 1', which does
not work out well when item_size == 0.
(cherry-picked from commit 81b6e63)
Resolves: #1643396","We'd calculate the ""real"" length of the string as 'item_size - 1', which does
not work out well when item_size == 0.
(cherry-picked from commit 81b6e63)
Resolves: #1643396",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,250,2018-12-05T11:05:46Z,2019-01-17T09:01:13Z,2019-01-17T09:01:19Z,MERGED,True,58,54,6,https://github.com/jsynacek,(#1643373) backports,2,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/250,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/250,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,250,2018-12-05T11:05:46Z,2019-01-17T09:01:13Z,2019-01-17T09:01:19Z,MERGED,True,58,54,6,https://github.com/jsynacek,(#1643373) backports,2,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/250,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/250#issuecomment-445830634,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,251,2018-12-06T15:10:15Z,2018-12-11T16:10:47Z,2018-12-11T16:10:47Z,MERGED,True,145,10,2,https://github.com/msekletar, cryptsetup-generator: introduce basic keydev support  (#1656869),4,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/251,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/251,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,252,2018-12-10T15:40:53Z,2018-12-12T08:20:46Z,2018-12-12T08:20:46Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1638676) rules: watch metadata changes on DASD devices,1,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/252,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/252,"To make sure the change event is emitted and udev db is updated
after metadata changes.
(cherry picked from commit 38397c8)
Resolves: #1638676","To make sure the change event is emitted and udev db is updated
after metadata changes.
(cherry picked from commit 38397c8)
Resolves: #1638676",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,253,2018-12-11T11:10:43Z,2019-02-11T09:42:41Z,2019-02-11T09:42:41Z,MERGED,True,5,2,1,https://github.com/jsynacek,(#1641764) tmpfiles 'e' glob backports,3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/253,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/253,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,254,2018-12-11T12:31:29Z,2019-02-11T09:53:33Z,2019-02-11T09:53:33Z,MERGED,True,0,30,1,https://github.com/jsynacek,(#1649518) systemctl: Allow 'edit' and 'cat' on unloaded units,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/254,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/254,"Don't fail if the unit has a LoadError; otherwise systemctl edit cannot be
used to correct the error (e.g. multiple ""ExecStart="" lines).
Remove file changed warning so cat output isn't interspersed with log messages.
Fixes #829
(cherry picked from commit 1e524ec)
Resolves: #1649518","Don't fail if the unit has a LoadError; otherwise systemctl edit cannot be
used to correct the error (e.g. multiple ""ExecStart="" lines).
Remove file changed warning so cat output isn't interspersed with log messages.
Fixes #829
(cherry picked from commit 1e524ec)
Resolves: #1649518",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,255,2018-12-11T19:41:40Z,2018-12-12T10:00:21Z,2019-03-04T09:58:24Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1653824) sysctl.d: switch net.ipv4.conf.all.rp_filter from 1 to 2,1,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/255,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/255,"This switches the RFC3704 Reverse Path filtering from Strict mode to Loose
mode. The Strict mode breaks some pretty common and reasonable use cases,
such as keeping connections via one default route alive after another one
appears (e.g. plugging an Ethernet cable when connected via Wi-Fi).
The strict filter also makes it impossible for NetworkManager to do
connectivity check on a newly arriving default route (it starts with a
higher metric and is bumped lower if there's connectivity).
Kernel's default is 0 (no filter), but a Loose filter is good enough. The
few use cases where a Strict mode could make sense can easily override
this.
The distributions that don't care about the client use cases and prefer a
strict filter could just ship a custom configuration in
/usr/lib/sysctl.d/ to override this.
Cherry-picked from: 230450d
Resolves: #1653824","This switches the RFC3704 Reverse Path filtering from Strict mode to Loose
mode. The Strict mode breaks some pretty common and reasonable use cases,
such as keeping connections via one default route alive after another one
appears (e.g. plugging an Ethernet cable when connected via Wi-Fi).
The strict filter also makes it impossible for NetworkManager to do
connectivity check on a newly arriving default route (it starts with a
higher metric and is bumped lower if there's connectivity).
Kernel's default is 0 (no filter), but a Loose filter is good enough. The
few use cases where a Strict mode could make sense can easily override
this.
The distributions that don't care about the client use cases and prefer a
strict filter could just ship a custom configuration in
/usr/lib/sysctl.d/ to override this.
Cherry-picked from: 230450d
Resolves: #1653824",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,256,2018-12-12T17:07:56Z,2019-05-02T15:26:40Z,2019-05-02T15:26:40Z,MERGED,True,47,42,5,https://github.com/msekletar,seccomp: reduce logging about failure to add syscall to seccomp (#1658691),1,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/256,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/256,"Our logs are full of:
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldstat() / -10037, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call get_thread_area() / -10076, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call set_thread_area() / -10079, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldfstat() / -10034, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldolduname() / -10036, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldlstat() / -10035, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call waitpid() / -10073, ignoring: Numerical argument out of domain
...
This is pointless and makes debug logs hard to read. Let's keep the logs
in test code, but disable it in nspawn and pid1. This is done through a function
parameter because those functions operate recursively and it's not possible to
make the caller to log meaningfully.
There should be no functional change, except the skipped debug logs.
(cherry-picked from commit b54f36c)
Resolves: #1658691","Our logs are full of:
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldstat() / -10037, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call get_thread_area() / -10076, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call set_thread_area() / -10079, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldfstat() / -10034, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldolduname() / -10036, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldlstat() / -10035, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call waitpid() / -10073, ignoring: Numerical argument out of domain
...
This is pointless and makes debug logs hard to read. Let's keep the logs
in test code, but disable it in nspawn and pid1. This is done through a function
parameter because those functions operate recursively and it's not possible to
make the caller to log meaningfully.
There should be no functional change, except the skipped debug logs.
(cherry-picked from commit b54f36c)
Resolves: #1658691",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,256,2018-12-12T17:07:56Z,2019-05-02T15:26:40Z,2019-05-02T15:26:40Z,MERGED,True,47,42,5,https://github.com/msekletar,seccomp: reduce logging about failure to add syscall to seccomp (#1658691),1,"['merge-ready', 'ci-waive', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/256,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/256#issuecomment-477067538,"Our logs are full of:
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldstat() / -10037, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call get_thread_area() / -10076, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call set_thread_area() / -10079, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldfstat() / -10034, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldolduname() / -10036, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call oldlstat() / -10035, ignoring: Numerical argument out of domain
Sep 19 09:22:10 autopkgtest systemd[690]: Failed to add rule for system call waitpid() / -10073, ignoring: Numerical argument out of domain
...
This is pointless and makes debug logs hard to read. Let's keep the logs
in test code, but disable it in nspawn and pid1. This is done through a function
parameter because those functions operate recursively and it's not possible to
make the caller to log meaningfully.
There should be no functional change, except the skipped debug logs.
(cherry-picked from commit b54f36c)
Resolves: #1658691",Could you force-push this PR so the new set of CIs gets triggered?,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,257,2018-12-18T11:01:31Z,2019-02-11T09:53:12Z,2019-02-11T09:53:12Z,MERGED,True,1,1,1,https://github.com/jsynacek,(#1660422) units/rescue.service.in: fix announcement message,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/257,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/257,Resolves: #1660422,Resolves: #1660422,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,258,2019-01-02T09:15:24Z,2019-01-14T12:04:30Z,2019-03-04T09:58:19Z,MERGED,True,1,1,1,https://github.com/lnykryn,(#1619292) unit: don't add Requires for tmp.mount,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/258,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/258,"rhel-only
Resolves: #1619292","rhel-only
Resolves: #1619292",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,259,2019-01-07T14:52:28Z,2019-01-17T09:42:43Z,2019-01-17T09:52:47Z,MERGED,True,298,14,4,https://github.com/mrc0mmand,travis: enable Travis CI on CentOS 7,5,"['merge-ready', 'needs-exhaustive-review', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/259,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/259,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,259,2019-01-07T14:52:28Z,2019-01-17T09:42:43Z,2019-01-17T09:52:47Z,MERGED,True,298,14,4,https://github.com/mrc0mmand,travis: enable Travis CI on CentOS 7,5,"['merge-ready', 'needs-exhaustive-review', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/259,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/259#issuecomment-452216743,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,"So, the Travis itself is working fine, yet the test suite doesn't like the docker environment.
FAIL: test-path
===============
Cannot add dependency job for unit local-fs.target, ignoring: Unit not found.
Cannot add dependency job for unit swap.target, ignoring: Unit not found.
Cannot add dependency job for unit slices.target, ignoring: Unit not found.
Cannot add dependency job for unit swap.target, ignoring: Unit not found.
Cannot add dependency job for unit local-fs.target, ignoring: Unit not found.
Cannot add dependency job for unit slices.target, ignoring: Unit not found.
Test timeout when testing path-changed.path
path-service.service: state = dead; result = success 
path-service.service: state = start; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = start; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
path-service.service: state = dead; result = success 
FAIL: test-path-util
====================
---/a/b/c/d---
---/a/b/c---
---/a/b---
---/a---
------
---/a/b/c---
---/a/b---
---/a---
------
Assertion 'rlf == 0' failed at src/test/test-path-util.c:155, function test_path_is_mount_point(). Aborting.
expected: ./aa/bb/..
actual: ./aa/bb/..
expected: /aa///
actual: /aa
expected: /aa///
actual: /aa
expected: error
actual: error
/bin/sh
/build/./test-path-util
/usr/bin/sh
/bin/sh
/build/./test-path-util
/usr/bin/sh
FAIL: test-capability
=====================
Capabilities:= cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,35,36,37+eip
Capabilities:= cap_dac_override,cap_net_raw+ep
Capabilities:= cap_dac_override+ep
Failed to drop auxiliary groups list: Operation not permitted
Failed to change group ID: Operation not permitted
Assertion 'fv == CAP_CLEAR' failed at src/test/test-capability.c:164, function test_update_inherited_set(). Aborting.
FAIL: test-copy
===============
Assertion 'access(f, F_OK) == 0' failed at src/test/test-copy.c:114, function test_copy_tree(). Aborting.

We dealt with the test-capability fail already in upstream (systemd/systemd#10663), fix is systemd/systemd@c446b84. I'll look for fixes for the rest of the fails as well.
Also, the cherry-picked commits are just for testing purposes, will drop them later. I'm not sure what workflow should be used for merging them, cc @lnykryn, @msekletar.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,259,2019-01-07T14:52:28Z,2019-01-17T09:42:43Z,2019-01-17T09:52:47Z,MERGED,True,298,14,4,https://github.com/mrc0mmand,travis: enable Travis CI on CentOS 7,5,"['merge-ready', 'needs-exhaustive-review', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/259,https://github.com/mrc0mmand,3,https://github.com/lnykryn/systemd-rhel/pull/259#issuecomment-452224263,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,"Fix for test-path-util is systemd/systemd@be24321. As the source tree is significantly changed in this version, it needs to be picked manually (in our tree it's src/shared/path-util.c). Also, it's not a test-only change, so it should get a more thorough review.
Issue: systemd/systemd#11092
PR: systemd/systemd#11094",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,259,2019-01-07T14:52:28Z,2019-01-17T09:42:43Z,2019-01-17T09:52:47Z,MERGED,True,298,14,4,https://github.com/mrc0mmand,travis: enable Travis CI on CentOS 7,5,"['merge-ready', 'needs-exhaustive-review', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/259,https://github.com/mrc0mmand,4,https://github.com/lnykryn/systemd-rhel/pull/259#issuecomment-452237506,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,"Fix for test-copy is systemd/systemd@ef202b8 - again, this patch must be rewritten for our source tree. This patch changes the original behavior of the fd_copy_directory function (see the commit description), so we should take this into consideration. Also, the related PR contains another two commits, which should be backported as well.
PR: https://github.com/systemd/systemd/pull/9213/commits",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,259,2019-01-07T14:52:28Z,2019-01-17T09:42:43Z,2019-01-17T09:52:47Z,MERGED,True,298,14,4,https://github.com/mrc0mmand,travis: enable Travis CI on CentOS 7,5,"['merge-ready', 'needs-exhaustive-review', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/259,https://github.com/mrc0mmand,5,https://github.com/lnykryn/systemd-rhel/pull/259#issuecomment-452264876,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,"test-path will apparently need some debugging, as I can't find any test-related change in upstream, which would fix the timeout and I can't even reproduce it manually:
# dnf -y install docker
# systemctl start docker
# git clone https://github.com/lnykryn/systemd-rhel
# git fetch -fu origin refs/pull/259/merge:pr
# git checkout pr
# export CONT_NAME=""systemd-debug""
# ci/travis-centos.sh SETUP RUN
...
PASS: test-path
...
============================================================================
Testsuite summary for systemd 219
============================================================================
# TOTAL: 106
# PASS:  101
# SKIP:  5
# XFAIL: 0
# FAIL:  0
# XPASS: 0
# ERROR: 0
============================================================================",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,259,2019-01-07T14:52:28Z,2019-01-17T09:42:43Z,2019-01-17T09:52:47Z,MERGED,True,298,14,4,https://github.com/mrc0mmand,travis: enable Travis CI on CentOS 7,5,"['merge-ready', 'needs-exhaustive-review', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/259,https://github.com/mrc0mmand,6,https://github.com/lnykryn/systemd-rhel/pull/259#issuecomment-454336595,Let's enable Travis CI on CentOS 7 for the systemd RHEL fork.,"Current state of Travis for RHEL7/RHEL8:
RHEL 7

4 failing tests, 3 of them should be fixed by #268
the last one needs further debugging

RHEL 8

after merging #269 the Travis on RHEL 8 is fully functional
known workarounds: test/udev-test.pl had to be disabled, as it relies on a functionality provided by newer systemd-detect-virt and it's pointless to run it in a virtualized docker container anyway",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,260,2019-01-08T12:04:46Z,2019-02-11T09:52:58Z,2019-02-11T12:28:44Z,MERGED,True,3,0,1,https://github.com/dtardon,(#1585411) core: mount-setup: handle non-existing mountpoints gracefully,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/260,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/260,"Commit e792e89 (""path-util: don't eat up ENOENT in
path_is_mount_point()"") changed path_is_mount_point() so it doesn't hide
-ENOENT from its caller. This causes all boots to fail early in case
any of the mount points does not exist (for instance, when kdbus isn't
loaded, /sys/fs/kdbus is missing).
Fix this by returning 0 from mount_one() if path_is_mount_point()
returned -ENOENT.
(cherry picked from commit b604cb9)
Resolves: #1585411","Commit e792e89 (""path-util: don't eat up ENOENT in
path_is_mount_point()"") changed path_is_mount_point() so it doesn't hide
-ENOENT from its caller. This causes all boots to fail early in case
any of the mount points does not exist (for instance, when kdbus isn't
loaded, /sys/fs/kdbus is missing).
Fix this by returning 0 from mount_one() if path_is_mount_point()
returned -ENOENT.
(cherry picked from commit b604cb9)
Resolves: #1585411",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,261,2019-01-10T09:47:43Z,2019-01-14T12:04:20Z,2019-01-15T10:05:35Z,MERGED,True,4,3,3,https://github.com/mrc0mmand,meson: various fixes for CentOS CI,2,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/261,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/261,"This PR contains several meson-related fixes to support building of the RHEL8 systemd in CentOS CI (CentOS 7), as we already do in upstream.","This PR contains several meson-related fixes to support building of the RHEL8 systemd in CentOS CI (CentOS 7), as we already do in upstream.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,261,2019-01-10T09:47:43Z,2019-01-14T12:04:20Z,2019-01-15T10:05:35Z,MERGED,True,4,3,3,https://github.com/mrc0mmand,meson: various fixes for CentOS CI,2,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/261,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/261#issuecomment-453095091,"This PR contains several meson-related fixes to support building of the RHEL8 systemd in CentOS CI (CentOS 7), as we already do in upstream.","As for the CI itself, I had to disable almost all integration test, as they keep crashing, will look into that asap.
https://ci.centos.org/job/systemd-rhel-pr-build/7/
Each job contains a console log and build artifacts. To make things more user-friendly, the build artifacts contain index.html, which is a simple directory index generated by tree.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,262,2019-01-10T09:54:25Z,2019-02-11T09:52:44Z,2019-02-11T12:27:56Z,MERGED,True,2,2,1,https://github.com/dtardon,"(#1664695) use path_startswith(""/dev"") in cryptsetup (#6732)",1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/262,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/262,"For both key and partition paths.
(cherry picked from commit 048dd62)
Resolves: #1664695","For both key and partition paths.
(cherry picked from commit 048dd62)
Resolves: #1664695",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,263,2019-01-10T12:43:50Z,2019-01-10T12:46:26Z,2019-01-10T13:01:31Z,MERGED,True,1,1,1,https://github.com/mrc0mmand,test-functions: fix dbus-1 installation,1,[],https://github.com/lnykryn/systemd-rhel/pull/263,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/263,"The basic setup for the well-known system and session buses is
now done in read-only files in ${datadir} (normally /usr/share).
See the NEWS entry for 1.9.18 for details.
http://cgit.freedesktop.org/dbus/dbus/tree/NEWS
Cherry-picked from: e63b61b

This should finally fix the integration testsuite (test/TEST-??-*) on RHEL 7.
cc @msekletar","The basic setup for the well-known system and session buses is
now done in read-only files in ${datadir} (normally /usr/share).
See the NEWS entry for 1.9.18 for details.
http://cgit.freedesktop.org/dbus/dbus/tree/NEWS
Cherry-picked from: e63b61b

This should finally fix the integration testsuite (test/TEST-??-*) on RHEL 7.
cc @msekletar",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,264,2019-01-10T14:45:52Z,2019-01-17T09:42:00Z,2019-01-17T09:42:00Z,MERGED,True,7,0,1,https://github.com/mrc0mmand,test: 01-basic: mask some services that currently don't run in qemu,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/264,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/264,Cherry-picked from: 6f9d3b0,Cherry-picked from: 6f9d3b0,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,264,2019-01-10T14:45:52Z,2019-01-17T09:42:00Z,2019-01-17T09:42:00Z,MERGED,True,7,0,1,https://github.com/mrc0mmand,test: 01-basic: mask some services that currently don't run in qemu,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/264,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/264#issuecomment-453130239,Cherry-picked from: 6f9d3b0,"This is more like nice to have, as it can be workarounded by installing systemd-journal-gateway and systemd-resolved packages, which create necessary users.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,265,2019-01-10T19:59:26Z,2019-01-14T12:04:10Z,2019-01-15T10:04:46Z,MERGED,True,2,6,6,https://github.com/mrc0mmand,test: Drop SKIP_INITRD for QEMU-based tests,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/265,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/265,"Not all distros support booting without an initrd. E.g. the Debian
kernel builds ext4 as a module and so relies on an initrd to
successfully start the QEMU-based images.
Cherry-picked from: c2d4da0

SKIP_INITRD effectively breaks all QEMU tests on RHEL/CentOS, as the ext4 filesystem is shipped as module and needs to be explicitly included in the custom initrd.","Not all distros support booting without an initrd. E.g. the Debian
kernel builds ext4 as a module and so relies on an initrd to
successfully start the QEMU-based images.
Cherry-picked from: c2d4da0

SKIP_INITRD effectively breaks all QEMU tests on RHEL/CentOS, as the ext4 filesystem is shipped as module and needs to be explicitly included in the custom initrd.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,265,2019-01-10T19:59:26Z,2019-01-14T12:04:10Z,2019-01-15T10:04:46Z,MERGED,True,2,6,6,https://github.com/mrc0mmand,test: Drop SKIP_INITRD for QEMU-based tests,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/265,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/265#issuecomment-453240582,"Not all distros support booting without an initrd. E.g. the Debian
kernel builds ext4 as a module and so relies on an initrd to
successfully start the QEMU-based images.
Cherry-picked from: c2d4da0

SKIP_INITRD effectively breaks all QEMU tests on RHEL/CentOS, as the ext4 filesystem is shipped as module and needs to be explicitly included in the custom initrd.","After some manual testing this indeed fixes most of the currently broken tests. Few (2) tests still keep failing (but only under systemd-nspawn) because of the known issue about overrides from /etc/systemd/system are not being applied.
Also, this PR should be merged AFTER #261 to deliver best™ results.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,267,2019-01-11T11:53:14Z,2019-01-14T12:03:34Z,2019-01-15T10:05:08Z,MERGED,True,62,8,4,https://github.com/mrc0mmand,rhel8: several fixes for test/TEST-13-NSPAWN-SMOKE,2,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/267,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/267,"This should be the last batch of fixes for the integration testsuite on RHEL8.


Explicitly enable user namespaces
Upstream issue: systemd/systemd#11173
Upstream PR: systemd/systemd#11193


Improved netns compatibility with older kernels
Upstream issue: systemd/systemd#10544
Upstream PR: systemd/systemd#10589","This should be the last batch of fixes for the integration testsuite on RHEL8.


Explicitly enable user namespaces
Upstream issue: systemd/systemd#11173
Upstream PR: systemd/systemd#11193


Improved netns compatibility with older kernels
Upstream issue: systemd/systemd#10544
Upstream PR: systemd/systemd#10589",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,268,2019-01-14T10:30:12Z,2019-01-17T09:42:17Z,2019-01-17T09:52:54Z,MERGED,True,6,15,3,https://github.com/mrc0mmand,Various fixes for Travis on RHEL 7,3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/268,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/268,"Several backports from upstream to support RHEL 7 systemd in Travis (CentOS 7 Docker container).


systemd/systemd@c446b84
Test-only change.
Original issue: systemd/systemd#10663
Original PR: systemd/systemd#10687


systemd/systemd@be24321
Original issue: systemd/systemd#11092
Original PR: systemd/systemd#11094


systemd/systemd@ef202b8
The original PR contains two more commits and I'm not sure if it's worth backporting them as well, opinions are welcome.
Original PR: systemd/systemd#9213


There's still one outstanding issue breaking the Travis CI, see #259 (comment).","Several backports from upstream to support RHEL 7 systemd in Travis (CentOS 7 Docker container).


systemd/systemd@c446b84
Test-only change.
Original issue: systemd/systemd#10663
Original PR: systemd/systemd#10687


systemd/systemd@be24321
Original issue: systemd/systemd#11092
Original PR: systemd/systemd#11094


systemd/systemd@ef202b8
The original PR contains two more commits and I'm not sure if it's worth backporting them as well, opinions are welcome.
Original PR: systemd/systemd#9213


There's still one outstanding issue breaking the Travis CI, see #259 (comment).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,269,2019-01-15T09:42:26Z,2019-01-15T10:02:02Z,2019-01-15T10:02:21Z,MERGED,True,0,8,1,https://github.com/mrc0mmand,tests: drop the precondition check for inherited flag,1,"['rhel8', 'needs-review']",https://github.com/lnykryn/systemd-rhel/pull/269,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/269,"Docker's default capability set has the inherited flag already
set - that breaks tests which expect otherwise. Let's just
drop the check and run the test anyway.
Fixes #10663
Cherry-picked from: c446b84

This is a RHEL8 change (the same commit is already being backported to RHEL7 branch in #268).","Docker's default capability set has the inherited flag already
set - that breaks tests which expect otherwise. Let's just
drop the check and run the test anyway.
Fixes #10663
Cherry-picked from: c446b84

This is a RHEL8 change (the same commit is already being backported to RHEL7 branch in #268).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,270,2019-01-15T12:39:50Z,2019-02-07T09:12:06Z,2019-02-07T09:12:07Z,MERGED,True,14,1,1,https://github.com/jsynacek,(#1663365) networkd: respect DHCP UseRoutes option,3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/270,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/270,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,270,2019-01-15T12:39:50Z,2019-02-07T09:12:06Z,2019-02-07T09:12:07Z,MERGED,True,14,1,1,https://github.com/jsynacek,(#1663365) networkd: respect DHCP UseRoutes option,3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/270,https://github.com/dtardon,2,https://github.com/lnykryn/systemd-rhel/pull/270#issuecomment-461309165,,LGTM,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,271,2019-01-16T09:53:39Z,2019-01-16T11:30:22Z,2019-01-16T11:30:22Z,MERGED,True,3,2,1,https://github.com/msekletar,(#1666646) journald: free cmdline buffers owned by iovec,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/271,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/271,"Resolves: #1666646
[msekleta: this is a followup for the fix of CVE-2018-16864. While
backporting upstream changes I've accidentally dropped the automatic
cleanup of the cmdline buffers. Technically speaking similar issue is in
coredump.c too, but after we dispatch iovec buffer in coredump.c we
immediately exit so allocated memory is reclaimed by the kernel.]","Resolves: #1666646
[msekleta: this is a followup for the fix of CVE-2018-16864. While
backporting upstream changes I've accidentally dropped the automatic
cleanup of the cmdline buffers. Technically speaking similar issue is in
coredump.c too, but after we dispatch iovec buffer in coredump.c we
immediately exit so allocated memory is reclaimed by the kernel.]",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,271,2019-01-16T09:53:39Z,2019-01-16T11:30:22Z,2019-01-16T11:30:22Z,MERGED,True,3,2,1,https://github.com/msekletar,(#1666646) journald: free cmdline buffers owned by iovec,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/271,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/271#issuecomment-454740162,"Resolves: #1666646
[msekleta: this is a followup for the fix of CVE-2018-16864. While
backporting upstream changes I've accidentally dropped the automatic
cleanup of the cmdline buffers. Technically speaking similar issue is in
coredump.c too, but after we dispatch iovec buffer in coredump.c we
immediately exit so allocated memory is reclaimed by the kernel.]","Doesn't this emit unused variable warnings (which turn into errors) during compilation?

Travis CI failure seems unrelated. Note that current Travis CI configuration still runs on Ubuntu",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,271,2019-01-16T09:53:39Z,2019-01-16T11:30:22Z,2019-01-16T11:30:22Z,MERGED,True,3,2,1,https://github.com/msekletar,(#1666646) journald: free cmdline buffers owned by iovec,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/271,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/271#issuecomment-454742310,"Resolves: #1666646
[msekleta: this is a followup for the fix of CVE-2018-16864. While
backporting upstream changes I've accidentally dropped the automatic
cleanup of the cmdline buffers. Technically speaking similar issue is in
coredump.c too, but after we dispatch iovec buffer in coredump.c we
immediately exit so allocated memory is reclaimed by the kernel.]","I would suggest that a cleaner approach would be to free the temp variables explicitely instead of using gcc cleanup. Or simply wrap the function call with a correct free function. And also add a comment, since ""set_iovec_field_free"" kind of suggest that stuff gets freed and doesn't leak.

I guess wrapping the calls with free() is out of the question since we need to free the strings after we dispatch iovec at the very end of dispatch_message_real(). Explicit free() after write_to_journal() is an option but I think that using cleanup macro is IMHO the better solution.
Btw, I don't really like this explicit assignment to cmdline1 cmdline2 but this is what upstream code does as well. I'd really like to have this handled by the iovec container but unfortunately we have a mix of on-stack and on-heap allocated buffers pointed from iovec. Hence we can't blindly free() them.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,272,2019-01-17T10:07:28Z,2019-01-17T12:37:00Z,2019-01-17T12:37:21Z,MERGED,True,288,67,4,https://github.com/mrc0mmand,Enable Travis CI for RHEL 8 branches,5,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/272,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/272,Cherry picked from #259.,Cherry picked from #259.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,273,2019-01-17T11:57:35Z,2019-02-11T09:52:30Z,2019-02-11T09:52:30Z,MERGED,True,6,2,1,https://github.com/jsynacek,(#1658115) journald: correctly attribute log messages also with cgroupsv1,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/273,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/273,"With cgroupsv1 a zombie process is migrated to root cgroup in all
hierarchies. This was changed for unified hierarchy and /proc/PID/cgroup
reports cgroup to which process belonged before it exited.
Be more suspicious about cgroup path reported by the kernel and use
unit_id provided by the log client if the kernel reports that process is
running in the root cgroup.
Users tend to care the most about 'log->unit_id' mapping so systemctl
status can correctly report last log lines. Also we wouldn't be able to
infer anything useful from ""/"" path anyway.
See: torvalds/linux@2e91fa7
(cherry picked from commit 672773b)
Resolves: #1658115","With cgroupsv1 a zombie process is migrated to root cgroup in all
hierarchies. This was changed for unified hierarchy and /proc/PID/cgroup
reports cgroup to which process belonged before it exited.
Be more suspicious about cgroup path reported by the kernel and use
unit_id provided by the log client if the kernel reports that process is
running in the root cgroup.
Users tend to care the most about 'log->unit_id' mapping so systemctl
status can correctly report last log lines. Also we wouldn't be able to
infer anything useful from ""/"" path anyway.
See: torvalds/linux@2e91fa7
(cherry picked from commit 672773b)
Resolves: #1658115",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,274,2019-01-17T12:24:21Z,2019-01-17T12:38:52Z,2019-01-17T12:39:16Z,MERGED,True,8,7,2,https://github.com/mrc0mmand,travis: Fix dbus timeout on RHEL/CentOS 7,2,"['rhel7', 'needs-review']",https://github.com/lnykryn/systemd-rhel/pull/274,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/274,This should fix the last timeouting test (test_path_changed) on RHEL/CentOS 7.,This should fix the last timeouting test (test_path_changed) on RHEL/CentOS 7.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,275,2019-01-22T09:39:52Z,2019-05-02T15:21:49Z,2019-05-02T15:21:49Z,MERGED,True,4,0,1,https://github.com/jsynacek,(#1667065) enable tmp mount,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/275,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/275,"rhel-only
Resolves: #1667065","rhel-only
Resolves: #1667065",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/276,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.","Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/276#issuecomment-456811001,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.","It looks like gcc4 is too old for ASan to work properly:
    Making all in docs/libudev
    Making all in docs/gudev
      DOC   Scanning header files
      DOC   Introspecting gobjects
    2019-01-23 08:00:26,135:scangobj.py:execute_command:1196:WARNING:Running scanner failed: -11, command: /bin/sh ../../libtool --mode=execute ./gudev-scan
    make[2]: *** [scan-build.stamp] Error 245
    make[1]: *** [all-recursive] Error 1
    make: *** [all] Error 2
    [root@host-8-252-40 systemd-219]# gdb /root/rpmbuild/BUILD/systemd-219/docs/gudev/.libs/lt-gudev-scan
    GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
    Copyright (C) 2013 Free Software Foundation, Inc.
    License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
    This is free software: you are free to change and redistribute it.
    There is NO WARRANTY, to the extent permitted by law.  Type ""show copying""
    and ""show warranty"" for details.
    This GDB was configured as ""x86_64-redhat-linux-gnu"".
    For bug reporting instructions, please see:
    <http://www.gnu.org/software/gdb/bugs/>...
    Reading symbols from /root/rpmbuild/BUILD/systemd-219/docs/gudev/.libs/lt-gudev-scan...done.
    (gdb) run
    Starting program: /root/rpmbuild/BUILD/systemd-219/docs/gudev/.libs/lt-gudev-scan
    [Thread debugging using libthread_db enabled]
    Using host libthread_db library ""/lib64/libthread_db.so.1"".
     
    Program received signal SIGSEGV, Segmentation fault.
    0x0000000000000000 in ?? ()
    (gdb) bt full
    #0  0x0000000000000000 in  ()
    #1  0x00007ffff2db4404 in __asan::MaybeInstallSigaction(int, void (*)(int, siginfo_t*, void*)) (signum=signum@entry=11, handler=
        0x7ffff2db4360 <__asan::ASAN_OnSIGSEGV(int, siginfo_t*, void*)>) at ../../../../libsanitizer/asan/asan_posix.cc:39
            sigact =
              {__sigaction_handler = {sa_handler = 0x0, sa_sigaction = 0x0}, sa_mask = {__val = {0, 0, 0, 0, 0, 0, 0, 0, 0, 18446744073699065856, 18446744073699069952, 140737353973760, 140737267879458, 0, 140737353987135, 140737272503952}}, sa_flags = -220471292, sa_restorer = 0x2008fff7000}
    #2  0x00007ffff2db46a2 in __asan::InstallSignalHandlers() (handler=
        0x7ffff2db4360 <__asan::ASAN_OnSIGSEGV(int, siginfo_t*, void*)>, signum=11) at ../../../../libsanitizer/asan/asan_posix.cc:94
    #3  0x00007ffff2db46a2 in __asan::InstallSignalHandlers() () at ../../../../libsanitizer/asan/asan_posix.cc:92
    #4  0x00007ffff2db57fb in __asan_init_v1() () at ../../../../libsanitizer/asan/asan_rtl.cc:500
            options = <optimized out>
            shadow_start = 2147446784
            shadow_end = 17594333495295
            full_shadow_is_available = true
    #5  0x00007ffff77cc907 in _GLOBAL__sub_I_00099_1_libudev.c () at src/libudev/libudev.c:252
    #6  0x00007ffff7dea903 in _dl_init (env=0x7fffffffe538, argv=0x7fffffffe528, argc=1, l=<optimized out>) at dl-init.c:82
            j = <optimized out>
            jm = <optimized out>
            addrs = <optimized out>
            init_array = <optimized out>
            env = 0x7fffffffe538
            argv = 0x7fffffffe528
            argc = 1
            l = <optimized out>
            preinit_array = <optimized out>
            preinit_array_size = <optimized out>
            i = 2
    #7  0x00007ffff7dea903 in _dl_init (main_map=0x7ffff7ffe150, argc=1, argv=0x7fffffffe528, env=0x7fffffffe538) at dl-init.c:131
            preinit_array = <optimized out>
            preinit_array_size = <optimized out>
            i = 2
    #8  0x00007ffff7ddc15a in _dl_start_user () at /lib64/ld-linux-x86-64.so.2
    #9  0x0000000000000001 in  ()
    #10 0x00007fffffffe776 in  ()
    #11 0x0000000000000000 in  ()

Using gcc6/gcc7 solves this issue.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/mrc0mmand,3,https://github.com/lnykryn/systemd-rhel/pull/276#issuecomment-457183877,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.",Blocked by https://bugzilla.redhat.com/show_bug.cgi?id=1669117,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/mrc0mmand,4,https://github.com/lnykryn/systemd-rhel/pull/276#issuecomment-458438443,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.","As this issue wouldn't let me sleep, I dug a little bit deeper, and after a painstakingly significant amount of time and several workarounds later I finally managed to compile & run systemd under ASan on RHEL 7. The ASan detected several memory leaks, so they should be fixed prior merging this PR.
Applied workarounds (only the ""relevant"" ones, the rest is described in the code itself):


GCC 8 from SCL (devtools-8)
There's a bug somewhere in the GCC 4 which causes unexpected segfaults in some applications when compiled with ASan (see the relevant BZ), so the best choice is to use a newer GCC. To get the best possible support I went with GCC 8 which works surprisingly well with the RHEL7 systemd.


Disabled warnings from newer GCCs
Several warnings were triggering the -Werror option a thus had to be disabled (if permanently of just temporarily has to be decided yet). Namely:



-Wimplicit-fallthrough=0
-Wformat-truncation=0
-Wno-cast-function-type
-Wno-logical-op


make has to be run with LD_PRELOAD=/lib64/libasan.so*
There's a known bug in GObject introspect which fails to handle ASan options during compilation, which causes unexpected errors in GISCAN phases of the build. Running the build with ""correct"" LD_PRELOAD fixes this issue, but causes significant slowdown (and breaks the compilation thanks to the memory leak check). Combination of LD_PRELOAD and ASAN_OPTIONS=detect_leaks=false allows the compilation to finish successfully in a reasonable time (however, the workaround itself is pretty ugly).

This is the first job which finished ""successfully"" (i.e. without compilation error), however it's missing the verbose test log. That should be fixed in https://travis-ci.org/lnykryn/systemd-rhel/jobs/485774546 once it finishes (Edit: the ""interesting"" part begins at https://travis-ci.org/lnykryn/systemd-rhel/jobs/485774546#L5126).
I'm not sure which workarounds we want to keep and which ones we'd like to fix, so feedback is definitely welcome (@msekletar).
Edit2: I disabled several other checks during the make phase to speed the compilation a little bit.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/mrc0mmand,5,https://github.com/lnykryn/systemd-rhel/pull/276#issuecomment-458520985,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.",Here's a run with both ASan and UBSan enabled: https://travis-ci.org/lnykryn/systemd-rhel/jobs/485858249#L5141,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/jsynacek,6,https://github.com/lnykryn/systemd-rhel/pull/276#issuecomment-479786278,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.",What is the status of this PR? Is it still WIP and therefore not supposed to be merged?,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,276,2019-01-23T10:23:42Z,2019-05-03T10:50:12Z,2019-05-03T10:50:12Z,CLOSED,False,76,5,3,https://github.com/mrc0mmand,travis: build & test systemd with ASan and UBSan on RHEL7,2,"['rhel7', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/276,https://github.com/mrc0mmand,7,https://github.com/lnykryn/systemd-rhel/pull/276#issuecomment-479800106,"Let's build & test systemd with Address Sanitizer and Undefined Behavior Sanitizer in Travis.
Marked as WIP as this has to be resolved & tested separately for staging and staging-next branches.","I'd leave this PR in WIP, as it still needs a lot of work due to missing backports. However, the RHEL8 counterpart in #309 is ready to go.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,277,2019-01-29T14:35:59Z,2019-02-15T09:18:21Z,2019-02-15T11:49:47Z,MERGED,True,9,4,1,https://github.com/dtardon,(#1267552) journal-remote: show error message if output file name does not end w…,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/277,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/277,"…ith .journal
journalctl -o export | systemd-journal-remote -o /tmp/dir -
gives the following error messages.
Failed to open output journal /tmp/dir: Invalid argument
Failed to get writer for source stdin: Invalid argument
Failed to create source for fd:0 (stdin): Invalid argument

And these are hard to understand what is the problem.
This commit makes journal-remote check whether the output file name
ends with .journal suffix or not, and if not, output error message.
(cherry picked from commit 6b1b9f7)
Resolves: bz#1267552","…ith .journal
journalctl -o export | systemd-journal-remote -o /tmp/dir -
gives the following error messages.
Failed to open output journal /tmp/dir: Invalid argument
Failed to get writer for source stdin: Invalid argument
Failed to create source for fd:0 (stdin): Invalid argument

And these are hard to understand what is the problem.
This commit makes journal-remote check whether the output file name
ends with .journal suffix or not, and if not, output error message.
(cherry picked from commit 6b1b9f7)
Resolves: bz#1267552",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,278,2019-01-29T18:17:56Z,2019-02-15T09:18:08Z,2019-02-15T11:42:14Z,MERGED,True,9,4,1,https://github.com/dtardon,(#1463678)  journalctl: allow --file/--directory with --boot or --list-boots,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/278,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/278,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,279,2019-01-30T09:17:47Z,2019-02-15T09:17:54Z,2019-02-15T11:48:59Z,MERGED,True,14,3,1,https://github.com/dtardon,(#1609816) shared/sleep-config: exclude zram devices from hibernation candidates,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/279,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/279,"On a host with sufficiently large zram but with no actual swap, logind will
respond to CanHibernate() with yes. With this patch, it will correctly respond
no, unless there are other swap devices to consider.
(cherry picked from commit 411ae92)
Resolves: #1609816","On a host with sufficiently large zram but with no actual swap, logind will
respond to CanHibernate() with yes. With this patch, it will correctly respond
no, unless there are other swap devices to consider.
(cherry picked from commit 411ae92)
Resolves: #1609816",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,280,2019-01-30T09:25:25Z,2019-02-11T09:51:43Z,2019-02-11T09:51:44Z,MERGED,True,2,1,1,https://github.com/jsynacek,(#1666612) rules: fix memory hotplug rule so systemd-detect-virt does not run too often,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/280,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/280,"Fixes a bug introduced in commit c50b7bc.
Resolves: #1666612","Fixes a bug introduced in commit c50b7bc.
Resolves: #1666612",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,281,2019-01-30T09:43:11Z,2019-02-18T14:40:47Z,2019-02-18T14:40:48Z,MERGED,True,9,1,1,https://github.com/jsynacek,(#1670728) rules: implement new memory hotplug policy,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/281,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/281,"Our new policy is based on following motivations (assumptions),

we want to allow the system to use hotplugged memory
we want memory ballon inflation to work as expected in VMs (going for small
to big in terms of memory footprint)
we want to allow memory hotplug and memory hot-unplug on high-end
enterprise server (we assume that node0 will have sufficient memory
resources and marking all memory as movable shouldn't be a problem)

Policy:

nevert online memory on s390 (on both physical and z/VM)
mark memory as ""online_movable"" on physical machines
mark memory as ""online"" in VMs

If you have the feeling that all this is very wrong and we shouldn't
encode complex policies in udev rules you are absolutely right. However,
for now, we don't have any better place where to put it. In ideal world
we would have a user-space daemon that would be able to configure the
system wrt. to currently present HW and user-defined policy.
Resolves: #1670728","Our new policy is based on following motivations (assumptions),

we want to allow the system to use hotplugged memory
we want memory ballon inflation to work as expected in VMs (going for small
to big in terms of memory footprint)
we want to allow memory hotplug and memory hot-unplug on high-end
enterprise server (we assume that node0 will have sufficient memory
resources and marking all memory as movable shouldn't be a problem)

Policy:

nevert online memory on s390 (on both physical and z/VM)
mark memory as ""online_movable"" on physical machines
mark memory as ""online"" in VMs

If you have the feeling that all this is very wrong and we shouldn't
encode complex policies in udev rules you are absolutely right. However,
for now, we don't have any better place where to put it. In ideal world
we would have a user-space daemon that would be able to configure the
system wrt. to currently present HW and user-defined policy.
Resolves: #1670728",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,282,2019-01-30T12:20:46Z,2019-02-18T14:20:56Z,2019-02-19T07:33:51Z,MERGED,True,10,0,1,https://github.com/dtardon,(#1272485) artificially serialize building of .policy files,1,"['merge-ready', 'rhel7', 'reviewed/needs-rework']",https://github.com/lnykryn/systemd-rhel/pull/282,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/282,"This allows to build these--and just these--files in a separate step
using `make -j1', to workaround concurrent write access to translation
cache by intltool-merge.","This allows to build these--and just these--files in a separate step
using `make -j1', to workaround concurrent write access to translation
cache by intltool-merge.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,282,2019-01-30T12:20:46Z,2019-02-18T14:20:56Z,2019-02-19T07:33:51Z,MERGED,True,10,0,1,https://github.com/dtardon,(#1272485) artificially serialize building of .policy files,1,"['merge-ready', 'rhel7', 'reviewed/needs-rework']",https://github.com/lnykryn/systemd-rhel/pull/282,https://github.com/dtardon,2,https://github.com/lnykryn/systemd-rhel/pull/282#issuecomment-458925361,"This allows to build these--and just these--files in a separate step
using `make -j1', to workaround concurrent write access to translation
cache by intltool-merge.","This requires an addition to the spec: add ""make i18n"" before the existing make call. If that's too involved, I could do a purely Makefile-side workaround; it would just be slightly longer (7-8 lines, I don't remember exactly how many of the .policy files there are).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,283,2019-02-05T14:19:56Z,2019-02-07T11:57:45Z,2019-02-07T11:57:45Z,MERGED,True,183,112,15,https://github.com/msekletar,(#1664976) (CVE-2018-16864) systemd: stack overflow when calling syslog from a command with long cmdline,10,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/283,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/283,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,284,2019-02-05T14:22:25Z,2019-02-11T09:51:15Z,2019-02-11T09:51:15Z,MERGED,True,99,88,7,https://github.com/msekletar,(#1664977) (CVE-2018-16865) systemd: stack overflow when receiving many journald entries,6,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/284,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/284,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,285,2019-02-05T14:24:36Z,2019-02-11T09:51:01Z,2019-02-11T09:51:01Z,MERGED,True,11,5,2,https://github.com/msekletar,(#1664978) (CVE-2018-16866) journal: fix syslog_parse_identifier(),1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/285,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/285,"Fixes #9829.
(cherry-picked from commit a6aadf4)
Resolves: #1664978","Fixes #9829.
(cherry-picked from commit a6aadf4)
Resolves: #1664978",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,286,2019-02-06T09:28:16Z,2019-02-06T17:11:06Z,2019-02-06T18:08:26Z,MERGED,True,6,0,1,https://github.com/dtardon,(#1626382) core: disable the effect of Restart= if there's a stop job pending fo…,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/286,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/286,"…r a service (#6581)
We shouldn't undo the job already enqueued, under any circumstances.
Fixes: #6504
(cherry picked from commit 0f52f8e)
Resolves: #1626382","…r a service (#6581)
We shouldn't undo the job already enqueued, under any circumstances.
Fixes: #6504
(cherry picked from commit 0f52f8e)
Resolves: #1626382",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/287,My first attempt in backporting the systemd-networkd testsuite from upstream.,My first attempt in backporting the systemd-networkd testsuite from upstream.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461011886,My first attempt in backporting the systemd-networkd testsuite from upstream.,@ssahani it would be great if you could take a look as well if I didn't forget something important.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/mrc0mmand,3,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461056800,My first attempt in backporting the systemd-networkd testsuite from upstream.,"Note: this will require several other patches, as the code won't compile right now (both CIs compile it with -Dnetworkd=false)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/lnykryn,4,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461081920,My first attempt in backporting the systemd-networkd testsuite from upstream.,"@mrc0mmand Since we don't plan to ship networkd for el8, wouldn't make more sense just to drop those tests?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/ssahani,5,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461099127,My first attempt in backporting the systemd-networkd testsuite from upstream.,I think it perfectly makes to include those at we should prepare for the future. adding tests would help us making the product better.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/ssahani,6,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461300379,My first attempt in backporting the systemd-networkd testsuite from upstream.,Overall LGTM. It would be nice to see if you can attach the logs thanks !,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/mrc0mmand,7,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461816877,My first attempt in backporting the systemd-networkd testsuite from upstream.,"@mrc0mmand Since we don't plan to ship networkd for el8, wouldn't make more sense just to drop those tests?

For some reason I though we're going to ship it due to other dependencies. In that case I'm not sure if it's worth the hassle tracking down all necessary commits to make this work.

Overall LGTM. It would be nice to see if you can attach the logs thanks !

I don't have the logs anymore, but you can reproduce it by simply compiling this PR.
As I finally re-enabled the networkd tests for the upstream repo (see systemd/systemd-centos-ci#66) I'm not sure if the effort needed to do the same for downstream is worth it. However, if you're willing to take over this PR, @ssahani, it would be much appreciated, as I lack the knowledge and experience (and time as well) to backport the necessary patches.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/ssahani,8,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461837323,My first attempt in backporting the systemd-networkd testsuite from upstream.,"@mrc0mmand Since we don't plan to ship networkd for el8, wouldn't make more sense just to drop those tests?

For some reason I though we're going to ship it due to other dependencies. In that case I'm not sure if it's worth the hassle tracking down all necessary commits to make this work.

Overall LGTM. It would be nice to see if you can attach the logs thanks !

I don't have the logs anymore, but you can reproduce it by simply compiling this PR.

No issues I am going to run this in a one minute machine.

As I finally re-enabled the networkd tests for the upstream repo (see systemd/systemd-centos-ci#66) I'm not sure if the effort needed to do the same for downstream is worth it.

Yes it does . I see a lots of ppl are asking for it . before release we need to run tests. Running tests no harm rather it's better.

However, if you're willing to take over this PR, @ssahani, it would be much appreciated, as I lack the knowledge and experience (and time as well) to backport the necessary patches.

Sure. I have to say you are doing great work . Thanks for working on this. Much appreciated.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/lnykryn,9,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461838760,My first attempt in backporting the systemd-networkd testsuite from upstream.,To be honest I would vote for dropping this. We don't care if any part of networkd brakes in rhel and it will only make the CI runs a bit longer.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/ssahani,10,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461840758,My first attempt in backporting the systemd-networkd testsuite from upstream.,"To be honest I would vote for dropping this. We don't care if any part of networkd brakes in rhel and it will only make the CI runs a bit longer.

Isn't it running separate to systemd tests that can be figured out which test cases failed. Running longer is not a issue. It's not a performance use case surely.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/lnykryn,11,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461844501,My first attempt in backporting the systemd-networkd testsuite from upstream.,"@ssahani  but again, why should we run those in the first place? We build systemd with -Dnetworkd=false in the spec file.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/ssahani,12,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-461845674,My first attempt in backporting the systemd-networkd testsuite from upstream.,"@ssahani but again, why should we run those in the first place? We build systemd with -Dnetworkd=false in the spec file.

This makes sense. Only should be run where it needed. That can be configured I guess.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,287,2019-02-06T12:34:10Z,2019-02-12T12:45:27Z,2019-02-12T12:45:28Z,CLOSED,False,3774,54,133,https://github.com/mrc0mmand,Backport systemd-networkd-tests fixes,45,"['rhel8', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/287,https://github.com/lnykryn,13,https://github.com/lnykryn/systemd-rhel/pull/287#issuecomment-462745637,My first attempt in backporting the systemd-networkd testsuite from upstream.,After a discussion with @mrc0mmand we have agreed that we can close this one.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,288,2019-02-06T13:28:29Z,2019-02-14T12:35:52Z,2019-02-14T12:35:55Z,MERGED,True,1,1,1,https://github.com/mrc0mmand,test-network: ignore tunnel devices automatically added by kernel,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/288,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/288,"Fixes #10934.
(cherry picked from commit e327272)

Original issue: systemd/systemd#10934","Fixes #10934.
(cherry picked from commit e327272)

Original issue: systemd/systemd#10934",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,289,2019-02-06T13:44:17Z,2019-02-20T14:00:55Z,2019-02-20T14:00:55Z,MERGED,True,51,1,3,https://github.com/dtardon,(#1571801)  cryptsetup: add support for sector-size= option,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/289,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/289,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,290,2019-02-06T15:19:07Z,2019-02-15T09:17:18Z,2019-02-15T11:49:25Z,MERGED,True,11,1,1,https://github.com/dtardon,(#1585913) main: improve RLIMIT_NOFILE handling (#5795),1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/290,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/290,"This has systemd look at /proc/sys/fs/nr_open to find the current maximum of
open files compiled into the kernel and tries to set the RLIMIT_NOFILE max to
it. This has the advantage the value chosen as limit is less arbitrary and also
improves the behavior of systemd in containers that have an rlimit set: When
systemd currently starts in a container that has RLIMIT_NOFILE set to e.g.
100000 systemd will lower it to 65536. With this patch systemd will try to set
the nofile limit to the allowed kernel maximum. If this fails, it will compute
the minimum of the current set value (the limit that is set on the container)
and the maximum value as soft limit and the currently set maximum value as the
maximum value. This way it retains the limit set on the container.
(cherry picked from commit 6385cb3)
Resolves: #1585913","This has systemd look at /proc/sys/fs/nr_open to find the current maximum of
open files compiled into the kernel and tries to set the RLIMIT_NOFILE max to
it. This has the advantage the value chosen as limit is less arbitrary and also
improves the behavior of systemd in containers that have an rlimit set: When
systemd currently starts in a container that has RLIMIT_NOFILE set to e.g.
100000 systemd will lower it to 65536. With this patch systemd will try to set
the nofile limit to the allowed kernel maximum. If this fails, it will compute
the minimum of the current set value (the limit that is set on the container)
and the maximum value as soft limit and the currently set maximum value as the
maximum value. This way it retains the limit set on the container.
(cherry picked from commit 6385cb3)
Resolves: #1585913",True,{'THUMBS_UP': ['https://github.com/centminmod']}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,291,2019-02-07T15:01:10Z,2019-02-11T09:50:23Z,2019-02-11T12:27:16Z,MERGED,True,2,0,1,https://github.com/dtardon,(#1627750) local-addresses: handle gracefully if routes lack an RTA_OIF attribute,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/291,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/291,"Some routes (such as those using ""nexthop"") don't have an RTA_OIF
attribute. We need to handle that gracefully, by simply ignoring the
route.
Fixes: #7854
(cherry picked from commit 568fc5c)
Resolves: #1627750","Some routes (such as those using ""nexthop"") don't have an RTA_OIF
attribute. We need to handle that gracefully, by simply ignoring the
route.
Fixes: #7854
(cherry picked from commit 568fc5c)
Resolves: #1627750",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,292,2019-02-08T09:55:40Z,2019-02-08T10:10:18Z,2019-03-04T09:58:15Z,MERGED,True,1,1,1,https://github.com/lnykryn,"(#1653824) Revert ""sysctl.d: switch net.ipv4.conf.all.rp_filter from 1 to 2""",1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/292,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/292,"This reverts commit 75c9af8.
Resolves: #1653824","This reverts commit 75c9af8.
Resolves: #1653824",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,293,2019-02-11T17:09:04Z,2019-03-27T16:11:28Z,2019-03-27T16:11:28Z,MERGED,True,1109,73,15,https://github.com/dtardon,(#1663143) be stricter when handling PID files and MAINPID sd_notify() messages,7,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/293,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/293,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,293,2019-02-11T17:09:04Z,2019-03-27T16:11:28Z,2019-03-27T16:11:28Z,MERGED,True,1109,73,15,https://github.com/dtardon,(#1663143) be stricter when handling PID files and MAINPID sd_notify() messages,7,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/293,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/293#issuecomment-463665363,,"Also, the remaining test failures in the CentOS CI are caused by systemd/systemd-centos-ci#69 - should be in the CentOS CI master in a few hours.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,293,2019-02-11T17:09:04Z,2019-03-27T16:11:28Z,2019-03-27T16:11:28Z,MERGED,True,1109,73,15,https://github.com/dtardon,(#1663143) be stricter when handling PID files and MAINPID sd_notify() messages,7,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/293,https://github.com/mrc0mmand,3,https://github.com/lnykryn/systemd-rhel/pull/293#issuecomment-464307810,,"Ugh, it looks like the test uses more newer features than I expected:
+ systemd-run -p DynamicUser=1 --unit=sleep.service /bin/sleep infinity
+ sleep infinity
Failed to determine peer security context: Protocol not available
Unknown assignment DynamicUser=1.
Failed to create bus message: No such device or address
Got unexpected auxiliary data with level=1 and type=2
[�[1;31mFAILED�[0m] Failed to start Testsuite service.
See 'systemctl status testsuite.service' for details.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,294,2019-02-12T11:03:16Z,2019-05-02T15:26:20Z,2019-05-02T15:26:20Z,MERGED,True,35,31,1,https://github.com/jsynacek,(#1643394) sd-bus: unify three code-paths which free struct bus_container,1,"['merge-ready', 'ci-waive', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/294,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/294,"We didn't free one of the fields in two of the places.
$ valgrind --show-leak-kinds=all --leak-check=full 
build/fuzz-bus-message 
test/fuzz/fuzz-bus-message/leak-c09c0e2256d43bc5e2d02748c8d8760e7bc25d20
...
==14457== HEAP SUMMARY:
==14457==     in use at exit: 3 bytes in 1 blocks
==14457==   total heap usage: 509 allocs, 508 frees, 51,016 bytes allocated
==14457==
==14457== 3 bytes in 1 blocks are definitely lost in loss record 1 of 1
==14457==    at 0x4C2EBAB: malloc (vg_replace_malloc.c:299)
==14457==    by 0x53AFE79: strndup (in /usr/lib64/libc-2.27.so)
==14457==    by 0x4F52EB8: free_and_strndup (string-util.c:1039)
==14457==    by 0x4F8E1AB: sd_bus_message_peek_type (bus-message.c:4193)
==14457==    by 0x4F76CB5: bus_message_dump (bus-dump.c:144)
==14457==    by 0x108F12: LLVMFuzzerTestOneInput (fuzz-bus-message.c:24)
==14457==    by 0x1090F7: main (fuzz-main.c:34)
==14457==
==14457== LEAK SUMMARY:
==14457==    definitely lost: 3 bytes in 1 blocks
(cherry picked from commit 6d1e0f4)
Resolves: #1643394","We didn't free one of the fields in two of the places.
$ valgrind --show-leak-kinds=all --leak-check=full 
build/fuzz-bus-message 
test/fuzz/fuzz-bus-message/leak-c09c0e2256d43bc5e2d02748c8d8760e7bc25d20
...
==14457== HEAP SUMMARY:
==14457==     in use at exit: 3 bytes in 1 blocks
==14457==   total heap usage: 509 allocs, 508 frees, 51,016 bytes allocated
==14457==
==14457== 3 bytes in 1 blocks are definitely lost in loss record 1 of 1
==14457==    at 0x4C2EBAB: malloc (vg_replace_malloc.c:299)
==14457==    by 0x53AFE79: strndup (in /usr/lib64/libc-2.27.so)
==14457==    by 0x4F52EB8: free_and_strndup (string-util.c:1039)
==14457==    by 0x4F8E1AB: sd_bus_message_peek_type (bus-message.c:4193)
==14457==    by 0x4F76CB5: bus_message_dump (bus-dump.c:144)
==14457==    by 0x108F12: LLVMFuzzerTestOneInput (fuzz-bus-message.c:24)
==14457==    by 0x1090F7: main (fuzz-main.c:34)
==14457==
==14457== LEAK SUMMARY:
==14457==    definitely lost: 3 bytes in 1 blocks
(cherry picked from commit 6d1e0f4)
Resolves: #1643394",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,295,2019-02-12T15:15:12Z,2019-02-21T21:00:57Z,2019-02-21T21:00:57Z,MERGED,True,19,7,2,https://github.com/msekletar,(#1657794) (CVE-2018-16866) journal: fix syslog_parse_identifier(),2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/295,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/295,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,296,2019-02-12T16:00:36Z,2019-02-15T10:10:22Z,2019-03-04T09:58:11Z,MERGED,True,20,0,1,https://github.com/lnykryn,(#1670126) rules: add elevator= kernel command line parameter,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/296,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/296,"Kernel removed the elevator= option, so let's reintroduce
it for rhel8 via udev rule.
rhel-only
Resolves: #1670126","Kernel removed the elevator= option, so let's reintroduce
it for rhel8 via udev rule.
rhel-only
Resolves: #1670126",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,297,2019-02-13T08:51:40Z,2019-02-14T11:16:41Z,2019-02-14T11:16:44Z,MERGED,True,3,3,1,https://github.com/mrc0mmand,test: replace echo with socat,1,"['rhel8', 'needs-review']",https://github.com/lnykryn/systemd-rhel/pull/297,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/297,"The original version of the test used netcat along with a standard
AF_UNIX socket, which caused issues across different netcat
implementations. The AF_UNIX socket was then replaced by a FIFO with a
simple echo, which, however, suffers from the same issue (some echo
implementations don't check if the write() was successful).
Let's revert back to the AF_UNIX socket, but replace netcat with socat,
which, hopefully, resolves the main issue.
Relevant commit: 9b45c2b
(cherry picked from commit b35d6d8)

After merging I'll re-enable this test in the CentOS CI (systemd/systemd-centos-ci#67).","The original version of the test used netcat along with a standard
AF_UNIX socket, which caused issues across different netcat
implementations. The AF_UNIX socket was then replaced by a FIFO with a
simple echo, which, however, suffers from the same issue (some echo
implementations don't check if the write() was successful).
Let's revert back to the AF_UNIX socket, but replace netcat with socat,
which, hopefully, resolves the main issue.
Relevant commit: 9b45c2b
(cherry picked from commit b35d6d8)

After merging I'll re-enable this test in the CentOS CI (systemd/systemd-centos-ci#67).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,298,2019-02-14T13:01:06Z,2019-02-18T14:23:34Z,2019-02-18T14:40:50Z,MERGED,True,4,1,1,https://github.com/mrc0mmand,rule-syntax-check: allow PROGRAM as an assignment,1,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/298,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/298,"(cherry picked from commit ed2dc50)

Fixes CI fail in #281.
cc @jsynacek","(cherry picked from commit ed2dc50)

Fixes CI fail in #281.
cc @jsynacek",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,299,2019-02-15T17:20:28Z,2019-02-18T14:22:15Z,2019-02-18T14:31:18Z,MERGED,True,1,1,1,https://github.com/mrc0mmand,tests: run `udevadm settle` after `fdisk`,1,"['rhel7', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/299,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/299,"This makes the script wait for the newly created partition to
show up before trying to put a filesystem on it, which should
prevent the tests from failing with the following error:
Command (m for help): Building a new DOS disklabel with disk identifier 0x614565d4.

Command (m for help): Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): Partition number (1-4, default 1): First sector (2048-819199, default 2048): Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-819199, default 819199): Partition 1 of type Linux and of size 290 MiB is set

Command (m for help): Partition type:
   p   primary (1 primary, 0 extended, 3 free)
   e   extended
Select (default p): Partition number (2-4, default 2): First sector (595968-819199, default 595968): Using default value 595968
Last sector, +sectors or +size{K,M,G} (595968-819199, default 819199): Partition 2 of type Linux and of size 50 MiB is set

Command (m for help): The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.
/dev/loop1p1: No such file or directory
Usage: mkfs.xfs
<snip>
mount: /dev/loop1p1 is write-protected, mounting read-only
mount: unknown filesystem type '(null)'

Based on 053edc5

Apparently partprobe doesn't wait until all partitions on the given device are created, which is causing issues in other PRs, like #293.
Example log: https://ci.centos.org/job/systemd-rhel-pr-build/129/artifact/systemd-centos-ci/artifacts_YXU2ci/testsuite-logs.bdM/TEST-02-CRYPTSETUP_FAIL.log","This makes the script wait for the newly created partition to
show up before trying to put a filesystem on it, which should
prevent the tests from failing with the following error:
Command (m for help): Building a new DOS disklabel with disk identifier 0x614565d4.

Command (m for help): Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): Partition number (1-4, default 1): First sector (2048-819199, default 2048): Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-819199, default 819199): Partition 1 of type Linux and of size 290 MiB is set

Command (m for help): Partition type:
   p   primary (1 primary, 0 extended, 3 free)
   e   extended
Select (default p): Partition number (2-4, default 2): First sector (595968-819199, default 595968): Using default value 595968
Last sector, +sectors or +size{K,M,G} (595968-819199, default 819199): Partition 2 of type Linux and of size 50 MiB is set

Command (m for help): The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.
/dev/loop1p1: No such file or directory
Usage: mkfs.xfs
<snip>
mount: /dev/loop1p1 is write-protected, mounting read-only
mount: unknown filesystem type '(null)'

Based on 053edc5

Apparently partprobe doesn't wait until all partitions on the given device are created, which is causing issues in other PRs, like #293.
Example log: https://ci.centos.org/job/systemd-rhel-pr-build/129/artifact/systemd-centos-ci/artifacts_YXU2ci/testsuite-logs.bdM/TEST-02-CRYPTSETUP_FAIL.log",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,299,2019-02-15T17:20:28Z,2019-02-18T14:22:15Z,2019-02-18T14:31:18Z,MERGED,True,1,1,1,https://github.com/mrc0mmand,tests: run `udevadm settle` after `fdisk`,1,"['rhel7', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/299,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/299#issuecomment-464319944,"This makes the script wait for the newly created partition to
show up before trying to put a filesystem on it, which should
prevent the tests from failing with the following error:
Command (m for help): Building a new DOS disklabel with disk identifier 0x614565d4.

Command (m for help): Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): Partition number (1-4, default 1): First sector (2048-819199, default 2048): Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-819199, default 819199): Partition 1 of type Linux and of size 290 MiB is set

Command (m for help): Partition type:
   p   primary (1 primary, 0 extended, 3 free)
   e   extended
Select (default p): Partition number (2-4, default 2): First sector (595968-819199, default 595968): Using default value 595968
Last sector, +sectors or +size{K,M,G} (595968-819199, default 819199): Partition 2 of type Linux and of size 50 MiB is set

Command (m for help): The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.
/dev/loop1p1: No such file or directory
Usage: mkfs.xfs
<snip>
mount: /dev/loop1p1 is write-protected, mounting read-only
mount: unknown filesystem type '(null)'

Based on 053edc5

Apparently partprobe doesn't wait until all partitions on the given device are created, which is causing issues in other PRs, like #293.
Example log: https://ci.centos.org/job/systemd-rhel-pr-build/129/artifact/systemd-centos-ci/artifacts_YXU2ci/testsuite-logs.bdM/TEST-02-CRYPTSETUP_FAIL.log",Tried to run it several times (~7x) in #300 with #293 merged and it indeed seems to fix the issue.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,300,2019-02-15T18:53:14Z,2019-02-16T09:28:31Z,2019-02-16T09:28:45Z,CLOSED,False,1061,74,15,https://github.com/mrc0mmand,(#1663143) Debug-only: udevadm settle,10,"['rhel7', 'needs-acks', 'needs-review', 'dont-merge']",https://github.com/lnykryn/systemd-rhel/pull/300,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/300,Debug-only branch to properly test changes in #299.,Debug-only branch to properly test changes in #299.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,301,2019-02-19T10:01:52Z,2019-02-19T12:27:55Z,2019-02-19T12:27:58Z,MERGED,True,44,8,3,https://github.com/mrc0mmand,C LGTM analysis for RHEL 8,5,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/301,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/301,Let's add a custom config for LGTM so the C part systemd can be compiled and properly analyzed.,Let's add a custom config for LGTM so the C part systemd can be compiled and properly analyzed.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,301,2019-02-19T10:01:52Z,2019-02-19T12:27:55Z,2019-02-19T12:27:58Z,MERGED,True,44,8,3,https://github.com/mrc0mmand,C LGTM analysis for RHEL 8,5,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/301,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/301#issuecomment-465070364,Let's add a custom config for LGTM so the C part systemd can be compiled and properly analyzed.,"This pull request introduces 1 alert and fixes 5 when merging 06809b7 into c95026c - view on LGTM.com
new alerts:

1 for Syntax error

fixed alerts:

2 for Syntax error
2 for Encoding error
1 for Unused local variable


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,301,2019-02-19T10:01:52Z,2019-02-19T12:27:55Z,2019-02-19T12:27:58Z,MERGED,True,44,8,3,https://github.com/mrc0mmand,C LGTM analysis for RHEL 8,5,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/301,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/301#issuecomment-465074952,Let's add a custom config for LGTM so the C part systemd can be compiled and properly analyzed.,"This pull request fixes 4 alerts when merging 77210ba into c95026c - view on LGTM.com
fixed alerts:

2 for Syntax error
2 for Encoding error


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,301,2019-02-19T10:01:52Z,2019-02-19T12:27:55Z,2019-02-19T12:27:58Z,MERGED,True,44,8,3,https://github.com/mrc0mmand,C LGTM analysis for RHEL 8,5,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/301,https://github.com/lnykryn,4,https://github.com/lnykryn/systemd-rhel/pull/301#issuecomment-465087893,Let's add a custom config for LGTM so the C part systemd can be compiled and properly analyzed.,"This pull request fixes 4 alerts when merging 86bed5c into c95026c - view on LGTM.com
fixed alerts:

2 for Syntax error
2 for Encoding error


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,301,2019-02-19T10:01:52Z,2019-02-19T12:27:55Z,2019-02-19T12:27:58Z,MERGED,True,44,8,3,https://github.com/mrc0mmand,C LGTM analysis for RHEL 8,5,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/301,https://github.com/mrc0mmand,5,https://github.com/lnykryn/systemd-rhel/pull/301#issuecomment-465093469,Let's add a custom config for LGTM so the C part systemd can be compiled and properly analyzed.,"So, the C analysis should work after merging this PR.
Taken from LGTM support forum:

Currently, unfortunately it’s not possible for users to configure which languages are analysed for a particular project once that project has already been added to LGTM.com (we’re working on improving this as we speak). In particular, modifying a lgtm.yml file in a Pull Request (like you have done here) will not cause the additional language to be analysed for that pull request.
For an additional language to be added to LGTM, we need to be able to build the default branch of a repository.

We may need to fix the LGTM for the staging branch first, though, if I understand the statement above correctly...",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/302,Several fixes for warnings found by LGTM.,Several fixes for warnings found by LGTM.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-465113798,Several fixes for warnings found by LGTM.,"This pull request fixes 6 alerts when merging c2bb19d into d26406c - view on LGTM.com
fixed alerts:

6 for Missing variable declaration


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/mrc0mmand,3,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-465119724,Several fixes for warnings found by LGTM.,"The remaining LGTM warnings are related to systemd parts, which have been removed from systemd upstream, namely:

python-systemd: moved to a separate repository (systemd/python-systemd) in 2799e51
libsystemd-terminal/systemd-consoled: dropped completely in d537694
gudev/gtk-doc: moved to a separate repository in 2375607

We can either follow the upstream path or just waive these warnings in LGTM.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/lnykryn,4,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-465121555,Several fixes for warnings found by LGTM.,"This pull request fixes 8 alerts when merging 18eb081 into d26406c - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unused local variable
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/lnykryn,5,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-467792627,Several fixes for warnings found by LGTM.,"This pull request fixes 8 alerts when merging 3234378 into 16d1f6e - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unused local variable
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/msekletar,6,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-489047394,Several fixes for warnings found by LGTM.,"I have created a BZ to match this PR.
https://bugzilla.redhat.com/show_bug.cgi?id=1705971",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/mrc0mmand,7,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-489053194,Several fixes for warnings found by LGTM.,"Pushed a new version with correct Resolves: lines, PTAL!",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,302,2019-02-19T12:35:33Z,2019-05-03T11:30:27Z,2019-05-03T11:30:27Z,MERGED,True,12,10,2,https://github.com/mrc0mmand,(#1705971) RHEL 8 LGTM fixes,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/302,https://github.com/lnykryn,8,https://github.com/lnykryn/systemd-rhel/pull/302#issuecomment-489055988,Several fixes for warnings found by LGTM.,"This pull request fixes 8 alerts when merging 6aeb079 into f5bd75f - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unused local variable
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,303,2019-02-21T16:02:40Z,2019-03-04T09:45:23Z,2019-03-04T09:45:27Z,MERGED,True,141,0,3,https://github.com/mrc0mmand,test: add TEST-24-UNIT-TESTS running all basic tests under containers,1,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/303,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/303,(cherry picked from commit 3f6f58e03a7d22154aabe036439e7f2fb4849570),(cherry picked from commit 3f6f58e03a7d22154aabe036439e7f2fb4849570),True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,304,2019-02-21T16:07:43Z,2019-04-04T11:38:55Z,2019-04-04T11:38:55Z,CLOSED,False,172,0,3,https://github.com/mrc0mmand,test: add simple test for importd,1,"['rhel8', 'needs-review', 'dont-merge', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/304,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/304,"It currently does not test pulling (i.e. http downloads), but we might
want to add that later on.

(cherry picked from commit f5095a6af064001c94d633123dabe2a59c841bf3)","It currently does not test pulling (i.e. http downloads), but we might
want to add that later on.

(cherry picked from commit f5095a6af064001c94d633123dabe2a59c841bf3)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,304,2019-02-21T16:07:43Z,2019-04-04T11:38:55Z,2019-04-04T11:38:55Z,CLOSED,False,172,0,3,https://github.com/mrc0mmand,test: add simple test for importd,1,"['rhel8', 'needs-review', 'dont-merge', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/304,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/304#issuecomment-466132339,"It currently does not test pulling (i.e. http downloads), but we might
want to add that later on.

(cherry picked from commit f5095a6af064001c94d633123dabe2a59c841bf3)","This test depends on btrfs, which is not present in RHEL 8 (but CentOS 7 has and supports it). In this case I'm not sure in which state the btrfs support in systemd is, but after fixing the missing mkfs.btrfs issue (which doesn't happen with the upstream systemd version) the test keeps failing:
[  OK  ] Started Virtual Machine and Container Download Service.
Failed to transfer image: Not enough free disk space to set up /var/lib/machines.
[FAILED] Failed to start Testsuite service.
See 'systemctl status testsuite.service' for details.

Fixed by bumping the disk image limit to 1GB. However, now the test fails with:
[  OK  ] Started Update UTMP about System Runlevel Changes.+ machinectl import-raw /var/tmp/testimage.raw

         Starting Virtual Machine and Container Download Service...
[  OK  ] Started Virtual Machine and Container Download Service.
Failed to transfer image: Failed to open /dev/loop-control: No such device
[FAILED] Failed to start Testsuite service.
See 'systemctl status testsuite.service' for details.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,304,2019-02-21T16:07:43Z,2019-04-04T11:38:55Z,2019-04-04T11:38:55Z,CLOSED,False,172,0,3,https://github.com/mrc0mmand,test: add simple test for importd,1,"['rhel8', 'needs-review', 'dont-merge', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/304,https://github.com/mrc0mmand,3,https://github.com/lnykryn/systemd-rhel/pull/304#issuecomment-479862132,"It currently does not test pulling (i.e. http downloads), but we might
want to add that later on.

(cherry picked from commit f5095a6af064001c94d633123dabe2a59c841bf3)","As btrfs is not supported on RHEL8, there's almost no reason to backport it. Let's close it for now.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,305,2019-02-21T16:14:08Z,2019-05-03T10:54:31Z,2019-05-03T10:54:31Z,CLOSED,False,148,79,22,https://github.com/mrc0mmand,test: add test for setting service manager environment variables,2,"['rhel8', 'needs-review', 'dont-merge', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/305,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/305,"worked on that.

(cherry picked from commit 79411bbcce7057754942af30939428d38f4369ac)","worked on that.

(cherry picked from commit 79411bbcce7057754942af30939428d38f4369ac)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,305,2019-02-21T16:14:08Z,2019-05-03T10:54:31Z,2019-05-03T10:54:31Z,CLOSED,False,148,79,22,https://github.com/mrc0mmand,test: add test for setting service manager environment variables,2,"['rhel8', 'needs-review', 'dont-merge', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/305,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/305#issuecomment-466119373,"worked on that.

(cherry picked from commit 79411bbcce7057754942af30939428d38f4369ac)",I guess this needs patches from systemd/systemd#10594 to be backported as well.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,307,2019-02-21T20:54:06Z,2019-05-03T11:00:44Z,2019-05-03T11:00:44Z,MERGED,True,475,134,15,https://github.com/mrc0mmand,(#1683334) Backport Type=exec service type,7,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/307,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/307,"My attempt in backporting the Type=exec service type, introduced by systemd/systemd#9620. The matching test case TEST-23-TYPE-EXEC is backported as well.
Fixes #306.","My attempt in backporting the Type=exec service type, introduced by systemd/systemd#9620. The matching test case TEST-23-TYPE-EXEC is backported as well.
Fixes #306.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,307,2019-02-21T20:54:06Z,2019-05-03T11:00:44Z,2019-05-03T11:00:44Z,MERGED,True,475,134,15,https://github.com/mrc0mmand,(#1683334) Backport Type=exec service type,7,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/307,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/307#issuecomment-489052398,"My attempt in backporting the Type=exec service type, introduced by systemd/systemd#9620. The matching test case TEST-23-TYPE-EXEC is backported as well.
Fixes #306.","Pushed a new version with correct Resolves: lines, PTAL!",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,307,2019-02-21T20:54:06Z,2019-05-03T11:00:44Z,2019-05-03T11:00:44Z,MERGED,True,475,134,15,https://github.com/mrc0mmand,(#1683334) Backport Type=exec service type,7,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/307,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/307#issuecomment-489057509,"My attempt in backporting the Type=exec service type, introduced by systemd/systemd#9620. The matching test case TEST-23-TYPE-EXEC is backported as well.
Fixes #306.",@mrc0mmand Thank you!,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,308,2019-02-22T11:27:18Z,2019-02-26T16:17:34Z,2019-04-04T09:25:20Z,MERGED,True,46,15,17,https://github.com/mrc0mmand,Fix & enable LGTM on RHEL7,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/308,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/308,"Let's attempt to fix outstanding issues which prevent the LGTM C analysis to be enabled for RHEL 7 (and then for RHEL 8 as well) branch.
Related LGTM issue: https://discuss.lgtm.com/t/missing-c-analysis-in-downstream-systemd-project/1769
The first one is following compilation error in LGTM infra:
[2019-01-18 21:46:47] [build]   CC       src/shared/libsystemd_shared_la-errno-list.lo
[2019-01-18 21:46:49] [build] In file included from src/shared/errno-list.c:32:0:
[2019-01-18 21:46:49] [build] src/shared/errno-from-name.h:143:1: error: conflicting types for ‘lookup_errno’
[2019-01-18 21:46:49] [build]  lookup_errno (register const char *str, register size_t len)
[2019-01-18 21:46:49] [build]  ^~~~~~~~~~~~
[2019-01-18 21:46:49] [build] src/shared/errno-list.c:28:33: note: previous declaration of ‘lookup_errno’ was here
[2019-01-18 21:46:49] [build]  static const struct errno_name* lookup_errno(register const char *str,
[2019-01-18 21:46:49] [build]                                  ^~~~~~~~~~~~
[2019-01-18 21:46:49] [build] Makefile:16172: recipe for target 'src/shared/libsystemd_shared_la-errno-list.lo' failed
[2019-01-18 21:46:49] [build] make[2]: *** [src/shared/libsystemd_shared_la-errno-list.lo] Error 1
[2019-01-18 21:46:49] [build] make[1]: *** [all-recursive] Error 1
[2019-01-18 21:46:49] [build] Makefile:19109: recipe for target 'all-recursive' failed

This should be fixed by systemd/systemd#5055.","Let's attempt to fix outstanding issues which prevent the LGTM C analysis to be enabled for RHEL 7 (and then for RHEL 8 as well) branch.
Related LGTM issue: https://discuss.lgtm.com/t/missing-c-analysis-in-downstream-systemd-project/1769
The first one is following compilation error in LGTM infra:
[2019-01-18 21:46:47] [build]   CC       src/shared/libsystemd_shared_la-errno-list.lo
[2019-01-18 21:46:49] [build] In file included from src/shared/errno-list.c:32:0:
[2019-01-18 21:46:49] [build] src/shared/errno-from-name.h:143:1: error: conflicting types for ‘lookup_errno’
[2019-01-18 21:46:49] [build]  lookup_errno (register const char *str, register size_t len)
[2019-01-18 21:46:49] [build]  ^~~~~~~~~~~~
[2019-01-18 21:46:49] [build] src/shared/errno-list.c:28:33: note: previous declaration of ‘lookup_errno’ was here
[2019-01-18 21:46:49] [build]  static const struct errno_name* lookup_errno(register const char *str,
[2019-01-18 21:46:49] [build]                                  ^~~~~~~~~~~~
[2019-01-18 21:46:49] [build] Makefile:16172: recipe for target 'src/shared/libsystemd_shared_la-errno-list.lo' failed
[2019-01-18 21:46:49] [build] make[2]: *** [src/shared/libsystemd_shared_la-errno-list.lo] Error 1
[2019-01-18 21:46:49] [build] make[1]: *** [all-recursive] Error 1
[2019-01-18 21:46:49] [build] Makefile:19109: recipe for target 'all-recursive' failed

This should be fixed by systemd/systemd#5055.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,308,2019-02-22T11:27:18Z,2019-02-26T16:17:34Z,2019-04-04T09:25:20Z,MERGED,True,46,15,17,https://github.com/mrc0mmand,Fix & enable LGTM on RHEL7,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/308,https://github.com/sj,2,https://github.com/lnykryn/systemd-rhel/pull/308#issuecomment-467466271,"Let's attempt to fix outstanding issues which prevent the LGTM C analysis to be enabled for RHEL 7 (and then for RHEL 8 as well) branch.
Related LGTM issue: https://discuss.lgtm.com/t/missing-c-analysis-in-downstream-systemd-project/1769
The first one is following compilation error in LGTM infra:
[2019-01-18 21:46:47] [build]   CC       src/shared/libsystemd_shared_la-errno-list.lo
[2019-01-18 21:46:49] [build] In file included from src/shared/errno-list.c:32:0:
[2019-01-18 21:46:49] [build] src/shared/errno-from-name.h:143:1: error: conflicting types for ‘lookup_errno’
[2019-01-18 21:46:49] [build]  lookup_errno (register const char *str, register size_t len)
[2019-01-18 21:46:49] [build]  ^~~~~~~~~~~~
[2019-01-18 21:46:49] [build] src/shared/errno-list.c:28:33: note: previous declaration of ‘lookup_errno’ was here
[2019-01-18 21:46:49] [build]  static const struct errno_name* lookup_errno(register const char *str,
[2019-01-18 21:46:49] [build]                                  ^~~~~~~~~~~~
[2019-01-18 21:46:49] [build] Makefile:16172: recipe for target 'src/shared/libsystemd_shared_la-errno-list.lo' failed
[2019-01-18 21:46:49] [build] make[2]: *** [src/shared/libsystemd_shared_la-errno-list.lo] Error 1
[2019-01-18 21:46:49] [build] make[1]: *** [all-recursive] Error 1
[2019-01-18 21:46:49] [build] Makefile:19109: recipe for target 'all-recursive' failed

This should be fixed by systemd/systemd#5055.","Hir @mrc0mmand. After our discussion on the LGTM forum (https://discuss.lgtm.com/t/missing-c-analysis-in-downstream-systemd-project/1769/11), I ran some off-line tests and got the build to work with the following .lgtm.yml configuration:
extraction:
  cpp:
    configure:
      command:
        - ./autogen.sh
        - ./configure --disable-timesyncd --disable-kdbus --disable-terminal --disable-gtk-doc --disable-manpages --disable-gtk-doc-html --enable-compat-libs --disable-sysusers --disable-ldconfig --enable-lz4 --disable-microhttpd

The last option --disable-microhttpd is the most important one: it stops LGTM from automatically detecting and installing libmicrohttpd-dev as a build dependency. If that dependency is installed, the build hits a Makefile directive that causes problems:
make[2]: *** No rule to make target 'src/journal-remote/browse.html', needed by 'all-am'.  Stop.

While I'm not entirely sure what exactly causes that problem (the file src/journal-remote/browse.html definitely exists), forcefully disabling microhttpd support resolves the issue. I haven't had much time to do experiments with other (or fewer) options to ./configure. I suggest you apply the .lgtm.yml I pasted above, then merge the LGTM configuration in this PR, after which I can enable C/C++ analysis for this repository.
Once C/C++ analysis for this repository is up and running, I suggest you enable automated code review for GitHub pull requests from here: https://lgtm.com/projects/g/lnykryn/systemd-rhel/ci/. You can then experiment with different parameters to ./configure in a new pull request to this repository, and the LGTM status on that PR will then immediately tell you if a particular set of build options causes issues.
Hope this makes sense; let me know (here or on the LGTM forum) if you need further help!",True,{'HOORAY': ['https://github.com/mrc0mmand']}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,309,2019-02-23T16:12:28Z,2019-05-03T11:00:30Z,2019-05-03T11:00:31Z,MERGED,True,462,150,15,https://github.com/mrc0mmand,(#1683319) travis: enable ASan and UBSan on RHEL8,13,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/309,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/309,"Let's enable Address Sanitizer and Undefined Behavior Sanitizer for RHEL 8. This should be much easier than the RHEL 7 effort, as the necessary patches to make it work should be relatively fresh.
Also, I'll try to hunt down all fixes which have been already introduced in upstream to weed out all known issues.
One side note (mainly for @msekletar) - I finally found out why neither ~/.bash_profile nor ~/.bashrc was working in Docker. I'll just copy-paste my note from the source:
# Note to my future frustrated self: docker exec runs the given command
# as sh -c 'command' - which means both .bash_profile and .bashrc will
# be ignored. That's because .bash_profile is sourced for LOGIN shells (i.e.
# sh -l), whereas .bashrc is sourced for NON-LOGIN INTERACTIVE shells
# (i.e. sh -i).
# As the default docker exec command lacks either of those options,
# we need to use a wrapper command which runs the wanted command
# under an explicit bash -i, so the SCL source above works properly.","Let's enable Address Sanitizer and Undefined Behavior Sanitizer for RHEL 8. This should be much easier than the RHEL 7 effort, as the necessary patches to make it work should be relatively fresh.
Also, I'll try to hunt down all fixes which have been already introduced in upstream to weed out all known issues.
One side note (mainly for @msekletar) - I finally found out why neither ~/.bash_profile nor ~/.bashrc was working in Docker. I'll just copy-paste my note from the source:
# Note to my future frustrated self: docker exec runs the given command
# as sh -c 'command' - which means both .bash_profile and .bashrc will
# be ignored. That's because .bash_profile is sourced for LOGIN shells (i.e.
# sh -l), whereas .bashrc is sourced for NON-LOGIN INTERACTIVE shells
# (i.e. sh -i).
# As the default docker exec command lacks either of those options,
# we need to use a wrapper command which runs the wanted command
# under an explicit bash -i, so the SCL source above works properly.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,309,2019-02-23T16:12:28Z,2019-05-03T11:00:30Z,2019-05-03T11:00:31Z,MERGED,True,462,150,15,https://github.com/mrc0mmand,(#1683319) travis: enable ASan and UBSan on RHEL8,13,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/309,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/309#issuecomment-466705765,"Let's enable Address Sanitizer and Undefined Behavior Sanitizer for RHEL 8. This should be much easier than the RHEL 7 effort, as the necessary patches to make it work should be relatively fresh.
Also, I'll try to hunt down all fixes which have been already introduced in upstream to weed out all known issues.
One side note (mainly for @msekletar) - I finally found out why neither ~/.bash_profile nor ~/.bashrc was working in Docker. I'll just copy-paste my note from the source:
# Note to my future frustrated self: docker exec runs the given command
# as sh -c 'command' - which means both .bash_profile and .bashrc will
# be ignored. That's because .bash_profile is sourced for LOGIN shells (i.e.
# sh -l), whereas .bashrc is sourced for NON-LOGIN INTERACTIVE shells
# (i.e. sh -i).
# As the default docker exec command lacks either of those options,
# we need to use a wrapper command which runs the wanted command
# under an explicit bash -i, so the SCL source above works properly.","Aaaand it works! Adding the ""needs-extensive-review"" label as this is not a test-only change, and I'm not sure if I didn't break something.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,310,2019-02-26T14:24:40Z,2019-02-26T14:40:18Z,2019-02-26T14:41:57Z,MERGED,True,1,0,1,https://github.com/lnykryn,(#1670126) rules: add the rule that adds elevator= kernel command line parameter,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/310,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/310,"rhel-only
Resolves: #1670126","rhel-only
Resolves: #1670126",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/311,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-467904962,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 13 alerts when merging 4df22c7 into a781c22 - view on LGTM.com
fixed alerts:

6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-467963532,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 15 alerts when merging 73386a7 into a781c22 - view on LGTM.com
fixed alerts:

6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
2 for Comparison result is always the same


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,4,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-467987982,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 23 alerts when merging 368d4f4 into a781c22 - view on LGTM.com
fixed alerts:

7 for Comparison result is always the same
6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
3 for Implicit downcast from bitfield


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,5,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-468003095,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request introduces 1 alert and fixes 25 when merging 300a5dd into a781c22 - view on LGTM.com
new alerts:

1 for Comparison result is always the same

fixed alerts:

8 for Comparison result is always the same
6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
3 for Implicit downcast from bitfield
1 for Ambiguously signed bit-field member


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,6,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-468228203,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 26 alerts when merging 5a5a676 into a781c22 - view on LGTM.com
fixed alerts:

9 for Comparison result is always the same
6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
3 for Implicit downcast from bitfield
1 for Ambiguously signed bit-field member


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,7,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-468245476,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 28 alerts when merging ba2518d into a781c22 - view on LGTM.com
fixed alerts:

11 for Comparison result is always the same
6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
3 for Implicit downcast from bitfield
1 for Ambiguously signed bit-field member


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,8,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-468299279,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 35 alerts when merging 70c9246 into a781c22 - view on LGTM.com
fixed alerts:

11 for Comparison result is always the same
6 for Missing variable declaration
6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
3 for Implicit downcast from bitfield
1 for Unneeded defensive code
1 for Ambiguously signed bit-field member


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,9,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-468304559,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","Even though this PR doesn't fix all identified warnings, I'd review and merge it in its current state, as stuff's getting too hard to follow.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/jsynacek,10,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-477474346,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","IMHO all the commits need to include ""Resolves:"" or ""Related:"", otherwise it won't be possible to merge them downstream.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,11,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-478494829,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","@jsynacek thanks for pointing it out, it completely slipped my mind. Should be fixed now.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,12,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-478510291,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 35 alerts when merging 3302ab3 into 2511291 - view on LGTM.com
fixed alerts:

11 for Comparison result is always the same
6 for Missing variable declaration
6 for Assignment where comparison was intended
4 for Potentially overflowing call to snprintf
3 for Use of potentially dangerous function
3 for Implicit downcast from bitfield
1 for Unneeded defensive code
1 for Ambiguously signed bit-field member


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,13,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479808590,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 7 alerts when merging 72b47a1 into ac46d01 - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,14,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479817397,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 7 alerts when merging 72b47a1 into ac46d01 - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,15,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479818375,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","Ugh, the LGTM analysis now keeps failing due to compilation error:
[2019-04-04 08:45:00] [build] make --no-print-directory all-recursive
[2019-04-04 08:45:00] [build] Making all in .
[2019-04-04 08:45:00] [build]   CC       src/cgls/cgls.o
[2019-04-04 08:45:01] [build] In file included from ./src/shared/util.h:92,
[2019-04-04 08:45:01] [build]                  from ./src/shared/cgroup-show.h:26,
[2019-04-04 08:45:01] [build]                  from src/cgls/cgls.c:29:
[2019-04-04 08:45:01] [build] ./src/shared/missing.h:989:19: error: static declaration of ‘renameat2’ follows non-static declaration
[2019-04-04 08:45:01] [build]  static inline int renameat2(int oldfd, const char *oldname, int newfd, const char *newname, unsigned flags) {
[2019-04-04 08:45:01] [build]                    ^~~~~~~~~
[2019-04-04 08:45:01] [build] In file included from src/cgls/cgls.c:23:
[2019-04-04 08:45:01] [build] /usr/x86_64-linux-gnu/include/stdio.h:164:12: note: previous declaration of ‘renameat2’ was here
[2019-04-04 08:45:01] [build]  extern int renameat2 (int __oldfd, const char *__old, int __newfd,
[2019-04-04 08:45:01] [build]             ^~~~~~~~~
[2019-04-04 08:45:02] [build] make[2]: *** [Makefile:15186: src/cgls/cgls.o] Error 1
[2019-04-04 08:45:02] [build] make[1]: *** [Makefile:19815: all-recursive] Error 1
[2019-04-04 08:45:02] [build] make: *** [Makefile:10424: all] Error 2",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,16,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479819927,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This seems to be a variation of systemd/systemd#8099 fixed by systemd/systemd@5187dd2, we may need to backport it, somehow...",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,17,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479824452,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 7 alerts when merging 38b4fbc into ac46d01 - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,18,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479847895,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","As the LGTM infrastructure got upgraded, mainly with newer glibc, I had to fix a few other issues:


dd5e0d9
This fixes issue mentioned in #311 (comment). To be somewhat consistent across the missing.h file I added the same workaround for other syscalls as well, not only the renameat2, which was causing issues


3fec580
Newer glibc stops including sys/sysmacros.h from the sys/types.h, which causes compilation issues in code using major() and minor() functions, e.g.:


[2019-04-04 09:32:27] [build] /usr/bin/ld: ./.libs/libsystemd-shared.a(libsystemd_shared_la-util.o): in function `get_ctty_devnr':
[2019-04-04 09:32:27] [build] util.c:(.text.get_ctty_devnr+0x8f): undefined reference to `major'
[2019-04-04 09:32:27] [build] /usr/bin/ld: util.c:(.text.get_ctty_devnr+0x12e): undefined reference to `minor'
[2019-04-04 09:32:27] [build] collect2: error: ld returned 1 exit status

Let's add it explicitly to files which need it.
With these two additional commits the LGTM analysis should work once again.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,19,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479854956,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 7 alerts when merging 3fec580 into ac46d01 - view on LGTM.com
fixed alerts:

6 for Missing variable declaration
1 for Unneeded defensive code


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,20,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-479855377,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","The current LGTM fail is caused by the last two commits not being present in the staging branch, should be fixed once this PR is merged.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/lnykryn,21,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-489066927,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.","This pull request fixes 38 alerts when merging d75397f into dd004bc - view on LGTM.com
fixed alerts:

11 for Comparison result is always the same
6 for Missing variable declaration
6 for Assignment where comparison was intended
6 for Use of potentially dangerous function
4 for Potentially overflowing call to snprintf
3 for Implicit downcast from bitfield
1 for Unneeded defensive code
1 for Ambiguously signed bit-field member


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,311,2019-02-27T14:29:27Z,2019-05-03T20:52:27Z,2019-05-03T20:52:27Z,CLOSED,False,62,57,20,https://github.com/mrc0mmand,(#1694605) Backport/fixes for issues found by LGTM on RHEL 7,21,"['rhel7', 'needs-bz', 'postponed']",https://github.com/lnykryn/systemd-rhel/pull/311,https://github.com/mrc0mmand,22,https://github.com/lnykryn/systemd-rhel/pull/311#issuecomment-489236120,"This PR attempts to fix errors & warnings found by LGTM. Recommendations are currently ignored, as it would make this PR unnecessarily big.
Note: some of these patches are not even in upstream (mostly because the particular code was completely rewritten in upstream).
Unresolved errors/warnings:

[error] src/shared/pager.c [link] - pager-related stuff has been significantly refactored in upstream, needs further investigation
[ignored] src/libsystemd/sd-bus/bus-bloom.h [link] - dropped from upstream along with kdbus
src/shared/strv.c [link] - strv_join_quoted was dropped from upstream (replaced by a different approach) without resolving this issue; would require some, possibly substantial, refactoring
[ignored] src/bootchart/* [link] - dropped from upstream (systemd/systemd@232c84b)
src/core/execute.c [link] - process_execute has been refactored to support longer process names (systemd/systemd@9bfaffd), not sure if it's worth backporting
[ignored] src/gudev/* - dropped from upstream (systemd/systemd@2375607)
src/shared/fw-util.c [link] - renamed to src/shared/firewall-util.c, however, not yet fixed in upstream

The [ignored] rules should hopefully take effect once this PR is merged.",Closed in favor of redhat-plumbers/systemd-rhel7#2,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,312,2019-03-04T09:29:17Z,2019-03-04T09:44:57Z,2019-03-04T09:45:00Z,MERGED,True,1,135,2,https://github.com/mrc0mmand,Travis cleanup (RHEL 7),2,"['rhel7', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/312,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/312,Drop the RHEL 8 manager from RHEL 7 branch (as it doesn't make sense to keep it there) and support SMP if available to speedup the compilation.,Drop the RHEL 8 manager from RHEL 7 branch (as it doesn't make sense to keep it there) and support SMP if available to speedup the compilation.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,313,2019-03-04T13:24:03Z,2019-05-03T10:50:32Z,2019-05-03T10:51:59Z,MERGED,True,455,193,89,https://github.com/mrc0mmand,(#1696224) Backport fuzzers,38,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/313,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/313,"This PR tries to backport all changes up to the introduction of the bus fuzzer, as in the current state the bus fuzzer wasn't executed even though it was present in the repository. Backporting the rest of the fuzzer infrastructure should finally provide test coverage for BZ#1635439, BZ#1635428, and BZ#1635435.
I'll leave a backport of remaining fuzzers to another PR to keep this one somewhat reviewable.
Notes:

220a60a ""dropped"" in favor of systemd/systemd@cf81c68
dropped dhcp6-client fuzzer introduced by systemd/systemd#10200","This PR tries to backport all changes up to the introduction of the bus fuzzer, as in the current state the bus fuzzer wasn't executed even though it was present in the repository. Backporting the rest of the fuzzer infrastructure should finally provide test coverage for BZ#1635439, BZ#1635428, and BZ#1635435.
I'll leave a backport of remaining fuzzers to another PR to keep this one somewhat reviewable.
Notes:

220a60a ""dropped"" in favor of systemd/systemd@cf81c68
dropped dhcp6-client fuzzer introduced by systemd/systemd#10200",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,314,2019-03-05T12:26:46Z,2019-05-02T15:30:29Z,2019-05-02T15:30:29Z,MERGED,True,85,14,17,https://github.com/jsynacek,(#1609349) segmentation violation in 'mempool_alloc0_tile' (libsystemd.so.0) due to mempool freelist corruption,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/314,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/314,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,315,2019-03-10T12:06:44Z,2019-03-10T12:30:52Z,2019-03-10T12:30:56Z,MERGED,True,87,8,2,https://github.com/mrc0mmand,`test/test-functions` backports,6,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/315,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/315,"Several backports for test/test-functions. The main reason is the introduction of NSPAWN_ARGUMENTS, which is necessary for CI parallelization (see systemd/systemd-centos-ci#78).","Several backports for test/test-functions. The main reason is the introduction of NSPAWN_ARGUMENTS, which is necessary for CI parallelization (see systemd/systemd-centos-ci#78).",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,316,2019-03-13T19:17:42Z,2019-03-13T19:55:35Z,2019-03-13T19:55:38Z,MERGED,True,7,2,1,https://github.com/mrc0mmand,test: don't overwrite TESTDIR if already set,1,"['rhel8', 'needs-review', 'test-only']",https://github.com/lnykryn/systemd-rhel/pull/316,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/316,"(cherry picked from commit 3f50fff)
This fixes artifact collection after recent parallelization changes in CentOS CI, see systemd/systemd#11981.","(cherry picked from commit 3f50fff)
This fixes artifact collection after recent parallelization changes in CentOS CI, see systemd/systemd#11981.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,317,2019-03-20T14:38:34Z,2019-05-03T10:30:22Z,2019-05-03T10:30:22Z,MERGED,True,2557,72,14,https://github.com/jsynacek,(#1689832) systemd-analyze security backports,15,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/317,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/317,"The security verb required a lot of the new code that handles the output table, so I've decided to backport all of the available format-table patches but one (the JSON output isn't there, because it required me to enable the internal JSON parser, which in turn was a lot more code...). And, of course, the smiley output needed backporting as well.
Resolves: #1689832","The security verb required a lot of the new code that handles the output table, so I've decided to backport all of the available format-table patches but one (the JSON output isn't there, because it required me to enable the internal JSON parser, which in turn was a lot more code...). And, of course, the smiley output needed backporting as well.
Resolves: #1689832",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,318,2019-03-21T19:21:50Z,2019-04-02T09:10:28Z,2019-04-02T09:10:28Z,MERGED,True,1,1,1,https://github.com/kyle-walker,(#1691511) Backport core: Fix edge case when processing /proc/self/mountinfo,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/318,https://github.com/kyle-walker,1,https://github.com/lnykryn/systemd-rhel/pull/318,"Currently, if there are two /proc/self/mountinfo entries with the same
mount point path, the mount setup flags computed for the second of
these two entries will overwrite the mount setup flags computed for
the first of these two entries. This is the root cause of issue #7798.
This patch changes mount_setup_existing_unit to prevent the
just_mounted mount setup flag from being overwritten if it is set to
true. This will allow all mount units created from /proc/self/mountinfo
entries to be initialized properly.
(cherry picked from commit 65d36b4)
Changed the downstream implementation as upstream has refactored quite a bit.
Resolves: #1691511","Currently, if there are two /proc/self/mountinfo entries with the same
mount point path, the mount setup flags computed for the second of
these two entries will overwrite the mount setup flags computed for
the first of these two entries. This is the root cause of issue #7798.
This patch changes mount_setup_existing_unit to prevent the
just_mounted mount setup flag from being overwritten if it is set to
true. This will allow all mount units created from /proc/self/mountinfo
entries to be initialized properly.
(cherry picked from commit 65d36b4)
Changed the downstream implementation as upstream has refactored quite a bit.
Resolves: #1691511",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,319,2019-03-27T08:42:28Z,2019-03-27T10:30:18Z,2019-03-27T10:30:18Z,MERGED,True,1,4,1,https://github.com/jsynacek,(#1692991) bus-socket: Fix line_begins() to accept word matching full string,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/319,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/319,"The switch to memory_startswith() changed the logic to only look for a space or
NUL byte after the matched word, but matching the full size should also be
acceptable.
This changed the behavior of parsing of ""AUTH\r\n"", where m will be set to 4,
since even though the word will match, the check for it being followed by ' '
or NUL will make line_begins() return false.
Tested:


Using netcat to connect to the private socket directly:
$ echo -ne '\0AUTH\r\n' | sudo nc -U /run/systemd/private
REJECTED EXTERNAL ANONYMOUS


Running the Ignition blackbox test:
$ sudo sh -c 'PATH=$PWD/bin/amd64:$PATH ./tests.test'
PASS


Fixes: d27b725
(cherry picked from commit 3f10c66)
Resolves: #1692991","The switch to memory_startswith() changed the logic to only look for a space or
NUL byte after the matched word, but matching the full size should also be
acceptable.
This changed the behavior of parsing of ""AUTH\r\n"", where m will be set to 4,
since even though the word will match, the check for it being followed by ' '
or NUL will make line_begins() return false.
Tested:


Using netcat to connect to the private socket directly:
$ echo -ne '\0AUTH\r\n' | sudo nc -U /run/systemd/private
REJECTED EXTERNAL ANONYMOUS


Running the Ignition blackbox test:
$ sudo sh -c 'PATH=$PWD/bin/amd64:$PATH ./tests.test'
PASS


Fixes: d27b725
(cherry picked from commit 3f10c66)
Resolves: #1692991",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,321,2019-03-28T14:26:12Z,2019-03-28T14:50:18Z,2019-03-28T15:18:17Z,MERGED,True,2,2,1,https://github.com/lnykryn,(#1693716) shutdown: in_container was used before its definition,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/321,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/321,"RHEL-only
Resolves: #1693716","RHEL-only
Resolves: #1693716",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,322,2019-04-02T09:02:13Z,2019-04-02T10:30:23Z,2019-04-02T10:30:23Z,MERGED,True,50,1,2,https://github.com/jsynacek,(#1693559) sd-bus: deal with cookie overruns,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/322,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/322,"Apparently this happens IRL. Let's carefully deal with issues like this:
when we overrun, let's not go back to zero but instead leave the highest
cookie bit set. We use that as indication that we are in ""overrun
territory"", and then are particularly careful with checking cookies,
i.e. that they haven't been used for still outstanding replies yet. This
should retain the quick cookie generation behaviour we used to have, but
permits dealing with overruns.
Replaces: #11804
Fixes: #11809
(cherry picked from commit 1f82f5b)
Resolves: #1693559","Apparently this happens IRL. Let's carefully deal with issues like this:
when we overrun, let's not go back to zero but instead leave the highest
cookie bit set. We use that as indication that we are in ""overrun
territory"", and then are particularly careful with checking cookies,
i.e. that they haven't been used for still outstanding replies yet. This
should retain the quick cookie generation behaviour we used to have, but
permits dealing with overruns.
Replaces: #11804
Fixes: #11809
(cherry picked from commit 1f82f5b)
Resolves: #1693559",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,323,2019-04-03T12:13:34Z,2019-05-02T14:50:33Z,2019-05-02T14:50:33Z,MERGED,True,6,0,2,https://github.com/jsynacek,(#1695601) logs-show: use grey color for de-emphasizing journal log output,1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/323,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/323,"(cherry picked from commit 67df9b7)
Resolves: #1695601","(cherry picked from commit 67df9b7)
Resolves: #1695601",True,{'THUMBS_UP': ['https://github.com/mrc0mmand']}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,324,2019-04-04T10:15:22Z,2019-05-02T15:25:03Z,2019-05-02T15:52:06Z,MERGED,True,189,160,7,https://github.com/lnykryn,(#1691691) Bz1691691,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/324,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/324,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,324,2019-04-04T10:15:22Z,2019-05-02T15:25:03Z,2019-05-02T15:52:06Z,MERGED,True,189,160,7,https://github.com/lnykryn,(#1691691) Bz1691691,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/324,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/324#issuecomment-481182533,,The nspawn fail in CentOS CI is fixed in #326,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,326,2019-04-04T13:28:50Z,2019-05-02T08:50:23Z,2019-05-02T08:50:23Z,MERGED,True,197,226,19,https://github.com/mrc0mmand,(#1697893) Fix nspawn scope (de)allocation,5,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/326,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/326,"Fixes #325.
Will give it a few CI runs to make sure it indeed fixes the mentioned issue. If so, I'll open a BZ and add necessary *Resolves: #XXX"" references to commits.","Fixes #325.
Will give it a few CI runs to make sure it indeed fixes the mentioned issue. If so, I'll open a BZ and add necessary *Resolves: #XXX"" references to commits.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,327,2019-04-08T11:19:10Z,2019-04-08T11:30:20Z,2019-04-08T11:30:20Z,MERGED,True,65,18,4,https://github.com/msekletar,(#1678641) systemd: Insufficient input validation in bus_process_object() resulting in PID 1 crash,3,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/327,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/327,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,328,2019-04-18T11:56:25Z,2019-04-18T12:20:19Z,2019-04-23T09:12:10Z,MERGED,True,1,2,1,https://github.com/mrc0mmand,"(#1701217) meson: drop misplaced -Wl,--undefined argument",1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/328,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/328,"Ld's man page says the following:
-u symbol
--undefined=symbol
Force symbol to be entered in the output file as an undefined symbol. Doing
this may, for example, trigger linking of additional modules from standard
libraries. -u may be repeated with different option arguments to enter
additional undefined symbols. This option is equivalent to the ""EXTERN""
linker script command.
If this option is being used to force additional modules to be pulled into
the link, and if it is an error for the symbol to remain undefined, then the
option --require-defined should be used instead.
This would imply that it always requires an argument, which this does not
pass. Thus it will grab the next argument on the command line as its
argument. Before it took one of the many -lrt args (presumably) and now it
grabs something other random linker argument and things break.
[zj: this line was added in the first version of the meson configuration back
in 5c23128. AFAICT, this was a mistake. No
such flag appeared in Makefile.am at the time.]
mesonbuild/meson#5113
(cherry picked from commit 700805f6c546f2adb79059614f3747f7b5474325)","Ld's man page says the following:
-u symbol
--undefined=symbol
Force symbol to be entered in the output file as an undefined symbol. Doing
this may, for example, trigger linking of additional modules from standard
libraries. -u may be repeated with different option arguments to enter
additional undefined symbols. This option is equivalent to the ""EXTERN""
linker script command.
If this option is being used to force additional modules to be pulled into
the link, and if it is an error for the symbol to remain undefined, then the
option --require-defined should be used instead.
This would imply that it always requires an argument, which this does not
pass. Thus it will grab the next argument on the command line as its
argument. Before it took one of the many -lrt args (presumably) and now it
grabs something other random linker argument and things break.
[zj: this line was added in the first version of the meson configuration back
in 5c23128. AFAICT, this was a mistake. No
such flag appeared in Makefile.am at the time.]
mesonbuild/meson#5113
(cherry picked from commit 700805f6c546f2adb79059614f3747f7b5474325)",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,328,2019-04-18T11:56:25Z,2019-04-18T12:20:19Z,2019-04-23T09:12:10Z,MERGED,True,1,2,1,https://github.com/mrc0mmand,"(#1701217) meson: drop misplaced -Wl,--undefined argument",1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/328,https://github.com/jsynacek,2,https://github.com/lnykryn/systemd-rhel/pull/328#issuecomment-485661583,"Ld's man page says the following:
-u symbol
--undefined=symbol
Force symbol to be entered in the output file as an undefined symbol. Doing
this may, for example, trigger linking of additional modules from standard
libraries. -u may be repeated with different option arguments to enter
additional undefined symbols. This option is equivalent to the ""EXTERN""
linker script command.
If this option is being used to force additional modules to be pulled into
the link, and if it is an error for the symbol to remain undefined, then the
option --require-defined should be used instead.
This would imply that it always requires an argument, which this does not
pass. Thus it will grab the next argument on the command line as its
argument. Before it took one of the many -lrt args (presumably) and now it
grabs something other random linker argument and things break.
[zj: this line was added in the first version of the meson configuration back
in 5c23128. AFAICT, this was a mistake. No
such flag appeared in Makefile.am at the time.]
mesonbuild/meson#5113
(cherry picked from commit 700805f6c546f2adb79059614f3747f7b5474325)","The commit message lacks the ""Resolves: ..."" line. @lnykryn Are you sure that this is going to work later on?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,328,2019-04-18T11:56:25Z,2019-04-18T12:20:19Z,2019-04-23T09:12:10Z,MERGED,True,1,2,1,https://github.com/mrc0mmand,"(#1701217) meson: drop misplaced -Wl,--undefined argument",1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/328,https://github.com/lnykryn,3,https://github.com/lnykryn/systemd-rhel/pull/328#issuecomment-485718842,"Ld's man page says the following:
-u symbol
--undefined=symbol
Force symbol to be entered in the output file as an undefined symbol. Doing
this may, for example, trigger linking of additional modules from standard
libraries. -u may be repeated with different option arguments to enter
additional undefined symbols. This option is equivalent to the ""EXTERN""
linker script command.
If this option is being used to force additional modules to be pulled into
the link, and if it is an error for the symbol to remain undefined, then the
option --require-defined should be used instead.
This would imply that it always requires an argument, which this does not
pass. Thus it will grab the next argument on the command line as its
argument. Before it took one of the many -lrt args (presumably) and now it
grabs something other random linker argument and things break.
[zj: this line was added in the first version of the meson configuration back
in 5c23128. AFAICT, this was a mistake. No
such flag appeared in Makefile.am at the time.]
mesonbuild/meson#5113
(cherry picked from commit 700805f6c546f2adb79059614f3747f7b5474325)","Hmm, thanks for spotting that, I should probably tweak my scripts to detect this. But it is not a big issue from my point of view, since it only means it won't be mentioned in the commit message to dist-git. But yeah it makes things more complicated when we want to find out why the patch was introduced.",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,329,2019-04-29T10:20:02Z,2019-04-29T10:30:22Z,2019-04-29T10:30:22Z,MERGED,True,57,16,4,https://github.com/lnykryn,(#1667871) Bz1667871,3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/329,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/329,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,330,2019-04-30T08:25:50Z,2019-04-30T08:50:21Z,2019-04-30T08:57:21Z,MERGED,True,1,10,1,https://github.com/lnykryn,"Revert ""core: one step back again, for nspawn we actually can't wait …",1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/330,https://github.com/lnykryn,1,https://github.com/lnykryn/systemd-rhel/pull/330,"…for cgroups running empty since systemd will get exactly zero notifications about it""
This reverts commit 743970d.
RHEL-only
https://bugzilla.redhat.com/show_bug.cgi?id=1141137
systemd/systemd#350
Resolves: #1703485","…for cgroups running empty since systemd will get exactly zero notifications about it""
This reverts commit 743970d.
RHEL-only
https://bugzilla.redhat.com/show_bug.cgi?id=1141137
systemd/systemd#350
Resolves: #1703485",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,330,2019-04-30T08:25:50Z,2019-04-30T08:50:21Z,2019-04-30T08:57:21Z,MERGED,True,1,10,1,https://github.com/lnykryn,"Revert ""core: one step back again, for nspawn we actually can't wait …",1,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/330,https://github.com/lnykryn,2,https://github.com/lnykryn/systemd-rhel/pull/330#issuecomment-487870196,"…for cgroups running empty since systemd will get exactly zero notifications about it""
This reverts commit 743970d.
RHEL-only
https://bugzilla.redhat.com/show_bug.cgi?id=1141137
systemd/systemd#350
Resolves: #1703485","This pull request fixes 1 alert when merging 932471b into 0ed1150 - view on LGTM.com
fixed alerts:

1 for FIXME comment


Comment posted by LGTM.com",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,331,2019-05-01T17:09:22Z,2019-05-02T08:40:20Z,2019-05-02T08:54:24Z,MERGED,True,28,5,1,https://github.com/msekletar,(#1697909) Fix hangs in spawn_wait(),3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/331,https://github.com/msekletar,1,https://github.com/lnykryn/systemd-rhel/pull/331,,,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,331,2019-05-01T17:09:22Z,2019-05-02T08:40:20Z,2019-05-02T08:54:24Z,MERGED,True,28,5,1,https://github.com/msekletar,(#1697909) Fix hangs in spawn_wait(),3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/331,https://github.com/msekletar,2,https://github.com/lnykryn/systemd-rhel/pull/331#issuecomment-488347969,,LGTM failure is unrelated.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,331,2019-05-01T17:09:22Z,2019-05-02T08:40:20Z,2019-05-02T08:54:24Z,MERGED,True,28,5,1,https://github.com/msekletar,(#1697909) Fix hangs in spawn_wait(),3,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/331,https://github.com/msekletar,3,https://github.com/lnykryn/systemd-rhel/pull/331#issuecomment-488350145,,@dtardon @jsynacek PTAL as soon as possible.,True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,332,2019-05-02T09:56:00Z,2019-05-02T11:20:33Z,2019-05-02T11:28:51Z,MERGED,True,34,10,5,https://github.com/mrc0mmand,(#1694605) Fix LGTM compilation for RHEL 7 systemd,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/332,https://github.com/mrc0mmand,1,https://github.com/lnykryn/systemd-rhel/pull/332,"This PR contains the last two commits from #311, which should fix the failing LGTM analysis on RHEL 7.
cc @msekletar","This PR contains the last two commits from #311, which should fix the failing LGTM analysis on RHEL 7.
cc @msekletar",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,332,2019-05-02T09:56:00Z,2019-05-02T11:20:33Z,2019-05-02T11:28:51Z,MERGED,True,34,10,5,https://github.com/mrc0mmand,(#1694605) Fix LGTM compilation for RHEL 7 systemd,2,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/332,https://github.com/mrc0mmand,2,https://github.com/lnykryn/systemd-rhel/pull/332#issuecomment-488628748,"This PR contains the last two commits from #311, which should fix the failing LGTM analysis on RHEL 7.
cc @msekletar","Just for a reference, the fail is expected, as the failing part is the base-branch build. The merge build is passing:",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,333,2019-05-02T11:10:59Z,2019-05-02T11:20:19Z,2019-09-21T13:56:50Z,MERGED,True,9,2,1,https://github.com/dtardon,(#1697909) avoid possible hang if our child process hangs,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/333,https://github.com/dtardon,1,https://github.com/lnykryn/systemd-rhel/pull/333,"If there is one or more unexpected child processes that terminate, but
the ""main"" child process hangs, we will loop through the terminated
children and then, eventually, get stuck in the waitpid() call. Let's
repeat the main cycle if that situation happens, as that allows us to
finish after timeout.
Related: #1697909","If there is one or more unexpected child processes that terminate, but
the ""main"" child process hangs, we will loop through the terminated
children and then, eventually, get stuck in the waitpid() call. Let's
repeat the main cycle if that situation happens, as that allows us to
finish after timeout.
Related: #1697909",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,333,2019-05-02T11:10:59Z,2019-05-02T11:20:19Z,2019-09-21T13:56:50Z,MERGED,True,9,2,1,https://github.com/dtardon,(#1697909) avoid possible hang if our child process hangs,1,"['merge-ready', 'rhel7']",https://github.com/lnykryn/systemd-rhel/pull/333,https://github.com/arjamizo,2,https://github.com/lnykryn/systemd-rhel/pull/333#issuecomment-533799944,"If there is one or more unexpected child processes that terminate, but
the ""main"" child process hangs, we will loop through the terminated
children and then, eventually, get stuck in the waitpid() call. Let's
repeat the main cycle if that situation happens, as that allows us to
finish after timeout.
Related: #1697909","Got the same problem
is there anything I can do about it without recompiling?",True,{}
lnykryn/systemd-rhel,https://github.com/lnykryn/systemd-rhel,334,2019-05-02T12:44:40Z,2019-05-02T13:30:22Z,2019-05-02T13:30:22Z,MERGED,True,24,1,3,https://github.com/jsynacek,(#1699287) journal audit resurrection,2,"['merge-ready', 'rhel8']",https://github.com/lnykryn/systemd-rhel/pull/334,https://github.com/jsynacek,1,https://github.com/lnykryn/systemd-rhel/pull/334,,,True,{}
