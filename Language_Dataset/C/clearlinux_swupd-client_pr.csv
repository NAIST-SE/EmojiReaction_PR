clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,13,2016-03-09T14:10:10Z,2016-03-17T18:39:27Z,2016-03-17T20:46:54Z,CLOSED,False,28,10,6,https://github.com/rojkov,Add compatibility with libarchive's bsdtar command,1,[],https://github.com/clearlinux/swupd-client/pull/13,https://github.com/rojkov,1,https://github.com/clearlinux/swupd-client/pull/13,"Since GNU tar fails to extract files with xattrs preserved when
Integrity Measurement Architecture (IMA) is enabled some vendors
may choose to install libarchive-based tar (bsdtar) on their embedded
devices, so the swupd server needs to be able to create archives
in its format.
This patch adds one compile-time options --enable-bsdtar that is used
to enable/disable GNU tar specific options.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
PS. I understand the team may not want to support two flavors of tar, but as users of the tool we have a use case for that and have to maintain our patches ourselves. And since our development policy requires us to submit PRs upstream for the patches we maintain I submit this PR.","Since GNU tar fails to extract files with xattrs preserved when
Integrity Measurement Architecture (IMA) is enabled some vendors
may choose to install libarchive-based tar (bsdtar) on their embedded
devices, so the swupd server needs to be able to create archives
in its format.
This patch adds one compile-time options --enable-bsdtar that is used
to enable/disable GNU tar specific options.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
PS. I understand the team may not want to support two flavors of tar, but as users of the tool we have a use case for that and have to maintain our patches ourselves. And since our development policy requires us to submit PRs upstream for the patches we maintain I submit this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,13,2016-03-09T14:10:10Z,2016-03-17T18:39:27Z,2016-03-17T20:46:54Z,CLOSED,False,28,10,6,https://github.com/rojkov,Add compatibility with libarchive's bsdtar command,1,[],https://github.com/clearlinux/swupd-client/pull/13,https://github.com/rojkov,2,https://github.com/clearlinux/swupd-client/pull/13#issuecomment-196716344,"Since GNU tar fails to extract files with xattrs preserved when
Integrity Measurement Architecture (IMA) is enabled some vendors
may choose to install libarchive-based tar (bsdtar) on their embedded
devices, so the swupd server needs to be able to create archives
in its format.
This patch adds one compile-time options --enable-bsdtar that is used
to enable/disable GNU tar specific options.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
PS. I understand the team may not want to support two flavors of tar, but as users of the tool we have a use case for that and have to maintain our patches ourselves. And since our development policy requires us to submit PRs upstream for the patches we maintain I submit this PR.","rebased to the latest master, resolved conflicts, force pushed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,13,2016-03-09T14:10:10Z,2016-03-17T18:39:27Z,2016-03-17T20:46:54Z,CLOSED,False,28,10,6,https://github.com/rojkov,Add compatibility with libarchive's bsdtar command,1,[],https://github.com/clearlinux/swupd-client/pull/13,https://github.com/barbieri,3,https://github.com/clearlinux/swupd-client/pull/13#issuecomment-198003806,"Since GNU tar fails to extract files with xattrs preserved when
Integrity Measurement Architecture (IMA) is enabled some vendors
may choose to install libarchive-based tar (bsdtar) on their embedded
devices, so the swupd server needs to be able to create archives
in its format.
This patch adds one compile-time options --enable-bsdtar that is used
to enable/disable GNU tar specific options.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
PS. I understand the team may not want to support two flavors of tar, but as users of the tool we have a use case for that and have to maintain our patches ourselves. And since our development policy requires us to submit PRs upstream for the patches we maintain I submit this PR.",ping?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,13,2016-03-09T14:10:10Z,2016-03-17T18:39:27Z,2016-03-17T20:46:54Z,CLOSED,False,28,10,6,https://github.com/rojkov,Add compatibility with libarchive's bsdtar command,1,[],https://github.com/clearlinux/swupd-client/pull/13,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/13#issuecomment-198026115,"Since GNU tar fails to extract files with xattrs preserved when
Integrity Measurement Architecture (IMA) is enabled some vendors
may choose to install libarchive-based tar (bsdtar) on their embedded
devices, so the swupd server needs to be able to create archives
in its format.
This patch adds one compile-time options --enable-bsdtar that is used
to enable/disable GNU tar specific options.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
PS. I understand the team may not want to support two flavors of tar, but as users of the tool we have a use case for that and have to maintain our patches ourselves. And since our development policy requires us to submit PRs upstream for the patches we maintain I submit this PR.","I rebased and pushed this commit to master, with a followup commit to restore the single quotes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,14,2016-03-10T20:35:39Z,2016-03-10T21:48:19Z,2016-04-01T19:37:22Z,CLOSED,False,149,147,34,https://github.com/bryteise,Update source file formats with clang v3.8,1,[],https://github.com/clearlinux/swupd-client/pull/14,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/14,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,14,2016-03-10T20:35:39Z,2016-03-10T21:48:19Z,2016-04-01T19:37:22Z,CLOSED,False,149,147,34,https://github.com/bryteise,Update source file formats with clang v3.8,1,[],https://github.com/clearlinux/swupd-client/pull/14,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/14#issuecomment-195065134,,"Looks like some files were missed, redoing.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,15,2016-03-10T21:55:31Z,2016-03-11T23:31:29Z,2016-04-01T19:37:16Z,CLOSED,False,151,149,34,https://github.com/bryteise,Update source file formats with clang v3.8,1,[],https://github.com/clearlinux/swupd-client/pull/15,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/15,Fixing missed files from #14,Fixing missed files from #14,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,15,2016-03-10T21:55:31Z,2016-03-11T23:31:29Z,2016-04-01T19:37:16Z,CLOSED,False,151,149,34,https://github.com/bryteise,Update source file formats with clang v3.8,1,[],https://github.com/clearlinux/swupd-client/pull/15,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/15#issuecomment-195602692,Fixing missed files from #14,Looks good. Pushed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,16,2016-03-11T23:39:11Z,2016-03-14T19:35:56Z,2016-04-01T19:37:15Z,MERGED,True,304,68,29,https://github.com/bryteise,Bundle add include,5,[],https://github.com/clearlinux/swupd-client/pull/16,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/16,This patchset adds support for the client to install bundle includes once this feature is in the server.,This patchset adds support for the client to install bundle includes once this feature is in the server.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,16,2016-03-11T23:39:11Z,2016-03-14T19:35:56Z,2016-04-01T19:37:15Z,MERGED,True,304,68,29,https://github.com/bryteise,Bundle add include,5,[],https://github.com/clearlinux/swupd-client/pull/16,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/16#issuecomment-196488535,This patchset adds support for the client to install bundle includes once this feature is in the server.,"This looks like a good starting point. I will merge, and let's iterate from here.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,17,2016-03-15T17:37:15Z,2016-03-15T17:45:11Z,2016-03-15T21:27:02Z,CLOSED,False,3190,521,156,https://github.com/bradTpeters,Search test,13,[],https://github.com/clearlinux/swupd-client/pull/17,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/17,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/18,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/ikeydoherty,2,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197027706,,"RFC 3986 already covers port numbers, should this not just be handled in the URI decode?
      authority   = [ userinfo ""@"" ] host [ "":"" port ]",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/ikeydoherty,3,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197028419,,..Feel somewhat guilty for mentioning it now I see the size of the diff.. :),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197056885,,@ikeydoherty Oh so late on that one... I completely forgot about that since I have too many different things the port gets passed to but yea all the port additions for testing the client were not required =(. I'll likely make a patch of shame removing them at some point when I get over my depression.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/ikeydoherty,5,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197058367,,"@bryteise yeah I feel bad for bringing it up now :S I notice Github now has comment reactions.. where's the ""crying into a cup"" one ..",True,{'HOORAY': ['https://github.com/bryteise']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bryteise,6,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197059699,,+1 outside of my comment about the setup script touching files.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bryteise,7,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197060450,,@ikeydoherty I don't know but party in your comment now XP.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/ikeydoherty,8,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197063194,,lol,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bradTpeters,9,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197067688,,bryteise - Sure I can cleanup the touch code; is the rm needed? These were copied from one of the existing test cases and repurposed for search. I didn't do any real cleanup,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bradTpeters,10,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197067844,,"Ikeydoherty - I'll leave the port cleanup to bryteise, since that same usage exists in every primary swupd command",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bryteise,11,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197068378,,@bradTpeters The rm isn't needed since you don't add any new files to the target-dir for the purpose of the test so all you need to do is remove the touch commands for all the tests.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/phmccarty,12,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197426446,,"Aside the few comments/questions I had, these changes look fine. +1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bradTpeters,13,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197584091,,Branch has been updated with feedback,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bryteise,14,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197585724,,"Looks good, +1.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/bradTpeters,15,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-197997823,,v3 with that final cleanup,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,18,2016-03-15T21:27:15Z,2016-03-17T18:06:16Z,2016-06-01T03:32:27Z,CLOSED,False,641,2,102,https://github.com/bradTpeters,Search testing,4,[],https://github.com/clearlinux/swupd-client/pull/18,https://github.com/phmccarty,16,https://github.com/clearlinux/swupd-client/pull/18#issuecomment-198007314,,"Looks good, thanks. I squashed the v2 and v3 commits into the functional test commit, and pushed to master.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,19,2016-03-15T23:04:22Z,2016-03-22T17:40:00Z,2016-04-01T19:37:02Z,CLOSED,False,496,63,69,https://github.com/bryteise,Update include,7,[],https://github.com/clearlinux/swupd-client/pull/19,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/19,This patch set adds support for swupd update to pull in included bundles. It also has a few fixups and cleanups found along the way.,This patch set adds support for swupd update to pull in included bundles. It also has a few fixups and cleanups found along the way.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,19,2016-03-15T23:04:22Z,2016-03-22T17:40:00Z,2016-04-01T19:37:02Z,CLOSED,False,496,63,69,https://github.com/bryteise,Update include,7,[],https://github.com/clearlinux/swupd-client/pull/19,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/19#issuecomment-199928410,This patch set adds support for swupd update to pull in included bundles. It also has a few fixups and cleanups found along the way.,"Looks good, pushed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,20,2016-03-18T19:54:20Z,2016-03-22T19:02:28Z,2016-06-01T03:32:25Z,CLOSED,False,59,53,2,https://github.com/bradTpeters,Search v2,2,[],https://github.com/clearlinux/swupd-client/pull/20,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/20,"Modifies some default behavior, providing all search term hits
across full OS by default.
Adds new '-s, --scope' limiter, which can be used to limit results
to one per bundle or one total
Also updates testing to align with new options and behavior
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Modifies some default behavior, providing all search term hits
across full OS by default.
Adds new '-s, --scope' limiter, which can be used to limit results
to one per bundle or one total
Also updates testing to align with new options and behavior
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,20,2016-03-18T19:54:20Z,2016-03-22T19:02:28Z,2016-06-01T03:32:25Z,CLOSED,False,59,53,2,https://github.com/bradTpeters,Search v2,2,[],https://github.com/clearlinux/swupd-client/pull/20,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/20#issuecomment-199931679,"Modifies some default behavior, providing all search term hits
across full OS by default.
Adds new '-s, --scope' limiter, which can be used to limit results
to one per bundle or one total
Also updates testing to align with new options and behavior
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","+1, aside from the indentation issue.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,20,2016-03-18T19:54:20Z,2016-03-22T19:02:28Z,2016-06-01T03:32:25Z,CLOSED,False,59,53,2,https://github.com/bradTpeters,Search v2,2,[],https://github.com/clearlinux/swupd-client/pull/20,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/20#issuecomment-199955837,"Modifies some default behavior, providing all search term hits
across full OS by default.
Adds new '-s, --scope' limiter, which can be used to limit results
to one per bundle or one total
Also updates testing to align with new options and behavior
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Fixed indentation, thanks Patrick",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,20,2016-03-18T19:54:20Z,2016-03-22T19:02:28Z,2016-06-01T03:32:25Z,CLOSED,False,59,53,2,https://github.com/bradTpeters,Search v2,2,[],https://github.com/clearlinux/swupd-client/pull/20,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/20#issuecomment-199963921,"Modifies some default behavior, providing all search term hits
across full OS by default.
Adds new '-s, --scope' limiter, which can be used to limit results
to one per bundle or one total
Also updates testing to align with new options and behavior
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Looks good, will push shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,22,2016-03-25T23:47:09Z,2016-04-04T19:40:55Z,2016-04-08T00:08:49Z,CLOSED,False,269,149,55,https://github.com/phmccarty,Store default URLs and format in config files; cleanups for URL handling,16,[],https://github.com/clearlinux/swupd-client/pull/22,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/22,"This patch series changes where default URL and format values are stored; instead of hardcoding the values in the swupd binary, they are now stored in config files. It also cleans up the handling of the URL global variables.","This patch series changes where default URL and format values are stored; instead of hardcoding the values in the swupd binary, they are now stored in config files. It also cleans up the handling of the URL global variables.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,22,2016-03-25T23:47:09Z,2016-04-04T19:40:55Z,2016-04-08T00:08:49Z,CLOSED,False,269,149,55,https://github.com/phmccarty,Store default URLs and format in config files; cleanups for URL handling,16,[],https://github.com/clearlinux/swupd-client/pull/22,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/22#issuecomment-205398206,"This patch series changes where default URL and format values are stored; instead of hardcoding the values in the swupd binary, they are now stored in config files. It also cleans up the handling of the URL global variables.",Added some more commits incorporating fixes from review comments.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,22,2016-03-25T23:47:09Z,2016-04-04T19:40:55Z,2016-04-08T00:08:49Z,CLOSED,False,269,149,55,https://github.com/phmccarty,Store default URLs and format in config files; cleanups for URL handling,16,[],https://github.com/clearlinux/swupd-client/pull/22,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/22#issuecomment-205463138,"This patch series changes where default URL and format values are stored; instead of hardcoding the values in the swupd binary, they are now stored in config files. It also cleans up the handling of the URL global variables.",I pushed these changes to master after squashing a couple of the commits I added this morning.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,23,2016-03-28T17:16:45Z,2016-03-29T18:51:05Z,2016-06-01T03:32:23Z,MERGED,True,11,3,1,https://github.com/bradTpeters,Fix --fix successful report,1,[],https://github.com/clearlinux/swupd-client/pull/23,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/23,"This patch modifies success/failure reporting to ensure when the MoM manifest
cannot be downloaded, we report failure.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","This patch modifies success/failure reporting to ensure when the MoM manifest
cannot be downloaded, we report failure.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,24,2016-03-30T00:57:00Z,2016-04-12T17:33:07Z,2016-04-19T22:25:05Z,CLOSED,False,176,0,1,https://github.com/jrguzman-intel,Adding script to create autocompletion function for complete command.,4,[],https://github.com/clearlinux/swupd-client/pull/24,https://github.com/jrguzman-intel,1,https://github.com/clearlinux/swupd-client/pull/24,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,24,2016-03-30T00:57:00Z,2016-04-12T17:33:07Z,2016-04-19T22:25:05Z,CLOSED,False,176,0,1,https://github.com/jrguzman-intel,Adding script to create autocompletion function for complete command.,4,[],https://github.com/clearlinux/swupd-client/pull/24,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/24#issuecomment-207064894,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,I think the project is mostly aligned on 2 space indents for shell scripts.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,24,2016-03-30T00:57:00Z,2016-04-12T17:33:07Z,2016-04-19T22:25:05Z,CLOSED,False,176,0,1,https://github.com/jrguzman-intel,Adding script to create autocompletion function for complete command.,4,[],https://github.com/clearlinux/swupd-client/pull/24,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/24#issuecomment-207069531,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,"@bryteise I would like to standardize on 2-space indents for the shell scripts, yes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,24,2016-03-30T00:57:00Z,2016-04-12T17:33:07Z,2016-04-19T22:25:05Z,CLOSED,False,176,0,1,https://github.com/jrguzman-intel,Adding script to create autocompletion function for complete command.,4,[],https://github.com/clearlinux/swupd-client/pull/24,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/24#issuecomment-207070353,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,"@jrguzman-intel Aside from the comments I added inline, and William's suggestion to change the indent level, I think these changes look good. I tested the autocompletion, and I'm not seeing any functional problems with it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,24,2016-03-30T00:57:00Z,2016-04-12T17:33:07Z,2016-04-19T22:25:05Z,CLOSED,False,176,0,1,https://github.com/jrguzman-intel,Adding script to create autocompletion function for complete command.,4,[],https://github.com/clearlinux/swupd-client/pull/24,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/24#issuecomment-209011247,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,"Looks good, +1. I will merge shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,24,2016-03-30T00:57:00Z,2016-04-12T17:33:07Z,2016-04-19T22:25:05Z,CLOSED,False,176,0,1,https://github.com/jrguzman-intel,Adding script to create autocompletion function for complete command.,4,[],https://github.com/clearlinux/swupd-client/pull/24,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/24#issuecomment-209020504,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,I squashed the last three commits into the original and merged. Thanks!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,25,2016-04-01T00:36:51Z,2016-04-01T18:50:45Z,2016-04-01T18:51:22Z,CLOSED,False,187,7,28,https://github.com/bryteise,Fix update when include manifests are not new,1,[],https://github.com/clearlinux/swupd-client/pull/25,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/25,"Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).","Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,25,2016-04-01T00:36:51Z,2016-04-01T18:50:45Z,2016-04-01T18:51:22Z,CLOSED,False,187,7,28,https://github.com/bryteise,Fix update when include manifests are not new,1,[],https://github.com/clearlinux/swupd-client/pull/25,https://github.com/tpepper,2,https://github.com/clearlinux/swupd-client/pull/25#issuecomment-204198349,"Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).","Sure stat() is cheap, but you really don't want to call that hundreds of thousands of times down inside set_tracked_files().  Instead load_manifests() could check that the bundle is a tracked bundle or not?  Then with one stat per bundle, set_tracked_files() might have a signature, eg:
set_tracked_files(struct manifest *manifest, bool is_tracked);
Assuming a zero'd manifest, you could even drop the second argument and only call the function for bundles for which you will unconditionall set the per file flag == 1.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,25,2016-04-01T00:36:51Z,2016-04-01T18:50:45Z,2016-04-01T18:51:22Z,CLOSED,False,187,7,28,https://github.com/bryteise,Fix update when include manifests are not new,1,[],https://github.com/clearlinux/swupd-client/pull/25,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/25#issuecomment-204200585,"Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).","Ah I was doing something like that originally but got bit by manifest allocation and forgot about the stat when I changed it X(.
I think going back to change alloc_manfiest to default setting is_tracked to 1 and then set_tracked_files can just return if the manifest is tracked.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,25,2016-04-01T00:36:51Z,2016-04-01T18:50:45Z,2016-04-01T18:51:22Z,CLOSED,False,187,7,28,https://github.com/bryteise,Fix update when include manifests are not new,1,[],https://github.com/clearlinux/swupd-client/pull/25,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/25#issuecomment-204519712,"Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).",Fixed in #26,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,26,2016-04-01T18:50:24Z,2016-04-04T19:01:31Z,2016-04-04T19:01:31Z,CLOSED,False,184,7,28,https://github.com/bryteise,Fix update when include manifests are not new,1,[],https://github.com/clearlinux/swupd-client/pull/26,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/26,"Changes from #25

Move calling of is_tracked_bundle outside the per file in a manifest loop by setting the file is_tracked property to 1 by default.


Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).","Changes from #25

Move calling of is_tracked_bundle outside the per file in a manifest loop by setting the file is_tracked property to 1 by default.


Previously include manifests that were not newer than the current
version would be silently ignored even if they had not been previously
installed causing bundles to miss included dependencies.
Fix this by adding a is_tracked field to struct file that is nonzero
when the bundle the file is contained in is marked as tracked via having
a /usr/share/clear/bundles/$name file.
The is_tracked == 0 version of the file will be dropped in the
consolidate_manifest phase if that filename from another bundle has
is_tracked != 0 to avoid downloading and installing an already existing
file.
The is_tracked == 0 version of the file will then be added to the update
list from the consolidated manifest if that file was not previously
installed on the system (in addition to the other cases it would already
have been added to the list for).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,27,2016-04-04T19:56:38Z,2016-04-04T21:29:35Z,2016-04-04T22:49:16Z,CLOSED,False,444,7,69,https://github.com/bryteise,Includes fixesv2,2,[],https://github.com/clearlinux/swupd-client/pull/27,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/27,This change adds support for includes to verify as well as fixes update when a newly included manifest was not updated in the version being updated to.,This change adds support for includes to verify as well as fixes update when a newly included manifest was not updated in the version being updated to.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,27,2016-04-04T19:56:38Z,2016-04-04T21:29:35Z,2016-04-04T22:49:16Z,CLOSED,False,444,7,69,https://github.com/bryteise,Includes fixesv2,2,[],https://github.com/clearlinux/swupd-client/pull/27,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/27#issuecomment-205504513,This change adds support for includes to verify as well as fixes update when a newly included manifest was not updated in the version being updated to.,Updated with request #28,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,28,2016-04-04T21:28:47Z,2016-04-05T00:17:37Z,2016-04-05T00:17:37Z,MERGED,True,445,6,68,https://github.com/bryteise,Includes fixesv3,2,[],https://github.com/clearlinux/swupd-client/pull/28,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/28,"Updates from v2 (closes #27) :

Add comment for what happens when set_untracked_manifest_files is called with ""MoM"" component.
Rename set_tracked_files function -> set_untracked_manifest_files to correct functions purpose.
Remove incorrect check for is_tracked_bundle when downloading packs
Update format path of testing files to formatstaging


This change adds support for includes to verify as well as fixes update when a newly included manifest was not updated in the version being updated to.","Updates from v2 (closes #27) :

Add comment for what happens when set_untracked_manifest_files is called with ""MoM"" component.
Rename set_tracked_files function -> set_untracked_manifest_files to correct functions purpose.
Remove incorrect check for is_tracked_bundle when downloading packs
Update format path of testing files to formatstaging


This change adds support for includes to verify as well as fixes update when a newly included manifest was not updated in the version being updated to.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,28,2016-04-04T21:28:47Z,2016-04-05T00:17:37Z,2016-04-05T00:17:37Z,MERGED,True,445,6,68,https://github.com/bryteise,Includes fixesv3,2,[],https://github.com/clearlinux/swupd-client/pull/28,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/28#issuecomment-205555312,"Updates from v2 (closes #27) :

Add comment for what happens when set_untracked_manifest_files is called with ""MoM"" component.
Rename set_tracked_files function -> set_untracked_manifest_files to correct functions purpose.
Remove incorrect check for is_tracked_bundle when downloading packs
Update format path of testing files to formatstaging


This change adds support for includes to verify as well as fixes update when a newly included manifest was not updated in the version being updated to.","Looks good, will merge shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,29,2016-04-05T05:38:29Z,2016-04-05T18:28:13Z,2016-04-08T00:08:47Z,MERGED,True,26,3,3,https://github.com/phmccarty,Always handle errors from recurse_manifest(),2,[],https://github.com/clearlinux/swupd-client/pull/29,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/29,"Some call sites of recurse_manifest() did not handle return codes. Add handling for those, and also fix a functional test that was broken after adding the proper error handling.","Some call sites of recurse_manifest() did not handle return codes. Add handling for those, and also fix a functional test that was broken after adding the proper error handling.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,29,2016-04-05T05:38:29Z,2016-04-05T18:28:13Z,2016-04-08T00:08:47Z,MERGED,True,26,3,3,https://github.com/phmccarty,Always handle errors from recurse_manifest(),2,[],https://github.com/clearlinux/swupd-client/pull/29,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/29#issuecomment-205900913,"Some call sites of recurse_manifest() did not handle return codes. Add handling for those, and also fix a functional test that was broken after adding the proper error handling.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,30,2016-04-05T15:34:33Z,2016-04-05T18:28:42Z,2016-04-08T00:08:46Z,CLOSED,False,43,11,3,https://github.com/phmccarty,Fix check for symlinks in a dirname path,2,[],https://github.com/clearlinux/swupd-client/pull/30,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/30,"The intended behavior here is to check if the directory path for the
current file contains any symlinks, not the full path itself. By not
checking the directory path only, verify --fix would not delete any
symlinks that were marked deleted.
Also, because the directory path is being examined now, we can obtain
the directory file descriptor (dirfd) and use unlinkat(2) to delete
files and directories instead of unlink/rmdir; doing so avoids race
conditions in that paths may change between calling realpath() and
unlink().
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","The intended behavior here is to check if the directory path for the
current file contains any symlinks, not the full path itself. By not
checking the directory path only, verify --fix would not delete any
symlinks that were marked deleted.
Also, because the directory path is being examined now, we can obtain
the directory file descriptor (dirfd) and use unlinkat(2) to delete
files and directories instead of unlink/rmdir; doing so avoids race
conditions in that paths may change between calling realpath() and
unlink().
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,30,2016-04-05T15:34:33Z,2016-04-05T18:28:42Z,2016-04-08T00:08:46Z,CLOSED,False,43,11,3,https://github.com/phmccarty,Fix check for symlinks in a dirname path,2,[],https://github.com/clearlinux/swupd-client/pull/30,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/30#issuecomment-205929170,"The intended behavior here is to check if the directory path for the
current file contains any symlinks, not the full path itself. By not
checking the directory path only, verify --fix would not delete any
symlinks that were marked deleted.
Also, because the directory path is being examined now, we can obtain
the directory file descriptor (dirfd) and use unlinkat(2) to delete
files and directories instead of unlink/rmdir; doing so avoids race
conditions in that paths may change between calling realpath() and
unlink().
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Added a commit to address review comments.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,30,2016-04-05T15:34:33Z,2016-04-05T18:28:42Z,2016-04-08T00:08:46Z,CLOSED,False,43,11,3,https://github.com/phmccarty,Fix check for symlinks in a dirname path,2,[],https://github.com/clearlinux/swupd-client/pull/30,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/30#issuecomment-205929607,"The intended behavior here is to check if the directory path for the
current file contains any symlinks, not the full path itself. By not
checking the directory path only, verify --fix would not delete any
symlinks that were marked deleted.
Also, because the directory path is being examined now, we can obtain
the directory file descriptor (dirfd) and use unlinkat(2) to delete
files and directories instead of unlink/rmdir; doing so avoids race
conditions in that paths may change between calling realpath() and
unlink().
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,30,2016-04-05T15:34:33Z,2016-04-05T18:28:42Z,2016-04-08T00:08:46Z,CLOSED,False,43,11,3,https://github.com/phmccarty,Fix check for symlinks in a dirname path,2,[],https://github.com/clearlinux/swupd-client/pull/30,https://github.com/amshinde,4,https://github.com/clearlinux/swupd-client/pull/30#issuecomment-205932566,"The intended behavior here is to check if the directory path for the
current file contains any symlinks, not the full path itself. By not
checking the directory path only, verify --fix would not delete any
symlinks that were marked deleted.
Also, because the directory path is being examined now, we can obtain
the directory file descriptor (dirfd) and use unlinkat(2) to delete
files and directories instead of unlink/rmdir; doing so avoids race
conditions in that paths may change between calling realpath() and
unlink().
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,30,2016-04-05T15:34:33Z,2016-04-05T18:28:42Z,2016-04-08T00:08:46Z,CLOSED,False,43,11,3,https://github.com/phmccarty,Fix check for symlinks in a dirname path,2,[],https://github.com/clearlinux/swupd-client/pull/30,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/30#issuecomment-205933317,"The intended behavior here is to check if the directory path for the
current file contains any symlinks, not the full path itself. By not
checking the directory path only, verify --fix would not delete any
symlinks that were marked deleted.
Also, because the directory path is being examined now, we can obtain
the directory file descriptor (dirfd) and use unlinkat(2) to delete
files and directories instead of unlink/rmdir; doing so avoids race
conditions in that paths may change between calling realpath() and
unlink().
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,31,2016-04-06T00:15:12Z,2016-04-08T21:12:27Z,2016-06-01T03:32:21Z,MERGED,True,6,0,1,https://github.com/fandeli,fix segfault in bundle-remove on invalid bundle,1,[],https://github.com/clearlinux/swupd-client/pull/31,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/31,"When trying to remove a bundle that has not
valid name contained into /usr/share/clear/bundles
a segfault arise. This patch solves that by
properly validating the bundle name is valid
within MoM.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","When trying to remove a bundle that has not
valid name contained into /usr/share/clear/bundles
a segfault arise. This patch solves that by
properly validating the bundle name is valid
within MoM.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,31,2016-04-06T00:15:12Z,2016-04-08T21:12:27Z,2016-06-01T03:32:21Z,MERGED,True,6,0,1,https://github.com/fandeli,fix segfault in bundle-remove on invalid bundle,1,[],https://github.com/clearlinux/swupd-client/pull/31,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/31#issuecomment-207608054,"When trying to remove a bundle that has not
valid name contained into /usr/share/clear/bundles
a segfault arise. This patch solves that by
properly validating the bundle name is valid
within MoM.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",Looks good! I'll push to master shortly.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,31,2016-04-06T00:15:12Z,2016-04-08T21:12:27Z,2016-06-01T03:32:21Z,MERGED,True,6,0,1,https://github.com/fandeli,fix segfault in bundle-remove on invalid bundle,1,[],https://github.com/clearlinux/swupd-client/pull/31,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/31#issuecomment-207608169,"When trying to remove a bundle that has not
valid name contained into /usr/share/clear/bundles
a segfault arise. This patch solves that by
properly validating the bundle name is valid
within MoM.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","Merged. Thanks, Jaime.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,32,2016-04-07T18:30:25Z,2016-04-08T18:38:36Z,2016-04-13T18:27:30Z,CLOSED,False,78,46,13,https://github.com/phmccarty,Fix a hashdump crash,3,[],https://github.com/clearlinux/swupd-client/pull/32,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/32,"My recent change that removed the init_globals() call from the hashdump code led to a crash if --basepath was not passed on the command line.
To fix, refactor the path_prefix init code to a new function, and explicitly call this function for hashdump.","My recent change that removed the init_globals() call from the hashdump code led to a crash if --basepath was not passed on the command line.
To fix, refactor the path_prefix init code to a new function, and explicitly call this function for hashdump.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,32,2016-04-07T18:30:25Z,2016-04-08T18:38:36Z,2016-04-13T18:27:30Z,CLOSED,False,78,46,13,https://github.com/phmccarty,Fix a hashdump crash,3,[],https://github.com/clearlinux/swupd-client/pull/32,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/32#issuecomment-207080467,"My recent change that removed the init_globals() call from the hashdump code led to a crash if --basepath was not passed on the command line.
To fix, refactor the path_prefix init code to a new function, and explicitly call this function for hashdump.",Added the missing free() for the get_current_dir_name() error case,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,32,2016-04-07T18:30:25Z,2016-04-08T18:38:36Z,2016-04-13T18:27:30Z,CLOSED,False,78,46,13,https://github.com/phmccarty,Fix a hashdump crash,3,[],https://github.com/clearlinux/swupd-client/pull/32,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/32#issuecomment-207550692,"My recent change that removed the init_globals() call from the hashdump code led to a crash if --basepath was not passed on the command line.
To fix, refactor the path_prefix init code to a new function, and explicitly call this function for hashdump.",Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,33,2016-04-07T18:40:40Z,2016-04-08T19:12:08Z,2016-04-08T19:12:08Z,CLOSED,False,1,4,1,https://github.com/bryteise,Reduce noise for updates and bundle-adds,1,[],https://github.com/clearlinux/swupd-client/pull/33,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/33,"Stop printing a message when bundles are included and going to be
installed or if bundles are already included and going to be skipped
when doing the add_subscriptions call.
Instead update the install_bundles call to notify users when an
installed bundle was attempted to be be installed again.","Stop printing a message when bundles are included and going to be
installed or if bundles are already included and going to be skipped
when doing the add_subscriptions call.
Instead update the install_bundles call to notify users when an
installed bundle was attempted to be be installed again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,33,2016-04-07T18:40:40Z,2016-04-08T19:12:08Z,2016-04-08T19:12:08Z,CLOSED,False,1,4,1,https://github.com/bryteise,Reduce noise for updates and bundle-adds,1,[],https://github.com/clearlinux/swupd-client/pull/33,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/33#issuecomment-207564065,"Stop printing a message when bundles are included and going to be
installed or if bundles are already included and going to be skipped
when doing the add_subscriptions call.
Instead update the install_bundles call to notify users when an
installed bundle was attempted to be be installed again.",Updated in #34,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,34,2016-04-08T19:11:39Z,2016-04-12T18:07:23Z,2016-04-12T18:07:23Z,CLOSED,False,62,15,12,https://github.com/bryteise,Reduce noise for updates and bundle-adds,1,[],https://github.com/clearlinux/swupd-client/pull/34,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/34,"Fixes #33 use of an undefined variable, also corrects a bug in detecting already installed updates and adds a functional test to ensure that detecting already installed bundles is done correctly.

Stop printing a message when bundles are included and going to be
installed or if bundles are already included and going to be skipped
when doing the add_subscriptions call.
Instead update the install_bundles call to notify users when an
installed bundle was attempted to be be installed again.","Fixes #33 use of an undefined variable, also corrects a bug in detecting already installed updates and adds a functional test to ensure that detecting already installed bundles is done correctly.

Stop printing a message when bundles are included and going to be
installed or if bundles are already included and going to be skipped
when doing the add_subscriptions call.
Instead update the install_bundles call to notify users when an
installed bundle was attempted to be be installed again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,34,2016-04-08T19:11:39Z,2016-04-12T18:07:23Z,2016-04-12T18:07:23Z,CLOSED,False,62,15,12,https://github.com/bryteise,Reduce noise for updates and bundle-adds,1,[],https://github.com/clearlinux/swupd-client/pull/34,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/34#issuecomment-209035149,"Fixes #33 use of an undefined variable, also corrects a bug in detecting already installed updates and adds a functional test to ensure that detecting already installed bundles is done correctly.

Stop printing a message when bundles are included and going to be
installed or if bundles are already included and going to be skipped
when doing the add_subscriptions call.
Instead update the install_bundles call to notify users when an
installed bundle was attempted to be be installed again.",Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,35,2016-04-11T19:08:13Z,2016-04-12T18:23:36Z,2016-06-01T03:32:19Z,CLOSED,False,130,51,16,https://github.com/fandeli,add --statedir option to alternate state directory,1,[],https://github.com/clearlinux/swupd-client/pull/35,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/35,"This option overrides the global setup for state_dir
variable that is now used to find out where swupd
is going to do work (state dir).
If not --statedir option is passed along, the global
STATE_DIR definition value is going to be used instead,
this last one can also be changed at compilation time.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","This option overrides the global setup for state_dir
variable that is now used to find out where swupd
is going to do work (state dir).
If not --statedir option is passed along, the global
STATE_DIR definition value is going to be used instead,
this last one can also be changed at compilation time.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,35,2016-04-11T19:08:13Z,2016-04-12T18:23:36Z,2016-06-01T03:32:19Z,CLOSED,False,130,51,16,https://github.com/fandeli,add --statedir option to alternate state directory,1,[],https://github.com/clearlinux/swupd-client/pull/35,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/35#issuecomment-209041256,"This option overrides the global setup for state_dir
variable that is now used to find out where swupd
is going to do work (state dir).
If not --statedir option is passed along, the global
STATE_DIR definition value is going to be used instead,
this last one can also be changed at compilation time.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",Looks good to me. I'll merge shortly.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,35,2016-04-11T19:08:13Z,2016-04-12T18:23:36Z,2016-06-01T03:32:19Z,CLOSED,False,130,51,16,https://github.com/fandeli,add --statedir option to alternate state directory,1,[],https://github.com/clearlinux/swupd-client/pull/35,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/35#issuecomment-209041451,"This option overrides the global setup for state_dir
variable that is now used to find out where swupd
is going to do work (state dir).
If not --statedir option is passed along, the global
STATE_DIR definition value is going to be used instead,
this last one can also be changed at compilation time.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","Merged, thanks!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,36,2016-04-12T04:54:34Z,2016-04-13T18:34:16Z,2016-04-20T19:59:19Z,MERGED,True,181,0,29,https://github.com/phmccarty,Fix for manifest consolidation,2,[],https://github.com/clearlinux/swupd-client/pull/36,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/36,"In the case where the same file is deleted in all bundles, but it was deleted in various versions for different bundles, the manifest consolidation step should choose the newest version among these deleted entries. More details on the justification are in the commit description.
Also, I added a functional test that covers the scenario where I ran into this bug.","In the case where the same file is deleted in all bundles, but it was deleted in various versions for different bundles, the manifest consolidation step should choose the newest version among these deleted entries. More details on the justification are in the commit description.
Also, I added a functional test that covers the scenario where I ran into this bug.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,36,2016-04-12T04:54:34Z,2016-04-13T18:34:16Z,2016-04-20T19:59:19Z,MERGED,True,181,0,29,https://github.com/phmccarty,Fix for manifest consolidation,2,[],https://github.com/clearlinux/swupd-client/pull/36,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/36#issuecomment-209526108,"In the case where the same file is deleted in all bundles, but it was deleted in various versions for different bundles, the manifest consolidation step should choose the newest version among these deleted entries. More details on the justification are in the commit description.
Also, I added a functional test that covers the scenario where I ran into this bug.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,38,2016-04-12T21:44:03Z,2016-04-12T22:09:06Z,2016-04-12T22:09:06Z,MERGED,True,78,3,13,https://github.com/bryteise,Add support for verify --install -m latest,1,[],https://github.com/clearlinux/swupd-client/pull/38,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/38,"Instead of specifying a version number argument to -m allow passing the
latest string which will query for the latest version and use that as
the install target version.","Instead of specifying a version number argument to -m allow passing the
latest string which will query for the latest version and use that as
the install target version.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,38,2016-04-12T21:44:03Z,2016-04-12T22:09:06Z,2016-04-12T22:09:06Z,MERGED,True,78,3,13,https://github.com/bryteise,Add support for verify --install -m latest,1,[],https://github.com/clearlinux/swupd-client/pull/38,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/38#issuecomment-209123725,"Instead of specifying a version number argument to -m allow passing the
latest string which will query for the latest version and use that as
the install target version.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,39,2016-04-12T21:57:40Z,2016-04-13T19:09:11Z,2016-04-20T19:59:08Z,CLOSED,False,33,124,10,https://github.com/phmccarty,Consolidate initialization actions; store lock file in state directory,2,[],https://github.com/clearlinux/swupd-client/pull/39,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/39,"To ease maintenance of swupd initialization steps, call all necessary functions for common actions in swupd_init().
Also, store the lock file in the state directory, now that the state directory is guaranteed to exist before creating the file. This also prevents multiple readers/writers for a given state directory.","To ease maintenance of swupd initialization steps, call all necessary functions for common actions in swupd_init().
Also, store the lock file in the state directory, now that the state directory is guaranteed to exist before creating the file. This also prevents multiple readers/writers for a given state directory.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,39,2016-04-12T21:57:40Z,2016-04-13T19:09:11Z,2016-04-20T19:59:08Z,CLOSED,False,33,124,10,https://github.com/phmccarty,Consolidate initialization actions; store lock file in state directory,2,[],https://github.com/clearlinux/swupd-client/pull/39,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/39#issuecomment-209151847,"To ease maintenance of swupd initialization steps, call all necessary functions for common actions in swupd_init().
Also, store the lock file in the state directory, now that the state directory is guaranteed to exist before creating the file. This also prevents multiple readers/writers for a given state directory.",+1  the consolidation was a little rough to follow with the free_globals moved from main.c to update.c but it everything seems right.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,39,2016-04-12T21:57:40Z,2016-04-13T19:09:11Z,2016-04-20T19:59:08Z,CLOSED,False,33,124,10,https://github.com/phmccarty,Consolidate initialization actions; store lock file in state directory,2,[],https://github.com/clearlinux/swupd-client/pull/39,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/39#issuecomment-209586788,"To ease maintenance of swupd initialization steps, call all necessary functions for common actions in swupd_init().
Also, store the lock file in the state directory, now that the state directory is guaranteed to exist before creating the file. This also prevents multiple readers/writers for a given state directory.","Yes, sorry about that. I will split the moving of free_globals into a separate commit.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,39,2016-04-12T21:57:40Z,2016-04-13T19:09:11Z,2016-04-20T19:59:08Z,CLOSED,False,33,124,10,https://github.com/phmccarty,Consolidate initialization actions; store lock file in state directory,2,[],https://github.com/clearlinux/swupd-client/pull/39,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/39#issuecomment-209598998,"To ease maintenance of swupd initialization steps, call all necessary functions for common actions in swupd_init().
Also, store the lock file in the state directory, now that the state directory is guaranteed to exist before creating the file. This also prevents multiple readers/writers for a given state directory.","I split that change out into a separate commit, and merged.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/42,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-213597912,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.",How about an alternative that uses the default curl handler for CURLOPT_WRITEFUNCTION and open the FILE * prior to initiating the download?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-213604628,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@bryteise That sounds reasonable, I think. So we only need to set CURLOPT_WRITEDATA to the FILE * we open for file->staging, because the default callback is fwrite()...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/pohly,4,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-214627373,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","+1 for using the default curl write handler. I didn't do that because I wanted to keep the existing semantic (= file only opened when transfer at least has started), but if that's not a problem, then it's certainly easier to open in advance.
Can you guys fix it that way? I'm a bit swamped right now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-214907848,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.",So @phmccarty attempted the default curl write handler and because of how we queue downloads we end up with too many open file descriptors so it seems like @pohly has the best approach.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-214915613,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@bryteise Right. I forgot to post the latest status here. The current async download code flow does not work well with the default write handler, so I would need to refactor to make it work.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/pohly,7,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-216805422,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@rojkov was so kind to address the review feedback (pohly#1).
As this is now seen as the right approach, I merged those fixes, squashed, rebased and force-pushed them in this PR. Please consider merging. No manual testing by myself, but @rojkov ran tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/pohly,8,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-258112826,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@phmccarty when testing this change in May, you ran into a ""bug in the hysteresis logic"" which you wanted to debug. Has that been fixed? Can this PR be merged now?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/phmccarty,9,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-258227075,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@pohly The hysteresis logic fix is merged (see #133).
I would rather use the default curl write handler (fwrite(3)) when downloading to files, as discussed in previous comments on this PR. But I haven't yet investigated the proper fix to use the default handler everywhere in the code. Some refactoring of the download code may be needed as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/pohly,10,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-260650360,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@phmccarty @tmarcu @bryteise: I've changed the code such that it uses the default curl write handler. I've intentionally not squashed or rebased, because the old commit was working and preserving it IMHO is useful.
Please review and merge.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,42,2016-04-14T10:01:48Z,2016-11-16T00:42:51Z,2016-11-16T00:42:51Z,MERGED,True,40,38,3,https://github.com/pohly,downloads: minimize syscalls to improve performance,2,[],https://github.com/clearlinux/swupd-client/pull/42,https://github.com/phmccarty,11,https://github.com/clearlinux/swupd-client/pull/42#issuecomment-260807003,"This fixes #41
Beware that I have only tested a slightly different patch against
2.87. Porting it to the current master code required some manual
conflict resolution and I haven't had the time to try the result.","@pohly I agree that keeping the original commit is helpful.
+1 from me. Thanks!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,43,2016-04-18T08:57:30Z,2016-04-22T18:18:26Z,2016-04-22T18:18:26Z,CLOSED,False,4,4,1,https://github.com/rojkov,staging.c: Protect tar command against special characters,1,[],https://github.com/clearlinux/swupd-client/pull/43,https://github.com/rojkov,1,https://github.com/clearlinux/swupd-client/pull/43,"It may happen that a bundle contains a directory named '#' and
other files under this directory, thus not only target files
need to be escaped in tar commands, but also target directories
where the files get installed.
Also a target file may have a name with '@' as its first symbol.
Since the symbol has a special meaning in case of bsdtar the
name needs to escaped in tar commands with the prefix './'.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
The problem was found in the version 2.87, but 3.x is still affected. Here's the typical log for the NodeJS bundle that triggers the issue:
   DEBUG   44.733 0.008 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array   | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - array 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.753 0.020 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - # 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.778 0.025 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator  | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - @@iterator 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.795 0.017 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile hardlink  | /var/lib/swupd/staged/f4dd7645d7dd327b351c08760e3e66170d75cbf518f385b66d76ae396fa02bdb -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js  -1
   DEBUG   44.796       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.implement.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.808 0.012 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js
   DEBUG   44.813 0.005 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile hardlink  | /var/lib/swupd/staged/1c7e7a0ffe86b0cdbe7081fe45f42f2a9b28f1f8fd4a2734a778ac0ee9e3efa7 -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js  -1
   DEBUG   44.813       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.index.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.825 0.011 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js","It may happen that a bundle contains a directory named '#' and
other files under this directory, thus not only target files
need to be escaped in tar commands, but also target directories
where the files get installed.
Also a target file may have a name with '@' as its first symbol.
Since the symbol has a special meaning in case of bsdtar the
name needs to escaped in tar commands with the prefix './'.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
The problem was found in the version 2.87, but 3.x is still affected. Here's the typical log for the NodeJS bundle that triggers the issue:
   DEBUG   44.733 0.008 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array   | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - array 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.753 0.020 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - # 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.778 0.025 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator  | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - @@iterator 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.795 0.017 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile hardlink  | /var/lib/swupd/staged/f4dd7645d7dd327b351c08760e3e66170d75cbf518f385b66d76ae396fa02bdb -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js  -1
   DEBUG   44.796       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.implement.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.808 0.012 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js
   DEBUG   44.813 0.005 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile hardlink  | /var/lib/swupd/staged/1c7e7a0ffe86b0cdbe7081fe45f42f2a9b28f1f8fd4a2734a778ac0ee9e3efa7 -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js  -1
   DEBUG   44.813       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.index.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.825 0.011 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,43,2016-04-18T08:57:30Z,2016-04-22T18:18:26Z,2016-04-22T18:18:26Z,CLOSED,False,4,4,1,https://github.com/rojkov,staging.c: Protect tar command against special characters,1,[],https://github.com/clearlinux/swupd-client/pull/43,https://github.com/barbieri,2,https://github.com/clearlinux/swupd-client/pull/43#issuecomment-211685199,"It may happen that a bundle contains a directory named '#' and
other files under this directory, thus not only target files
need to be escaped in tar commands, but also target directories
where the files get installed.
Also a target file may have a name with '@' as its first symbol.
Since the symbol has a special meaning in case of bsdtar the
name needs to escaped in tar commands with the prefix './'.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
The problem was found in the version 2.87, but 3.x is still affected. Here's the typical log for the NodeJS bundle that triggers the issue:
   DEBUG   44.733 0.008 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array   | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - array 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.753 0.020 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - # 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.778 0.025 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator  | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - @@iterator 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.795 0.017 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile hardlink  | /var/lib/swupd/staged/f4dd7645d7dd327b351c08760e3e66170d75cbf518f385b66d76ae396fa02bdb -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js  -1
   DEBUG   44.796       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.implement.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.808 0.012 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js
   DEBUG   44.813 0.005 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile hardlink  | /var/lib/swupd/staged/1c7e7a0ffe86b0cdbe7081fe45f42f2a9b28f1f8fd4a2734a778ac0ee9e3efa7 -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js  -1
   DEBUG   44.813       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.index.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.825 0.011 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js","looks okay, but the right solution to the escape would be to use the exec() variant that you can pass individual components as an array, not this system()-like where it calls sh -c ""cmd"" .",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,43,2016-04-18T08:57:30Z,2016-04-22T18:18:26Z,2016-04-22T18:18:26Z,CLOSED,False,4,4,1,https://github.com/rojkov,staging.c: Protect tar command against special characters,1,[],https://github.com/clearlinux/swupd-client/pull/43,https://github.com/rojkov,3,https://github.com/clearlinux/swupd-client/pull/43#issuecomment-211769933,"It may happen that a bundle contains a directory named '#' and
other files under this directory, thus not only target files
need to be escaped in tar commands, but also target directories
where the files get installed.
Also a target file may have a name with '@' as its first symbol.
Since the symbol has a special meaning in case of bsdtar the
name needs to escaped in tar commands with the prefix './'.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
The problem was found in the version 2.87, but 3.x is still affected. Here's the typical log for the NodeJS bundle that triggers the issue:
   DEBUG   44.733 0.008 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array   | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - array 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.753 0.020 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - # 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.778 0.025 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator  | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - @@iterator 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.795 0.017 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile hardlink  | /var/lib/swupd/staged/f4dd7645d7dd327b351c08760e3e66170d75cbf518f385b66d76ae396fa02bdb -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js  -1
   DEBUG   44.796       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.implement.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.808 0.012 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js
   DEBUG   44.813 0.005 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile hardlink  | /var/lib/swupd/staged/1c7e7a0ffe86b0cdbe7081fe45f42f2a9b28f1f8fd4a2734a778ac0ee9e3efa7 -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js  -1
   DEBUG   44.813       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.index.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.825 0.011 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js","Replacing system() with exec() is not enough when pipes come to the picture. I'd do the replacement as a part of the ""get rid of the dep on shell""-task.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,43,2016-04-18T08:57:30Z,2016-04-22T18:18:26Z,2016-04-22T18:18:26Z,CLOSED,False,4,4,1,https://github.com/rojkov,staging.c: Protect tar command against special characters,1,[],https://github.com/clearlinux/swupd-client/pull/43,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/43#issuecomment-212027445,"It may happen that a bundle contains a directory named '#' and
other files under this directory, thus not only target files
need to be escaped in tar commands, but also target directories
where the files get installed.
Also a target file may have a name with '@' as its first symbol.
Since the symbol has a special meaning in case of bsdtar the
name needs to escaped in tar commands with the prefix './'.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
The problem was found in the version 2.87, but 3.x is still affected. Here's the typical log for the NodeJS bundle that triggers the issue:
   DEBUG   44.733 0.008 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array   | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - array 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.753 0.020 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - # 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.778 0.025 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator  | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - @@iterator 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.795 0.017 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile hardlink  | /var/lib/swupd/staged/f4dd7645d7dd327b351c08760e3e66170d75cbf518f385b66d76ae396fa02bdb -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js  -1
   DEBUG   44.796       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.implement.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.808 0.012 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js
   DEBUG   44.813 0.005 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile hardlink  | /var/lib/swupd/staged/1c7e7a0ffe86b0cdbe7081fe45f42f2a9b28f1f8fd4a2734a778ac0ee9e3efa7 -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js  -1
   DEBUG   44.813       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.index.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.825 0.011 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js","@barbieri There is a system_argv() function in swupd-server that we could also use in swupd-client (https://github.com/clearlinux/swupd-server/blob/ae299e2126b251d7ac0db972b39038e55757e9c7/src/helpers.c#L147). But as @rojkov notes, when pipes are used, a different solution is needed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,43,2016-04-18T08:57:30Z,2016-04-22T18:18:26Z,2016-04-22T18:18:26Z,CLOSED,False,4,4,1,https://github.com/rojkov,staging.c: Protect tar command against special characters,1,[],https://github.com/clearlinux/swupd-client/pull/43,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/43#issuecomment-213539519,"It may happen that a bundle contains a directory named '#' and
other files under this directory, thus not only target files
need to be escaped in tar commands, but also target directories
where the files get installed.
Also a target file may have a name with '@' as its first symbol.
Since the symbol has a special meaning in case of bsdtar the
name needs to escaped in tar commands with the prefix './'.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com
The problem was found in the version 2.87, but 3.x is still affected. Here's the typical log for the NodeJS bundle that triggers the issue:
   DEBUG   44.733 0.008 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array   | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - array 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.753 0.020 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - # 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.778 0.025 src/staging.c                :408   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator  | directory overwrite   | bsdtar -C /var/lib/swupd/tmprenamedir --preserve-permissions  -cf - @@iterator 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/# --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.795 0.017 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile hardlink  | /var/lib/swupd/staged/f4dd7645d7dd327b351c08760e3e66170d75cbf518f385b66d76ae396fa02bdb -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js  -1
   DEBUG   44.796       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.implement.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.808 0.012 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/implement.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.implement.js
   DEBUG   44.813 0.005 src/staging.c                :431   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile hardlink  | /var/lib/swupd/staged/1c7e7a0ffe86b0cdbe7081fe45f42f2a9b28f1f8fd4a2734a778ac0ee9e3efa7 -> /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js  -1
   DEBUG   44.813       src/staging.c                :446   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | dotfile install   | bsdtar -C /var/lib/swupd/staged --preserve-permissions  -cf - .update.index.js 2> /dev/null | bsdtar -C /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator --preserve-permissions  -xf - 2> /dev/null
   DEBUG   44.825 0.011 src/staging.c                :475   | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/index.js | Installed dotfile not present | /usr/lib/node_modules/npm/node_modules/node-gyp/node_modules/path-array/node_modules/array-index/node_modules/es6-symbol/node_modules/es5-ext/array/#/@@iterator/.update.index.js",Rebased to latest master and merged. Thanks!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,46,2016-04-20T16:22:07Z,2016-04-20T16:23:54Z,2016-04-20T19:54:23Z,MERGED,True,263,68,5,https://github.com/ocallesp,Signature verification,3,[],https://github.com/clearlinux/swupd-client/pull/46,https://github.com/ocallesp,1,https://github.com/clearlinux/swupd-client/pull/46,Implementation of signature and certificate validation.,Implementation of signature and certificate validation.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,46,2016-04-20T16:22:07Z,2016-04-20T16:23:54Z,2016-04-20T19:54:23Z,MERGED,True,263,68,5,https://github.com/ocallesp,Signature verification,3,[],https://github.com/clearlinux/swupd-client/pull/46,https://github.com/ikeydoherty,2,https://github.com/clearlinux/swupd-client/pull/46#issuecomment-212500525,Implementation of signature and certificate validation.,I might suggest running clang-format -i $(find . -name '*.[ch]'),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,46,2016-04-20T16:22:07Z,2016-04-20T16:23:54Z,2016-04-20T19:54:23Z,MERGED,True,263,68,5,https://github.com/ocallesp,Signature verification,3,[],https://github.com/clearlinux/swupd-client/pull/46,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/46#issuecomment-212579015,Implementation of signature and certificate validation.,"The access control lists for this repo were not set up the way I intended, so I force-pushed to master to remove this merge. Apologies for any inconvenience this may have caused.",True,{'THUMBS_UP': ['https://github.com/ikeydoherty']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,47,2016-04-20T16:30:40Z,2016-04-20T16:32:46Z,2016-04-20T19:58:38Z,MERGED,True,215,221,9,https://github.com/ikeydoherty,Fix formatting issues introduced by pull request #46,1,[],https://github.com/clearlinux/swupd-client/pull/47,https://github.com/ikeydoherty,1,https://github.com/clearlinux/swupd-client/pull/47,Signed-off-by: Ikey Doherty michael.i.doherty@intel.com,Signed-off-by: Ikey Doherty michael.i.doherty@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,47,2016-04-20T16:30:40Z,2016-04-20T16:32:46Z,2016-04-20T19:58:38Z,MERGED,True,215,221,9,https://github.com/ikeydoherty,Fix formatting issues introduced by pull request #46,1,[],https://github.com/clearlinux/swupd-client/pull/47,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/47#issuecomment-212580097,Signed-off-by: Ikey Doherty michael.i.doherty@intel.com,"The access control lists for this repo were not set up the way I intended, so I force-pushed to master to remove this merge. Apologies for any inconvenience this may have caused.",True,{'THUMBS_UP': ['https://github.com/ikeydoherty']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,48,2016-04-20T17:23:24Z,2016-04-22T18:47:45Z,2016-04-22T18:47:45Z,CLOSED,False,56,57,8,https://github.com/ikeydoherty,Cleanups,2,[],https://github.com/clearlinux/swupd-client/pull/48,https://github.com/ikeydoherty,1,https://github.com/clearlinux/swupd-client/pull/48,Couple of quick cleanups rebased against the current master,Couple of quick cleanups rebased against the current master,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,48,2016-04-20T17:23:24Z,2016-04-22T18:47:45Z,2016-04-22T18:47:45Z,CLOSED,False,56,57,8,https://github.com/ikeydoherty,Cleanups,2,[],https://github.com/clearlinux/swupd-client/pull/48,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/48#issuecomment-213549855,Couple of quick cleanups rebased against the current master,+1 on the second patch,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,48,2016-04-20T17:23:24Z,2016-04-22T18:47:45Z,2016-04-22T18:47:45Z,CLOSED,False,56,57,8,https://github.com/ikeydoherty,Cleanups,2,[],https://github.com/clearlinux/swupd-client/pull/48,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/48#issuecomment-213550061,Couple of quick cleanups rebased against the current master,"I'm not incredibly happy with some of the style changes from clang-format, but I'll tolerate it for now.
Merged.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,49,2016-04-20T23:20:00Z,2016-04-22T18:52:43Z,2016-04-22T18:52:43Z,CLOSED,False,1,1,1,https://github.com/bradTpeters,Add symlink match to Search,1,[],https://github.com/clearlinux/swupd-client/pull/49,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/49,"Match search term against symlinks as well as files. This is
necessary in order to find hits for perfectly valid searches","Match search term against symlinks as well as files. This is
necessary in order to find hits for perfectly valid searches",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,49,2016-04-20T23:20:00Z,2016-04-22T18:52:43Z,2016-04-22T18:52:43Z,CLOSED,False,1,1,1,https://github.com/bradTpeters,Add symlink match to Search,1,[],https://github.com/clearlinux/swupd-client/pull/49,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/49#issuecomment-213550781,"Match search term against symlinks as well as files. This is
necessary in order to find hits for perfectly valid searches","Looks good, will merge shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,49,2016-04-20T23:20:00Z,2016-04-22T18:52:43Z,2016-04-22T18:52:43Z,CLOSED,False,1,1,1,https://github.com/bradTpeters,Add symlink match to Search,1,[],https://github.com/clearlinux/swupd-client/pull/49,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/49#issuecomment-213551344,"Match search term against symlinks as well as files. This is
necessary in order to find hits for perfectly valid searches",Merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,50,2016-04-22T15:30:56Z,2016-08-04T19:12:07Z,2016-08-04T19:12:07Z,CLOSED,False,2,2,1,https://github.com/jrguzman-intel,Change delta's name from FROM-TO-HASH2 to FROM-TO-HASH1-HASH2 format.,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/50,https://github.com/jrguzman-intel,1,https://github.com/clearlinux/swupd-client/pull/50,"There is an issue when two different files in a newer release have same hash:
This is, when swupd updates a file by applying a delta, it takes the HASH2 to
know the file where delta must be applyed. If files are different in current
release (before updating), there must be 2 deltas, one for each file but as
the two files have same hash in new release delta's name are the same:
FROM-TO-HASH2 and it is when issue arises due to just the last delta file is
kept when swupd server creates files and packs. So when swupd client tries to
apply the delta to one of the file that does not corresponds it will fail and
generates an error. At the first look it will seem like delta file is corrupted
however the issue is that delta file was created for another file.
To solve this issue we include the hash for the original file in the delta's
name so that swupd client can take the correct delta and apply it:
FROM-TO-HASH1-HASH2.
Warning: A corresponding patch to swupd server must be applied in order to
sync both sides and understand the new delta's name format.
->
Refer to jrguzman-intel/swupd-server@6b98c2a
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com","There is an issue when two different files in a newer release have same hash:
This is, when swupd updates a file by applying a delta, it takes the HASH2 to
know the file where delta must be applyed. If files are different in current
release (before updating), there must be 2 deltas, one for each file but as
the two files have same hash in new release delta's name are the same:
FROM-TO-HASH2 and it is when issue arises due to just the last delta file is
kept when swupd server creates files and packs. So when swupd client tries to
apply the delta to one of the file that does not corresponds it will fail and
generates an error. At the first look it will seem like delta file is corrupted
however the issue is that delta file was created for another file.
To solve this issue we include the hash for the original file in the delta's
name so that swupd client can take the correct delta and apply it:
FROM-TO-HASH1-HASH2.
Warning: A corresponding patch to swupd server must be applied in order to
sync both sides and understand the new delta's name format.
->
Refer to jrguzman-intel/swupd-server@6b98c2a
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,50,2016-04-22T15:30:56Z,2016-08-04T19:12:07Z,2016-08-04T19:12:07Z,CLOSED,False,2,2,1,https://github.com/jrguzman-intel,Change delta's name from FROM-TO-HASH2 to FROM-TO-HASH1-HASH2 format.,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/50,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/50#issuecomment-214907500,"There is an issue when two different files in a newer release have same hash:
This is, when swupd updates a file by applying a delta, it takes the HASH2 to
know the file where delta must be applyed. If files are different in current
release (before updating), there must be 2 deltas, one for each file but as
the two files have same hash in new release delta's name are the same:
FROM-TO-HASH2 and it is when issue arises due to just the last delta file is
kept when swupd server creates files and packs. So when swupd client tries to
apply the delta to one of the file that does not corresponds it will fail and
generates an error. At the first look it will seem like delta file is corrupted
however the issue is that delta file was created for another file.
To solve this issue we include the hash for the original file in the delta's
name so that swupd client can take the correct delta and apply it:
FROM-TO-HASH1-HASH2.
Warning: A corresponding patch to swupd server must be applied in order to
sync both sides and understand the new delta's name format.
->
Refer to jrguzman-intel/swupd-server@6b98c2a
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com","+1
@phmccarty would you want to get the change into a release this week?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,50,2016-04-22T15:30:56Z,2016-08-04T19:12:07Z,2016-08-04T19:12:07Z,CLOSED,False,2,2,1,https://github.com/jrguzman-intel,Change delta's name from FROM-TO-HASH2 to FROM-TO-HASH1-HASH2 format.,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/50,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/50#issuecomment-214907645,"There is an issue when two different files in a newer release have same hash:
This is, when swupd updates a file by applying a delta, it takes the HASH2 to
know the file where delta must be applyed. If files are different in current
release (before updating), there must be 2 deltas, one for each file but as
the two files have same hash in new release delta's name are the same:
FROM-TO-HASH2 and it is when issue arises due to just the last delta file is
kept when swupd server creates files and packs. So when swupd client tries to
apply the delta to one of the file that does not corresponds it will fail and
generates an error. At the first look it will seem like delta file is corrupted
however the issue is that delta file was created for another file.
To solve this issue we include the hash for the original file in the delta's
name so that swupd client can take the correct delta and apply it:
FROM-TO-HASH1-HASH2.
Warning: A corresponding patch to swupd server must be applied in order to
sync both sides and understand the new delta's name format.
->
Refer to jrguzman-intel/swupd-server@6b98c2a
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",I will note this probably could use a few tests since we don't have many delta functional tests in the client atm.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,50,2016-04-22T15:30:56Z,2016-08-04T19:12:07Z,2016-08-04T19:12:07Z,CLOSED,False,2,2,1,https://github.com/jrguzman-intel,Change delta's name from FROM-TO-HASH2 to FROM-TO-HASH1-HASH2 format.,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/50,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/50#issuecomment-214914980,"There is an issue when two different files in a newer release have same hash:
This is, when swupd updates a file by applying a delta, it takes the HASH2 to
know the file where delta must be applyed. If files are different in current
release (before updating), there must be 2 deltas, one for each file but as
the two files have same hash in new release delta's name are the same:
FROM-TO-HASH2 and it is when issue arises due to just the last delta file is
kept when swupd server creates files and packs. So when swupd client tries to
apply the delta to one of the file that does not corresponds it will fail and
generates an error. At the first look it will seem like delta file is corrupted
however the issue is that delta file was created for another file.
To solve this issue we include the hash for the original file in the delta's
name so that swupd client can take the correct delta and apply it:
FROM-TO-HASH1-HASH2.
Warning: A corresponding patch to swupd server must be applied in order to
sync both sides and understand the new delta's name format.
->
Refer to jrguzman-intel/swupd-server@6b98c2a
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",@bryteise I think this change should go in for the format6 bump.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,50,2016-04-22T15:30:56Z,2016-08-04T19:12:07Z,2016-08-04T19:12:07Z,CLOSED,False,2,2,1,https://github.com/jrguzman-intel,Change delta's name from FROM-TO-HASH2 to FROM-TO-HASH1-HASH2 format.,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/50,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/50#issuecomment-237653687,"There is an issue when two different files in a newer release have same hash:
This is, when swupd updates a file by applying a delta, it takes the HASH2 to
know the file where delta must be applyed. If files are different in current
release (before updating), there must be 2 deltas, one for each file but as
the two files have same hash in new release delta's name are the same:
FROM-TO-HASH2 and it is when issue arises due to just the last delta file is
kept when swupd server creates files and packs. So when swupd client tries to
apply the delta to one of the file that does not corresponds it will fail and
generates an error. At the first look it will seem like delta file is corrupted
however the issue is that delta file was created for another file.
To solve this issue we include the hash for the original file in the delta's
name so that swupd client can take the correct delta and apply it:
FROM-TO-HASH1-HASH2.
Warning: A corresponding patch to swupd server must be applied in order to
sync both sides and understand the new delta's name format.
->
Refer to jrguzman-intel/swupd-server@6b98c2a
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",Merged into master.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,51,2016-04-25T17:43:41Z,2016-04-25T23:55:02Z,2016-04-25T23:55:02Z,CLOSED,False,2,2,1,https://github.com/bradTpeters,Fix manifest iteration,1,[],https://github.com/clearlinux/swupd-client/pull/51,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/51,"search_file_in_manifest() is not starting its iteration from
list_head, leading to incomplete manifest search and failing
verify_fix_path()
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","search_file_in_manifest() is not starting its iteration from
list_head, leading to incomplete manifest search and failing
verify_fix_path()
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,51,2016-04-25T17:43:41Z,2016-04-25T23:55:02Z,2016-04-25T23:55:02Z,CLOSED,False,2,2,1,https://github.com/bradTpeters,Fix manifest iteration,1,[],https://github.com/clearlinux/swupd-client/pull/51,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/51#issuecomment-214486644,"search_file_in_manifest() is not starting its iteration from
list_head, leading to incomplete manifest search and failing
verify_fix_path()
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1 though having a test that verifies the newly correct behavior (because it failed before this patch) would be an improvement.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,51,2016-04-25T17:43:41Z,2016-04-25T23:55:02Z,2016-04-25T23:55:02Z,CLOSED,False,2,2,1,https://github.com/bradTpeters,Fix manifest iteration,1,[],https://github.com/clearlinux/swupd-client/pull/51,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/51#issuecomment-214565982,"search_file_in_manifest() is not starting its iteration from
list_head, leading to incomplete manifest search and failing
verify_fix_path()
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Looks good. I will follow up with a functional test.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,51,2016-04-25T17:43:41Z,2016-04-25T23:55:02Z,2016-04-25T23:55:02Z,CLOSED,False,2,2,1,https://github.com/bradTpeters,Fix manifest iteration,1,[],https://github.com/clearlinux/swupd-client/pull/51,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/51#issuecomment-214566436,"search_file_in_manifest() is not starting its iteration from
list_head, leading to incomplete manifest search and failing
verify_fix_path()
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,52,2016-04-25T23:38:52Z,2016-04-27T17:07:34Z,2016-04-27T17:08:39Z,CLOSED,False,18,0,3,https://github.com/phmccarty,Fix deletion of directory trees with 'verify --fix',1,[],https://github.com/clearlinux/swupd-client/pull/52,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/52,"For safety, 'verify --fix' does not use swupd_rm() (like 'update') when
deleting files, etc. Instead, each deleted entry is considered
individually.
So for the deletion step to work correctly with 'verify --fix', files
contained within directories must be listed before the directories
themselves. A simple solution is to make the manifest reverse filename
sorted (opposite of the current filename sorted order).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","For safety, 'verify --fix' does not use swupd_rm() (like 'update') when
deleting files, etc. Instead, each deleted entry is considered
individually.
So for the deletion step to work correctly with 'verify --fix', files
contained within directories must be listed before the directories
themselves. A simple solution is to make the manifest reverse filename
sorted (opposite of the current filename sorted order).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,52,2016-04-25T23:38:52Z,2016-04-27T17:07:34Z,2016-04-27T17:08:39Z,CLOSED,False,18,0,3,https://github.com/phmccarty,Fix deletion of directory trees with 'verify --fix',1,[],https://github.com/clearlinux/swupd-client/pull/52,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/52#issuecomment-214563916,"For safety, 'verify --fix' does not use swupd_rm() (like 'update') when
deleting files, etc. Instead, each deleted entry is considered
individually.
So for the deletion step to work correctly with 'verify --fix', files
contained within directories must be listed before the directories
themselves. A simple solution is to make the manifest reverse filename
sorted (opposite of the current filename sorted order).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",I will follow up later with a functional test.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,52,2016-04-25T23:38:52Z,2016-04-27T17:07:34Z,2016-04-27T17:08:39Z,CLOSED,False,18,0,3,https://github.com/phmccarty,Fix deletion of directory trees with 'verify --fix',1,[],https://github.com/clearlinux/swupd-client/pull/52,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/52#issuecomment-214568366,"For safety, 'verify --fix' does not use swupd_rm() (like 'update') when
deleting files, etc. Instead, each deleted entry is considered
individually.
So for the deletion step to work correctly with 'verify --fix', files
contained within directories must be listed before the directories
themselves. A simple solution is to make the manifest reverse filename
sorted (opposite of the current filename sorted order).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Looks good.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,52,2016-04-25T23:38:52Z,2016-04-27T17:07:34Z,2016-04-27T17:08:39Z,CLOSED,False,18,0,3,https://github.com/phmccarty,Fix deletion of directory trees with 'verify --fix',1,[],https://github.com/clearlinux/swupd-client/pull/52,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/52#issuecomment-215150497,"For safety, 'verify --fix' does not use swupd_rm() (like 'update') when
deleting files, etc. Instead, each deleted entry is considered
individually.
So for the deletion step to work correctly with 'verify --fix', files
contained within directories must be listed before the directories
themselves. A simple solution is to make the manifest reverse filename
sorted (opposite of the current filename sorted order).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","Merged. I addressed William's comment, squashing that change into the original commit. And I added a functional test.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/rojkov,1,https://github.com/clearlinux/swupd-client/pull/53,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/barbieri,2,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-214774287,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","looks good to me, can you also work on integrating this with their unit tests? The best case is to use their existing tests with out wrapper, once it passes we can propose:

hide existing swupd from $PATH;
rename/symlink swupdctl to swupd in $PATH (drop-in replacement!)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/rojkov,3,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-215084237,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","I've added a couple of squashable commits addressing the comments.
I haven't tried to run the functional tests in Ostro yet. Hopefully I'll have time for that on Friday or next week.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/barbieri,4,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-216657627,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","@rojkov now that ostro 1.0 is out, can you get to the tests?
IMO we can also start to apply this PR to Ostro nightly builds if you're comfortable with that, make sure to hide the swupd and exposing the dbus client in its place so our QA tests that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/rojkov,5,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-216861990,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","@barbieri I got reallocated to another project. @igor-stoppa is going to continue on this.
I think we need to upgrade swupd to the latest&greatest in Ostro first (it's v2.87 currently). Then this patch can be applied for the nightly builds. And before upgrading swupd in Ostro we'd better have #42 merged upstream.
Yesterday I tried to run the functional tests on our target device: the problem is that the tests are supposed to be run on a host system from a build directory which is not really suitable for embedded development. After tweaking tests/functional/swupdlib.bash I managed to run the tests against the D-Bus wrapper swupdctl and got 23/49 pass rate. If run against the actual executable swupd the pass rate is 24/49. Again such low pass rate is due to targeting a normal host system where e.g. bashisms and normal coreutils are allowed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/barbieri,6,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-216931670,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","Do you execute the tests using a local DBus? You should play with dbus-daemon launch and export the variables so you don't reach the actual system bus, rather going with the local dbus-daemon for the test. It can use a specific dbus & policy configuration files to allow to run as non-root if that's the requirement.
Also, please run these tests in the expected environment, maybe get clearlinux and do it there. @phmccarty what do you recommend to get 100% pass rate?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/bryteise,7,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-216933656,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","@barbieri @igor-stoppa ClearLinux would be easiest though installing the dependencies wouldn't be too hard for any distro. Just our version of bsdiff (https://github.com/clearlinux/bsdiff) installed manually and everything else should be in any reasonable distro.
Unfortunately the tests require root at the moment due to tar xattr extraction (sudo is used in the tests that need them).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/bryteise,8,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-218243536,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","Just a comment before merging, that this needs to be given a run through clang-format.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/rojkov,9,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-234203415,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","fixed typos;
used string_or_die() instead of aprintf();
stricter policy on unrecognized options in the daemon;
added closing file descriptors upon errors;
added error notification upon empty input in EPOLLIN;
ran the code through clang-format;
got rid of debugging info in output;
rebased and force pushed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/bryteise,10,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-235039958,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","So this looks pretty good to me.
@phmccarty @tmarcu @bradTpeters Could we get another look over, I'm interested on further opinions on dbus-wrapper/dbus_client.c:on_command_cancel function's error handling but otherwise I don't have any additional comments that should be addressed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/andred,11,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-263930614,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","It's a pity that this makes the client dependent on systemd. It's not possible to use systemd in every environment, and so far swupd works fine without systemd (with one minor change to update_triggers()). I haven't looked at the patches, but is it really impossible to achieve what is being achieved here by using libdbus directly, or maybe glib?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/barbieri,12,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-263974977,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","this doesn't require systemd per se, just the library it provides -- which is more efficient and smaller than libdbus, that's why it's being used by other projects.
If a real situation where we  need the dbus wrapper and not installing systemd, we can create a static library to link against and live with that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/andred,13,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-264134073,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","I wasn't clear enough. But the whole systemd project (including libsystemd.so) doesn't even compile against anything but glibc, in particular the musl c library, without numerous patches (none of which seem to be going to be accepted upstream by either party). Given embedded devices often use something else than glibc, it'd be a shame if swupd locked itself out by depending on it. I realise this place here is probably not the right to have an architectural discussion like this, and swupd is (mainly / only?) targeting Clearlinux with its own use-cases, and swupd shouldn't be limited because some other, unrelated use-case might break, but swupd seemed like a good choice for system updates of embedded devices so far. That is my main concern.
One last - even if libsystemd's dbus wrapper is more efficient, does it matter? Are there that many messages being sent that it actually matters?
Would a patch that allows selectively building against libsystemd or libdbus or libglib-dbus be acceptable?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/barbieri,14,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-264181471,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.","indeed there are not many messages, my point is that due that reason libdbus is being deprecated in favor of libsystemd to reach DBus... at least for projects that rely on an external library. AFAIU Qt and Glib talk directly to the bus.
libglib-dbus is horrible to use, I've used it in few projects and it's the worst DBus bind I ever used. If we need to go small, use libell https://git.kernel.org/cgit/libs/ell/ell.git/ it was created by connman/ofono/... team after long time experience with glib-dbus, which lead them to create their own dbus wrapper with glib... but then they just used a subset and libell was born to be just that subset.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,53,2016-04-26T12:49:12Z,2017-05-03T18:36:19Z,2017-05-03T18:38:06Z,CLOSED,False,3144,1,22,https://github.com/rojkov,Add DBus wrapper around swupd client,10,['enhancement'],https://github.com/clearlinux/swupd-client/pull/53,https://github.com/tmarcu,15,https://github.com/clearlinux/swupd-client/pull/53#issuecomment-298998542,"Simple daemon offering a system-bus D-Bus interface for
asynchronously triggering/executing Clear Linux swupd-client
utility from another process.
The D-Bus API reflects functionality offered by command line
interface of the Clear linux swupd-client utility (swupd).
Functionality is needed by Ostro OS architecture where it must
be possible to trigger system software update actions from a
containerized process. Thus, direct fork() & exec() doesnt work.
Since D-Bus access is enabled by enabling access to a single
socket, this can be arranged for a containerized process.
This patch adds two binaries: swupdd and swupdctl. The former
is a D-Bus service wrapping swupd. It starts on demand
and exits after timeout (30 sec). The latter is a drop-in
replacement for swupd that communicates with the D-Bus
wrapper via D-Bus.",Please open another issue if there is proposed work going forward with this feature.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,54,2016-04-26T18:02:16Z,2016-06-21T21:31:54Z,2016-06-21T21:31:54Z,CLOSED,False,342,112,6,https://github.com/ocallesp,Signature verification,10,[],https://github.com/clearlinux/swupd-client/pull/54,https://github.com/ocallesp,1,https://github.com/clearlinux/swupd-client/pull/54,need code review,need code review,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,54,2016-04-26T18:02:16Z,2016-06-21T21:31:54Z,2016-06-21T21:31:54Z,CLOSED,False,342,112,6,https://github.com/ocallesp,Signature verification,10,[],https://github.com/clearlinux/swupd-client/pull/54,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/54#issuecomment-227578871,need code review,This PR has been superceded by #83,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,55,2016-04-26T18:35:12Z,2016-04-28T18:15:20Z,2016-04-28T18:15:20Z,CLOSED,False,1,1,1,https://github.com/fandeli,fix error checking/retry handling on pack download,1,[],https://github.com/clearlinux/swupd-client/pull/55,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/55,"In the update loop when downloading packs a return
status is checked with an unreacheable error number
-ENONET, this is because the function is called
download_subscribed_packs() without forcing the
pack to download, so the only chance to this to
return an error is at checking network aviability
with a return code -ENOSWUPDSERVER so far. This
was causing the retry mechanism on this point to
be completely ignored and skipped right away.
Beyond checking for -ENOSWUPDSERVER, this fix
checks whether any error ocurred in the packs
download function, granting that if some code
changes inside the caller is checking accorrdingly.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","In the update loop when downloading packs a return
status is checked with an unreacheable error number
-ENONET, this is because the function is called
download_subscribed_packs() without forcing the
pack to download, so the only chance to this to
return an error is at checking network aviability
with a return code -ENOSWUPDSERVER so far. This
was causing the retry mechanism on this point to
be completely ignored and skipped right away.
Beyond checking for -ENOSWUPDSERVER, this fix
checks whether any error ocurred in the packs
download function, granting that if some code
changes inside the caller is checking accorrdingly.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,55,2016-04-26T18:35:12Z,2016-04-28T18:15:20Z,2016-04-28T18:15:20Z,CLOSED,False,1,1,1,https://github.com/fandeli,fix error checking/retry handling on pack download,1,[],https://github.com/clearlinux/swupd-client/pull/55,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/55#issuecomment-214904115,"In the update loop when downloading packs a return
status is checked with an unreacheable error number
-ENONET, this is because the function is called
download_subscribed_packs() without forcing the
pack to download, so the only chance to this to
return an error is at checking network aviability
with a return code -ENOSWUPDSERVER so far. This
was causing the retry mechanism on this point to
be completely ignored and skipped right away.
Beyond checking for -ENOSWUPDSERVER, this fix
checks whether any error ocurred in the packs
download function, granting that if some code
changes inside the caller is checking accorrdingly.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","I am for this change. Having packs hold up progress for any reason is sensible since it would still allow much smaller/faster updates if a network blip happens.
We will need to improve the download_subscribed_packs code to make the most of this change though as any tar issues aren't handled very well making this more trouble in the short term.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,55,2016-04-26T18:35:12Z,2016-04-28T18:15:20Z,2016-04-28T18:15:20Z,CLOSED,False,1,1,1,https://github.com/fandeli,fix error checking/retry handling on pack download,1,[],https://github.com/clearlinux/swupd-client/pull/55,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/55#issuecomment-215514865,"In the update loop when downloading packs a return
status is checked with an unreacheable error number
-ENONET, this is because the function is called
download_subscribed_packs() without forcing the
pack to download, so the only chance to this to
return an error is at checking network aviability
with a return code -ENOSWUPDSERVER so far. This
was causing the retry mechanism on this point to
be completely ignored and skipped right away.
Beyond checking for -ENOSWUPDSERVER, this fix
checks whether any error ocurred in the packs
download function, granting that if some code
changes inside the caller is checking accorrdingly.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","@bryteise I agree that the error handling in the pack handling logic needs improvement, but because this change is only for the 'update' path, where packs are always optional, I think we can address the pack untar errors, etc. later.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,55,2016-04-26T18:35:12Z,2016-04-28T18:15:20Z,2016-04-28T18:15:20Z,CLOSED,False,1,1,1,https://github.com/fandeli,fix error checking/retry handling on pack download,1,[],https://github.com/clearlinux/swupd-client/pull/55,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/55#issuecomment-215515000,"In the update loop when downloading packs a return
status is checked with an unreacheable error number
-ENONET, this is because the function is called
download_subscribed_packs() without forcing the
pack to download, so the only chance to this to
return an error is at checking network aviability
with a return code -ENOSWUPDSERVER so far. This
was causing the retry mechanism on this point to
be completely ignored and skipped right away.
Beyond checking for -ENOSWUPDSERVER, this fix
checks whether any error ocurred in the packs
download function, granting that if some code
changes inside the caller is checking accorrdingly.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",This change looks fine. I will merge shortly.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,55,2016-04-26T18:35:12Z,2016-04-28T18:15:20Z,2016-04-28T18:15:20Z,CLOSED,False,1,1,1,https://github.com/fandeli,fix error checking/retry handling on pack download,1,[],https://github.com/clearlinux/swupd-client/pull/55,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/55#issuecomment-215515929,"In the update loop when downloading packs a return
status is checked with an unreacheable error number
-ENONET, this is because the function is called
download_subscribed_packs() without forcing the
pack to download, so the only chance to this to
return an error is at checking network aviability
with a return code -ENOSWUPDSERVER so far. This
was causing the retry mechanism on this point to
be completely ignored and skipped right away.
Beyond checking for -ENOSWUPDSERVER, this fix
checks whether any error ocurred in the packs
download function, granting that if some code
changes inside the caller is checking accorrdingly.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/chuyd,1,https://github.com/clearlinux/swupd-client/pull/56,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/56#issuecomment-214904707,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","Thanks for catching this issue! It is a side effect of running init_globals() for 'check-update', even though 'check-update' doesn't require set_content_url() being called at all... I'm not sure of the best approach to take here...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/56#issuecomment-214907040,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","I'm actually in favor of having it setting the content url to something static that passes init_globals for check-update and then removing the -u option from the command.
But... if we want to have unified option handling between more swupd commands I'd just reject the -u option entirely and if only a content or version url is passed print a warning but attempt to use the same url for both.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/fandeli,4,https://github.com/clearlinux/swupd-client/pull/56#issuecomment-214909044,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","+1 removing -u from command and set both to whatever -c is, is harder to
handle decently from init_globals()
On Tue, Apr 26, 2016 at 5:29 PM, William Douglas notifications@github.com
wrote:

I'm actually in favor of having it setting the content url to something
static that passes init_globals for check-update and then removing the -u
option from the command.
But... if we want to have unified option handling between more swupd
commands I'd just reject the -u option entirely and if only a content or
version url is passed print a warning but attempt to use the same url for
both.

You are receiving this because you are subscribed to this thread.
Reply to this email directly or view it on GitHub
#56 (comment)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/56#issuecomment-215518904,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","I'm hesitant to remove the -u option right now, or else scripts will break. When the unified getopt handling is implemented, the options will likely break anyway, so I would prefer to not break compatibility before that time when we can announce the breaking option-related changes and how to migrate scripts.
I think we should call set_content_url("""") for now, and if check-update ever needs to download update content in the future, we can add the -c option.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/56#issuecomment-218588726,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","@chuyd After reconsidering the various possible solutions here, given the current state of option parsing, I think your approach is cleanest.
The future unified getopt interface will completely overhaul the parsing, and we can revisit the check-update options at that time.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,56,2016-04-26T20:47:58Z,2016-05-11T21:02:14Z,2016-05-11T21:02:14Z,CLOSED,False,1,0,1,https://github.com/chuyd,Fix check-update content url message,1,[],https://github.com/clearlinux/swupd-client/pull/56,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/56#issuecomment-218589195,"Fix ""Use the -c option instead"" message in check-update since it does
not require the -c option, this occurs when the default contenturl
can not be foud in the config files, this patch sets the content url
with the version url value in check-update.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com",Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/57,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-214898835,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","A test run with this patch fails with:
swupd bundle-add os-core-dev
swupd-client bundle adder 3.5.2
Copyright (C) 2012-2016 Intel Corporation
Attempting to download version string to memory
Downloading required packs...
Downloading os-core-dev pack for version 7500
Extracting pack.
Installing bundle(s) files...
Failed to stage file(s) (ret = -2). Cannot proceed with bundle-add
Possible filedescriptor leak: fd_number=""4"",fd_details=""socket:[5418]""
root@clr-bf85f5c2c3964f7fb7eff8072655dde2 /home #

Much better than corrupting the file system by installing a bunch of 0 length files, as it was without this patch.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-214899014,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",A follow-on patch is going to clean up the partially installed bundle(s) contents,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-214906013,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/bradTpeters,5,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-214911950,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Msg updated. I'm a little concerned that outputting filename may imply the cause of the error is the file mentioned, when in fact it is likely to be a disk out of space error",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-215521113,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","@bradTpeters I agree with that concern, but do_staging() error handling needs rework anyway, so at this point in the code we don't have enough information about what errors actually occurred.
But by printing the filename that failed to stage, swupd developers will at least have some information to work with, until we start to send this type of information over telemetry. The message is not actionable for end users, which is the downside, but if users file a bug report, when there may be enough information in the output to work with.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-215522233,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Looks good. I'll fix up a little whitespace issue afterward and then merge.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,57,2016-04-26T21:47:24Z,2016-04-28T18:41:51Z,2016-04-28T18:41:51Z,CLOSED,False,4,0,1,https://github.com/bradTpeters,Add check for do_staging return code,2,[],https://github.com/clearlinux/swupd-client/pull/57,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/57#issuecomment-215523484,"Add check for do_staging return code, aborting bundle-add
operation when any file or directory fails to stage. This
addresses file system corruption seen when client runs out
of disk space
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Merged. (I squashed the whitespace change into the commit instead.),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,58,2016-04-26T22:17:38Z,2016-04-27T16:36:21Z,2016-04-27T16:36:21Z,MERGED,True,1933,1545,150,https://github.com/bryteise,Move functional tests to use the BATS framework,1,[],https://github.com/clearlinux/swupd-client/pull/58,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/58,This change also removes duplicate test from search.,This change also removes duplicate test from search.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,58,2016-04-26T22:17:38Z,2016-04-27T16:36:21Z,2016-04-27T16:36:21Z,MERGED,True,1933,1545,150,https://github.com/bryteise,Move functional tests to use the BATS framework,1,[],https://github.com/clearlinux/swupd-client/pull/58,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/58#issuecomment-215140667,This change also removes duplicate test from search.,"I'm seeing three test failures when running the suite on Arch. They are:

update/include-old-bundle
update/include
update/newest-deleted

There appear to be differences in ordering of pack downloads? Maybe we need to sort subs before downloading?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,58,2016-04-26T22:17:38Z,2016-04-27T16:36:21Z,2016-04-27T16:36:21Z,MERGED,True,1933,1545,150,https://github.com/bryteise,Move functional tests to use the BATS framework,1,[],https://github.com/clearlinux/swupd-client/pull/58,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/58#issuecomment-215141244,This change also removes duplicate test from search.,I'll merge this now and we can debug the pack download ordering issue after.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,59,2016-04-27T22:38:34Z,2016-05-10T16:59:25Z,2016-05-10T16:59:25Z,CLOSED,False,61,1,3,https://github.com/fandeli,fix to check whether resume download is supported,1,[],https://github.com/clearlinux/swupd-client/pull/59,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/59,"When pack is going to be downloaded an option for
curl called resume is activated no matter what,
however although major http server support 'Range'
command that enables this functionality, not all
complies with this, when swupd client tries to
re-download a partial file from one of the server
that does not support 'Range' it will just throw
an error and stop to work until partial download
is deleted by hand.
This patch address that issue by checking first
whether server supports 'Range' command and if not
then disable 'resume' of packs.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","When pack is going to be downloaded an option for
curl called resume is activated no matter what,
however although major http server support 'Range'
command that enables this functionality, not all
complies with this, when swupd client tries to
re-download a partial file from one of the server
that does not support 'Range' it will just throw
an error and stop to work until partial download
is deleted by hand.
This patch address that issue by checking first
whether server supports 'Range' command and if not
then disable 'resume' of packs.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,59,2016-04-27T22:38:34Z,2016-05-10T16:59:25Z,2016-05-10T16:59:25Z,CLOSED,False,61,1,3,https://github.com/fandeli,fix to check whether resume download is supported,1,[],https://github.com/clearlinux/swupd-client/pull/59,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/59#issuecomment-215528790,"When pack is going to be downloaded an option for
curl called resume is activated no matter what,
however although major http server support 'Range'
command that enables this functionality, not all
complies with this, when swupd client tries to
re-download a partial file from one of the server
that does not support 'Range' it will just throw
an error and stop to work until partial download
is deleted by hand.
This patch address that issue by checking first
whether server supports 'Range' command and if not
then disable 'resume' of packs.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",@fandeli I like this approach. I have a couple of suggestions that I added inline.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,59,2016-04-27T22:38:34Z,2016-05-10T16:59:25Z,2016-05-10T16:59:25Z,CLOSED,False,61,1,3,https://github.com/fandeli,fix to check whether resume download is supported,1,[],https://github.com/clearlinux/swupd-client/pull/59,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/59#issuecomment-218222360,"When pack is going to be downloaded an option for
curl called resume is activated no matter what,
however although major http server support 'Range'
command that enables this functionality, not all
complies with this, when swupd client tries to
re-download a partial file from one of the server
that does not support 'Range' it will just throw
an error and stop to work until partial download
is deleted by hand.
This patch address that issue by checking first
whether server supports 'Range' command and if not
then disable 'resume' of packs.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",Merged to master,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,60,2016-04-28T17:19:25Z,2016-04-28T17:24:57Z,2016-04-28T17:24:57Z,CLOSED,False,85,6,6,https://github.com/bryteise,Fix version to memory download,1,[],https://github.com/clearlinux/swupd-client/pull/60,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/60,"In the case where the swupd_download_version_to_memory callback was run
multiple times, it would overwrite previous data instead of appending.
Correct this behavior by keeping track of data written so far in the
struct passed to the callback.
Resolves issue #45.","In the case where the swupd_download_version_to_memory callback was run
multiple times, it would overwrite previous data instead of appending.
Correct this behavior by keeping track of data written so far in the
struct passed to the callback.
Resolves issue #45.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,60,2016-04-28T17:19:25Z,2016-04-28T17:24:57Z,2016-04-28T17:24:57Z,CLOSED,False,85,6,6,https://github.com/bryteise,Fix version to memory download,1,[],https://github.com/clearlinux/swupd-client/pull/60,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/60#issuecomment-215501685,"In the case where the swupd_download_version_to_memory callback was run
multiple times, it would overwrite previous data instead of appending.
Correct this behavior by keeping track of data written so far in the
struct passed to the callback.
Resolves issue #45.",Fixes in #61,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,61,2016-04-28T17:24:19Z,2016-04-28T17:59:19Z,2016-04-28T17:59:19Z,MERGED,True,84,6,6,https://github.com/bryteise,Fix version to memory download,1,[],https://github.com/clearlinux/swupd-client/pull/61,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/61,"Contains whites pace fix from #60.
In the case where the swupd_download_version_to_memory callback was run
multiple times, it would overwrite previous data instead of appending.
Correct this behavior by keeping track of data written so far in the
struct passed to the callback.
Resolves issue #45.","Contains whites pace fix from #60.
In the case where the swupd_download_version_to_memory callback was run
multiple times, it would overwrite previous data instead of appending.
Correct this behavior by keeping track of data written so far in the
struct passed to the callback.
Resolves issue #45.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,61,2016-04-28T17:24:19Z,2016-04-28T17:59:19Z,2016-04-28T17:59:19Z,MERGED,True,84,6,6,https://github.com/bryteise,Fix version to memory download,1,[],https://github.com/clearlinux/swupd-client/pull/61,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/61#issuecomment-215511080,"Contains whites pace fix from #60.
In the case where the swupd_download_version_to_memory callback was run
multiple times, it would overwrite previous data instead of appending.
Correct this behavior by keeping track of data written so far in the
struct passed to the callback.
Resolves issue #45.",Looks good to me.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,62,2016-04-29T19:48:50Z,2016-04-29T19:54:15Z,2016-04-29T19:54:15Z,MERGED,True,14,0,1,https://github.com/bryteise,Always sort subs after read_subscriptions_alt,1,[],https://github.com/clearlinux/swupd-client/pull/62,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/62,"When creating #58, some tests were observed to fail due to the subs list having a different order between systems. This change should prevent the behavior but needs tested on a system which saw the failing tests in the first place.
In order to avoid non deterministic behavior when processing the subs
list, sort it after running read_subscription_alt as it may add items to
the list in a different order between runs.","When creating #58, some tests were observed to fail due to the subs list having a different order between systems. This change should prevent the behavior but needs tested on a system which saw the failing tests in the first place.
In order to avoid non deterministic behavior when processing the subs
list, sort it after running read_subscription_alt as it may add items to
the list in a different order between runs.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,62,2016-04-29T19:48:50Z,2016-04-29T19:54:15Z,2016-04-29T19:54:15Z,MERGED,True,14,0,1,https://github.com/bryteise,Always sort subs after read_subscriptions_alt,1,[],https://github.com/clearlinux/swupd-client/pull/62,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/62#issuecomment-215861552,"When creating #58, some tests were observed to fail due to the subs list having a different order between systems. This change should prevent the behavior but needs tested on a system which saw the failing tests in the first place.
In order to avoid non deterministic behavior when processing the subs
list, sort it after running read_subscription_alt as it may add items to
the list in a different order between runs.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,64,2016-05-02T21:52:42Z,2016-05-03T16:09:12Z,2016-05-03T16:09:12Z,MERGED,True,31,2,5,https://github.com/bryteise,Ensure bundle-remove gets one bundle argument,1,[],https://github.com/clearlinux/swupd-client/pull/64,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/64,"Instead of only checking if bundle-remove has at least one bundle
argument and ignoring additional ones, check that there is exactly one
argument passed to bundle-remove instead.","Instead of only checking if bundle-remove has at least one bundle
argument and ignoring additional ones, check that there is exactly one
argument passed to bundle-remove instead.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,64,2016-05-02T21:52:42Z,2016-05-03T16:09:12Z,2016-05-03T16:09:12Z,MERGED,True,31,2,5,https://github.com/bryteise,Ensure bundle-remove gets one bundle argument,1,[],https://github.com/clearlinux/swupd-client/pull/64,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/64#issuecomment-216578986,"Instead of only checking if bundle-remove has at least one bundle
argument and ignoring additional ones, check that there is exactly one
argument passed to bundle-remove instead.",Looks good.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,65,2016-05-03T20:30:32Z,2016-05-05T21:49:58Z,2016-05-05T21:49:58Z,CLOSED,False,25,2,4,https://github.com/bryteise,Correct return check of get_latest_version,1,[],https://github.com/clearlinux/swupd-client/pull/65,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/65,"Update verify to correctly check the return value of get_latest_version
for errors. Since get_latest_version could return a variety of negative
error codes to signify errors compare against that range instead of -1
to determine success of the operation.","Update verify to correctly check the return value of get_latest_version
for errors. Since get_latest_version could return a variety of negative
error codes to signify errors compare against that range instead of -1
to determine success of the operation.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,65,2016-05-03T20:30:32Z,2016-05-05T21:49:58Z,2016-05-05T21:49:58Z,CLOSED,False,25,2,4,https://github.com/bryteise,Correct return check of get_latest_version,1,[],https://github.com/clearlinux/swupd-client/pull/65,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/65#issuecomment-217290140,"Update verify to correctly check the return value of get_latest_version
for errors. Since get_latest_version could return a variety of negative
error codes to signify errors compare against that range instead of -1
to determine success of the operation.",Addressed in #66,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,66,2016-05-05T21:47:05Z,2016-05-10T17:33:41Z,2016-05-10T17:33:41Z,CLOSED,False,271,121,31,https://github.com/bryteise,Bundle add fix path,5,[],https://github.com/clearlinux/swupd-client/pull/66,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/66,"Patch set adds support for verify_fix_path running as expected when using bundle add.
This involves some invasive changes to manifest.c's recurse_manifests and consolidate_submanifests (the latter effectively being renamed into consolidate_files). These changes are mostly to break away from modifying a given manifest in place and instead operating on independant lists of bundles or files that can then be moved into the owning manifest as needed.
There is also an extra unrelated patch correcting how the return of get_latest_version was being used and adding a test to verify correct behavior.","Patch set adds support for verify_fix_path running as expected when using bundle add.
This involves some invasive changes to manifest.c's recurse_manifests and consolidate_submanifests (the latter effectively being renamed into consolidate_files). These changes are mostly to break away from modifying a given manifest in place and instead operating on independant lists of bundles or files that can then be moved into the owning manifest as needed.
There is also an extra unrelated patch correcting how the return of get_latest_version was being used and adding a test to verify correct behavior.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,66,2016-05-05T21:47:05Z,2016-05-10T17:33:41Z,2016-05-10T17:33:41Z,CLOSED,False,271,121,31,https://github.com/bryteise,Bundle add fix path,5,[],https://github.com/clearlinux/swupd-client/pull/66,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/66#issuecomment-218231981,"Patch set adds support for verify_fix_path running as expected when using bundle add.
This involves some invasive changes to manifest.c's recurse_manifests and consolidate_submanifests (the latter effectively being renamed into consolidate_files). These changes are mostly to break away from modifying a given manifest in place and instead operating on independant lists of bundles or files that can then be moved into the owning manifest as needed.
There is also an extra unrelated patch correcting how the return of get_latest_version was being used and adding a test to verify correct behavior.",Looks good. Merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,68,2016-05-11T22:13:29Z,2016-05-13T17:40:36Z,2016-05-13T17:40:36Z,CLOSED,False,121,0,18,https://github.com/bryteise,Enforce includes hierarchy with bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/68,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/68,"Don't allow bundle-remove to remove bundles that are included by other
currently installed bundles.","Don't allow bundle-remove to remove bundles that are included by other
currently installed bundles.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,68,2016-05-11T22:13:29Z,2016-05-13T17:40:36Z,2016-05-13T17:40:36Z,CLOSED,False,121,0,18,https://github.com/bryteise,Enforce includes hierarchy with bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/68,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/68#issuecomment-219110800,"Don't allow bundle-remove to remove bundles that are included by other
currently installed bundles.",Looks good. Merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,69,2016-05-12T21:01:35Z,2016-05-13T15:26:08Z,2016-05-13T15:26:08Z,CLOSED,False,0,0,0,https://github.com/chuyd,Fix coredump by empty args and go to error if set_path_prefix returns false,0,[],https://github.com/clearlinux/swupd-client/pull/69,https://github.com/chuyd,1,https://github.com/clearlinux/swupd-client/pull/69,"The commit  063f0f1 fixes the coredump generated by the abort()
from the string_or_die function for the following scenarios:
--path=, --url= --versionurl= --contenturl= are empty string values.
The commit a0b8931 fixes the scenarioo when  set_path_prefix returns
false, displaying ""cannot continue"" but swupd continues its execution. This
is fixed by going to err when a return false is received from set_path_prefix","The commit  063f0f1 fixes the coredump generated by the abort()
from the string_or_die function for the following scenarios:
--path=, --url= --versionurl= --contenturl= are empty string values.
The commit a0b8931 fixes the scenarioo when  set_path_prefix returns
false, displaying ""cannot continue"" but swupd continues its execution. This
is fixed by going to err when a return false is received from set_path_prefix",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,69,2016-05-12T21:01:35Z,2016-05-13T15:26:08Z,2016-05-13T15:26:08Z,CLOSED,False,0,0,0,https://github.com/chuyd,Fix coredump by empty args and go to error if set_path_prefix returns false,0,[],https://github.com/clearlinux/swupd-client/pull/69,https://github.com/chuyd,2,https://github.com/clearlinux/swupd-client/pull/69#issuecomment-219072613,"The commit  063f0f1 fixes the coredump generated by the abort()
from the string_or_die function for the following scenarios:
--path=, --url= --versionurl= --contenturl= are empty string values.
The commit a0b8931 fixes the scenarioo when  set_path_prefix returns
false, displaying ""cannot continue"" but swupd continues its execution. This
is fixed by going to err when a return false is received from set_path_prefix","I'll modify the pull request, to remove the  commit 063f0f1 which issue was fixed with the merged commit 1800f19",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,70,2016-05-13T15:38:57Z,2016-05-13T15:50:27Z,2016-05-13T15:50:27Z,MERGED,True,6,12,6,https://github.com/chuyd,Fix the swupd resume when set_path_prefix returns false ,1,[],https://github.com/clearlinux/swupd-client/pull/70,https://github.com/chuyd,1,https://github.com/clearlinux/swupd-client/pull/70,"When set_path_prefix returns false, a message ""cannot continue""
appears but swupd continues its execution, this patch goes to
err when a false is returned by set_path_prefix.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","When set_path_prefix returns false, a message ""cannot continue""
appears but swupd continues its execution, this patch goes to
err when a false is returned by set_path_prefix.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,70,2016-05-13T15:38:57Z,2016-05-13T15:50:27Z,2016-05-13T15:50:27Z,MERGED,True,6,12,6,https://github.com/chuyd,Fix the swupd resume when set_path_prefix returns false ,1,[],https://github.com/clearlinux/swupd-client/pull/70,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/70#issuecomment-219083077,"When set_path_prefix returns false, a message ""cannot continue""
appears but swupd continues its execution, this patch goes to
err when a false is returned by set_path_prefix.
Signed-off-by: Jesus Ornelas Aguayo jesus.ornelas.aguayo@intel.com","Looks good, thanks!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/incandescant,1,https://github.com/clearlinux/swupd-client/pull/71,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com","Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/incandescant,2,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-219166285,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com","Partially fixes #67 (but doesn't address CURLOPT_PINNEDPUBLICKEY set to ""/usr/share/clear/update-ca/425b0f6b.key"" in curl.c).
Tested by both:

passing custom values for every added --with-* option and observing the passed values in config.h after invoking configure
not passing custom values for any of the added --with* options and observing defaults in config.h after invoking configure",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-219167765,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com",+1 needs a format bump though,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-219803192,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com",Looks good. I'll queue this for a format bump.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-260819529,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com","This needs to be rebased. We no longer have need for the 2 CA_CERT variables, are the others still needing to become configurable?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-261624505,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com","@tmarcu Because the configure.ac has been heavily revised since this patch was submitted, a rewrite is required.
I would suggest that the following defaults be configurable:

STATE_DIR
LOCK_DIR
BUNDLES_DIR
UPDATE_CA_CERTS_PATH
MOTD_FILE

Making the above configurable will aid cross-distro adoption, because the filesystem layout/conventions may be different. And the default BUNDLES_DIR and UPDATE_CA_CERTS_PATH are Clear Linux oriented, so it would be nice to configure those too.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-298981126,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com","STATE_DIR and CERT_PATH are configurable now, leaving:
LOCK_DIR
BUNDLES_DIR
MOTD_FILE",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,71,2016-05-13T21:39:03Z,2017-05-03T18:40:56Z,2017-05-03T18:40:56Z,CLOSED,False,49,14,1,https://github.com/incandescant,Make paths configurable,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/71,https://github.com/tmarcu,8,https://github.com/clearlinux/swupd-client/pull/71#issuecomment-298999288,"Change the follwing symbols to be confiurable via --with-* options:
BUNDLES_DIR, UPDATE_CA_CERTS_PATH, SIGNATURE_CA_CERT, STATE_DIR,
LOG_DIR, LOCK_DIR, MOTD_FILE
Note: this changes the default value of:

BUNDLES_DIR from /usr/share/clear/bundles to
/usr/share/swupd/bundles
UPDATE_CA_CERTS_PATH from /usr/share/clear/update-ca to
/usr/share/swupd/update-ca

Defaults remain the same for all other variables which are now
configurable
Signed-off-by: Joshua Lock joshua.g.lock@intel.com",Closing and opened new issue for #208,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,72,2016-05-17T21:10:39Z,2016-05-20T19:36:59Z,2016-05-20T19:36:59Z,MERGED,True,159,21,40,https://github.com/bryteise,Update verify,2,[],https://github.com/clearlinux/swupd-client/pull/72,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/72,"Pull request for update path to validate file hashes after successful tar extraction.
This also contains a change for the python web server test to increase sleep time before running the test, resolving issues on my system where tests would fail when the system was under load.","Pull request for update path to validate file hashes after successful tar extraction.
This also contains a change for the python web server test to increase sleep time before running the test, resolving issues on my system where tests would fail when the system was under load.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,72,2016-05-17T21:10:39Z,2016-05-20T19:36:59Z,2016-05-20T19:36:59Z,MERGED,True,159,21,40,https://github.com/bryteise,Update verify,2,[],https://github.com/clearlinux/swupd-client/pull/72,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/72#issuecomment-220698817,"Pull request for update path to validate file hashes after successful tar extraction.
This also contains a change for the python web server test to increase sleep time before running the test, resolving issues on my system where tests would fail when the system was under load.","+1, will merge shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,73,2016-05-18T22:44:57Z,2016-08-04T19:12:21Z,2016-08-04T19:12:21Z,CLOSED,False,3,1,2,https://github.com/jrguzman-intel,Make directory hashes independent on filename,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/73,https://github.com/jrguzman-intel,1,https://github.com/clearlinux/swupd-client/pull/73,"Calculate the hash for directories is desiderable to be independent
on the dirname due to the subsequent calculation on the staged/HASH
file. Here is used const ""DIRECTORY"" string for input name for
all folders.
->
There is a patch for server side that must be applied at same time than this
jrguzman-intel/swupd-server#23
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com","Calculate the hash for directories is desiderable to be independent
on the dirname due to the subsequent calculation on the staged/HASH
file. Here is used const ""DIRECTORY"" string for input name for
all folders.
->
There is a patch for server side that must be applied at same time than this
jrguzman-intel/swupd-server#23
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,73,2016-05-18T22:44:57Z,2016-08-04T19:12:21Z,2016-08-04T19:12:21Z,CLOSED,False,3,1,2,https://github.com/jrguzman-intel,Make directory hashes independent on filename,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/73,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/73#issuecomment-220429897,"Calculate the hash for directories is desiderable to be independent
on the dirname due to the subsequent calculation on the staged/HASH
file. Here is used const ""DIRECTORY"" string for input name for
all folders.
->
There is a patch for server side that must be applied at same time than this
jrguzman-intel/swupd-server#23
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,73,2016-05-18T22:44:57Z,2016-08-04T19:12:21Z,2016-08-04T19:12:21Z,CLOSED,False,3,1,2,https://github.com/jrguzman-intel,Make directory hashes independent on filename,1,['format-bump'],https://github.com/clearlinux/swupd-client/pull/73,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/73#issuecomment-237653736,"Calculate the hash for directories is desiderable to be independent
on the dirname due to the subsequent calculation on the staged/HASH
file. Here is used const ""DIRECTORY"" string for input name for
all folders.
->
There is a patch for server side that must be applied at same time than this
jrguzman-intel/swupd-server#23
<-
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",Merged into master branch.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,74,2016-05-19T18:39:16Z,2016-10-07T22:28:58Z,2016-10-07T22:29:23Z,CLOSED,False,258,76,8,https://github.com/jrguzman-intel,Replace system calls by local system_argv functions.,3,[],https://github.com/clearlinux/swupd-client/pull/74,https://github.com/jrguzman-intel,1,https://github.com/clearlinux/swupd-client/pull/74,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com","There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,74,2016-05-19T18:39:16Z,2016-10-07T22:28:58Z,2016-10-07T22:29:23Z,CLOSED,False,258,76,8,https://github.com/jrguzman-intel,Replace system calls by local system_argv functions.,3,[],https://github.com/clearlinux/swupd-client/pull/74,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/74#issuecomment-227812971,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com",+1 on the latest changes.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,74,2016-05-19T18:39:16Z,2016-10-07T22:28:58Z,2016-10-07T22:29:23Z,CLOSED,False,258,76,8,https://github.com/jrguzman-intel,Replace system calls by local system_argv functions.,3,[],https://github.com/clearlinux/swupd-client/pull/74,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/74#issuecomment-252376158,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com","Rebased to latest master, and resolved all merge conflicts.
The new PR is #144",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,75,2016-05-24T17:11:31Z,2016-05-31T18:25:10Z,2016-05-31T18:25:10Z,CLOSED,False,116,16,18,https://github.com/bryteise,Allow bundle-add to fallback to full files,1,[],https://github.com/clearlinux/swupd-client/pull/75,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/75,"Instead of requiring a pack is used for bundle-add, allow the use of
verify_fix_path when staging fails to: download, verify and stage the
item using the full file.
This change also separates the staging from installation so that all
files are first staged before they are all then renamed.
Correct output of tests where the 'required' wording was removed.","Instead of requiring a pack is used for bundle-add, allow the use of
verify_fix_path when staging fails to: download, verify and stage the
item using the full file.
This change also separates the staging from installation so that all
files are first staged before they are all then renamed.
Correct output of tests where the 'required' wording was removed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,75,2016-05-24T17:11:31Z,2016-05-31T18:25:10Z,2016-05-31T18:25:10Z,CLOSED,False,116,16,18,https://github.com/bryteise,Allow bundle-add to fallback to full files,1,[],https://github.com/clearlinux/swupd-client/pull/75,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/75#issuecomment-222776576,"Instead of requiring a pack is used for bundle-add, allow the use of
verify_fix_path when staging fails to: download, verify and stage the
item using the full file.
This change also separates the staging from installation so that all
files are first staged before they are all then renamed.
Correct output of tests where the 'required' wording was removed.",Rebased and merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,76,2016-05-24T22:57:53Z,2016-05-31T18:12:27Z,2016-05-31T18:12:27Z,CLOSED,False,2,0,1,https://github.com/bryteise,Set ret to indicate error in update failure path,1,[],https://github.com/clearlinux/swupd-client/pull/76,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/76,"When unable to allocate the submanifest list for either the current or
server manifest, set ret to indicate failure.","When unable to allocate the submanifest list for either the current or
server manifest, set ret to indicate failure.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,76,2016-05-24T22:57:53Z,2016-05-31T18:12:27Z,2016-05-31T18:12:27Z,CLOSED,False,2,0,1,https://github.com/bryteise,Set ret to indicate error in update failure path,1,[],https://github.com/clearlinux/swupd-client/pull/76,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/76#issuecomment-222772365,"When unable to allocate the submanifest list for either the current or
server manifest, set ret to indicate failure.",Looks correct,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,76,2016-05-24T22:57:53Z,2016-05-31T18:12:27Z,2016-05-31T18:12:27Z,CLOSED,False,2,0,1,https://github.com/bryteise,Set ret to indicate error in update failure path,1,[],https://github.com/clearlinux/swupd-client/pull/76,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/76#issuecomment-222772864,"When unable to allocate the submanifest list for either the current or
server manifest, set ret to indicate failure.",Rebased and merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,77,2016-05-25T23:26:26Z,2016-05-31T18:08:09Z,2016-05-31T18:08:09Z,MERGED,True,1,1,1,https://github.com/bryteise,Correctly free manifest data,1,[],https://github.com/clearlinux/swupd-client/pull/77,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/77,Call free_manifest instead of plain free on allocated manifests.,Call free_manifest instead of plain free on allocated manifests.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,77,2016-05-25T23:26:26Z,2016-05-31T18:08:09Z,2016-05-31T18:08:09Z,MERGED,True,1,1,1,https://github.com/bryteise,Correctly free manifest data,1,[],https://github.com/clearlinux/swupd-client/pull/77,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/77#issuecomment-222771488,Call free_manifest instead of plain free on allocated manifests.,Good catch! Will merge shortly.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,78,2016-05-25T23:58:54Z,2016-05-31T19:09:55Z,2016-05-31T19:09:56Z,CLOSED,False,14,17,3,https://github.com/bryteise,Stop using out of scope stack memory,1,[],https://github.com/clearlinux/swupd-client/pull/78,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/78,"When running get_latest_version, the swupd_curl_get_file would allocate
a version_container struct on the stack that would then be used by the
curl callback to keep track of the buffer offset. This use was invalid
however because the callback was run after the stack had been popped
which lead to undefined behavior.
Instead change the swupd_curl_get_file function to take the struct
itself so it will refer to memory valid for the entire length of the
call.
The swupd_curl_get_file function should likely be restructured at some
point so that in memory downloads are less of a hack (only able to
download a LINE_MAX worth of data) at some point however and this will
need to be updated again.","When running get_latest_version, the swupd_curl_get_file would allocate
a version_container struct on the stack that would then be used by the
curl callback to keep track of the buffer offset. This use was invalid
however because the callback was run after the stack had been popped
which lead to undefined behavior.
Instead change the swupd_curl_get_file function to take the struct
itself so it will refer to memory valid for the entire length of the
call.
The swupd_curl_get_file function should likely be restructured at some
point so that in memory downloads are less of a hack (only able to
download a LINE_MAX worth of data) at some point however and this will
need to be updated again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,78,2016-05-25T23:58:54Z,2016-05-31T19:09:55Z,2016-05-31T19:09:56Z,CLOSED,False,14,17,3,https://github.com/bryteise,Stop using out of scope stack memory,1,[],https://github.com/clearlinux/swupd-client/pull/78,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/78#issuecomment-222789544,"When running get_latest_version, the swupd_curl_get_file would allocate
a version_container struct on the stack that would then be used by the
curl callback to keep track of the buffer offset. This use was invalid
however because the callback was run after the stack had been popped
which lead to undefined behavior.
Instead change the swupd_curl_get_file function to take the struct
itself so it will refer to memory valid for the entire length of the
call.
The swupd_curl_get_file function should likely be restructured at some
point so that in memory downloads are less of a hack (only able to
download a LINE_MAX worth of data) at some point however and this will
need to be updated again.","Looks good, merged.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,79,2016-06-02T21:44:00Z,2016-06-09T20:39:54Z,2016-06-09T20:39:54Z,CLOSED,False,132,0,18,https://github.com/bryteise,Skip verified unchanged files in update,1,[],https://github.com/clearlinux/swupd-client/pull/79,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/79,"Instead of just checking if the versions have changed for a file to be
updated, compare the current file's hash to updated file's expected hash
and only queue files for update that are changed.","Instead of just checking if the versions have changed for a file to be
updated, compare the current file's hash to updated file's expected hash
and only queue files for update that are changed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,79,2016-06-02T21:44:00Z,2016-06-09T20:39:54Z,2016-06-09T20:39:54Z,CLOSED,False,132,0,18,https://github.com/bryteise,Skip verified unchanged files in update,1,[],https://github.com/clearlinux/swupd-client/pull/79,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/79#issuecomment-225019007,"Instead of just checking if the versions have changed for a file to be
updated, compare the current file's hash to updated file's expected hash
and only queue files for update that are changed.","+1, looks good",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,80,2016-06-03T21:59:57Z,2016-06-03T23:25:40Z,2016-06-03T23:25:40Z,MERGED,True,1,1,1,https://github.com/jrguzman-intel,Fix for completion when absolute path is given,1,[],https://github.com/clearlinux/swupd-client/pull/80,https://github.com/jrguzman-intel,1,https://github.com/clearlinux/swupd-client/pull/80,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,80,2016-06-03T21:59:57Z,2016-06-03T23:25:40Z,2016-06-03T23:25:40Z,MERGED,True,1,1,1,https://github.com/jrguzman-intel,Fix for completion when absolute path is given,1,[],https://github.com/clearlinux/swupd-client/pull/80,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/80#issuecomment-223717585,Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com,"Looks good, thanks!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,82,2016-06-10T20:45:30Z,2016-06-21T21:30:32Z,2016-06-28T17:57:57Z,MERGED,True,12,8,1,https://github.com/phmccarty,Improvements for update list creation,1,[],https://github.com/clearlinux/swupd-client/pull/82,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/82,"The recently added call to verify_file(), used to skip files that are
already installed and have correct hashes, is a nice optimization for
the case when an update crosses a build where a new minversion was
applied to the server content.
However, I ran into a case where calling verify_file() like this results
in an incomplete update: If the corresponding hash calculation of a file
in the latest version *follows a symlink"" for the path in the current
version, the hashes will match (assuming the same file content).
This issue is avoidable by checking for the file's presence in the
current version's manifest first, because manifests only contain real
paths (no non-leaf path components are symlinks).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","The recently added call to verify_file(), used to skip files that are
already installed and have correct hashes, is a nice optimization for
the case when an update crosses a build where a new minversion was
applied to the server content.
However, I ran into a case where calling verify_file() like this results
in an incomplete update: If the corresponding hash calculation of a file
in the latest version *follows a symlink"" for the path in the current
version, the hashes will match (assuming the same file content).
This issue is avoidable by checking for the file's presence in the
current version's manifest first, because manifests only contain real
paths (no non-leaf path components are symlinks).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,82,2016-06-10T20:45:30Z,2016-06-21T21:30:32Z,2016-06-28T17:57:57Z,MERGED,True,12,8,1,https://github.com/phmccarty,Improvements for update list creation,1,[],https://github.com/clearlinux/swupd-client/pull/82,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/82#issuecomment-225291428,"The recently added call to verify_file(), used to skip files that are
already installed and have correct hashes, is a nice optimization for
the case when an update crosses a build where a new minversion was
applied to the server content.
However, I ran into a case where calling verify_file() like this results
in an incomplete update: If the corresponding hash calculation of a file
in the latest version *follows a symlink"" for the path in the current
version, the hashes will match (assuming the same file content).
This issue is avoidable by checking for the file's presence in the
current version's manifest first, because manifests only contain real
paths (no non-leaf path components are symlinks).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",I plan to add a functional test for the situation described in the second paragraph. That will be a separate patch.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,82,2016-06-10T20:45:30Z,2016-06-21T21:30:32Z,2016-06-28T17:57:57Z,MERGED,True,12,8,1,https://github.com/phmccarty,Improvements for update list creation,1,[],https://github.com/clearlinux/swupd-client/pull/82,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/82#issuecomment-225679789,"The recently added call to verify_file(), used to skip files that are
already installed and have correct hashes, is a nice optimization for
the case when an update crosses a build where a new minversion was
applied to the server content.
However, I ran into a case where calling verify_file() like this results
in an incomplete update: If the corresponding hash calculation of a file
in the latest version *follows a symlink"" for the path in the current
version, the hashes will match (assuming the same file content).
This issue is avoidable by checking for the file's presence in the
current version's manifest first, because manifests only contain real
paths (no non-leaf path components are symlinks).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",uploaded version 2 of the patch,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,82,2016-06-10T20:45:30Z,2016-06-21T21:30:32Z,2016-06-28T17:57:57Z,MERGED,True,12,8,1,https://github.com/phmccarty,Improvements for update list creation,1,[],https://github.com/clearlinux/swupd-client/pull/82,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/82#issuecomment-227575599,"The recently added call to verify_file(), used to skip files that are
already installed and have correct hashes, is a nice optimization for
the case when an update crosses a build where a new minversion was
applied to the server content.
However, I ran into a case where calling verify_file() like this results
in an incomplete update: If the corresponding hash calculation of a file
in the latest version *follows a symlink"" for the path in the current
version, the hashes will match (assuming the same file content).
This issue is avoidable by checking for the file's presence in the
current version's manifest first, because manifests only contain real
paths (no non-leaf path components are symlinks).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",uploaded v3 patch,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,82,2016-06-10T20:45:30Z,2016-06-21T21:30:32Z,2016-06-28T17:57:57Z,MERGED,True,12,8,1,https://github.com/phmccarty,Improvements for update list creation,1,[],https://github.com/clearlinux/swupd-client/pull/82,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/82#issuecomment-227576627,"The recently added call to verify_file(), used to skip files that are
already installed and have correct hashes, is a nice optimization for
the case when an update crosses a build where a new minversion was
applied to the server content.
However, I ran into a case where calling verify_file() like this results
in an incomplete update: If the corresponding hash calculation of a file
in the latest version *follows a symlink"" for the path in the current
version, the hashes will match (assuming the same file content).
This issue is avoidable by checking for the file's presence in the
current version's manifest first, because manifests only contain real
paths (no non-leaf path components are symlinks).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/83,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-226316234,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,"First patch has bundle-add and verify but should also have the other commands as well (update, bundle-remove, search, check-update)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-226588428,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,"@tmarcu There are various calls to signature_download_and_verify() that should be removed, because swupd-server should only be signing the Manifest.MoM. We should remove those calls in this patch series.",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-226661025,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,"Will post a V3 soon with many more changes, ignore previous PR for now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-227584305,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,"Your branch is 35 commits behind master, too. Please rebase.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-227586876,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,We need calls to initialize_signature() for most other subcommands (anything that loads a MoM).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-227840923,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,"@tmarcu Running make check fails:
test/signature_verify_test.c:49:7: error: too many arguments to function initialize_signature",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-228146946,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,Superceded by #85,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,83,2016-06-15T20:18:16Z,2016-06-23T18:47:46Z,2016-07-16T19:55:21Z,CLOSED,False,317,160,10,https://github.com/tmarcu,Signature verification,1,[],https://github.com/clearlinux/swupd-client/pull/83,https://github.com/bradTpeters,9,https://github.com/clearlinux/swupd-client/pull/83#issuecomment-233148023,Rebasing previous patches onto master with very minor changes to style and removing deprecated API calls.,"I suppose that's fair; I was targeting those commands described by the
swupd spec. I'll send out a v2 Monday
On Wed, Jun 15, 2016 at 8:52 PM, William Douglas notifications@github.com
wrote:

First patch has bundle-add and verify but should also have the other
commands as well (update, bundle-remove, search, check-update)

You are receiving this because you are subscribed to this thread.
Reply to this email directly, view it on GitHub
#83 (comment),
or mute the thread
https://github.com/notifications/unsubscribe/ABDgRbgu_XhwKDri442z7dWDdffMGiZnks5qMGXxgaJpZM4I2wE7
.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/84,The second commit in this series is the functional change. More details in the commit description.,The second commit in this series is the functional change. More details in the commit description.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227896165,The second commit in this series is the functional change. More details in the commit description.,New patch set uploaded.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227902297,The second commit in this series is the functional change. More details in the commit description.,Patch set no. 3 uploaded,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227902499,The second commit in this series is the functional change. More details in the commit description.,and... patch set no. 4,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227904932,The second commit in this series is the functional change. More details in the commit description.,uploaded patch set 5,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/tpepper,6,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227907666,The second commit in this series is the functional change. More details in the commit description.,lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/bradTpeters,7,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227913025,The second commit in this series is the functional change. More details in the commit description.,This looks great Patrick; nicely done,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,84,2016-06-21T20:01:52Z,2016-06-23T00:18:13Z,2016-06-28T17:57:55Z,MERGED,True,672,684,110,https://github.com/phmccarty,Implement bundle manifest hash checks,4,[],https://github.com/clearlinux/swupd-client/pull/84,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/84#issuecomment-227915299,The second commit in this series is the functional change. More details in the commit description.,"Thanks, I will merge shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,85,2016-06-23T00:26:41Z,2016-06-23T23:20:54Z,2016-06-24T17:44:04Z,CLOSED,False,374,170,10,https://github.com/tmarcu,Implement signature verification,9,[],https://github.com/clearlinux/swupd-client/pull/85,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/85,"This patch enables the swupd client to do signing verification on the MoM, which
ensures a root of trust for the rest of the update by guaranteeing the
authenticity of the MoM and content it includes.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","This patch enables the swupd client to do signing verification on the MoM, which
ensures a root of trust for the rest of the update by guaranteeing the
authenticity of the MoM and content it includes.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,85,2016-06-23T00:26:41Z,2016-06-23T23:20:54Z,2016-06-24T17:44:04Z,CLOSED,False,374,170,10,https://github.com/tmarcu,Implement signature verification,9,[],https://github.com/clearlinux/swupd-client/pull/85,https://github.com/tpepper,2,https://github.com/clearlinux/swupd-client/pull/85#issuecomment-227918650,"This patch enables the swupd client to do signing verification on the MoM, which
ensures a root of trust for the rest of the update by guaranteeing the
authenticity of the MoM and content it includes.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Can the commit say ""signature verification"" instead of ""signing verification""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,85,2016-06-23T00:26:41Z,2016-06-23T23:20:54Z,2016-06-24T17:44:04Z,CLOSED,False,374,170,10,https://github.com/tmarcu,Implement signature verification,9,[],https://github.com/clearlinux/swupd-client/pull/85,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/85#issuecomment-228119289,"This patch enables the swupd client to do signing verification on the MoM, which
ensures a root of trust for the rest of the update by guaranteeing the
authenticity of the MoM and content it includes.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",@tmarcu It seems like a second 'swupd verify' run skips the signature verification. The verify should happen every time.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,85,2016-06-23T00:26:41Z,2016-06-23T23:20:54Z,2016-06-24T17:44:04Z,CLOSED,False,374,170,10,https://github.com/tmarcu,Implement signature verification,9,[],https://github.com/clearlinux/swupd-client/pull/85,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/85#issuecomment-228214072,"This patch enables the swupd client to do signing verification on the MoM, which
ensures a root of trust for the rest of the update by guaranteeing the
authenticity of the MoM and content it includes.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",@tpepper is going to follow up with some additional changes in a few PR.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,86,2016-06-24T00:59:22Z,2016-06-27T17:36:17Z,2016-06-27T17:36:17Z,MERGED,True,424,243,13,https://github.com/tpepper,Signature verification,2,[],https://github.com/clearlinux/swupd-client/pull/86,https://github.com/tpepper,1,https://github.com/clearlinux/swupd-client/pull/86,"This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.","This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,86,2016-06-24T00:59:22Z,2016-06-27T17:36:17Z,2016-06-27T17:36:17Z,MERGED,True,424,243,13,https://github.com/tpepper,Signature verification,2,[],https://github.com/clearlinux/swupd-client/pull/86,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/86#issuecomment-228424070,"This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.","+1 from me
update: after some local testing, running into a segfault, so debugging that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,86,2016-06-24T00:59:22Z,2016-06-27T17:36:17Z,2016-06-27T17:36:17Z,MERGED,True,424,243,13,https://github.com/tpepper,Signature verification,2,[],https://github.com/clearlinux/swupd-client/pull/86,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/86#issuecomment-228427808,"This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.",Still reviewing but looking good thus far,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,86,2016-06-24T00:59:22Z,2016-06-27T17:36:17Z,2016-06-27T17:36:17Z,MERGED,True,424,243,13,https://github.com/tpepper,Signature verification,2,[],https://github.com/clearlinux/swupd-client/pull/86,https://github.com/tpepper,4,https://github.com/clearlinux/swupd-client/pull/86#issuecomment-228506693,"This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.","I moved the terminate_signature() and initialize_signature() into a new swupd_deinit() and the existing swupd_init().  I'm now able to verify, verify/fix, bundle add and bundle remove.
The pre-existing load_mom() segfault in swupd search is still there...didn't have time to look into it.  Am hoping @bradTpeters and @phmccarty made progress on it at the end of the day separately?
And I observe that bundle add/remove both have a bunch of pre-existing memory leakage...need a issue opened, run through valgrind and some thought on how to add proper memory management?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,86,2016-06-24T00:59:22Z,2016-06-27T17:36:17Z,2016-06-27T17:36:17Z,MERGED,True,424,243,13,https://github.com/tpepper,Signature verification,2,[],https://github.com/clearlinux/swupd-client/pull/86,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/86#issuecomment-228817070,"This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.","There is a minor build issue when building without signature verification enabled, so I'll push a fix for that as a followup.
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,86,2016-06-24T00:59:22Z,2016-06-27T17:36:17Z,2016-06-27T17:36:17Z,MERGED,True,424,243,13,https://github.com/tpepper,Signature verification,2,[],https://github.com/clearlinux/swupd-client/pull/86,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/86#issuecomment-228817270,"This PR represents the final working state of Tudor and I as we went through OpenSSL's poor documentation and addressed review comments from PR #85 .  The src/signature.c:verify_signature() function is an abomination, but we think we doesn't leak openssl state and valgrind is agreeing.  The code is focused now on just the MoM signature verification flow, which means some functions are now static.  The cert and cert path are now autoconf configurable.",@tpepper I'm not seeing the swupd search bug anymore. Let me know if you still see it.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,88,2016-06-27T18:39:05Z,2016-06-27T18:52:22Z,2016-06-27T18:52:22Z,MERGED,True,1,1,1,https://github.com/tpepper,don't segfault on not found MoM,1,[],https://github.com/clearlinux/swupd-client/pull/88,https://github.com/tpepper,1,https://github.com/clearlinux/swupd-client/pull/88,"If the MoM is not found on the server to match the os version on which
you're running, swupd search's MoM downloader returns 0 instead of an
error.  EMOM_NOTFOUND is a natural value to return.
When 0 is returned, the null MoM pointer is later derferenced leading to a
segfault.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com","If the MoM is not found on the server to match the os version on which
you're running, swupd search's MoM downloader returns 0 instead of an
error.  EMOM_NOTFOUND is a natural value to return.
When 0 is returned, the null MoM pointer is later derferenced leading to a
segfault.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,88,2016-06-27T18:39:05Z,2016-06-27T18:52:22Z,2016-06-27T18:52:22Z,MERGED,True,1,1,1,https://github.com/tpepper,don't segfault on not found MoM,1,[],https://github.com/clearlinux/swupd-client/pull/88,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/88#issuecomment-228837017,"If the MoM is not found on the server to match the os version on which
you're running, swupd search's MoM downloader returns 0 instead of an
error.  EMOM_NOTFOUND is a natural value to return.
When 0 is returned, the null MoM pointer is later derferenced leading to a
segfault.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com","Good find, though it's strange we're only seeing this with the new load_mom call.
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,88,2016-06-27T18:39:05Z,2016-06-27T18:52:22Z,2016-06-27T18:52:22Z,MERGED,True,1,1,1,https://github.com/tpepper,don't segfault on not found MoM,1,[],https://github.com/clearlinux/swupd-client/pull/88,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/88#issuecomment-228839623,"If the MoM is not found on the server to match the os version on which
you're running, swupd search's MoM downloader returns 0 instead of an
error.  EMOM_NOTFOUND is a natural value to return.
When 0 is returned, the null MoM pointer is later derferenced leading to a
segfault.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",Looks good,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,90,2016-06-27T19:02:24Z,2016-06-27T19:06:44Z,2016-06-28T17:57:55Z,MERGED,True,66,0,36,https://github.com/phmccarty,Ignore sigverify errors in existing tests,2,[],https://github.com/clearlinux/swupd-client/pull/90,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/90,"Because signature verification is a feature that we need separate testing for, and swupd's output may print a verification error (or not) depending on how swupd was built, add a helper function to remove the verification error message when swupd is built with verification enabled. If verification is not enabled, swupd will not print any message, and the function is a no-op.","Because signature verification is a feature that we need separate testing for, and swupd's output may print a verification error (or not) depending on how swupd was built, add a helper function to remove the verification error message when swupd is built with verification enabled. If verification is not enabled, swupd will not print any message, and the function is a no-op.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,90,2016-06-27T19:02:24Z,2016-06-27T19:06:44Z,2016-06-28T17:57:55Z,MERGED,True,66,0,36,https://github.com/phmccarty,Ignore sigverify errors in existing tests,2,[],https://github.com/clearlinux/swupd-client/pull/90,https://github.com/tpepper,2,https://github.com/clearlinux/swupd-client/pull/90#issuecomment-228843526,"Because signature verification is a feature that we need separate testing for, and swupd's output may print a verification error (or not) depending on how swupd was built, add a helper function to remove the verification error message when swupd is built with verification enabled. If verification is not enabled, swupd will not print any message, and the function is a no-op.",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/91,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/91#issuecomment-228845497,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,+1 looks good,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/tpepper,3,https://github.com/clearlinux/swupd-client/pull/91#issuecomment-228845531,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,"The commit message is lacking here.  It should include a fixes issue 89 indicator.
Except it only fixes one of the four leaks.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/91#issuecomment-228863197,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,It fixes 3 of 4; looking at the 4th now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/bradTpeters,5,https://github.com/clearlinux/swupd-client/pull/91#issuecomment-228865145,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,One additional free() added to address the 4th issue,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/tpepper,6,https://github.com/clearlinux/swupd-client/pull/91#issuecomment-228874735,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,"The latest iteration of the PR has a bunch of memory management issues:
==8919== Memcheck, a memory error detector
==8919== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.
==8919== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info
==8919== Command: /usr/local/bin/swupd search -p ./foo -F staging -u http://clearlinux-sandbox.jf.intel.com/update/ AAAAAAAAAAA
==8919== 
Attempting to download version string to memory
Searching for 'AAAAAAAAAAA'

Signature check succeeded.
==8919== Invalid read of size 8
==8919==    at 0x404923: do_search (search.c:271)
==8919==    by 0x405369: search_main (search.c:522)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919==  Address 0xa1e5d48 is 24 bytes inside a block of size 56 free'd
==8919==    at 0x4C29CF0: free (vg_replace_malloc.c:530)
==8919==    by 0x404ECD: download_manifests (search.c:472)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919==  Block was alloc'd at
==8919==    at 0x4C2A988: calloc (vg_replace_malloc.c:711)
==8919==    by 0x4E3F061: alloc_manifest (manifest.c:154)
==8919==    by 0x4E3F061: manifest_from_file (manifest.c:244)
==8919==    by 0x4E400DD: load_mom (manifest.c:597)
==8919==    by 0x404C38: download_manifests (search.c:412)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919== 
==8919== Invalid read of size 8
==8919==    at 0x4E3D1BF: verify_bundle_hash (hash.c:262)
==8919==    by 0x4E4016E: load_manifest (manifest.c:635)
==8919==    by 0x40497F: do_search (search.c:278)
==8919==    by 0x405369: search_main (search.c:522)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919==  Address 0xa1e5d48 is 24 bytes inside a block of size 56 free'd
==8919==    at 0x4C29CF0: free (vg_replace_malloc.c:530)
==8919==    by 0x404ECD: download_manifests (search.c:472)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919==  Block was alloc'd at
==8919==    at 0x4C2A988: calloc (vg_replace_malloc.c:711)
==8919==    by 0x4E3F061: alloc_manifest (manifest.c:154)
==8919==    by 0x4E3F061: manifest_from_file (manifest.c:244)
==8919==    by 0x4E400DD: load_mom (manifest.c:597)
==8919==    by 0x404C38: download_manifests (search.c:412)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919== 
==8919== Invalid read of size 8
==8919==    at 0x4E3E9D3: list_head (list.c:164)
==8919==    by 0x4E3D1C7: verify_bundle_hash (hash.c:262)
==8919==    by 0x4E4016E: load_manifest (manifest.c:635)
==8919==    by 0x40497F: do_search (search.c:278)
==8919==    by 0x405369: search_main (search.c:522)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919==  Address 0xf8 is not stack'd, malloc'd or (recently) free'd
==8919== 
==8919== 
==8919== Process terminating with default action of signal 11 (SIGSEGV)
==8919==  Access not within mapped region at address 0xF8
==8919==    at 0x4E3E9D3: list_head (list.c:164)
==8919==    by 0x4E3D1C7: verify_bundle_hash (hash.c:262)
==8919==    by 0x4E4016E: load_manifest (manifest.c:635)
==8919==    by 0x40497F: do_search (search.c:278)
==8919==    by 0x405369: search_main (search.c:522)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919==  If you believe this happened as a result of a stack
==8919==  overflow in your program's main thread (unlikely but
==8919==  possible), you can try to increase the size of the
==8919==  main thread stack using the --main-stacksize= flag.
==8919==  The main thread stack size used in this run was 8388608.
==8919== 
==8919== HEAP SUMMARY:
==8919==     in use at exit: 225,905 bytes in 4,137 blocks
==8919==   total heap usage: 319,890 allocs, 315,753 frees, 26,077,899 bytes allocated
==8919== 
==8919== 4 bytes in 1 blocks are definitely lost in loss record 8 of 871
==8919==    at 0x4C28BF6: malloc (vg_replace_malloc.c:299)
==8919==    by 0x62213D9: strdup (in /usr/lib64/libc-2.22.so)
==8919==    by 0x4E3F07A: alloc_manifest (manifest.c:160)
==8919==    by 0x4E3F07A: manifest_from_file (manifest.c:244)
==8919==    by 0x4E400DD: load_mom (manifest.c:597)
==8919==    by 0x404C38: download_manifests (search.c:412)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919== 
==8919== 1,181 bytes in 22 blocks are definitely lost in loss record 841 of 871
==8919==    at 0x4C2AB8B: realloc (vg_replace_malloc.c:785)
==8919==    by 0x62AAB1C: __vasprintf_chk (in /usr/lib64/libc-2.22.so)
==8919==    by 0x4E3D43E: vasprintf (stdio2.h:210)
==8919==    by 0x4E3D43E: string_or_die (helpers.c:651)
==8919==    by 0x404CCB: query_total_download_size (search.c:364)
==8919==    by 0x404CCB: download_manifests (search.c:421)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919== 
==8919== 4,690 bytes in 110 blocks are definitely lost in loss record 867 of 871
==8919==    at 0x4C28BF6: malloc (vg_replace_malloc.c:299)
==8919==    by 0x62AAB47: __vasprintf_chk (in /usr/lib64/libc-2.22.so)
==8919==    by 0x4E3D43E: vasprintf (stdio2.h:210)
==8919==    by 0x4E3D43E: string_or_die (helpers.c:651)
==8919==    by 0x404CCB: query_total_download_size (search.c:364)
==8919==    by 0x404CCB: download_manifests (search.c:421)
==8919==    by 0x4052BA: search_main (search.c:502)
==8919==    by 0x61B757F: (below main) (in /usr/lib64/libc-2.22.so)
==8919== 
==8919== LEAK SUMMARY:
==8919==    definitely lost: 5,875 bytes in 133 blocks
==8919==    indirectly lost: 0 bytes in 0 blocks
==8919==      possibly lost: 0 bytes in 0 blocks
==8919==    still reachable: 220,030 bytes in 4,004 blocks
==8919==         suppressed: 0 bytes in 0 blocks
==8919== Reachable blocks (those to which a pointer was found) are not shown.
==8919== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==8919== 
==8919== For counts of detected and suppressed errors, rerun with: -v
==8919== ERROR SUMMARY: 18 errors from 6 contexts (suppressed: 0 from 0)
Segmentation fault",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,91,2016-06-27T19:10:14Z,2016-08-02T20:35:23Z,2016-08-02T20:35:23Z,CLOSED,False,0,0,0,https://github.com/bradTpeters,Fix memleak in query_total_download_size(),0,[],https://github.com/clearlinux/swupd-client/pull/91,https://github.com/bradTpeters,7,https://github.com/clearlinux/swupd-client/pull/91#issuecomment-228876233,Signed-off-by: Brad T. Peters brad.t.peters@intel.com,"Just added a fix for the original 3 or 4 leaks; I'll look into the above regressions more tomorrow; spent the wkend getting over a bug, and it seems I'm not quite fully over it",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,92,2016-06-28T20:15:29Z,2016-07-01T22:00:10Z,2016-07-01T22:00:19Z,CLOSED,False,83,86,1,https://github.com/phmccarty,Try local signature verification first before downloading,1,[],https://github.com/clearlinux/swupd-client/pull/92,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/92,"In case the Manifest.MoM.sig already exists locally (e.g. it was shipped
inside the Manifest.MoM.tar), then try to verify the local copy first.
If the verify fails because the .sig is missing, or for any other
reason, then download a fresh copy from the server.
For the implementation, I refactored verify_signature() to not print
error messages if the verification fails the first time, because we
""retry"" by downloading the fresh copy. If the verification fails the
second time, then error messages are printed. Also, I consolidated the
cleanup logic in this function to reduce duplication.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","In case the Manifest.MoM.sig already exists locally (e.g. it was shipped
inside the Manifest.MoM.tar), then try to verify the local copy first.
If the verify fails because the .sig is missing, or for any other
reason, then download a fresh copy from the server.
For the implementation, I refactored verify_signature() to not print
error messages if the verification fails the first time, because we
""retry"" by downloading the fresh copy. If the verification fails the
second time, then error messages are printed. Also, I consolidated the
cleanup logic in this function to reduce duplication.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,92,2016-06-28T20:15:29Z,2016-07-01T22:00:10Z,2016-07-01T22:00:19Z,CLOSED,False,83,86,1,https://github.com/phmccarty,Try local signature verification first before downloading,1,[],https://github.com/clearlinux/swupd-client/pull/92,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/92#issuecomment-230044690,"In case the Manifest.MoM.sig already exists locally (e.g. it was shipped
inside the Manifest.MoM.tar), then try to verify the local copy first.
If the verify fails because the .sig is missing, or for any other
reason, then download a fresh copy from the server.
For the implementation, I refactored verify_signature() to not print
error messages if the verification fails the first time, because we
""retry"" by downloading the fresh copy. If the verification fails the
second time, then error messages are printed. Also, I consolidated the
cleanup logic in this function to reduce duplication.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Uploaded patch set 2,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,92,2016-06-28T20:15:29Z,2016-07-01T22:00:10Z,2016-07-01T22:00:19Z,CLOSED,False,83,86,1,https://github.com/phmccarty,Try local signature verification first before downloading,1,[],https://github.com/clearlinux/swupd-client/pull/92,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/92#issuecomment-230050135,"In case the Manifest.MoM.sig already exists locally (e.g. it was shipped
inside the Manifest.MoM.tar), then try to verify the local copy first.
If the verify fails because the .sig is missing, or for any other
reason, then download a fresh copy from the server.
For the implementation, I refactored verify_signature() to not print
error messages if the verification fails the first time, because we
""retry"" by downloading the fresh copy. If the verification fails the
second time, then error messages are printed. Also, I consolidated the
cleanup logic in this function to reduce duplication.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","New flow and retry looks good.  +1, other than my one comment",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,92,2016-06-28T20:15:29Z,2016-07-01T22:00:10Z,2016-07-01T22:00:19Z,CLOSED,False,83,86,1,https://github.com/phmccarty,Try local signature verification first before downloading,1,[],https://github.com/clearlinux/swupd-client/pull/92,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/92#issuecomment-230056442,"In case the Manifest.MoM.sig already exists locally (e.g. it was shipped
inside the Manifest.MoM.tar), then try to verify the local copy first.
If the verify fails because the .sig is missing, or for any other
reason, then download a fresh copy from the server.
For the implementation, I refactored verify_signature() to not print
error messages if the verification fails the first time, because we
""retry"" by downloading the fresh copy. If the verification fails the
second time, then error messages are printed. Also, I consolidated the
cleanup logic in this function to reduce duplication.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","Cool, will merge shortly",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,92,2016-06-28T20:15:29Z,2016-07-01T22:00:10Z,2016-07-01T22:00:19Z,CLOSED,False,83,86,1,https://github.com/phmccarty,Try local signature verification first before downloading,1,[],https://github.com/clearlinux/swupd-client/pull/92,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/92#issuecomment-230056733,"In case the Manifest.MoM.sig already exists locally (e.g. it was shipped
inside the Manifest.MoM.tar), then try to verify the local copy first.
If the verify fails because the .sig is missing, or for any other
reason, then download a fresh copy from the server.
For the implementation, I refactored verify_signature() to not print
error messages if the verification fails the first time, because we
""retry"" by downloading the fresh copy. If the verification fails the
second time, then error messages are printed. Also, I consolidated the
cleanup logic in this function to reduce duplication.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Rebased and merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,93,2016-07-14T17:02:56Z,2016-08-23T19:59:28Z,2016-08-23T19:59:28Z,CLOSED,False,1,0,1,https://github.com/fandeli,Warn about bundle not installed when running bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/93,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/93,"In the case when trying to remove the non existing bundle
first warn about that fact, then fail with an error.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com","In the case when trying to remove the non existing bundle
first warn about that fact, then fail with an error.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,93,2016-07-14T17:02:56Z,2016-08-23T19:59:28Z,2016-08-23T19:59:28Z,CLOSED,False,1,0,1,https://github.com/fandeli,Warn about bundle not installed when running bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/93,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/93#issuecomment-232769213,"In the case when trying to remove the non existing bundle
first warn about that fact, then fail with an error.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,93,2016-07-14T17:02:56Z,2016-08-23T19:59:28Z,2016-08-23T19:59:28Z,CLOSED,False,1,0,1,https://github.com/fandeli,Warn about bundle not installed when running bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/93,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/93#issuecomment-233052576,"In the case when trying to remove the non existing bundle
first warn about that fact, then fail with an error.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,93,2016-07-14T17:02:56Z,2016-08-23T19:59:28Z,2016-08-23T19:59:28Z,CLOSED,False,1,0,1,https://github.com/fandeli,Warn about bundle not installed when running bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/93,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/93#issuecomment-235411014,"In the case when trying to remove the non existing bundle
first warn about that fact, then fail with an error.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,93,2016-07-14T17:02:56Z,2016-08-23T19:59:28Z,2016-08-23T19:59:28Z,CLOSED,False,1,0,1,https://github.com/fandeli,Warn about bundle not installed when running bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/93,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/93#issuecomment-241857416,"In the case when trying to remove the non existing bundle
first warn about that fact, then fail with an error.
Signed-off-by: Jaime A. Garcia jaime.garcia.naranjo@intel.com",Merged +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,96,2016-07-19T00:26:09Z,2016-07-19T17:51:38Z,2016-07-19T17:51:38Z,CLOSED,False,43,6,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,1,[],https://github.com/clearlinux/swupd-client/pull/96,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/96,"Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,97,2016-07-19T17:52:23Z,2016-07-19T20:27:55Z,2016-07-20T07:44:45Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,2,[],https://github.com/clearlinux/swupd-client/pull/97,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/97,"Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,97,2016-07-19T17:52:23Z,2016-07-19T20:27:55Z,2016-07-20T07:44:45Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,2,[],https://github.com/clearlinux/swupd-client/pull/97,https://github.com/tpepper,2,https://github.com/clearlinux/swupd-client/pull/97#issuecomment-233746898,"Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Suggest commit message begin with the following slight edit:
Move swupd signature verification to mandatory.  Failed
signature verification now aborts 'swupd' commands.
Their operation may be forced to proceed past the signature
verification if the following flag is passed in:
...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,97,2016-07-19T17:52:23Z,2016-07-19T20:27:55Z,2016-07-20T07:44:45Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,2,[],https://github.com/clearlinux/swupd-client/pull/97,https://github.com/tpepper,3,https://github.com/clearlinux/swupd-client/pull/97#issuecomment-233748647,"Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Aside from the minor comments above, looks good to me.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,97,2016-07-19T17:52:23Z,2016-07-19T20:27:55Z,2016-07-20T07:44:45Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,2,[],https://github.com/clearlinux/swupd-client/pull/97,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/97#issuecomment-233755293,"Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",I'll close and open a new PR incorporating your commit msg change,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,97,2016-07-19T17:52:23Z,2016-07-19T20:27:55Z,2016-07-20T07:44:45Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,2,[],https://github.com/clearlinux/swupd-client/pull/97,https://github.com/pohly,5,https://github.com/clearlinux/swupd-client/pull/97#issuecomment-233869058,"Moves swupd signature verification to mandatory, where
the operation will not proceed unless the following flag
is passed in:
--force-continue-with-unverified-signature
The signed MoM serves as the top level chain of trust as
far as swupd is concerned, and it is used to extend content
trust down to the individual file level.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","@bradTpeters not sure how you guys normally handle it, but usually it is better to force-push a rewritten commit to the same branch while the PR is open. Then the existing PR will get updated and all comments related to the change stay in one place, instead of getting scattered among different PRs.
One of the Github quirks is that it doesn't allow reopening the PR after a force-push. So it's too later for this PR here (bradTpeters:mandatory_sig_ver already updated). New PR is #98.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,98,2016-07-19T20:28:45Z,2016-08-31T22:18:20Z,2016-08-31T22:18:21Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Mandatory sig ver,2,[],https://github.com/clearlinux/swupd-client/pull/98,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/98,New PR incorporating Tim's input,New PR incorporating Tim's input,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,98,2016-07-19T20:28:45Z,2016-08-31T22:18:20Z,2016-08-31T22:18:21Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Mandatory sig ver,2,[],https://github.com/clearlinux/swupd-client/pull/98,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/98#issuecomment-233755790,New PR incorporating Tim's input,"Do not actually merge this yet, this patch is provided just for review",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,98,2016-07-19T20:28:45Z,2016-08-31T22:18:20Z,2016-08-31T22:18:21Z,CLOSED,False,41,6,8,https://github.com/bradTpeters,Mandatory sig ver,2,[],https://github.com/clearlinux/swupd-client/pull/98,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/98#issuecomment-243920093,New PR incorporating Tim's input,Closing this and re-opening with a highly modified version,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,99,2016-07-25T17:22:17Z,2016-08-23T19:59:20Z,2016-08-23T19:59:20Z,CLOSED,False,3,3,2,https://github.com/tpepper,TLS comment clarification,2,[],https://github.com/clearlinux/swupd-client/pull/99,https://github.com/tpepper,1,https://github.com/clearlinux/swupd-client/pull/99,"The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com","The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,99,2016-07-25T17:22:17Z,2016-08-23T19:59:20Z,2016-08-23T19:59:20Z,CLOSED,False,3,3,2,https://github.com/tpepper,TLS comment clarification,2,[],https://github.com/clearlinux/swupd-client/pull/99,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/99#issuecomment-235062256,"The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,99,2016-07-25T17:22:17Z,2016-08-23T19:59:20Z,2016-08-23T19:59:20Z,CLOSED,False,3,3,2,https://github.com/tpepper,TLS comment clarification,2,[],https://github.com/clearlinux/swupd-client/pull/99,https://github.com/tpepper,3,https://github.com/clearlinux/swupd-client/pull/99#issuecomment-235356723,"The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",An additional little patch for something I've seen this past week:  there's no version number in bundle manifest hash mismatch printf.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,99,2016-07-25T17:22:17Z,2016-08-23T19:59:20Z,2016-08-23T19:59:20Z,CLOSED,False,3,3,2,https://github.com/tpepper,TLS comment clarification,2,[],https://github.com/clearlinux/swupd-client/pull/99,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/99#issuecomment-235358448,"The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",Good idea! +1 on the second patch.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,99,2016-07-25T17:22:17Z,2016-08-23T19:59:20Z,2016-08-23T19:59:20Z,CLOSED,False,3,3,2,https://github.com/tpepper,TLS comment clarification,2,[],https://github.com/clearlinux/swupd-client/pull/99,https://github.com/bradTpeters,5,https://github.com/clearlinux/swupd-client/pull/99#issuecomment-235410798,"The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",+1 for both changes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,99,2016-07-25T17:22:17Z,2016-08-23T19:59:20Z,2016-08-23T19:59:20Z,CLOSED,False,3,3,2,https://github.com/tpepper,TLS comment clarification,2,[],https://github.com/clearlinux/swupd-client/pull/99,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/99#issuecomment-241857388,"The issue with TLS versions is on the server side.  The client
must specify which version to use, but that version must be
supported by the server.  And sadly the server world is often
running old OS's with old libraries and daemons.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",Merged +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/100,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/100#issuecomment-235370068,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","This looks great Patrick! Ran it through a quick test run as well
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/tpepper,3,https://github.com/clearlinux/swupd-client/pull/100#issuecomment-235385041,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Nice simple way to get some additional useful info!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/100#issuecomment-235410011,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","One comment - Here's sample output:

swupd-client swupd 3.6.0
Copyright (C) 2012-2016 Intel Corporation
Compile-time options: +BZIP2 +SIGVERIFY -COVERAGE -BSDTAR

It would probably be preferable to have the copyright appear first, followed by version and compile time options",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/100#issuecomment-238332721,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",@bradTpeters I had not considered reordering the lines. I do like that copyright statement being printed first.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/100#issuecomment-238334899,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","@bradTpeters On second thought, I just invoked a few GNU tools with --version, and they all print the program name and version info first, followed by the copyright statement. So, it's ""common"" to see the ordering swupd currently uses.
Maybe we could remove the blank line? It seems unnecessary.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,100,2016-07-26T18:08:53Z,2016-08-23T19:59:13Z,2016-09-06T22:56:37Z,CLOSED,False,58,0,2,https://github.com/phmccarty,Print some build-time options in --version output,1,[],https://github.com/clearlinux/swupd-client/pull/100,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/100#issuecomment-241857343,"To make compile-time options more easily discoverable at runtime, make
the --version output more verbose by printing a few of them. Other
options can be easily added in the future by adding an appropriate
AC_DEFINE call in configure.ac, and updating the new header added in
this commit (swupd-build-opts.h).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Merged +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,102,2016-08-01T17:30:28Z,2016-08-22T23:32:09Z,2016-08-22T23:32:09Z,CLOSED,False,2,0,1,https://github.com/fenrus75,Enable HTTP/2 protocol as option,1,[],https://github.com/clearlinux/swupd-client/pull/102,https://github.com/fenrus75,1,https://github.com/clearlinux/swupd-client/pull/102,"Allow curl to use the HTTP/2 protocol, with an automatic fallback to
HTTP/1.1.
Because of the optional nature, there's also no strict error handling
performed, if requesting HTTP/2 fails it fails.... and we get HTTP/1.1.","Allow curl to use the HTTP/2 protocol, with an automatic fallback to
HTTP/1.1.
Because of the optional nature, there's also no strict error handling
performed, if requesting HTTP/2 fails it fails.... and we get HTTP/1.1.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,102,2016-08-01T17:30:28Z,2016-08-22T23:32:09Z,2016-08-22T23:32:09Z,CLOSED,False,2,0,1,https://github.com/fenrus75,Enable HTTP/2 protocol as option,1,[],https://github.com/clearlinux/swupd-client/pull/102,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/102#issuecomment-237080097,"Allow curl to use the HTTP/2 protocol, with an automatic fallback to
HTTP/1.1.
Because of the optional nature, there's also no strict error handling
performed, if requesting HTTP/2 fails it fails.... and we get HTTP/1.1.","I see you are correct -  curl/lib/http.c, use_http_1_1plus():  does indeed default to 1.1 if NONE is set
Change looks good to me
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,102,2016-08-01T17:30:28Z,2016-08-22T23:32:09Z,2016-08-22T23:32:09Z,CLOSED,False,2,0,1,https://github.com/fenrus75,Enable HTTP/2 protocol as option,1,[],https://github.com/clearlinux/swupd-client/pull/102,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/102#issuecomment-237614346,"Allow curl to use the HTTP/2 protocol, with an automatic fallback to
HTTP/1.1.
Because of the optional nature, there's also no strict error handling
performed, if requesting HTTP/2 fails it fails.... and we get HTTP/1.1.","+1 lgtm, do you have any thoughts on using CURL_HTTP_VERSION_2TLS in the future?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,102,2016-08-01T17:30:28Z,2016-08-22T23:32:09Z,2016-08-22T23:32:09Z,CLOSED,False,2,0,1,https://github.com/fenrus75,Enable HTTP/2 protocol as option,1,[],https://github.com/clearlinux/swupd-client/pull/102,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/102#issuecomment-241582920,"Allow curl to use the HTTP/2 protocol, with an automatic fallback to
HTTP/1.1.
Because of the optional nature, there's also no strict error handling
performed, if requesting HTTP/2 fails it fails.... and we get HTTP/1.1.",Merged into master.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,103,2016-08-02T20:42:32Z,2017-05-11T21:27:28Z,2017-05-11T21:27:28Z,CLOSED,False,111,20,5,https://github.com/bradTpeters,Enospace,3,[],https://github.com/clearlinux/swupd-client/pull/103,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/103,"Series of 3 patches which 1) refactor a minimalist download list prior to acting, 2) add a pre-bundle(s)-add test for sufficient space, and 3) pay attention to download return codes to ensure a bundle-add does not proceed if download fails","Series of 3 patches which 1) refactor a minimalist download list prior to acting, 2) add a pre-bundle(s)-add test for sufficient space, and 3) pay attention to download return codes to ensure a bundle-add does not proceed if download fails",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,103,2016-08-02T20:42:32Z,2017-05-11T21:27:28Z,2017-05-11T21:27:28Z,CLOSED,False,111,20,5,https://github.com/bradTpeters,Enospace,3,[],https://github.com/clearlinux/swupd-client/pull/103,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/103#issuecomment-300921851,"Series of 3 patches which 1) refactor a minimalist download list prior to acting, 2) add a pre-bundle(s)-add test for sufficient space, and 3) pay attention to download return codes to ensure a bundle-add does not proceed if download fails",Closing and tracking for future work when logic can be reconsidered to cover the system constraints better.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,104,2016-08-08T17:59:36Z,2016-08-24T01:04:20Z,2016-08-24T01:34:09Z,CLOSED,False,1,0,1,https://github.com/pdxjohnny,Add free on file not found in get_current_version,1,[],https://github.com/clearlinux/swupd-client/pull/104,https://github.com/pdxjohnny,1,https://github.com/clearlinux/swupd-client/pull/104,Signed-off-by: John Andersen john.s.andersen@intel.com,Signed-off-by: John Andersen john.s.andersen@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,104,2016-08-08T17:59:36Z,2016-08-24T01:04:20Z,2016-08-24T01:34:09Z,CLOSED,False,1,0,1,https://github.com/pdxjohnny,Add free on file not found in get_current_version,1,[],https://github.com/clearlinux/swupd-client/pull/104,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/104#issuecomment-238324791,Signed-off-by: John Andersen john.s.andersen@intel.com,+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,104,2016-08-08T17:59:36Z,2016-08-24T01:04:20Z,2016-08-24T01:34:09Z,CLOSED,False,1,0,1,https://github.com/pdxjohnny,Add free on file not found in get_current_version,1,[],https://github.com/clearlinux/swupd-client/pull/104,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/104#issuecomment-241928816,Signed-off-by: John Andersen john.s.andersen@intel.com,"Merged into master 2698a7a, but in the future working in a branch makes it much easier to merge changes on this end.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,104,2016-08-08T17:59:36Z,2016-08-24T01:04:20Z,2016-08-24T01:34:09Z,CLOSED,False,1,0,1,https://github.com/pdxjohnny,Add free on file not found in get_current_version,1,[],https://github.com/clearlinux/swupd-client/pull/104,https://github.com/pdxjohnny,4,https://github.com/clearlinux/swupd-client/pull/104#issuecomment-241933066,Signed-off-by: John Andersen john.s.andersen@intel.com,Good to know :-) I'll do that next time,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/106,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/106#issuecomment-239036756,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Modified to use the AS_IF macro, avoiding the --without-X issue Patrick mentioned",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/106#issuecomment-239299893,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Latest adds support for the AC_ARG_ENABLE macro's as well,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/106#issuecomment-239332051,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Third try's a charm?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/bradTpeters,5,https://github.com/clearlinux/swupd-client/pull/106#issuecomment-240170561,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Patrick no +1? Did you have more feedback?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/106#issuecomment-240181194,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","No, I forgot to comment.
+1 from me on this latest revision.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,106,2016-08-09T18:43:24Z,2016-08-23T23:48:19Z,2016-08-23T23:48:19Z,CLOSED,False,98,6,2,https://github.com/bradTpeters,Add configure.ac support for state dir options,1,[],https://github.com/clearlinux/swupd-client/pull/106,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/106#issuecomment-241917266,"Add configuration support for contenturl, versionurl, and formatid.
The order or preference for state config options is now:

swupd cmdline: -u or -v options passed to the specific command
./configure: --with-contenturl=, --with-versionurl=, or --with-formatid=
Fall back to the defaults provided in /usr/share/defaults/swupd

While adding these new configure options, this patch also adds a report
out from the configure script, showing selected options
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Merged 38839b8,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,107,2016-08-11T17:39:27Z,2016-08-23T23:27:31Z,2016-09-06T22:56:34Z,CLOSED,False,1,1,1,https://github.com/phmccarty,Improve output for miscellaneous curl errors,1,[],https://github.com/clearlinux/swupd-client/pull/107,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/107,"Because libcurl has many different error codes, referring the end user
to curl.h is not ideal for the errors swupd does not handle explicitly.
Instead, call curl_easy_strerror() to print a generic error string as
indicated by the error code.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","Because libcurl has many different error codes, referring the end user
to curl.h is not ideal for the errors swupd does not handle explicitly.
Instead, call curl_easy_strerror() to print a generic error string as
indicated by the error code.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,107,2016-08-11T17:39:27Z,2016-08-23T23:27:31Z,2016-09-06T22:56:34Z,CLOSED,False,1,1,1,https://github.com/phmccarty,Improve output for miscellaneous curl errors,1,[],https://github.com/clearlinux/swupd-client/pull/107,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/107#issuecomment-241580725,"Because libcurl has many different error codes, referring the end user
to curl.h is not ideal for the errors swupd does not handle explicitly.
Instead, call curl_easy_strerror() to print a generic error string as
indicated by the error code.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,107,2016-08-11T17:39:27Z,2016-08-23T23:27:31Z,2016-09-06T22:56:34Z,CLOSED,False,1,1,1,https://github.com/phmccarty,Improve output for miscellaneous curl errors,1,[],https://github.com/clearlinux/swupd-client/pull/107,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/107#issuecomment-241912122,"Because libcurl has many different error codes, referring the end user
to curl.h is not ideal for the errors swupd does not handle explicitly.
Instead, call curl_easy_strerror() to print a generic error string as
indicated by the error code.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Merged into master de2ef70,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,108,2016-08-12T18:06:01Z,2016-08-23T20:21:27Z,2016-09-06T22:56:34Z,CLOSED,False,8,7,3,https://github.com/phmccarty,Cleanups for certificate verification failure path,4,[],https://github.com/clearlinux/swupd-client/pull/108,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/108,"This path series addresses several issues: two double free issues that lead to segfaults, two memory leaks, and an issue with error handling in swupd_init().","This path series addresses several issues: two double free issues that lead to segfaults, two memory leaks, and an issue with error handling in swupd_init().",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,108,2016-08-12T18:06:01Z,2016-08-23T20:21:27Z,2016-09-06T22:56:34Z,CLOSED,False,8,7,3,https://github.com/phmccarty,Cleanups for certificate verification failure path,4,[],https://github.com/clearlinux/swupd-client/pull/108,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/108#issuecomment-241864408,"This path series addresses several issues: two double free issues that lead to segfaults, two memory leaks, and an issue with error handling in swupd_init().",All but the last patch has been merged. I'll open a new PR with the corrected patch.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,109,2016-08-15T22:23:24Z,2016-08-15T22:55:35Z,2016-09-06T22:56:33Z,MERGED,True,46,54,48,https://github.com/phmccarty,Fix functional tests for breaking changes,1,[],https://github.com/clearlinux/swupd-client/pull/109,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/109,"To two latest commits introduce breaking changes to the updater, so the
static server content needs to be refreshed.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","To two latest commits introduce breaking changes to the updater, so the
static server content needs to be refreshed.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,110,2016-08-16T09:03:29Z,2016-11-11T18:53:10Z,2016-11-11T18:53:10Z,CLOSED,False,18,1,4,https://github.com/rojkov,Make pinned pubkey configurable,1,[],https://github.com/clearlinux/swupd-client/pull/110,https://github.com/rojkov,1,https://github.com/clearlinux/swupd-client/pull/110,"The server may move to a new location where a different pubkey
needs to be used.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com","The server may move to a new location where a different pubkey
needs to be used.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,110,2016-08-16T09:03:29Z,2016-11-11T18:53:10Z,2016-11-11T18:53:10Z,CLOSED,False,18,1,4,https://github.com/rojkov,Make pinned pubkey configurable,1,[],https://github.com/clearlinux/swupd-client/pull/110,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/110#issuecomment-260028052,"The server may move to a new location where a different pubkey
needs to be used.
Signed-off-by: Dmitry Rozhkov dmitry.rozhkov@linux.intel.com",Removing certificate pinning from swupd in order to support the move to a CDN.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,111,2016-08-18T18:16:03Z,2016-08-23T23:32:57Z,2016-08-23T23:32:57Z,CLOSED,False,0,2,1,https://github.com/bradTpeters,Fix fp_pubkey double free,1,[],https://github.com/clearlinux/swupd-client/pull/111,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/111,"Fix double-free which happens when loading a key fails. This patch
ensures fp_pubkey cleanup only happens in terminate_signature().
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Fix double-free which happens when loading a key fails. This patch
ensures fp_pubkey cleanup only happens in terminate_signature().
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,111,2016-08-18T18:16:03Z,2016-08-23T23:32:57Z,2016-08-23T23:32:57Z,CLOSED,False,0,2,1,https://github.com/bradTpeters,Fix fp_pubkey double free,1,[],https://github.com/clearlinux/swupd-client/pull/111,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/111#issuecomment-240809537,"Fix double-free which happens when loading a key fails. This patch
ensures fp_pubkey cleanup only happens in terminate_signature().
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",This should be applied after Patrick's double free patch set,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,111,2016-08-18T18:16:03Z,2016-08-23T23:32:57Z,2016-08-23T23:32:57Z,CLOSED,False,0,2,1,https://github.com/bradTpeters,Fix fp_pubkey double free,1,[],https://github.com/clearlinux/swupd-client/pull/111,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/111#issuecomment-240841132,"Fix double-free which happens when loading a key fails. This patch
ensures fp_pubkey cleanup only happens in terminate_signature().
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","This solution would work okay. Or, setting fp_pubkey to NULL after fclose() is called in both of these spots would also work.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,111,2016-08-18T18:16:03Z,2016-08-23T23:32:57Z,2016-08-23T23:32:57Z,CLOSED,False,0,2,1,https://github.com/bradTpeters,Fix fp_pubkey double free,1,[],https://github.com/clearlinux/swupd-client/pull/111,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/111#issuecomment-240842000,"Fix double-free which happens when loading a key fails. This patch
ensures fp_pubkey cleanup only happens in terminate_signature().
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1 will merge after following format bump.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,111,2016-08-18T18:16:03Z,2016-08-23T23:32:57Z,2016-08-23T23:32:57Z,CLOSED,False,0,2,1,https://github.com/bradTpeters,Fix fp_pubkey double free,1,[],https://github.com/clearlinux/swupd-client/pull/111,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/111#issuecomment-241913301,"Fix double-free which happens when loading a key fails. This patch
ensures fp_pubkey cleanup only happens in terminate_signature().
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Merged into master 4a303e3,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,112,2016-08-22T17:16:04Z,2016-08-23T23:35:09Z,2016-08-23T23:35:09Z,CLOSED,False,2,10,1,https://github.com/sofar,Simplify branch code in hash_needs_work.,1,[],https://github.com/clearlinux/swupd-client/pull/112,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/112,"These simple branches can be expressed in simply 1 line instead
of 5, without comprimising legibility.","These simple branches can be expressed in simply 1 line instead
of 5, without comprimising legibility.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,112,2016-08-22T17:16:04Z,2016-08-23T23:35:09Z,2016-08-23T23:35:09Z,CLOSED,False,2,10,1,https://github.com/sofar,Simplify branch code in hash_needs_work.,1,[],https://github.com/clearlinux/swupd-client/pull/112,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/112#issuecomment-241498402,"These simple branches can be expressed in simply 1 line instead
of 5, without comprimising legibility.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,112,2016-08-22T17:16:04Z,2016-08-23T23:35:09Z,2016-08-23T23:35:09Z,CLOSED,False,2,10,1,https://github.com/sofar,Simplify branch code in hash_needs_work.,1,[],https://github.com/clearlinux/swupd-client/pull/112,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/112#issuecomment-241913775,"These simple branches can be expressed in simply 1 line instead
of 5, without comprimising legibility.",Merged into master 7ae10e2,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,113,2016-08-22T17:20:09Z,2016-08-24T00:25:41Z,2016-08-24T00:25:41Z,CLOSED,False,1,5,1,https://github.com/sofar,Text book implementation of `remove()`.,1,[],https://github.com/clearlinux/swupd-client/pull/113,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/113,"The definition of remove(2) is exactly this implementation,
so this can be shortened.","The definition of remove(2) is exactly this implementation,
so this can be shortened.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,113,2016-08-22T17:20:09Z,2016-08-24T00:25:41Z,2016-08-24T00:25:41Z,CLOSED,False,1,5,1,https://github.com/sofar,Text book implementation of `remove()`.,1,[],https://github.com/clearlinux/swupd-client/pull/113,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/113#issuecomment-241499026,"The definition of remove(2) is exactly this implementation,
so this can be shortened.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,113,2016-08-22T17:20:09Z,2016-08-24T00:25:41Z,2016-08-24T00:25:41Z,CLOSED,False,1,5,1,https://github.com/sofar,Text book implementation of `remove()`.,1,[],https://github.com/clearlinux/swupd-client/pull/113,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/113#issuecomment-241923290,"The definition of remove(2) is exactly this implementation,
so this can be shortened.",Merged into master 3cde6ff,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,114,2016-08-22T17:36:22Z,2016-08-24T00:28:53Z,2016-08-24T00:29:32Z,CLOSED,False,48,62,2,https://github.com/sofar,Statistics: inline counter increments.,1,[],https://github.com/clearlinux/swupd-client/pull/114,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/114,"This is a negligable performance increase and more of a cleanup
of symbol space. In order for these to inline, we need the stats
to be exported instead, so we go from 8+1 exports to 1+1.","This is a negligable performance increase and more of a cleanup
of symbol space. In order for these to inline, we need the stats
to be exported instead, so we go from 8+1 exports to 1+1.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,114,2016-08-22T17:36:22Z,2016-08-24T00:28:53Z,2016-08-24T00:29:32Z,CLOSED,False,48,62,2,https://github.com/sofar,Statistics: inline counter increments.,1,[],https://github.com/clearlinux/swupd-client/pull/114,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/114#issuecomment-241501796,"This is a negligable performance increase and more of a cleanup
of symbol space. In order for these to inline, we need the stats
to be exported instead, so we go from 8+1 exports to 1+1.",Updated with Patrick's comment addressed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,114,2016-08-22T17:36:22Z,2016-08-24T00:28:53Z,2016-08-24T00:29:32Z,CLOSED,False,48,62,2,https://github.com/sofar,Statistics: inline counter increments.,1,[],https://github.com/clearlinux/swupd-client/pull/114,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/114#issuecomment-241502331,"This is a negligable performance increase and more of a cleanup
of symbol space. In order for these to inline, we need the stats
to be exported instead, so we go from 8+1 exports to 1+1.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,114,2016-08-22T17:36:22Z,2016-08-24T00:28:53Z,2016-08-24T00:29:32Z,CLOSED,False,48,62,2,https://github.com/sofar,Statistics: inline counter increments.,1,[],https://github.com/clearlinux/swupd-client/pull/114,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/114#issuecomment-241923761,"This is a negligable performance increase and more of a cleanup
of symbol space. In order for these to inline, we need the stats
to be exported instead, so we go from 8+1 exports to 1+1.",Merged into master b8c6335,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,115,2016-08-22T18:00:42Z,2016-08-24T00:44:21Z,2016-08-24T00:44:21Z,CLOSED,False,17,21,5,https://github.com/sofar,Namespace cleanup: make functions/vars static.,1,[],https://github.com/clearlinux/swupd-client/pull/115,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/115,"Remaining hits by findstatic.pl are public API functions and
dangling statistic increments (but those last are fixed by the
PR cleaning up the stats, so they can be ignored for this PR).","Remaining hits by findstatic.pl are public API functions and
dangling statistic increments (but those last are fixed by the
PR cleaning up the stats, so they can be ignored for this PR).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,115,2016-08-22T18:00:42Z,2016-08-24T00:44:21Z,2016-08-24T00:44:21Z,CLOSED,False,17,21,5,https://github.com/sofar,Namespace cleanup: make functions/vars static.,1,[],https://github.com/clearlinux/swupd-client/pull/115,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/115#issuecomment-241499917,"Remaining hits by findstatic.pl are public API functions and
dangling statistic increments (but those last are fixed by the
PR cleaning up the stats, so they can be ignored for this PR).",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,115,2016-08-22T18:00:42Z,2016-08-24T00:44:21Z,2016-08-24T00:44:21Z,CLOSED,False,17,21,5,https://github.com/sofar,Namespace cleanup: make functions/vars static.,1,[],https://github.com/clearlinux/swupd-client/pull/115,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/115#issuecomment-241926059,"Remaining hits by findstatic.pl are public API functions and
dangling statistic increments (but those last are fixed by the
PR cleaning up the stats, so they can be ignored for this PR).",Merged into master 76c5686,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,116,2016-08-22T23:21:20Z,2016-08-22T23:24:14Z,2016-08-22T23:24:14Z,CLOSED,False,1,3,1,https://github.com/sofar,Unconditionally remove file after download if errors.,1,[],https://github.com/clearlinux/swupd-client/pull/116,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/116,"We've created the convention that zero-sized packs are ""already
processed"" earlier and don't need to be re-downloaded. However,
if we have an unlikely failure that Curl created a zero-length
file, but was unable to write any bytes output to it (due to
e.g. network connection failure), then we'd leave a zero-sized
pack file on the system, potentially causing a redownload attempt
to skip all further re-downloads.
Ergo, we should always remove zero-sized pack files if any error
happened.","We've created the convention that zero-sized packs are ""already
processed"" earlier and don't need to be re-downloaded. However,
if we have an unlikely failure that Curl created a zero-length
file, but was unable to write any bytes output to it (due to
e.g. network connection failure), then we'd leave a zero-sized
pack file on the system, potentially causing a redownload attempt
to skip all further re-downloads.
Ergo, we should always remove zero-sized pack files if any error
happened.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,116,2016-08-22T23:21:20Z,2016-08-22T23:24:14Z,2016-08-22T23:24:14Z,CLOSED,False,1,3,1,https://github.com/sofar,Unconditionally remove file after download if errors.,1,[],https://github.com/clearlinux/swupd-client/pull/116,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/116#issuecomment-241581415,"We've created the convention that zero-sized packs are ""already
processed"" earlier and don't need to be re-downloaded. However,
if we have an unlikely failure that Curl created a zero-length
file, but was unable to write any bytes output to it (due to
e.g. network connection failure), then we'd leave a zero-sized
pack file on the system, potentially causing a redownload attempt
to skip all further re-downloads.
Ergo, we should always remove zero-sized pack files if any error
happened.","Ignore this, I need to think this over some more.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,117,2016-08-23T20:23:33Z,2016-08-23T20:26:14Z,2016-09-06T22:56:25Z,CLOSED,False,4,0,1,https://github.com/phmccarty,Fix a memory leak,1,[],https://github.com/clearlinux/swupd-client/pull/117,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/117,"X509_STORE_CTX_free() is being called in the ""verify success"" path, but
not in the error path.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","X509_STORE_CTX_free() is being called in the ""verify success"" path, but
not in the error path.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,117,2016-08-23T20:23:33Z,2016-08-23T20:26:14Z,2016-09-06T22:56:25Z,CLOSED,False,4,0,1,https://github.com/phmccarty,Fix a memory leak,1,[],https://github.com/clearlinux/swupd-client/pull/117,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/117#issuecomment-241866296,"X509_STORE_CTX_free() is being called in the ""verify success"" path, but
not in the error path.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1 Merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,118,2016-08-23T21:54:37Z,2016-08-23T22:17:49Z,2016-08-23T22:17:49Z,CLOSED,False,8,5,1,https://github.com/sofar,"Do not mark a pack file as ""downloaded and extracted"" on tar error.",1,[],https://github.com/clearlinux/swupd-client/pull/118,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/118,"Because this code did not ever look at the return value of
tar, it is possible that a download succeeded to download
something (possibly a bad file on the server, etc.) properly,
and tar then failed to extract it (possible local problems
with disk space, a random memory failure, etc.).
When this condition happens, we should never leave an empty
pack file on the system, since we're sure that there was an
error extracting it, and the best course of action is to
either re-download it or download individual files. Of course,
the latter is likely going to happen anyway.","Because this code did not ever look at the return value of
tar, it is possible that a download succeeded to download
something (possibly a bad file on the server, etc.) properly,
and tar then failed to extract it (possible local problems
with disk space, a random memory failure, etc.).
When this condition happens, we should never leave an empty
pack file on the system, since we're sure that there was an
error extracting it, and the best course of action is to
either re-download it or download individual files. Of course,
the latter is likely going to happen anyway.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,118,2016-08-23T21:54:37Z,2016-08-23T22:17:49Z,2016-08-23T22:17:49Z,CLOSED,False,8,5,1,https://github.com/sofar,"Do not mark a pack file as ""downloaded and extracted"" on tar error.",1,[],https://github.com/clearlinux/swupd-client/pull/118,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/118#issuecomment-241895128,"Because this code did not ever look at the return value of
tar, it is possible that a download succeeded to download
something (possibly a bad file on the server, etc.) properly,
and tar then failed to extract it (possible local problems
with disk space, a random memory failure, etc.).
When this condition happens, we should never leave an empty
pack file on the system, since we're sure that there was an
error extracting it, and the best course of action is to
either re-download it or download individual files. Of course,
the latter is likely going to happen anyway.","This change would cause the client to try and redownload bad server content (which shouldn't exist but given that this is the curl didn't get an error path...) and since these are packs, likely large amounts server content. The previous behavior would short circuit the redownload because even though there was an error returned and the file is queued to redownload, the download function would early return due to the zero length tar file being present.
After the pack download section the individual files would be downloaded to work around the bad packs.
I'd prefer to keep that behavior but add comments to make it clear the reason behind the current logic.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,118,2016-08-23T21:54:37Z,2016-08-23T22:17:49Z,2016-08-23T22:17:49Z,CLOSED,False,8,5,1,https://github.com/sofar,"Do not mark a pack file as ""downloaded and extracted"" on tar error.",1,[],https://github.com/clearlinux/swupd-client/pull/118,https://github.com/sofar,3,https://github.com/clearlinux/swupd-client/pull/118#issuecomment-241896105,"Because this code did not ever look at the return value of
tar, it is possible that a download succeeded to download
something (possibly a bad file on the server, etc.) properly,
and tar then failed to extract it (possible local problems
with disk space, a random memory failure, etc.).
When this condition happens, we should never leave an empty
pack file on the system, since we're sure that there was an
error extracting it, and the best course of action is to
either re-download it or download individual files. Of course,
the latter is likely going to happen anyway.","Would it retry the download in this pass or in next passes?
If it retries in the next pass, then that is sensible, after all, if we do have a problem on the server (it's serving badly encoded data for instance) we will fix it, increasing the likelyhood that it will be proper content.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,118,2016-08-23T21:54:37Z,2016-08-23T22:17:49Z,2016-08-23T22:17:49Z,CLOSED,False,8,5,1,https://github.com/sofar,"Do not mark a pack file as ""downloaded and extracted"" on tar error.",1,[],https://github.com/clearlinux/swupd-client/pull/118,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/118#issuecomment-241897854,"Because this code did not ever look at the return value of
tar, it is possible that a download succeeded to download
something (possibly a bad file on the server, etc.) properly,
and tar then failed to extract it (possible local problems
with disk space, a random memory failure, etc.).
When this condition happens, we should never leave an empty
pack file on the system, since we're sure that there was an
error extracting it, and the best course of action is to
either re-download it or download individual files. Of course,
the latter is likely going to happen anyway.",It will retry in the next pass but I don't think that helps since the fix would need to be done in a very small window (a few minutes at the longest) of first getting the tar error for it to make a difference for the end user running into a bad pack. The user is just as likely to have a faster experience skipping the pack redownload entirely and going to full files than hoping we fix the pack just as they are seeing the issue.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,118,2016-08-23T21:54:37Z,2016-08-23T22:17:49Z,2016-08-23T22:17:49Z,CLOSED,False,8,5,1,https://github.com/sofar,"Do not mark a pack file as ""downloaded and extracted"" on tar error.",1,[],https://github.com/clearlinux/swupd-client/pull/118,https://github.com/sofar,5,https://github.com/clearlinux/swupd-client/pull/118#issuecomment-241898250,"Because this code did not ever look at the return value of
tar, it is possible that a download succeeded to download
something (possibly a bad file on the server, etc.) properly,
and tar then failed to extract it (possible local problems
with disk space, a random memory failure, etc.).
When this condition happens, we should never leave an empty
pack file on the system, since we're sure that there was an
error extracting it, and the best course of action is to
either re-download it or download individual files. Of course,
the latter is likely going to happen anyway.","Alright then, closing this.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,119,2016-08-24T20:11:05Z,2016-08-24T23:25:02Z,2016-08-24T23:25:20Z,MERGED,True,16,7,4,https://github.com/tpepper,Memmgmt,2,[],https://github.com/clearlinux/swupd-client/pull/119,https://github.com/tpepper,1,https://github.com/clearlinux/swupd-client/pull/119,Issue #87 and issue #89 should be addressed by the two commits here.,Issue #87 and issue #89 should be addressed by the two commits here.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,119,2016-08-24T20:11:05Z,2016-08-24T23:25:02Z,2016-08-24T23:25:20Z,MERGED,True,16,7,4,https://github.com/tpepper,Memmgmt,2,[],https://github.com/clearlinux/swupd-client/pull/119,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/119#issuecomment-242238946,Issue #87 and issue #89 should be addressed by the two commits here.,+1 merged fe0a91e,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,120,2016-08-25T17:49:09Z,2016-08-30T23:11:03Z,2016-08-30T23:11:03Z,CLOSED,False,1,2,1,https://github.com/tpepper,enable TLS1.2,1,[],https://github.com/clearlinux/swupd-client/pull/120,https://github.com/tpepper,1,https://github.com/clearlinux/swupd-client/pull/120,"All servers should support this for a long time now.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com","All servers should support this for a long time now.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,120,2016-08-25T17:49:09Z,2016-08-30T23:11:03Z,2016-08-30T23:11:03Z,CLOSED,False,1,2,1,https://github.com/tpepper,enable TLS1.2,1,[],https://github.com/clearlinux/swupd-client/pull/120,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/120#issuecomment-243610517,"All servers should support this for a long time now.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",Merged into master efa04d4.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/122,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243535988,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",This is still v1 of the explaination; awaiting input from @bryteise,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243565390,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Updated commit msg as per @bryteise input,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243592573,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","In commit message, second paragraph, ""update the update"" should be ""the update"".",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243593093,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Also for the commit message: third paragraph, s/client/current/, to reduce ambiguity.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/bradTpeters,6,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243593293,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243593393,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1 on the code change,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/bradTpeters,8,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243593836,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",s/client/current/ done,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/phmccarty,9,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243594152,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Great, +1 from me on the commit description updates.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/bryteise,10,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243598241,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,122,2016-08-30T18:32:54Z,2016-08-30T22:33:56Z,2016-08-30T22:33:56Z,CLOSED,False,6,1,1,https://github.com/bradTpeters,Fix update failure during new bundle include,1,[],https://github.com/clearlinux/swupd-client/pull/122,https://github.com/tmarcu,11,https://github.com/clearlinux/swupd-client/pull/122#issuecomment-243603096,"When a new bundle was added as an included bundle from a previously installed
bundle, files in the new bundle were not getting properly installed. This was due to last_change
pointing at to old an entry, and swupd assuming the file was already installed.
This patch ensures last_change points at the more recent, tracked last_changed
entry, and the new file(s) gets installed
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Merged into master 9fc6729.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,123,2016-08-31T22:19:09Z,2016-08-31T22:46:55Z,2016-08-31T22:46:56Z,CLOSED,False,83,12,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,1,[],https://github.com/clearlinux/swupd-client/pull/123,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/123,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When a client-side
files hash is found to differ from that expected given by the MoM,
we will abort or fix, as described:

During Update: Any sig or hash failure: Report and abort. Can be forced.
During Verify: Any sig or hash failure: Warn
During Verify fix: Any sig or hash failure: Autofix

Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When a client-side
files hash is found to differ from that expected given by the MoM,
we will abort or fix, as described:

During Update: Any sig or hash failure: Report and abort. Can be forced.
During Verify: Any sig or hash failure: Warn
During Verify fix: Any sig or hash failure: Autofix

Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,123,2016-08-31T22:19:09Z,2016-08-31T22:46:55Z,2016-08-31T22:46:56Z,CLOSED,False,83,12,8,https://github.com/bradTpeters,Move sign/verify to abort on failure,1,[],https://github.com/clearlinux/swupd-client/pull/123,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/123#issuecomment-243920681,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When a client-side
files hash is found to differ from that expected given by the MoM,
we will abort or fix, as described:

During Update: Any sig or hash failure: Report and abort. Can be forced.
During Verify: Any sig or hash failure: Warn
During Verify fix: Any sig or hash failure: Autofix

Signed-off-by: Brad T. Peters brad.t.peters@intel.com","This new pull request is rebased on recent patches, and modified from the previous PR.
As discussed face to face, I am seeing a strange failure case in which, on verify with a invalid cert, I see a double free with the following. Currently investigating, insights welcome:
Failed PEM_read_X509() for /usr/share/clear/update-ca/ClearLinuxRoot.pem
139941999204120:error:0D07207B:asn1 encoding routines:ASN1_get_object:header too long:asn1_lib.c:157:
139941999204120:error:0D068066:asn1 encoding routines:ASN1_CHECK_TLEN:bad object header:tasn_dec.c:1185:
139941999204120:error:0D07803A:asn1 encoding routines:ASN1_ITEM_EX_D2I:nested asn1 error:tasn_dec.c:374:Type=X509
139941999204120:error:0906700D:PEM routines:PEM_ASN1_read_bio:ASN1 lib:pem_oth.c:83:
Failed to load valid certificate. Attempting to proceed
Verifying version 10170
Attempting to download version string to memory
Curl error: Out of memory
Error: Network issue, unable to download manifest
*** Error in `/home/swupd-client.1496.move2mandatory/.libs/lt-swupd': double free or corruption (top): 0x00000000009f1e20 ***",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,124,2016-08-31T23:12:19Z,2016-09-01T22:39:01Z,2016-09-06T23:13:35Z,CLOSED,False,89,16,6,https://github.com/bradTpeters,Mandatory sig,1,[],https://github.com/clearlinux/swupd-client/pull/124,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/124,"Resolve double fclose; Still seeing curl OOM error, attempting to resolve","Resolve double fclose; Still seeing curl OOM error, attempting to resolve",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,124,2016-08-31T23:12:19Z,2016-09-01T22:39:01Z,2016-09-06T23:13:35Z,CLOSED,False,89,16,6,https://github.com/bradTpeters,Mandatory sig,1,[],https://github.com/clearlinux/swupd-client/pull/124,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/124#issuecomment-244234030,"Resolve double fclose; Still seeing curl OOM error, attempting to resolve","Closing this PR. The desired behavior has changed, so this patch is out of date.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,125,2016-09-01T21:53:15Z,2016-09-13T18:12:59Z,2016-09-13T18:13:00Z,CLOSED,False,47,4,1,https://github.com/sofar,Recover from missing or bad bundle manifests files.,1,[],https://github.com/clearlinux/swupd-client/pull/125,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/125,"This addresses #94.
We can't verify that bundles are correct if a bundle manifest we need is missign or corrupted.
We first check if these files are missing, and download them before verifying them.
If they are present or have just been downloaded, we can verify the hash checksum. If this fails to verify, we immediately erase the bad file and return an error code.
Because the overlying routines properly do retries, we'll get back to the start of this routine again and download the proper bundle manifest file, completing the recovery.","This addresses #94.
We can't verify that bundles are correct if a bundle manifest we need is missign or corrupted.
We first check if these files are missing, and download them before verifying them.
If they are present or have just been downloaded, we can verify the hash checksum. If this fails to verify, we immediately erase the bad file and return an error code.
Because the overlying routines properly do retries, we'll get back to the start of this routine again and download the proper bundle manifest file, completing the recovery.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,125,2016-09-01T21:53:15Z,2016-09-13T18:12:59Z,2016-09-13T18:13:00Z,CLOSED,False,47,4,1,https://github.com/sofar,Recover from missing or bad bundle manifests files.,1,[],https://github.com/clearlinux/swupd-client/pull/125,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/125#issuecomment-246772248,"This addresses #94.
We can't verify that bundles are correct if a bundle manifest we need is missign or corrupted.
We first check if these files are missing, and download them before verifying them.
If they are present or have just been downloaded, we can verify the hash checksum. If this fails to verify, we immediately erase the bad file and return an error code.
Because the overlying routines properly do retries, we'll get back to the start of this routine again and download the proper bundle manifest file, completing the recovery.",This PR was merged a few days ago (commit ba4f800).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,126,2016-09-01T22:58:29Z,2016-09-14T18:37:47Z,2016-10-29T00:04:05Z,MERGED,True,0,11,1,https://github.com/phmccarty,Remove unused function,1,[],https://github.com/clearlinux/swupd-client/pull/126,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/126,"A recent commit removed the declaration for this function in swupd.h,
and now the compiler warns about it being unused, so the function can be
removed entirely now.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","A recent commit removed the declaration for this function in swupd.h,
and now the compiler warns about it being unused, so the function can be
removed entirely now.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,126,2016-09-01T22:58:29Z,2016-09-14T18:37:47Z,2016-10-29T00:04:05Z,MERGED,True,0,11,1,https://github.com/phmccarty,Remove unused function,1,[],https://github.com/clearlinux/swupd-client/pull/126,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/126#issuecomment-247112414,"A recent commit removed the declaration for this function in swupd.h,
and now the compiler warns about it being unused, so the function can be
removed entirely now.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",lol,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,127,2016-09-02T00:23:05Z,2016-09-02T20:47:49Z,2016-09-30T22:00:17Z,MERGED,True,163,0,1,https://github.com/tmarcu,Add certificate signature validation script,1,[],https://github.com/clearlinux/swupd-client/pull/127,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/127,"This script checks that a give data file and signature verify correctly against
a certificate. Without introducing fuzzing, this covers all (8) combinations of
valid and invalid files that may occur, and corrupts them in the more often
seen ways, such as a partially downloaded Manifest, or a wrong signature file.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","This script checks that a give data file and signature verify correctly against
a certificate. Without introducing fuzzing, this covers all (8) combinations of
valid and invalid files that may occur, and corrupts them in the more often
seen ways, such as a partially downloaded Manifest, or a wrong signature file.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,127,2016-09-02T00:23:05Z,2016-09-02T20:47:49Z,2016-09-30T22:00:17Z,MERGED,True,163,0,1,https://github.com/tmarcu,Add certificate signature validation script,1,[],https://github.com/clearlinux/swupd-client/pull/127,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/127#issuecomment-244443777,"This script checks that a give data file and signature verify correctly against
a certificate. Without introducing fuzzing, this covers all (8) combinations of
valid and invalid files that may occur, and corrupts them in the more often
seen ways, such as a partially downloaded Manifest, or a wrong signature file.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,127,2016-09-02T00:23:05Z,2016-09-02T20:47:49Z,2016-09-30T22:00:17Z,MERGED,True,163,0,1,https://github.com/tmarcu,Add certificate signature validation script,1,[],https://github.com/clearlinux/swupd-client/pull/127,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/127#issuecomment-244483718,"This script checks that a give data file and signature verify correctly against
a certificate. Without introducing fuzzing, this covers all (8) combinations of
valid and invalid files that may occur, and corrupts them in the more often
seen ways, such as a partially downloaded Manifest, or a wrong signature file.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",Merged 33a0fcb,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,128,2016-09-02T20:38:46Z,2016-09-30T22:11:53Z,2016-10-29T00:03:59Z,CLOSED,False,228,0,32,https://github.com/phmccarty,Add missing update include test,1,[],https://github.com/clearlinux/swupd-client/pull/128,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/128,"This is a functional test for the fix implemented in #122.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","This is a functional test for the fix implemented in #122.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,128,2016-09-02T20:38:46Z,2016-09-30T22:11:53Z,2016-10-29T00:03:59Z,CLOSED,False,228,0,32,https://github.com/phmccarty,Add missing update include test,1,[],https://github.com/clearlinux/swupd-client/pull/128,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/128#issuecomment-250864377,"This is a functional test for the fix implemented in #122.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Merged 285c18c,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,129,2016-09-06T23:16:39Z,2016-10-01T01:19:37Z,2016-10-01T01:19:37Z,CLOSED,False,24,2,5,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/129,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/129,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,129,2016-09-06T23:16:39Z,2016-10-01T01:19:37Z,2016-10-01T01:19:37Z,CLOSED,False,24,2,5,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/129,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/129#issuecomment-245125789,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",This v3 implementation is actually far smaller than the prior patch; retaining the same behavior for all subcommands really simplified the logic.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,129,2016-09-06T23:16:39Z,2016-10-01T01:19:37Z,2016-10-01T01:19:37Z,CLOSED,False,24,2,5,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/129,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/129#issuecomment-245125938,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","A follow-on patch, which I'm working on, will add retry logic, but that will be an independent patch",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,129,2016-09-06T23:16:39Z,2016-10-01T01:19:37Z,2016-10-01T01:19:37Z,CLOSED,False,24,2,5,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/129,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/129#issuecomment-245128526,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Thanks Patrick - updated accordingly,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,129,2016-09-06T23:16:39Z,2016-10-01T01:19:37Z,2016-10-01T01:19:37Z,CLOSED,False,24,2,5,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/129,https://github.com/tpepper,5,https://github.com/clearlinux/swupd-client/pull/129#issuecomment-245378934,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Definitely like the simplification, even if getting there meant some churn.  We're in a better place.
Can you run the code through valgrind for a positive and negative signature?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,129,2016-09-06T23:16:39Z,2016-10-01T01:19:37Z,2016-10-01T01:19:37Z,CLOSED,False,24,2,5,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/129,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/129#issuecomment-250883915,"Moves swupd signature verification to mandatory, though --force
is supported in some cases, described here:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--force will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
--force has no effect
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Brad's v4 patch is tracked in #140,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,130,2016-09-07T00:56:50Z,2016-09-07T01:29:09Z,2016-10-29T00:03:58Z,MERGED,True,1,1,1,https://github.com/phmccarty,Fix swupd operations when curl is not HTTP2-enabled,1,[],https://github.com/clearlinux/swupd-client/pull/130,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/130,"To support running swupd on distros without an HTTP2-enabled curl
package, explicitly check for the ""unsupported protocol"" error, returned
by libcurl in this event.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","To support running swupd on distros without an HTTP2-enabled curl
package, explicitly check for the ""unsupported protocol"" error, returned
by libcurl in this event.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,130,2016-09-07T00:56:50Z,2016-09-07T01:29:09Z,2016-10-29T00:03:58Z,MERGED,True,1,1,1,https://github.com/phmccarty,Fix swupd operations when curl is not HTTP2-enabled,1,[],https://github.com/clearlinux/swupd-client/pull/130,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/130#issuecomment-245143306,"To support running swupd on distros without an HTTP2-enabled curl
package, explicitly check for the ""unsupported protocol"" error, returned
by libcurl in this event.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","This fixes running the test suite on Arch Linux, and also works okay on Clear Linux.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,130,2016-09-07T00:56:50Z,2016-09-07T01:29:09Z,2016-10-29T00:03:58Z,MERGED,True,1,1,1,https://github.com/phmccarty,Fix swupd operations when curl is not HTTP2-enabled,1,[],https://github.com/clearlinux/swupd-client/pull/130,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/130#issuecomment-245148201,"To support running swupd on distros without an HTTP2-enabled curl
package, explicitly check for the ""unsupported protocol"" error, returned
by libcurl in this event.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1 Merged f442666,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,131,2016-09-07T19:30:05Z,2016-10-01T00:08:02Z,2016-10-29T00:03:46Z,CLOSED,False,29,22,4,https://github.com/phmccarty,Hashdump cleanups,3,[],https://github.com/clearlinux/swupd-client/pull/131,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/131,"This patch series includes some changes to the 'hashdump' subcommand. Namely, I renamed its -b option to -p for consistency with the other subcommands, and I reworked the tool to allow relative pathnames.","This patch series includes some changes to the 'hashdump' subcommand. Namely, I renamed its -b option to -p for consistency with the other subcommands, and I reworked the tool to allow relative pathnames.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,131,2016-09-07T19:30:05Z,2016-10-01T00:08:02Z,2016-10-29T00:03:46Z,CLOSED,False,29,22,4,https://github.com/phmccarty,Hashdump cleanups,3,[],https://github.com/clearlinux/swupd-client/pull/131,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/131#issuecomment-250865864,"This patch series includes some changes to the 'hashdump' subcommand. Namely, I renamed its -b option to -p for consistency with the other subcommands, and I reworked the tool to allow relative pathnames.",Merged 2b3af5a,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,131,2016-09-07T19:30:05Z,2016-10-01T00:08:02Z,2016-10-29T00:03:46Z,CLOSED,False,29,22,4,https://github.com/phmccarty,Hashdump cleanups,3,[],https://github.com/clearlinux/swupd-client/pull/131,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/131#issuecomment-250866351,"This patch series includes some changes to the 'hashdump' subcommand. Namely, I renamed its -b option to -p for consistency with the other subcommands, and I reworked the tool to allow relative pathnames.","This is a series of three commits, but I only see the last commit in master. Reopening.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,131,2016-09-07T19:30:05Z,2016-10-01T00:08:02Z,2016-10-29T00:03:46Z,CLOSED,False,29,22,4,https://github.com/phmccarty,Hashdump cleanups,3,[],https://github.com/clearlinux/swupd-client/pull/131,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/131#issuecomment-250878858,"This patch series includes some changes to the 'hashdump' subcommand. Namely, I renamed its -b option to -p for consistency with the other subcommands, and I reworked the tool to allow relative pathnames.","+1, mistake merging on my part, they are all correctly merged into master now: fc1556 and c427c1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,132,2016-09-07T22:43:31Z,2016-09-28T18:00:39Z,2016-09-28T18:00:39Z,CLOSED,False,53,31,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/132,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/132,"Updates the order of preference for content_url, version_url
and formate_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Updates the order of preference for content_url, version_url
and formate_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,132,2016-09-07T22:43:31Z,2016-09-28T18:00:39Z,2016-09-28T18:00:39Z,CLOSED,False,53,31,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/132,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/132#issuecomment-246770928,"Updates the order of preference for content_url, version_url
and formate_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","In the commit description, ""formate_string"" should be ""format_string"".",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,132,2016-09-07T22:43:31Z,2016-09-28T18:00:39Z,2016-09-28T18:00:39Z,CLOSED,False,53,31,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/132,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/132#issuecomment-250028066,"Updates the order of preference for content_url, version_url
and formate_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",New PR at #138,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,133,2016-09-08T19:22:57Z,2016-10-01T01:17:41Z,2016-10-29T00:03:45Z,CLOSED,False,76,24,1,https://github.com/phmccarty,Fix hysteresis logic for fullfile downloads,1,[],https://github.com/clearlinux/swupd-client/pull/133,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/133,"This is a first pass at properly enforcing the hysteresis for the fullfile downloads. Some initial testing looks promising, so I'm opening this PR now for early feedback.","This is a first pass at properly enforcing the hysteresis for the fullfile downloads. Some initial testing looks promising, so I'm opening this PR now for early feedback.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,133,2016-09-08T19:22:57Z,2016-10-01T01:17:41Z,2016-10-29T00:03:45Z,CLOSED,False,76,24,1,https://github.com/phmccarty,Fix hysteresis logic for fullfile downloads,1,[],https://github.com/clearlinux/swupd-client/pull/133,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/133#issuecomment-245780493,"This is a first pass at properly enforcing the hysteresis for the fullfile downloads. Some initial testing looks promising, so I'm opening this PR now for early feedback.","For reference, I have a hysteresis-debug branch in my forked repo for debugging the hysteresis behavior.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,133,2016-09-08T19:22:57Z,2016-10-01T01:17:41Z,2016-10-29T00:03:45Z,CLOSED,False,76,24,1,https://github.com/phmccarty,Fix hysteresis logic for fullfile downloads,1,[],https://github.com/clearlinux/swupd-client/pull/133,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/133#issuecomment-250336842,"This is a first pass at properly enforcing the hysteresis for the fullfile downloads. Some initial testing looks promising, so I'm opening this PR now for early feedback.","Uploaded patch set 2, addressing Brad's comments.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,133,2016-09-08T19:22:57Z,2016-10-01T01:17:41Z,2016-10-29T00:03:45Z,CLOSED,False,76,24,1,https://github.com/phmccarty,Fix hysteresis logic for fullfile downloads,1,[],https://github.com/clearlinux/swupd-client/pull/133,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/133#issuecomment-250840411,"This is a first pass at properly enforcing the hysteresis for the fullfile downloads. Some initial testing looks promising, so I'm opening this PR now for early feedback.","I tested this patch a few more times in the past couple of days, and everything looks okay to me. In fact, I'm seeing some performance gain for fullfile downloads with this patch compared to current master.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,133,2016-09-08T19:22:57Z,2016-10-01T01:17:41Z,2016-10-29T00:03:45Z,CLOSED,False,76,24,1,https://github.com/phmccarty,Fix hysteresis logic for fullfile downloads,1,[],https://github.com/clearlinux/swupd-client/pull/133,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/133#issuecomment-250883807,"This is a first pass at properly enforcing the hysteresis for the fullfile downloads. Some initial testing looks promising, so I'm opening this PR now for early feedback.",@tmarcu merged this change (commit 981e053),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,134,2016-09-13T17:27:00Z,2016-09-30T21:31:25Z,2016-09-30T21:41:38Z,CLOSED,False,5,2,1,https://github.com/sofar,Make remove() error messages correct and useful.,1,[],https://github.com/clearlinux/swupd-client/pull/134,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/134,"We do not want to print this message if there was no file to begin
with, so check that errno isn't ENOENT.
We also want to print strerror(errno) instead of a code, and last,
we want to print the right filename here as well.
This is due to commit f06bcdb.
We should seriously consider also reverting that commit, as there
is almost no value in these error messages.","We do not want to print this message if there was no file to begin
with, so check that errno isn't ENOENT.
We also want to print strerror(errno) instead of a code, and last,
we want to print the right filename here as well.
This is due to commit f06bcdb.
We should seriously consider also reverting that commit, as there
is almost no value in these error messages.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,134,2016-09-13T17:27:00Z,2016-09-30T21:31:25Z,2016-09-30T21:41:38Z,CLOSED,False,5,2,1,https://github.com/sofar,Make remove() error messages correct and useful.,1,[],https://github.com/clearlinux/swupd-client/pull/134,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/134#issuecomment-246761528,"We do not want to print this message if there was no file to begin
with, so check that errno isn't ENOENT.
We also want to print strerror(errno) instead of a code, and last,
we want to print the right filename here as well.
This is due to commit f06bcdb.
We should seriously consider also reverting that commit, as there
is almost no value in these error messages.","I am in favor of reverting f06bcdb, mainly because unlink_all_staged_content() was intended to be called speculatively, ignoring any errors that may arise from removing the content.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,134,2016-09-13T17:27:00Z,2016-09-30T21:31:25Z,2016-09-30T21:41:38Z,CLOSED,False,5,2,1,https://github.com/sofar,Make remove() error messages correct and useful.,1,[],https://github.com/clearlinux/swupd-client/pull/134,https://github.com/sofar,3,https://github.com/clearlinux/swupd-client/pull/134#issuecomment-249914745,"We do not want to print this message if there was no file to begin
with, so check that errno isn't ENOENT.
We also want to print strerror(errno) instead of a code, and last,
we want to print the right filename here as well.
This is due to commit f06bcdb.
We should seriously consider also reverting that commit, as there
is almost no value in these error messages.","@tmarcu I'm OK with reverting as well. If you end up doing the revert, just close this one.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,134,2016-09-13T17:27:00Z,2016-09-30T21:31:25Z,2016-09-30T21:41:38Z,CLOSED,False,5,2,1,https://github.com/sofar,Make remove() error messages correct and useful.,1,[],https://github.com/clearlinux/swupd-client/pull/134,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/134#issuecomment-250857192,"We do not want to print this message if there was no file to begin
with, so check that errno isn't ENOENT.
We also want to print strerror(errno) instead of a code, and last,
we want to print the right filename here as well.
This is due to commit f06bcdb.
We should seriously consider also reverting that commit, as there
is almost no value in these error messages.",Reverting and voiding the call so we can ignore the output in this function.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,134,2016-09-13T17:27:00Z,2016-09-30T21:31:25Z,2016-09-30T21:41:38Z,CLOSED,False,5,2,1,https://github.com/sofar,Make remove() error messages correct and useful.,1,[],https://github.com/clearlinux/swupd-client/pull/134,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/134#issuecomment-250859132,"We do not want to print this message if there was no file to begin
with, so check that errno isn't ENOENT.
We also want to print strerror(errno) instead of a code, and last,
we want to print the right filename here as well.
This is due to commit f06bcdb.
We should seriously consider also reverting that commit, as there
is almost no value in these error messages.",07fc972,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,135,2016-09-13T18:10:58Z,2016-10-19T00:53:14Z,2016-10-19T00:53:14Z,MERGED,True,24,15,1,https://github.com/sofar,"Stop using readdir_r, switch to recommended readdir() instead.",1,[],https://github.com/clearlinux/swupd-client/pull/135,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/135,"Man 3 readdir_r states: ""This function is deprecated; use readdir(3)
instead.""
Further, it also reads:
*  In the current POSIX.1 specification (POSIX.1-2008), readdir(3) is
   not required to be thread-safe.  However, in modern
   implementations (including the glibc implementation), concurrent
   calls to readdir(3) that specify different directory streams are
   thread-safe.  Therefore, the use of readdir_r() is generally
   unnecessary in multithreaded programs.  In cases where multiple
   threads must read from the same directory stream, using readdir(3)
   with external synchronization is still preferable to the use of
   readdir_r(), for the reasons given in the points above.

I don't expect swupd-client to be used with anything other than
glibc at this moment, and I don't see that the current code is
unsafely being used in multithreaded code, so we should avoid
using the deprecated interface.","Man 3 readdir_r states: ""This function is deprecated; use readdir(3)
instead.""
Further, it also reads:
*  In the current POSIX.1 specification (POSIX.1-2008), readdir(3) is
   not required to be thread-safe.  However, in modern
   implementations (including the glibc implementation), concurrent
   calls to readdir(3) that specify different directory streams are
   thread-safe.  Therefore, the use of readdir_r() is generally
   unnecessary in multithreaded programs.  In cases where multiple
   threads must read from the same directory stream, using readdir(3)
   with external synchronization is still preferable to the use of
   readdir_r(), for the reasons given in the points above.

I don't expect swupd-client to be used with anything other than
glibc at this moment, and I don't see that the current code is
unsafely being used in multithreaded code, so we should avoid
using the deprecated interface.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,135,2016-09-13T18:10:58Z,2016-10-19T00:53:14Z,2016-10-19T00:53:14Z,MERGED,True,24,15,1,https://github.com/sofar,"Stop using readdir_r, switch to recommended readdir() instead.",1,[],https://github.com/clearlinux/swupd-client/pull/135,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/135#issuecomment-246771666,"Man 3 readdir_r states: ""This function is deprecated; use readdir(3)
instead.""
Further, it also reads:
*  In the current POSIX.1 specification (POSIX.1-2008), readdir(3) is
   not required to be thread-safe.  However, in modern
   implementations (including the glibc implementation), concurrent
   calls to readdir(3) that specify different directory streams are
   thread-safe.  Therefore, the use of readdir_r() is generally
   unnecessary in multithreaded programs.  In cases where multiple
   threads must read from the same directory stream, using readdir(3)
   with external synchronization is still preferable to the use of
   readdir_r(), for the reasons given in the points above.

I don't expect swupd-client to be used with anything other than
glibc at this moment, and I don't see that the current code is
unsafely being used in multithreaded code, so we should avoid
using the deprecated interface.",Needs testing.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,135,2016-09-13T18:10:58Z,2016-10-19T00:53:14Z,2016-10-19T00:53:14Z,MERGED,True,24,15,1,https://github.com/sofar,"Stop using readdir_r, switch to recommended readdir() instead.",1,[],https://github.com/clearlinux/swupd-client/pull/135,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/135#issuecomment-254266570,"Man 3 readdir_r states: ""This function is deprecated; use readdir(3)
instead.""
Further, it also reads:
*  In the current POSIX.1 specification (POSIX.1-2008), readdir(3) is
   not required to be thread-safe.  However, in modern
   implementations (including the glibc implementation), concurrent
   calls to readdir(3) that specify different directory streams are
   thread-safe.  Therefore, the use of readdir_r() is generally
   unnecessary in multithreaded programs.  In cases where multiple
   threads must read from the same directory stream, using readdir(3)
   with external synchronization is still preferable to the use of
   readdir_r(), for the reasons given in the points above.

I don't expect swupd-client to be used with anything other than
glibc at this moment, and I don't see that the current code is
unsafely being used in multithreaded code, so we should avoid
using the deprecated interface.",Aside from the comments I agree with the change. Even in a multithreaded mode swupd shouldn't have threads accessing the same dir.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,135,2016-09-13T18:10:58Z,2016-10-19T00:53:14Z,2016-10-19T00:53:14Z,MERGED,True,24,15,1,https://github.com/sofar,"Stop using readdir_r, switch to recommended readdir() instead.",1,[],https://github.com/clearlinux/swupd-client/pull/135,https://github.com/sofar,4,https://github.com/clearlinux/swupd-client/pull/135#issuecomment-254320746,"Man 3 readdir_r states: ""This function is deprecated; use readdir(3)
instead.""
Further, it also reads:
*  In the current POSIX.1 specification (POSIX.1-2008), readdir(3) is
   not required to be thread-safe.  However, in modern
   implementations (including the glibc implementation), concurrent
   calls to readdir(3) that specify different directory streams are
   thread-safe.  Therefore, the use of readdir_r() is generally
   unnecessary in multithreaded programs.  In cases where multiple
   threads must read from the same directory stream, using readdir(3)
   with external synchronization is still preferable to the use of
   readdir_r(), for the reasons given in the points above.

I don't expect swupd-client to be used with anything other than
glibc at this moment, and I don't see that the current code is
unsafely being used in multithreaded code, so we should avoid
using the deprecated interface.",Updated - made the changes to ret as requested.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,136,2016-09-14T18:32:27Z,2016-09-14T18:38:10Z,2016-09-14T18:38:10Z,CLOSED,False,0,11,1,https://github.com/sofar,Remove fopen_exclusive() - dead code.,1,[],https://github.com/clearlinux/swupd-client/pull/136,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/136,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,136,2016-09-14T18:32:27Z,2016-09-14T18:38:10Z,2016-09-14T18:38:10Z,CLOSED,False,0,11,1,https://github.com/sofar,Remove fopen_exclusive() - dead code.,1,[],https://github.com/clearlinux/swupd-client/pull/136,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/136#issuecomment-247112114,,Duplicate of #126 :-),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,136,2016-09-14T18:32:27Z,2016-09-14T18:38:10Z,2016-09-14T18:38:10Z,CLOSED,False,0,11,1,https://github.com/sofar,Remove fopen_exclusive() - dead code.,1,[],https://github.com/clearlinux/swupd-client/pull/136,https://github.com/sofar,3,https://github.com/clearlinux/swupd-client/pull/136#issuecomment-247112849,,Merged #126,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,137,2016-09-15T19:39:07Z,2016-10-01T00:03:40Z,2016-10-01T00:03:40Z,CLOSED,False,0,1,1,https://github.com/sofar,Don't print signature check result if OK.,1,[],https://github.com/clearlinux/swupd-client/pull/137,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/137,"This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.","This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,137,2016-09-15T19:39:07Z,2016-10-01T00:03:40Z,2016-10-01T00:03:40Z,CLOSED,False,0,1,1,https://github.com/sofar,Don't print signature check result if OK.,1,[],https://github.com/clearlinux/swupd-client/pull/137,https://github.com/bradTpeters,2,https://github.com/clearlinux/swupd-client/pull/137#issuecomment-247445686,"This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.",I disagree; positive affirmation of a secure operation has a lot of value IMO.  Certainly worth 1 line of output,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,137,2016-09-15T19:39:07Z,2016-10-01T00:03:40Z,2016-10-01T00:03:40Z,CLOSED,False,0,1,1,https://github.com/sofar,Don't print signature check result if OK.,1,[],https://github.com/clearlinux/swupd-client/pull/137,https://github.com/sofar,3,https://github.com/clearlinux/swupd-client/pull/137#issuecomment-247510390,"This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.","There are hundreds of things that succeed in an update, possibly thousands. The only success message that matters is the one at the end that indicates that everything succeeded.
Also, this is printed twice, not just once.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,137,2016-09-15T19:39:07Z,2016-10-01T00:03:40Z,2016-10-01T00:03:40Z,CLOSED,False,0,1,1,https://github.com/sofar,Don't print signature check result if OK.,1,[],https://github.com/clearlinux/swupd-client/pull/137,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/137#issuecomment-247679897,"This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.","I do see your point. If we're that worried about minimizing output, +1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,137,2016-09-15T19:39:07Z,2016-10-01T00:03:40Z,2016-10-01T00:03:40Z,CLOSED,False,0,1,1,https://github.com/sofar,Don't print signature check result if OK.,1,[],https://github.com/clearlinux/swupd-client/pull/137,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/137#issuecomment-250840776,"This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,137,2016-09-15T19:39:07Z,2016-10-01T00:03:40Z,2016-10-01T00:03:40Z,CLOSED,False,0,1,1,https://github.com/sofar,Don't print signature check result if OK.,1,[],https://github.com/clearlinux/swupd-client/pull/137,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/137#issuecomment-250878445,"This adds almost no value, since any failure results in a
thorough error message and possibly exit or retries.","+1 Merged 026de00, this was a helpful message when debugging correctness.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,138,2016-09-27T19:24:50Z,2016-10-01T00:56:39Z,2016-10-01T00:56:39Z,CLOSED,False,66,47,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/138,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/138,"Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,138,2016-09-27T19:24:50Z,2016-10-01T00:56:39Z,2016-10-01T00:56:39Z,CLOSED,False,66,47,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/138,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/138#issuecomment-250818222,"Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,138,2016-09-27T19:24:50Z,2016-10-01T00:56:39Z,2016-10-01T00:56:39Z,CLOSED,False,66,47,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/138,https://github.com/bradTpeters,3,https://github.com/clearlinux/swupd-client/pull/138#issuecomment-250852961,"Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Updated,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,138,2016-09-27T19:24:50Z,2016-10-01T00:56:39Z,2016-10-01T00:56:39Z,CLOSED,False,66,47,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/138,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/138#issuecomment-250857804,"Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",Debug code removed. Blasted file descriptor leak ;),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,138,2016-09-27T19:24:50Z,2016-10-01T00:56:39Z,2016-10-01T00:56:39Z,CLOSED,False,66,47,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/138,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/138#issuecomment-250867580,"Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,138,2016-09-27T19:24:50Z,2016-10-01T00:56:39Z,2016-10-01T00:56:39Z,CLOSED,False,66,47,2,https://github.com/bradTpeters,Update fallback preference for global configuration,1,[],https://github.com/clearlinux/swupd-client/pull/138,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/138#issuecomment-250882623,"Updates the order of preference for content_url, version_url
and format_string, from:

Runtime flags
Configure time options
State dir files

to:

Runtime flags
State dir files
Configure time options

This patch also changes the logic of the setter functions to allow
multiple calls. Once the respective global is set, that function will
return true or 0, ie ""success"", (depending on the function).
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",+1 merged e8ae92a,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,139,2016-09-28T18:20:57Z,2016-10-01T00:22:48Z,2016-10-01T00:22:49Z,CLOSED,False,1,1,1,https://github.com/sofar,Do not report leaks in sockets.,1,[],https://github.com/clearlinux/swupd-client/pull/139,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/139,"The only sockets held are irrelevant for our file descriptor
leak check, which focuses on leaks in opening/closing regular
files. Some of the sockets are things like pacrunner that
curl opens, and we should just ignore leaks in them.","The only sockets held are irrelevant for our file descriptor
leak check, which focuses on leaks in opening/closing regular
files. Some of the sockets are things like pacrunner that
curl opens, and we should just ignore leaks in them.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,139,2016-09-28T18:20:57Z,2016-10-01T00:22:48Z,2016-10-01T00:22:49Z,CLOSED,False,1,1,1,https://github.com/sofar,Do not report leaks in sockets.,1,[],https://github.com/clearlinux/swupd-client/pull/139,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/139#issuecomment-250254185,"The only sockets held are irrelevant for our file descriptor
leak check, which focuses on leaks in opening/closing regular
files. Some of the sockets are things like pacrunner that
curl opens, and we should just ignore leaks in them.",@bradTpeters this should do the trick.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,139,2016-09-28T18:20:57Z,2016-10-01T00:22:48Z,2016-10-01T00:22:49Z,CLOSED,False,1,1,1,https://github.com/sofar,Do not report leaks in sockets.,1,[],https://github.com/clearlinux/swupd-client/pull/139,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/139#issuecomment-250262842,"The only sockets held are irrelevant for our file descriptor
leak check, which focuses on leaks in opening/closing regular
files. Some of the sockets are things like pacrunner that
curl opens, and we should just ignore leaks in them.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,139,2016-09-28T18:20:57Z,2016-10-01T00:22:48Z,2016-10-01T00:22:49Z,CLOSED,False,1,1,1,https://github.com/sofar,Do not report leaks in sockets.,1,[],https://github.com/clearlinux/swupd-client/pull/139,https://github.com/bradTpeters,4,https://github.com/clearlinux/swupd-client/pull/139#issuecomment-250277304,"The only sockets held are irrelevant for our file descriptor
leak check, which focuses on leaks in opening/closing regular
files. Some of the sockets are things like pacrunner that
curl opens, and we should just ignore leaks in them.",Yep +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,139,2016-09-28T18:20:57Z,2016-10-01T00:22:48Z,2016-10-01T00:22:49Z,CLOSED,False,1,1,1,https://github.com/sofar,Do not report leaks in sockets.,1,[],https://github.com/clearlinux/swupd-client/pull/139,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/139#issuecomment-250880165,"The only sockets held are irrelevant for our file descriptor
leak check, which focuses on leaks in opening/closing regular
files. Some of the sockets are things like pacrunner that
curl opens, and we should just ignore leaks in them.",+1 and merged f071915,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,140,2016-09-30T22:18:28Z,2016-11-22T02:26:26Z,2016-11-22T02:26:26Z,CLOSED,False,85,14,10,https://github.com/bradTpeters,Move signature verification to Mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/140,https://github.com/bradTpeters,1,https://github.com/clearlinux/swupd-client/pull/140,"Moves swupd signature verification to mandatory, though --nosigcheck
enables user to bypass all signature-based security checks:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--nosigcheck will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole, since theoretically it
becomes possible for update content to be installed which did not
originate with the Clear Linux team.
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com","Moves swupd signature verification to mandatory, though --nosigcheck
enables user to bypass all signature-based security checks:
The signed MoM serves as the top level chain
of trust as far as swupd is concerned, and it is used to extend
content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason,
we warn and abort the operation.
--nosigcheck will allow this to proceed, explicitly accepting the
unverified MoM and outputting a log entry to the Journal to this
effect. This may introduce a security hole, since theoretically it
becomes possible for update content to be installed which did not
originate with the Clear Linux team.
For files being downloaded from a Clear server, the downloaded file
must match the MoM hash, or a warning is emitted and the operation is
aborted.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,143,2016-10-07T19:18:53Z,2016-10-14T01:49:24Z,2016-11-28T22:05:10Z,MERGED,True,1,1,1,https://github.com/phmccarty,Set O_CLOEXEC when opening the certificate file,1,[],https://github.com/clearlinux/swupd-client/pull/143,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/143,"Because swupd-client on Clear Linux may fork/exec clr-boot-manager near
the end of its operation, which itself checks for file descriptor leaks
before exiting, it will report leaks for files it did not open (i.e.
inherited from the parent process, swupd).
To resolve this, set O_CLOEXEC when opening the cert file using the ""e""
flag (glibc extension).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","Because swupd-client on Clear Linux may fork/exec clr-boot-manager near
the end of its operation, which itself checks for file descriptor leaks
before exiting, it will report leaks for files it did not open (i.e.
inherited from the parent process, swupd).
To resolve this, set O_CLOEXEC when opening the cert file using the ""e""
flag (glibc extension).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,143,2016-10-07T19:18:53Z,2016-10-14T01:49:24Z,2016-11-28T22:05:10Z,MERGED,True,1,1,1,https://github.com/phmccarty,Set O_CLOEXEC when opening the certificate file,1,[],https://github.com/clearlinux/swupd-client/pull/143,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/143#issuecomment-252354425,"Because swupd-client on Clear Linux may fork/exec clr-boot-manager near
the end of its operation, which itself checks for file descriptor leaks
before exiting, it will report leaks for files it did not open (i.e.
inherited from the parent process, swupd).
To resolve this, set O_CLOEXEC when opening the cert file using the ""e""
flag (glibc extension).
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",Tested on Clear build 10820 with this patch applied to v3.6.5.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,144,2016-10-07T22:27:58Z,2017-05-11T21:17:14Z,2017-11-30T23:31:07Z,CLOSED,False,284,92,10,https://github.com/phmccarty,Replace system calls by local system_argv functions.,3,"['enhancement', 'format-bump']",https://github.com/clearlinux/swupd-client/pull/144,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/144,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,144,2016-10-07T22:27:58Z,2017-05-11T21:17:14Z,2017-11-30T23:31:07Z,CLOSED,False,284,92,10,https://github.com/phmccarty,Replace system calls by local system_argv functions.,3,"['enhancement', 'format-bump']",https://github.com/clearlinux/swupd-client/pull/144,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/144#issuecomment-252376472,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","There are 10 failing functional tests with this patch, so those issues need looking at.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,144,2016-10-07T22:27:58Z,2017-05-11T21:17:14Z,2017-11-30T23:31:07Z,CLOSED,False,284,92,10,https://github.com/phmccarty,Replace system calls by local system_argv functions.,3,"['enhancement', 'format-bump']",https://github.com/clearlinux/swupd-client/pull/144,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/144#issuecomment-263489593,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","I rebased this branch, removed asserts, and resolved the issues with the functional tests not passing. It turns out that we needed to handle execvp failures, because the helper scripts often do not exist for tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,144,2016-10-07T22:27:58Z,2017-05-11T21:17:14Z,2017-11-30T23:31:07Z,CLOSED,False,284,92,10,https://github.com/phmccarty,Replace system calls by local system_argv functions.,3,"['enhancement', 'format-bump']",https://github.com/clearlinux/swupd-client/pull/144,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/144#issuecomment-263972014,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","I just recalled there is a call to popen() as well, so we need a helper function for it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,144,2016-10-07T22:27:58Z,2017-05-11T21:17:14Z,2017-11-30T23:31:07Z,CLOSED,False,284,92,10,https://github.com/phmccarty,Replace system calls by local system_argv functions.,3,"['enhancement', 'format-bump']",https://github.com/clearlinux/swupd-client/pull/144,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/144#issuecomment-300919589,"There are new functions that replace system() calls: system_argv()
and system_argv_pipe(). They are based on execvp() function and they
can manage any argument including filenames with characters that could
be interpreted as meta-characters in a regular system() function.
So no escape for the arguments needed and is less prone to errors.
Signed-off-by: Jose R Guzman jose.r.guzman.mosqueda@intel.com
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",After further discussions this will not be implemented due to uncertainty about alternatives to our shell and tar usage.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,145,2016-10-10T22:35:30Z,2016-10-11T17:25:21Z,2016-10-11T17:27:24Z,CLOSED,False,2,2,1,https://github.com/phmccarty,Initialize tmprenamedir in the state directory,1,[],https://github.com/clearlinux/swupd-client/pull/145,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/145,"Initializing this directory here fixes an issue with creating custom
Clear Linux Docker images with swupd; when ""tmprenamedir"" doesn't exist
in the image layer and is later created in the container layer, a
rename() call will fail with EXDEV, due to the layers existing on
different overlayed filesystems. Ensuring that ""tmprenamedir"" is always
present in the state directory resolves the issue.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","Initializing this directory here fixes an issue with creating custom
Clear Linux Docker images with swupd; when ""tmprenamedir"" doesn't exist
in the image layer and is later created in the container layer, a
rename() call will fail with EXDEV, due to the layers existing on
different overlayed filesystems. Ensuring that ""tmprenamedir"" is always
present in the state directory resolves the issue.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,145,2016-10-10T22:35:30Z,2016-10-11T17:25:21Z,2016-10-11T17:27:24Z,CLOSED,False,2,2,1,https://github.com/phmccarty,Initialize tmprenamedir in the state directory,1,[],https://github.com/clearlinux/swupd-client/pull/145,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/145#issuecomment-252767558,"Initializing this directory here fixes an issue with creating custom
Clear Linux Docker images with swupd; when ""tmprenamedir"" doesn't exist
in the image layer and is later created in the container layer, a
rename() call will fail with EXDEV, due to the layers existing on
different overlayed filesystems. Ensuring that ""tmprenamedir"" is always
present in the state directory resolves the issue.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,145,2016-10-10T22:35:30Z,2016-10-11T17:25:21Z,2016-10-11T17:27:24Z,CLOSED,False,2,2,1,https://github.com/phmccarty,Initialize tmprenamedir in the state directory,1,[],https://github.com/clearlinux/swupd-client/pull/145,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/145#issuecomment-252985316,"Initializing this directory here fixes an issue with creating custom
Clear Linux Docker images with swupd; when ""tmprenamedir"" doesn't exist
in the image layer and is later created in the container layer, a
rename() call will fail with EXDEV, due to the layers existing on
different overlayed filesystems. Ensuring that ""tmprenamedir"" is always
present in the state directory resolves the issue.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","After further testing and understanding of how the Docker layering system works, this change doesn't fix the issue. Since the target file for the rename() will always be new, it will exist in the container layer, so EXDEV is still raised due to ""tmprenamedir"" being in the image layer.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,146,2016-10-11T19:25:05Z,2016-10-14T01:48:32Z,2017-10-20T18:46:03Z,MERGED,True,3,0,1,https://github.com/bryteise,Update gitignore for gtags metadata,1,[],https://github.com/clearlinux/swupd-client/pull/146,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/146,"Ignore GPATH, GRTAGS and GTAGS files created by the gtags tool.","Ignore GPATH, GRTAGS and GTAGS files created by the gtags tool.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,147,2016-10-11T20:31:59Z,2016-10-14T01:50:17Z,2017-10-20T18:46:06Z,MERGED,True,7,3,1,https://github.com/bryteise,Remove staging content during verify_fix_path,1,['bug'],https://github.com/clearlinux/swupd-client/pull/147,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/147,"When a file doesn't verify as part of verify_fix_path, prior to
downloading and staging the new file, first remove the old file staging
content.
This change was required due to a failure with swupd-client when run
inside Docker due to /var/lib/swupd being layered under multiple mount
points because of separate Docker Run commands. This caused rename(2) to
fail when the expected layout of /var/lib/swupd is to be the same mount
point.
With this change in place, the rename source content that would be from
a different mount is removed and redownloaded into the same mount as the
rename target.","When a file doesn't verify as part of verify_fix_path, prior to
downloading and staging the new file, first remove the old file staging
content.
This change was required due to a failure with swupd-client when run
inside Docker due to /var/lib/swupd being layered under multiple mount
points because of separate Docker Run commands. This caused rename(2) to
fail when the expected layout of /var/lib/swupd is to be the same mount
point.
With this change in place, the rename source content that would be from
a different mount is removed and redownloaded into the same mount as the
rename target.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,147,2016-10-11T20:31:59Z,2016-10-14T01:50:17Z,2017-10-20T18:46:06Z,MERGED,True,7,3,1,https://github.com/bryteise,Remove staging content during verify_fix_path,1,['bug'],https://github.com/clearlinux/swupd-client/pull/147,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/147#issuecomment-253046527,"When a file doesn't verify as part of verify_fix_path, prior to
downloading and staging the new file, first remove the old file staging
content.
This change was required due to a failure with swupd-client when run
inside Docker due to /var/lib/swupd being layered under multiple mount
points because of separate Docker Run commands. This caused rename(2) to
fail when the expected layout of /var/lib/swupd is to be the same mount
point.
With this change in place, the rename source content that would be from
a different mount is removed and redownloaded into the same mount as the
rename target.",Looks good. +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,148,2016-10-13T17:22:23Z,2016-10-14T01:51:01Z,2016-10-14T01:51:01Z,MERGED,True,7,0,1,https://github.com/sofar,Time: Display time spent using the raw monotonic clock.,1,[],https://github.com/clearlinux/swupd-client/pull/148,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/148,"Besides being a better clock source, this clock source does not
change with time skew. We also don't print the time taken unless
we actually do something significant.","Besides being a better clock source, this clock source does not
change with time skew. We also don't print the time taken unless
we actually do something significant.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,149,2016-10-25T06:58:43Z,2016-11-02T18:41:00Z,2016-11-14T18:45:31Z,MERGED,True,265,204,35,https://github.com/phmccarty,"Refactoring subscription management, accounting, and update list creation",12,[],https://github.com/clearlinux/swupd-client/pull/149,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/149,"This patch series addresses a number of issues:

Subscription management for the 'update' subcommand. To make the consolidation/link steps simpler, there should the ""from"" subscription list and the ""to"" subscription list, instead of just the ""to"" list.
Reporting ""bundle"" changes for updates instead of ""manifest"" changes
Other accounting issues for update stats
Reworking the update list creation logic. There is a major performance bug in the current code: hash checks are performed for every file that did not change.","This patch series addresses a number of issues:

Subscription management for the 'update' subcommand. To make the consolidation/link steps simpler, there should the ""from"" subscription list and the ""to"" subscription list, instead of just the ""to"" list.
Reporting ""bundle"" changes for updates instead of ""manifest"" changes
Other accounting issues for update stats
Reworking the update list creation logic. There is a major performance bug in the current code: hash checks are performed for every file that did not change.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,149,2016-10-25T06:58:43Z,2016-11-02T18:41:00Z,2016-11-14T18:45:31Z,MERGED,True,265,204,35,https://github.com/phmccarty,"Refactoring subscription management, accounting, and update list creation",12,[],https://github.com/clearlinux/swupd-client/pull/149,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/149#issuecomment-256106580,"This patch series addresses a number of issues:

Subscription management for the 'update' subcommand. To make the consolidation/link steps simpler, there should the ""from"" subscription list and the ""to"" subscription list, instead of just the ""to"" list.
Reporting ""bundle"" changes for updates instead of ""manifest"" changes
Other accounting issues for update stats
Reworking the update list creation logic. There is a major performance bug in the current code: hash checks are performed for every file that did not change.",Looks OK to me.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,149,2016-10-25T06:58:43Z,2016-11-02T18:41:00Z,2016-11-14T18:45:31Z,MERGED,True,265,204,35,https://github.com/phmccarty,"Refactoring subscription management, accounting, and update list creation",12,[],https://github.com/clearlinux/swupd-client/pull/149,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/149#issuecomment-256217440,"This patch series addresses a number of issues:

Subscription management for the 'update' subcommand. To make the consolidation/link steps simpler, there should the ""from"" subscription list and the ""to"" subscription list, instead of just the ""to"" list.
Reporting ""bundle"" changes for updates instead of ""manifest"" changes
Other accounting issues for update stats
Reworking the update list creation logic. There is a major performance bug in the current code: hash checks are performed for every file that did not change.","Pushed patch set 2, addressing Auke's comment.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,149,2016-10-25T06:58:43Z,2016-11-02T18:41:00Z,2016-11-14T18:45:31Z,MERGED,True,265,204,35,https://github.com/phmccarty,"Refactoring subscription management, accounting, and update list creation",12,[],https://github.com/clearlinux/swupd-client/pull/149,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/149#issuecomment-257415737,"This patch series addresses a number of issues:

Subscription management for the 'update' subcommand. To make the consolidation/link steps simpler, there should the ""from"" subscription list and the ""to"" subscription list, instead of just the ""to"" list.
Reporting ""bundle"" changes for updates instead of ""manifest"" changes
Other accounting issues for update stats
Reworking the update list creation logic. There is a major performance bug in the current code: hash checks are performed for every file that did not change.",Uploaded patch set 3.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,150,2016-11-02T21:09:54Z,2016-11-09T01:44:02Z,2016-11-09T01:44:02Z,MERGED,True,54,8,4,https://github.com/icarus-sparry,Add options to handle xattr at compile time.,2,[],https://github.com/clearlinux/swupd-client/pull/150,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/150,"Swupd used to use a sorted blob of extended file attributes as part of
the data that was used to verify the contents. This caused problems if
extra attributes were added. In particular if a clearlinux system was
being run in a container that had selinux enabled in the base OS.
Add a configure option to allow the attributes to be considered or
not. Based on advice, the default is to ignore them, as this is what
everyone expects.
Tidied up passing a --selinux flag to tar, this is also handled by a new
config option.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Swupd used to use a sorted blob of extended file attributes as part of
the data that was used to verify the contents. This caused problems if
extra attributes were added. In particular if a clearlinux system was
being run in a container that had selinux enabled in the base OS.
Add a configure option to allow the attributes to be considered or
not. Based on advice, the default is to ignore them, as this is what
everyone expects.
Tidied up passing a --selinux flag to tar, this is also handled by a new
config option.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,150,2016-11-02T21:09:54Z,2016-11-09T01:44:02Z,2016-11-09T01:44:02Z,MERGED,True,54,8,4,https://github.com/icarus-sparry,Add options to handle xattr at compile time.,2,[],https://github.com/clearlinux/swupd-client/pull/150,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/150#issuecomment-258980131,"Swupd used to use a sorted blob of extended file attributes as part of
the data that was used to verify the contents. This caused problems if
extra attributes were added. In particular if a clearlinux system was
being run in a container that had selinux enabled in the base OS.
Add a configure option to allow the attributes to be considered or
not. Based on advice, the default is to ignore them, as this is what
everyone expects.
Tidied up passing a --selinux flag to tar, this is also handled by a new
config option.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Additional comments in xattr.c.
Logic simplified in configure.ac",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,150,2016-11-02T21:09:54Z,2016-11-09T01:44:02Z,2016-11-09T01:44:02Z,MERGED,True,54,8,4,https://github.com/icarus-sparry,Add options to handle xattr at compile time.,2,[],https://github.com/clearlinux/swupd-client/pull/150,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/150#issuecomment-259021176,"Swupd used to use a sorted blob of extended file attributes as part of
the data that was used to verify the contents. This caused problems if
extra attributes were added. In particular if a clearlinux system was
being run in a container that had selinux enabled in the base OS.
Add a configure option to allow the attributes to be considered or
not. Based on advice, the default is to ignore them, as this is what
everyone expects.
Tidied up passing a --selinux flag to tar, this is also handled by a new
config option.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Looks good to me. +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,151,2016-11-03T04:15:41Z,2016-11-03T21:12:47Z,2016-11-14T18:45:55Z,MERGED,True,698,652,118,https://github.com/phmccarty,Change interface for functional test output checking,7,[],https://github.com/clearlinux/swupd-client/pull/151,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/151,"Instead of checking entries in the ""lines"" array that BATS populates with swupd-client output, I decided to implement a new interface for checking output.
The motivation for this change is to ease maintenance of the swupd-client functional tests, especially when its output changes.
This interface requires each functional test to create a file named lines-checked that declares a list of checked lines of output, and when the test in run, the swupd-client output is inspecting to make sure every entry in lines-checked is present, and in order.
Additionally, the lines-checked file supports matching with regular expressions (the ERE supported by AWK) by prefixing the line with ""REGEXP:"", since several of the current tests that output paths with the full path_prefix need this treatment.","Instead of checking entries in the ""lines"" array that BATS populates with swupd-client output, I decided to implement a new interface for checking output.
The motivation for this change is to ease maintenance of the swupd-client functional tests, especially when its output changes.
This interface requires each functional test to create a file named lines-checked that declares a list of checked lines of output, and when the test in run, the swupd-client output is inspecting to make sure every entry in lines-checked is present, and in order.
Additionally, the lines-checked file supports matching with regular expressions (the ERE supported by AWK) by prefixing the line with ""REGEXP:"", since several of the current tests that output paths with the full path_prefix need this treatment.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,151,2016-11-03T04:15:41Z,2016-11-03T21:12:47Z,2016-11-14T18:45:55Z,MERGED,True,698,652,118,https://github.com/phmccarty,Change interface for functional test output checking,7,[],https://github.com/clearlinux/swupd-client/pull/151,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/151#issuecomment-258063923,"Instead of checking entries in the ""lines"" array that BATS populates with swupd-client output, I decided to implement a new interface for checking output.
The motivation for this change is to ease maintenance of the swupd-client functional tests, especially when its output changes.
This interface requires each functional test to create a file named lines-checked that declares a list of checked lines of output, and when the test in run, the swupd-client output is inspecting to make sure every entry in lines-checked is present, and in order.
Additionally, the lines-checked file supports matching with regular expressions (the ERE supported by AWK) by prefixing the line with ""REGEXP:"", since several of the current tests that output paths with the full path_prefix need this treatment.","One gap with this new interface is that it will not detect unexpected error messages... The checked lines could appear anywhere in the output as long as they are in the correct order.
I will experiment with adding a global ignore list containing regexps for messages that can be skipped for tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,151,2016-11-03T04:15:41Z,2016-11-03T21:12:47Z,2016-11-14T18:45:55Z,MERGED,True,698,652,118,https://github.com/phmccarty,Change interface for functional test output checking,7,[],https://github.com/clearlinux/swupd-client/pull/151,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/151#issuecomment-258069917,"Instead of checking entries in the ""lines"" array that BATS populates with swupd-client output, I decided to implement a new interface for checking output.
The motivation for this change is to ease maintenance of the swupd-client functional tests, especially when its output changes.
This interface requires each functional test to create a file named lines-checked that declares a list of checked lines of output, and when the test in run, the swupd-client output is inspecting to make sure every entry in lines-checked is present, and in order.
Additionally, the lines-checked file supports matching with regular expressions (the ERE supported by AWK) by prefixing the line with ""REGEXP:"", since several of the current tests that output paths with the full path_prefix need this treatment.","Added the global ignore list support with enforcement, and I fixed up the remaining functional test issues, primarily with unchecked lines.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,152,2016-11-03T22:29:15Z,2016-11-04T23:24:50Z,2017-10-20T18:46:07Z,MERGED,True,111,101,41,https://github.com/tmarcu,Swupd performance,14,[],https://github.com/clearlinux/swupd-client/pull/152,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/152,Rebased patches from package to merge into main code base.,Rebased patches from package to merge into main code base.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,152,2016-11-03T22:29:15Z,2016-11-04T23:24:50Z,2017-10-20T18:46:07Z,MERGED,True,111,101,41,https://github.com/tmarcu,Swupd performance,14,[],https://github.com/clearlinux/swupd-client/pull/152,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/152#issuecomment-258513748,Rebased patches from package to merge into main code base.,"V2, updated code based on comments and updated several commit messages to be more verbose about the changes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,152,2016-11-03T22:29:15Z,2016-11-04T23:24:50Z,2017-10-20T18:46:07Z,MERGED,True,111,101,41,https://github.com/tmarcu,Swupd performance,14,[],https://github.com/clearlinux/swupd-client/pull/152,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/152#issuecomment-258570165,Rebased patches from package to merge into main code base.,+1,True,{'HOORAY': ['https://github.com/phmccarty']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,153,2016-11-04T19:01:24Z,2016-11-15T01:10:32Z,2017-10-20T18:46:10Z,MERGED,True,0,10,1,https://github.com/tmarcu,Remove certificate pinning,1,[],https://github.com/clearlinux/swupd-client/pull/153,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/153,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,153,2016-11-04T19:01:24Z,2016-11-15T01:10:32Z,2017-10-20T18:46:10Z,MERGED,True,0,10,1,https://github.com/tmarcu,Remove certificate pinning,1,[],https://github.com/clearlinux/swupd-client/pull/153,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/153#issuecomment-258544688,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,A commit message about why this is necessary would be helpful.,True,"{'THUMBS_UP': ['https://github.com/tmarcu'], 'LAUGH': ['https://github.com/tmarcu'], 'HOORAY': ['https://github.com/tmarcu']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,154,2016-11-07T21:19:12Z,2016-11-09T01:48:31Z,2016-11-14T18:46:13Z,MERGED,True,1,0,1,https://github.com/phmccarty,Print error message for CURLE_COULDNT_CONNECT,1,[],https://github.com/clearlinux/swupd-client/pull/154,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/154,"Certain types of network-connectivity problems hit this curl error, so
print a diagnostic message when it occurs.","Certain types of network-connectivity problems hit this curl error, so
print a diagnostic message when it occurs.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,154,2016-11-07T21:19:12Z,2016-11-09T01:48:31Z,2016-11-14T18:46:13Z,MERGED,True,1,0,1,https://github.com/phmccarty,Print error message for CURLE_COULDNT_CONNECT,1,[],https://github.com/clearlinux/swupd-client/pull/154,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/154#issuecomment-258967428,"Certain types of network-connectivity problems hit this curl error, so
print a diagnostic message when it occurs.","The functional test suite emits many of the ""could not read file"" errors, so we either need to ignore them or add special handling when using the file:// protocol.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,154,2016-11-07T21:19:12Z,2016-11-09T01:48:31Z,2016-11-14T18:46:13Z,MERGED,True,1,0,1,https://github.com/phmccarty,Print error message for CURLE_COULDNT_CONNECT,1,[],https://github.com/clearlinux/swupd-client/pull/154,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/154#issuecomment-259228763,"Certain types of network-connectivity problems hit this curl error, so
print a diagnostic message when it occurs.","I decided to only print a message for the CURLE_COULDNT_CONNECT error, which seems to occur frequently for network connectivity issues.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,155,2016-11-08T19:12:08Z,2016-11-11T18:52:05Z,2016-11-14T18:46:12Z,MERGED,True,1,1,2,https://github.com/phmccarty,build: track m4 directory to avoid aclocal warning,1,[],https://github.com/clearlinux/swupd-client/pull/155,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/155,"When running 'autoreconf', aclocal warns that the ""m4"" directory does
not exist, even though AC_CONFIG_MACRO_DIR in configure.ac declares that
it should exist.
To avoid the warning, track the directory in the git tree.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","When running 'autoreconf', aclocal warns that the ""m4"" directory does
not exist, even though AC_CONFIG_MACRO_DIR in configure.ac declares that
it should exist.
To avoid the warning, track the directory in the git tree.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,156,2016-11-15T14:55:47Z,2016-11-18T13:29:13Z,2016-11-18T13:29:13Z,CLOSED,False,8,2,2,https://github.com/pohly,tar: extract failure handling,1,[],https://github.com/clearlinux/swupd-client/pull/156,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/156,"tar errors when unpacking individual files used to be ignored in swupd
client < 3.0 and current 3.6.0 still prints a message about ""ignoring
tar extract failure for fullfile ..."" but the error is not really
getting ignored. Instead, downloading is tried again a few times
before swupd gives up.
This is relevant in Ostro OS where IMA prevents bsdtar from setting a
security.ima xattr when the value is redundant (see ""[Linux-ima-user]
copying files with security.ima xattr"" - the consensus is that the
kernel is too strict and needs to be fixed), leading to errors that
can be ignored.
The same can happen when extracting a pack file, and there errors also
should be ignored.
In both cases it is useful to see the actual error messages from the
tar command, so the redirection to /dev/null gets removed.","tar errors when unpacking individual files used to be ignored in swupd
client < 3.0 and current 3.6.0 still prints a message about ""ignoring
tar extract failure for fullfile ..."" but the error is not really
getting ignored. Instead, downloading is tried again a few times
before swupd gives up.
This is relevant in Ostro OS where IMA prevents bsdtar from setting a
security.ima xattr when the value is redundant (see ""[Linux-ima-user]
copying files with security.ima xattr"" - the consensus is that the
kernel is too strict and needs to be fixed), leading to errors that
can be ignored.
The same can happen when extracting a pack file, and there errors also
should be ignored.
In both cases it is useful to see the actual error messages from the
tar command, so the redirection to /dev/null gets removed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,156,2016-11-15T14:55:47Z,2016-11-18T13:29:13Z,2016-11-18T13:29:13Z,CLOSED,False,8,2,2,https://github.com/pohly,tar: extract failure handling,1,[],https://github.com/clearlinux/swupd-client/pull/156,https://github.com/pohly,2,https://github.com/clearlinux/swupd-client/pull/156#issuecomment-260746738,"tar errors when unpacking individual files used to be ignored in swupd
client < 3.0 and current 3.6.0 still prints a message about ""ignoring
tar extract failure for fullfile ..."" but the error is not really
getting ignored. Instead, downloading is tried again a few times
before swupd gives up.
This is relevant in Ostro OS where IMA prevents bsdtar from setting a
security.ima xattr when the value is redundant (see ""[Linux-ima-user]
copying files with security.ima xattr"" - the consensus is that the
kernel is too strict and needs to be fixed), leading to errors that
can be ignored.
The same can happen when extracting a pack file, and there errors also
should be ignored.
In both cases it is useful to see the actual error messages from the
tar command, so the redirection to /dev/null gets removed.",Treating tar errors as fatal would also be okay. I have backported the kernel patch which avoids the security.ima warnings and that seems to work okay.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,156,2016-11-15T14:55:47Z,2016-11-18T13:29:13Z,2016-11-18T13:29:13Z,CLOSED,False,8,2,2,https://github.com/pohly,tar: extract failure handling,1,[],https://github.com/clearlinux/swupd-client/pull/156,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/156#issuecomment-260778927,"tar errors when unpacking individual files used to be ignored in swupd
client < 3.0 and current 3.6.0 still prints a message about ""ignoring
tar extract failure for fullfile ..."" but the error is not really
getting ignored. Instead, downloading is tried again a few times
before swupd gives up.
This is relevant in Ostro OS where IMA prevents bsdtar from setting a
security.ima xattr when the value is redundant (see ""[Linux-ima-user]
copying files with security.ima xattr"" - the consensus is that the
kernel is too strict and needs to be fixed), leading to errors that
can be ignored.
The same can happen when extracting a pack file, and there errors also
should be ignored.
In both cases it is useful to see the actual error messages from the
tar command, so the redirection to /dev/null gets removed.","Also in the spirit of survivability, we should try to recover and retry when possible before declaring it's fatal.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,156,2016-11-15T14:55:47Z,2016-11-18T13:29:13Z,2016-11-18T13:29:13Z,CLOSED,False,8,2,2,https://github.com/pohly,tar: extract failure handling,1,[],https://github.com/clearlinux/swupd-client/pull/156,https://github.com/pohly,4,https://github.com/clearlinux/swupd-client/pull/156#issuecomment-261531543,"tar errors when unpacking individual files used to be ignored in swupd
client < 3.0 and current 3.6.0 still prints a message about ""ignoring
tar extract failure for fullfile ..."" but the error is not really
getting ignored. Instead, downloading is tried again a few times
before swupd gives up.
This is relevant in Ostro OS where IMA prevents bsdtar from setting a
security.ima xattr when the value is redundant (see ""[Linux-ima-user]
copying files with security.ima xattr"" - the consensus is that the
kernel is too strict and needs to be fixed), leading to errors that
can be ignored.
The same can happen when extracting a pack file, and there errors also
should be ignored.
In both cases it is useful to see the actual error messages from the
tar command, so the redirection to /dev/null gets removed.","I no longer need to ignore tar errors, so this change isn't needed anymore.
Can someone else take care of the broken printf()?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/157,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260759378,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","+1
Can you implement the same change for the update --status command as well?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260769968,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Added the code for update --status.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/icarus-sparry,4,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260774932,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Also added the print of the current OS, which was talked about on IRC",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/icarus-sparry,5,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260775249,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",I need to figure out the github workflow so I can squash these 5 commits (including 2 merges) to 1.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/icarus-sparry,6,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260794010,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","OK, that is better, only one commit to merge now (although I would accept a request to turn it into 2, one to add the printing of the current OS version in the check-update path and one to do the two return code changes).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260807943,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",@icarus-sparry I'm okay with the single commit. +1 from me.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260809858,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","One other thing: there are some functional test updates needed:

3 tests fail because the lines from lines-checked do not exactly match printed output. This is due to the added printf(). I would recommend updating lines-checked for the 3 tests.
Now that the exit status for update --status and check-update tests will be either 0 or 1, the tests should explicitly check for the expected exit status.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,157,2016-11-15T20:19:14Z,2016-11-16T00:59:06Z,2017-08-31T22:57:54Z,MERGED,True,27,5,10,https://github.com/icarus-sparry,swupd-client check-update return 1 if none available,1,[],https://github.com/clearlinux/swupd-client/pull/157,https://github.com/phmccarty,9,https://github.com/clearlinux/swupd-client/pull/157#issuecomment-260817074,"make the return code for swupd-client be 1 if there is no update
available. This follows in the tradition of grep, which returns 0 if
there are matches, 1 if there are not, and 2 for errors.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Looks good to me. +1 (again),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,158,2016-11-16T10:56:49Z,2016-11-17T08:27:51Z,2016-11-17T08:27:51Z,MERGED,True,1,1,1,https://github.com/andred,build: allow out of tree builds,1,[],https://github.com/clearlinux/swupd-client/pull/158,https://github.com/andred,1,https://github.com/clearlinux/swupd-client/pull/158,"When doing out-of-tree builds, the distributed
scripts are in different directory than where
the build is happening. This doesn't work:
make  install-exec-hook
make[2]: Entering directory ''
perl scripts/findstatic.pl /.o | grep -v Checking ||:
Can't open perl script ""scripts/findstatic.pl"": No such file or directory
make[2]: Leaving directory ''
We therefore need to give perl the full path
of the perl-script to run using the standard
automake variable top_srcdir:
make  install-exec-hook
make[2]: Entering directory ''
perl ../../../../../../../../tmp/swupd-client.git/scripts/findstatic.pl /.o | grep -v Checking ||:
'bin_paths' is unique to src/search.o, should be static?  (initialised variable)
'do_search' is unique to src/search.o, should be static?  (function)
'download_manifests' is unique to src/search.o, should be static?  (function)
'file_search' is unique to src/search.o, should be static?  (function)
'lib_paths' is unique to src/search.o, should be static?  (initialised variable)
'report_find' is unique to src/search.o, should be static?  (function)
'scope' is unique to src/search.o, should be static?  (initialised variable)
'search_type' is unique to src/search.o, should be static?  (initialised variable)
make[2]: Leaving directory ''
Signed-off-by: Andr Draszik git@andred.net","When doing out-of-tree builds, the distributed
scripts are in different directory than where
the build is happening. This doesn't work:
make  install-exec-hook
make[2]: Entering directory ''
perl scripts/findstatic.pl /.o | grep -v Checking ||:
Can't open perl script ""scripts/findstatic.pl"": No such file or directory
make[2]: Leaving directory ''
We therefore need to give perl the full path
of the perl-script to run using the standard
automake variable top_srcdir:
make  install-exec-hook
make[2]: Entering directory ''
perl ../../../../../../../../tmp/swupd-client.git/scripts/findstatic.pl /.o | grep -v Checking ||:
'bin_paths' is unique to src/search.o, should be static?  (initialised variable)
'do_search' is unique to src/search.o, should be static?  (function)
'download_manifests' is unique to src/search.o, should be static?  (function)
'file_search' is unique to src/search.o, should be static?  (function)
'lib_paths' is unique to src/search.o, should be static?  (initialised variable)
'report_find' is unique to src/search.o, should be static?  (function)
'scope' is unique to src/search.o, should be static?  (initialised variable)
'search_type' is unique to src/search.o, should be static?  (initialised variable)
make[2]: Leaving directory ''
Signed-off-by: Andr Draszik git@andred.net",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,159,2016-11-16T23:20:03Z,2016-11-17T08:52:22Z,2016-11-17T08:52:22Z,MERGED,True,1022,14,20,https://github.com/sofar,"Docs, units, autogen.",4,[],https://github.com/clearlinux/swupd-client/pull/159,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/159,"4 changes, all fairly trivial.

Add auto-update units. Reworks configure.ac to not create non-dynamic files.
Add trivial autogen.sh
Add man page support.
Add (stored) generated troff files.","4 changes, all fairly trivial.

Add auto-update units. Reworks configure.ac to not create non-dynamic files.
Add trivial autogen.sh
Add man page support.
Add (stored) generated troff files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,159,2016-11-16T23:20:03Z,2016-11-17T08:52:22Z,2016-11-17T08:52:22Z,MERGED,True,1022,14,20,https://github.com/sofar,"Docs, units, autogen.",4,[],https://github.com/clearlinux/swupd-client/pull/159,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/159#issuecomment-261106756,"4 changes, all fairly trivial.

Add auto-update units. Reworks configure.ac to not create non-dynamic files.
Add trivial autogen.sh
Add man page support.
Add (stored) generated troff files.",There was already some whitespace damage in Makefile.am I think. Fixed now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,159,2016-11-16T23:20:03Z,2016-11-17T08:52:22Z,2016-11-17T08:52:22Z,MERGED,True,1022,14,20,https://github.com/sofar,"Docs, units, autogen.",4,[],https://github.com/clearlinux/swupd-client/pull/159,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/159#issuecomment-261107171,"4 changes, all fairly trivial.

Add auto-update units. Reworks configure.ac to not create non-dynamic files.
Add trivial autogen.sh
Add man page support.
Add (stored) generated troff files.",+1 from me,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,160,2016-11-17T19:25:36Z,2016-11-21T18:59:24Z,2016-11-21T18:59:24Z,MERGED,True,15,7,3,https://github.com/pohly,fix --enable-xattr,2,[],https://github.com/clearlinux/swupd-client/pull/160,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/160,"Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.","Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,160,2016-11-17T19:25:36Z,2016-11-21T18:59:24Z,2016-11-21T18:59:24Z,MERGED,True,15,7,3,https://github.com/pohly,fix --enable-xattr,2,[],https://github.com/clearlinux/swupd-client/pull/160,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/160#issuecomment-261346180,"Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.",Probably should delete the misleading comment in swupd-build-variant.h about configure.ac ensures a sensible configuration.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,160,2016-11-17T19:25:36Z,2016-11-21T18:59:24Z,2016-11-21T18:59:24Z,MERGED,True,15,7,3,https://github.com/pohly,fix --enable-xattr,2,[],https://github.com/clearlinux/swupd-client/pull/160,https://github.com/pohly,3,https://github.com/clearlinux/swupd-client/pull/160#issuecomment-261350143,"Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.","@icarus-sparry I've replaced the comment in a separate commit. It wasn't that misleading (after all, configure still picks sensible combinations when using GNU tar), but there was indeed a bit more that could have been said about this.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,160,2016-11-17T19:25:36Z,2016-11-21T18:59:24Z,2016-11-21T18:59:24Z,MERGED,True,15,7,3,https://github.com/pohly,fix --enable-xattr,2,[],https://github.com/clearlinux/swupd-client/pull/160,https://github.com/pohly,4,https://github.com/clearlinux/swupd-client/pull/160#issuecomment-261622879,"Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.","@phmccarty good catch, fixed commit force-pushed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,160,2016-11-17T19:25:36Z,2016-11-21T18:59:24Z,2016-11-21T18:59:24Z,MERGED,True,15,7,3,https://github.com/pohly,fix --enable-xattr,2,[],https://github.com/clearlinux/swupd-client/pull/160,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/160#issuecomment-262027523,"Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,160,2016-11-17T19:25:36Z,2016-11-21T18:59:24Z,2016-11-21T18:59:24Z,MERGED,True,15,7,3,https://github.com/pohly,fix --enable-xattr,2,[],https://github.com/clearlinux/swupd-client/pull/160,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/160#issuecomment-262033010,"Commit fc0f570 added a check that prevents using --enable-xattr
together with --enable-bsdtar, perhaps because it was assumed that this
wouldn't work because there is no special tar option as in the GNU tar
case.
But bsdtar worked fined in combination with IMA and Smack xattrs in
Ostro OS. Xattrs are set accordingly there on the server side, so the
check needs to be removed to allow the combination.
Besides that, enabling xattrs also had no effect because xattrs.c
never got to see the SWUPD_WITH_XATTRS define due to not including
config.h.
@icarus-sparry this is the fix I mentioned on IRC.",Thanks @pohly ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,161,2016-11-17T19:28:07Z,2016-11-21T19:00:11Z,2016-11-21T19:00:11Z,MERGED,True,12,2,2,https://github.com/pohly,Add configure option to re-enable updating of config files,1,[],https://github.com/clearlinux/swupd-client/pull/161,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/161,"This is required by distros which ship configuration files under
/etc. Those files then are considered read-only and must be updated as
part of OS updates.","This is required by distros which ship configuration files under
/etc. Those files then are considered read-only and must be updated as
part of OS updates.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,161,2016-11-17T19:28:07Z,2016-11-21T19:00:11Z,2016-11-21T19:00:11Z,MERGED,True,12,2,2,https://github.com/pohly,Add configure option to re-enable updating of config files,1,[],https://github.com/clearlinux/swupd-client/pull/161,https://github.com/pohly,2,https://github.com/clearlinux/swupd-client/pull/161#issuecomment-261467673,"This is required by distros which ship configuration files under
/etc. Those files then are considered read-only and must be updated as
part of OS updates.",@phmccarty revised commit force-pushed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,161,2016-11-17T19:28:07Z,2016-11-21T19:00:11Z,2016-11-21T19:00:11Z,MERGED,True,12,2,2,https://github.com/pohly,Add configure option to re-enable updating of config files,1,[],https://github.com/clearlinux/swupd-client/pull/161,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/161#issuecomment-261622213,"This is required by distros which ship configuration files under
/etc. Those files then are considered read-only and must be updated as
part of OS updates.","+1, thanks.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,161,2016-11-17T19:28:07Z,2016-11-21T19:00:11Z,2016-11-21T19:00:11Z,MERGED,True,12,2,2,https://github.com/pohly,Add configure option to re-enable updating of config files,1,[],https://github.com/clearlinux/swupd-client/pull/161,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/161#issuecomment-262033256,"This is required by distros which ship configuration files under
/etc. Those files then are considered read-only and must be updated as
part of OS updates.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/162,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-261352512,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34",First I have heard that ignoring xattrs was the agreed solution for verifying Manifest files. Where was it discussed?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/pohly,3,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-261360757,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34",@icarus-sparry see clearlinux/swupd-server#34 (comment),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-261626624,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","I like this change. The xattr support is meant for actual update content, not the manifest files that describe the update content.
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-262031012,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","I like the concept of this change, and it's the correct thing to do.
However, what do you think about not changing the function signature since the manifest is the -only- place we pass in false, and changing it such that verify_file() checks if (file->is_manifest): don't use xattrs? The filetype is populated so we always know what kind of file it is, and then we wouldn't have to sprinkle in a new param everywhere.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/icarus-sparry,6,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-262033599,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","@tmarcu, sorry, but I don't think this is the right thing to do. The point about xattrs is that they are extensible metadata. One suggested use for them is to assign an Author field to a document, another is for libraries such as libcurl to record where something was downloaded from. If xattrs every get used in this manner then we will need to provide a list of which attributes are to be included into the verification, so we can know to ignore the Download and Author fields, but keep the security.ima.
Once you have this need for every file, then providing an empty list for Manifests is easy.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/pohly,7,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-262065900,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","@icarus-sparry: there is no security.ima xattr on the Manifest files at the moment. What you describe (per xattr control) can be a future improvement, although using it for security.ima probably would need a good justification given also the complexity on the server side. In the meantime, can we please focus on a solution that has a chance of getting implemented soon?
@tmarcu yes, checking file->is_manifest also would work for me. Do you want me to provide (and test) a patch for that?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/tmarcu,8,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-262081329,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","@icarus-sparry I don't believe the current patch or the proposal solve the xattr list problem still. I agree supporting xattrs fully will require a more complex change to differentiate out of a list, but that might be out of scope for this patch since we ignore then fully as is.
@pohly Could you do the file->is_manifest change? It's kind-of a rewrite of this patch, but the resulting patch should only be a couple lines in the end.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,162,2016-11-17T19:31:31Z,2016-11-28T18:16:12Z,2016-11-28T18:16:12Z,MERGED,True,8,1,1,https://github.com/pohly,ignore xattrs when verifying Manifest files,1,[],https://github.com/clearlinux/swupd-client/pull/162,https://github.com/pohly,9,https://github.com/clearlinux/swupd-client/pull/162#issuecomment-262470394,"When IMA or Smack are active on the client, the downloaded Manifest
files will be assigned certain xattrs (security.ima
resp. security.SMACK64). Those xattrs did not exist on the server side
(because it is most likely not having those kernel features enabled)
and besides, the swupd-server code wouldn't include them in the
Manifest hashes even if they existed (see write_manifest_plain() in
src/manifest.c).
Therefore the client must ignore xattrs when verifying Manifest files.
This is the only place where verification gets relaxed. All other locations
still use xattrs, just as before.
This is the solution that was agree upon when discussing clearlinux/swupd-server#34","@tmarcu using ""is_manifest"" indeed made the patch a lot simpler. Revised commit force-pushed.
I verified that this avoids the hash mismatch errors for the manifests in Ostro while still finding hash mismatches for system files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,163,2016-11-21T22:47:15Z,2016-11-22T23:22:24Z,2017-11-30T23:31:04Z,MERGED,True,32,2,4,https://github.com/phmccarty,Enable travis-ci,4,[],https://github.com/clearlinux/swupd-client/pull/163,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/163,This series fully enables travis-ci for running the functional test suite.,This series fully enables travis-ci for running the functional test suite.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,163,2016-11-21T22:47:15Z,2016-11-22T23:22:24Z,2017-11-30T23:31:04Z,MERGED,True,32,2,4,https://github.com/phmccarty,Enable travis-ci,4,[],https://github.com/clearlinux/swupd-client/pull/163,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/163#issuecomment-262092362,This series fully enables travis-ci for running the functional test suite.,"Link to latest build log from my travis-ci branch:
https://travis-ci.org/phmccarty/swupd-client/builds/177807934",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,163,2016-11-21T22:47:15Z,2016-11-22T23:22:24Z,2017-11-30T23:31:04Z,MERGED,True,32,2,4,https://github.com/phmccarty,Enable travis-ci,4,[],https://github.com/clearlinux/swupd-client/pull/163,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/163#issuecomment-262396031,This series fully enables travis-ci for running the functional test suite.,"+1, thank you for updating testing as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,164,2016-11-22T02:37:58Z,2017-01-25T23:00:25Z,2017-10-20T18:46:14Z,MERGED,True,79,15,10,https://github.com/tmarcu,Move signature verification to mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/164,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/164,"This sets swupd signature verification to mandatory, failing and exiting
for any verify error, though --nosigcheck enables user to bypass all
signature-based security checks.
The signed MoM serves as the top level chain of trust, and it is used to
extend content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason, we
warn and abort the operation.
Passing --nosigcheck will allow this to proceed, explicitly accepting the
unverifiable MoM and outputting a log entry to the Journal. This is not
recommended and unsupported by upstream once the chain of security is broken,
because it may imply update content was or may be installed that was not
generated by the official upstream.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","This sets swupd signature verification to mandatory, failing and exiting
for any verify error, though --nosigcheck enables user to bypass all
signature-based security checks.
The signed MoM serves as the top level chain of trust, and it is used to
extend content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason, we
warn and abort the operation.
Passing --nosigcheck will allow this to proceed, explicitly accepting the
unverifiable MoM and outputting a log entry to the Journal. This is not
recommended and unsupported by upstream once the chain of security is broken,
because it may imply update content was or may be installed that was not
generated by the official upstream.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,164,2016-11-22T02:37:58Z,2017-01-25T23:00:25Z,2017-10-20T18:46:14Z,MERGED,True,79,15,10,https://github.com/tmarcu,Move signature verification to mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/164,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/164#issuecomment-262334507,"This sets swupd signature verification to mandatory, failing and exiting
for any verify error, though --nosigcheck enables user to bypass all
signature-based security checks.
The signed MoM serves as the top level chain of trust, and it is used to
extend content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason, we
warn and abort the operation.
Passing --nosigcheck will allow this to proceed, explicitly accepting the
unverifiable MoM and outputting a log entry to the Journal. This is not
recommended and unsupported by upstream once the chain of security is broken,
because it may imply update content was or may be installed that was not
generated by the official upstream.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Also, for the record, the functional test suite fails with this patch (only when passing --enable-signature-verification). @tmarcu will be working on resolving those failures.",True,"{'LAUGH': ['https://github.com/tmarcu'], 'THUMBS_UP': ['https://github.com/tmarcu']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,164,2016-11-22T02:37:58Z,2017-01-25T23:00:25Z,2017-10-20T18:46:14Z,MERGED,True,79,15,10,https://github.com/tmarcu,Move signature verification to mandatory,1,[],https://github.com/clearlinux/swupd-client/pull/164,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/164#issuecomment-275259803,"This sets swupd signature verification to mandatory, failing and exiting
for any verify error, though --nosigcheck enables user to bypass all
signature-based security checks.
The signed MoM serves as the top level chain of trust, and it is used to
extend content trust down to the individual file level. When the signature
of the top-level MoM is invalid or cannot be verified for any reason, we
warn and abort the operation.
Passing --nosigcheck will allow this to proceed, explicitly accepting the
unverifiable MoM and outputting a log entry to the Journal. This is not
recommended and unsupported by upstream once the chain of security is broken,
because it may imply update content was or may be installed that was not
generated by the official upstream.
Signed-off-by: Brad T. Peters brad.t.peters@intel.com
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,165,2016-11-22T19:44:35Z,2016-11-22T19:46:17Z,2016-12-21T21:35:04Z,MERGED,True,1,1,1,https://github.com/phmccarty,Fix typo in Makefile.am,1,[],https://github.com/clearlinux/swupd-client/pull/165,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/165,"The backslash for the second-to-last entry in EXTRA_DIST was omitted,
leading to a dist issue.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com","The backslash for the second-to-last entry in EXTRA_DIST was omitted,
leading to a dist issue.
Signed-off-by: Patrick McCarty patrick.mccarty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,166,2016-11-22T21:26:28Z,2016-11-22T23:12:55Z,2017-10-20T18:46:12Z,MERGED,True,2,2,1,https://github.com/tmarcu,Do not block on systemctl post-update triggers,1,[],https://github.com/clearlinux/swupd-client/pull/166,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/166,"We call systemctl to update triggers once an update finishes, which enqueues a
task and then waits to finish by default thus blocking the system() call. This
adds unnecessary time to the update, so set --no-block and move on since we
already reached the end of the update.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","We call systemctl to update triggers once an update finishes, which enqueues a
task and then waits to finish by default thus blocking the system() call. This
adds unnecessary time to the update, so set --no-block and move on since we
already reached the end of the update.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,166,2016-11-22T21:26:28Z,2016-11-22T23:12:55Z,2017-10-20T18:46:12Z,MERGED,True,2,2,1,https://github.com/tmarcu,Do not block on systemctl post-update triggers,1,[],https://github.com/clearlinux/swupd-client/pull/166,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/166#issuecomment-262374753,"We call systemctl to update triggers once an update finishes, which enqueues a
task and then waits to finish by default thus blocking the system() call. This
adds unnecessary time to the update, so set --no-block and move on since we
already reached the end of the update.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,167,2016-11-23T21:17:25Z,2016-11-30T02:15:06Z,2016-11-30T19:42:49Z,MERGED,True,133,22,7,https://github.com/sofar,Telemetry - re-introduce telemetry.,4,[],https://github.com/clearlinux/swupd-client/pull/167,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/167,"This is a new telemetry framework for swupd-client. The patch is split up in a few changes:

clean out some old telemetry stuff that was left around and is unused.
Separate patch to always create new telemetry drop folder
introduce new telemetry() function and use it in 3 locations (check, update, and verify paths) to create a telemetry record at completion of those actions.

This won't actually deliver records to the telemetry service. For that, a separate telemetry agent will be created that runs as a separate process and does not affect swupd operation. That ""probe"" will have its own repository.","This is a new telemetry framework for swupd-client. The patch is split up in a few changes:

clean out some old telemetry stuff that was left around and is unused.
Separate patch to always create new telemetry drop folder
introduce new telemetry() function and use it in 3 locations (check, update, and verify paths) to create a telemetry record at completion of those actions.

This won't actually deliver records to the telemetry service. For that, a separate telemetry agent will be created that runs as a separate process and does not affect swupd operation. That ""probe"" will have its own repository.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,167,2016-11-23T21:17:25Z,2016-11-30T02:15:06Z,2016-11-30T19:42:49Z,MERGED,True,133,22,7,https://github.com/sofar,Telemetry - re-introduce telemetry.,4,[],https://github.com/clearlinux/swupd-client/pull/167,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/167#issuecomment-263321626,"This is a new telemetry framework for swupd-client. The patch is split up in a few changes:

clean out some old telemetry stuff that was left around and is unused.
Separate patch to always create new telemetry drop folder
introduce new telemetry() function and use it in 3 locations (check, update, and verify paths) to create a telemetry record at completion of those actions.

This won't actually deliver records to the telemetry service. For that, a separate telemetry agent will be created that runs as a separate process and does not affect swupd operation. That ""probe"" will have its own repository.",Fixed up all the telemetry messages starting with action=.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,167,2016-11-23T21:17:25Z,2016-11-30T02:15:06Z,2016-11-30T19:42:49Z,MERGED,True,133,22,7,https://github.com/sofar,Telemetry - re-introduce telemetry.,4,[],https://github.com/clearlinux/swupd-client/pull/167,https://github.com/sofar,3,https://github.com/clearlinux/swupd-client/pull/167#issuecomment-263422392,"This is a new telemetry framework for swupd-client. The patch is split up in a few changes:

clean out some old telemetry stuff that was left around and is unused.
Separate patch to always create new telemetry drop folder
introduce new telemetry() function and use it in 3 locations (check, update, and verify paths) to create a telemetry record at completion of those actions.

This won't actually deliver records to the telemetry service. For that, a separate telemetry agent will be created that runs as a separate process and does not affect swupd operation. That ""probe"" will have its own repository.","I've fixed up all the comments, and added 1 more commit to rename the dirs to state_dirs. I've inserted it before the series since that makes more sense.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,167,2016-11-23T21:17:25Z,2016-11-30T02:15:06Z,2016-11-30T19:42:49Z,MERGED,True,133,22,7,https://github.com/sofar,Telemetry - re-introduce telemetry.,4,[],https://github.com/clearlinux/swupd-client/pull/167,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/167#issuecomment-263426288,"This is a new telemetry framework for swupd-client. The patch is split up in a few changes:

clean out some old telemetry stuff that was left around and is unused.
Separate patch to always create new telemetry drop folder
introduce new telemetry() function and use it in 3 locations (check, update, and verify paths) to create a telemetry record at completion of those actions.

This won't actually deliver records to the telemetry service. For that, a separate telemetry agent will be created that runs as a separate process and does not affect swupd operation. That ""probe"" will have its own repository.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,168,2016-11-29T15:57:13Z,2017-05-03T18:58:35Z,2017-05-03T18:58:35Z,CLOSED,False,7,0,1,https://github.com/andred,staging: better handle file type change from directory,1,[],https://github.com/clearlinux/swupd-client/pull/168,https://github.com/andred,1,https://github.com/clearlinux/swupd-client/pull/168,"If the file type changes from directory to something else,
we have to make sure to end up in the right place when
extracting it.
So far, we end up the directory case, but of course we
need to get into the case of non-directory.
Note that at least bsdtar handles extracting a new non-
directory over an existing directory with the same name
fine, i.e. the existing directory is correctly removed,
and the new file (or symlink) created instead.
Signed-off-by: Andr Draszik git@andred.net","If the file type changes from directory to something else,
we have to make sure to end up in the right place when
extracting it.
So far, we end up the directory case, but of course we
need to get into the case of non-directory.
Note that at least bsdtar handles extracting a new non-
directory over an existing directory with the same name
fine, i.e. the existing directory is correctly removed,
and the new file (or symlink) created instead.
Signed-off-by: Andr Draszik git@andred.net",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,168,2016-11-29T15:57:13Z,2017-05-03T18:58:35Z,2017-05-03T18:58:35Z,CLOSED,False,7,0,1,https://github.com/andred,staging: better handle file type change from directory,1,[],https://github.com/clearlinux/swupd-client/pull/168,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/168#issuecomment-264271057,"If the file type changes from directory to something else,
we have to make sure to end up in the right place when
extracting it.
So far, we end up the directory case, but of course we
need to get into the case of non-directory.
Note that at least bsdtar handles extracting a new non-
directory over an existing directory with the same name
fine, i.e. the existing directory is correctly removed,
and the new file (or symlink) created instead.
Signed-off-by: Andr Draszik git@andred.net","We discussed this a bit yesterday to come up with a more complete solution to the problem of directory -> symlink. For the trivial case, empty dir -> symlink the code should work to just remove the dir and create a new link. However, considering the case of a directory that's populated, we need to do better:

If dir is empty: rmdir & create link
If dir is not empty: all files should be marked deleted, delete all marked files first & try to rmdir
If leftover content remains: mv dir -> dir.timestamp, create the new link/file & continue.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/169,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.","To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/169#issuecomment-264108542,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.",I added a few additional cleanup patches for configure.ac before adding the new option.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/169#issuecomment-264215379,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.",Could we also get this path configurable through the command line?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/169#issuecomment-264267401,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.","@bryteise The command line is getting bloated and ugly, what are the flags you propose to add?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/169#issuecomment-264267707,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.",@tmarcu -C --certificate-path,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/169#issuecomment-264965930,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.","Currently untested, but I implemented a -C/--certpath option for the subcommands to override the builtin default value.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,169,2016-12-01T02:34:43Z,2016-12-21T00:23:39Z,2016-12-21T06:45:24Z,MERGED,True,321,159,10,https://github.com/phmccarty,Cleanups for the configure.ac; make the certificate location configurable,9,[],https://github.com/clearlinux/swupd-client/pull/169,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/169#issuecomment-268391278,"To better support running the functional test suite with signature
verification enabled, make the certificate location configurable. Note
that the basename of the certificate used for verification can be
configured separately with the --with-swupdcert=NAME option.",Rebased to latest master.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,170,2016-12-06T19:32:36Z,2016-12-08T18:32:01Z,2016-12-08T18:32:01Z,MERGED,True,36,8,6,https://github.com/sofar,"Telemetry: new API, add bundle add/remove telemetry.",2,[],https://github.com/clearlinux/swupd-client/pull/170,https://github.com/sofar,1,https://github.com/clearlinux/swupd-client/pull/170,"Change telemetry API - add class component.
Telemetry: add telemetry for bundle add, remove.","Change telemetry API - add class component.
Telemetry: add telemetry for bundle add, remove.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,170,2016-12-06T19:32:36Z,2016-12-08T18:32:01Z,2016-12-08T18:32:01Z,MERGED,True,36,8,6,https://github.com/sofar,"Telemetry: new API, add bundle add/remove telemetry.",2,[],https://github.com/clearlinux/swupd-client/pull/170,https://github.com/ahkok,2,https://github.com/clearlinux/swupd-client/pull/170#issuecomment-265587142,"Change telemetry API - add class component.
Telemetry: add telemetry for bundle add, remove.",Updated to fix a minor leak.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,170,2016-12-06T19:32:36Z,2016-12-08T18:32:01Z,2016-12-08T18:32:01Z,MERGED,True,36,8,6,https://github.com/sofar,"Telemetry: new API, add bundle add/remove telemetry.",2,[],https://github.com/clearlinux/swupd-client/pull/170,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/170#issuecomment-265589142,"Change telemetry API - add class component.
Telemetry: add telemetry for bundle add, remove.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,171,2016-12-19T23:18:02Z,2016-12-22T00:09:15Z,2017-11-30T23:31:09Z,MERGED,True,21,0,1,https://github.com/phmccarty,build: add 'compliant' target for fixing code style issues,1,[],https://github.com/clearlinux/swupd-client/pull/171,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/171,"To simplify the discovery of C code style issues and enforce the rules
specified in .clang-format, I've added a new 'compliant' target for
running the appropriate clang-format command.
In case code style issues are found, source files are modified in place,
and the resulting diff can be viewed. The exit code in this case will be
1, so make will exit with an error. This helps to automate testing for
code style issues.","To simplify the discovery of C code style issues and enforce the rules
specified in .clang-format, I've added a new 'compliant' target for
running the appropriate clang-format command.
In case code style issues are found, source files are modified in place,
and the resulting diff can be viewed. The exit code in this case will be
1, so make will exit with an error. This helps to automate testing for
code style issues.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,173,2017-01-05T23:11:26Z,2017-01-25T01:30:43Z,2017-11-30T23:31:11Z,MERGED,True,53,29,11,https://github.com/phmccarty,Some error handling improvements; miscellaneous cleanups,14,[],https://github.com/clearlinux/swupd-client/pull/173,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/173,"This series is a first pass at some error handling improvements, with the goal of using the same error codes for certain classes of errors, and to make sure the main program always exits with a positive value for errors.
I have not yet addressed the more complex error handling scenarios (e.g. in src/staging.c). That will come later.
One behavior change should be noted: for swupd operations that require zero packs, the operation will now fail if the packs fail to extract with tar. Previously, pack extraction issues were ignored.","This series is a first pass at some error handling improvements, with the goal of using the same error codes for certain classes of errors, and to make sure the main program always exits with a positive value for errors.
I have not yet addressed the more complex error handling scenarios (e.g. in src/staging.c). That will come later.
One behavior change should be noted: for swupd operations that require zero packs, the operation will now fail if the packs fail to extract with tar. Previously, pack extraction issues were ignored.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,173,2017-01-05T23:11:26Z,2017-01-25T01:30:43Z,2017-11-30T23:31:11Z,MERGED,True,53,29,11,https://github.com/phmccarty,Some error handling improvements; miscellaneous cleanups,14,[],https://github.com/clearlinux/swupd-client/pull/173,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/173#issuecomment-270787871,"This series is a first pass at some error handling improvements, with the goal of using the same error codes for certain classes of errors, and to make sure the main program always exits with a positive value for errors.
I have not yet addressed the more complex error handling scenarios (e.g. in src/staging.c). That will come later.
One behavior change should be noted: for swupd operations that require zero packs, the operation will now fail if the packs fail to extract with tar. Previously, pack extraction issues were ignored.","One other thing to note: bundle-add and verify --install will fail for pack tar extract failures. If that behavior is not desired, then I will need to address this issue.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,173,2017-01-05T23:11:26Z,2017-01-25T01:30:43Z,2017-11-30T23:31:11Z,MERGED,True,53,29,11,https://github.com/phmccarty,Some error handling improvements; miscellaneous cleanups,14,[],https://github.com/clearlinux/swupd-client/pull/173,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/173#issuecomment-270793446,"This series is a first pass at some error handling improvements, with the goal of using the same error codes for certain classes of errors, and to make sure the main program always exits with a positive value for errors.
I have not yet addressed the more complex error handling scenarios (e.g. in src/staging.c). That will come later.
One behavior change should be noted: for swupd operations that require zero packs, the operation will now fail if the packs fail to extract with tar. Previously, pack extraction issues were ignored.",@phmccarty Is that failure going to happen if there was a download problem (corrupt tar)? Assuming it fails if there was no download issue then that is correct behavior imo.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,173,2017-01-05T23:11:26Z,2017-01-25T01:30:43Z,2017-11-30T23:31:11Z,MERGED,True,53,29,11,https://github.com/phmccarty,Some error handling improvements; miscellaneous cleanups,14,[],https://github.com/clearlinux/swupd-client/pull/173,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/173#issuecomment-270794510,"This series is a first pass at some error handling improvements, with the goal of using the same error codes for certain classes of errors, and to make sure the main program always exits with a positive value for errors.
I have not yet addressed the more complex error handling scenarios (e.g. in src/staging.c). That will come later.
One behavior change should be noted: for swupd operations that require zero packs, the operation will now fail if the packs fail to extract with tar. Previously, pack extraction issues were ignored.","@bryteise The new failure case is when the download succeeds (from libcurl's perspective), but the tar extract fails.
Also, my previous comment was incorrect. bundle-add doesn't check for pack download errors, so only verify --install would be affected by the new failure case.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,174,2017-01-10T18:09:12Z,2017-01-18T17:46:07Z,2017-01-18T17:46:07Z,MERGED,True,17,3,1,https://github.com/ahkok,Telemetry: Atomically create telemetry record.,1,[],https://github.com/clearlinux/swupd-client/pull/174,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/174,"As it turns out, systemd is so efficient spotting new telemetry
records and spawning swupd-probe to retrieve them, that on several
occasions it does so before the entire record is written out by
printf(). This results in the server receiving an empty record from
the swupd telemetry process - it is reading the record data before
writing succeeded.
To guard against this, we atomically move (rename(2)) the record
after it was fully generated. This assures that the full record data
is present before swupd-probe can see it.
To do this safely, we mkstemp() the record outside the telemetry
spool in /var/lib/swupd, and then move it after it is complete
into /var/lib/swupd/telemetry. This requires, unfortunately, that
we use basename(3), and another string for the final file name,
since rename(2) doesn't allow moving to a folder (it requires the
file argument).","As it turns out, systemd is so efficient spotting new telemetry
records and spawning swupd-probe to retrieve them, that on several
occasions it does so before the entire record is written out by
printf(). This results in the server receiving an empty record from
the swupd telemetry process - it is reading the record data before
writing succeeded.
To guard against this, we atomically move (rename(2)) the record
after it was fully generated. This assures that the full record data
is present before swupd-probe can see it.
To do this safely, we mkstemp() the record outside the telemetry
spool in /var/lib/swupd, and then move it after it is complete
into /var/lib/swupd/telemetry. This requires, unfortunately, that
we use basename(3), and another string for the final file name,
since rename(2) doesn't allow moving to a folder (it requires the
file argument).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/MarioCarrilloA,1,https://github.com/clearlinux/swupd-client/pull/175,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/sofar,2,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-272553628,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","Please also update the man page to add the new subcommand:
https://github.com/clearlinux/swupd-client/blob/master/docs/swupd.1.md
Edit: and re-generate swupd.1 after editing the .md file.",True,{'THUMBS_UP': ['https://github.com/MarioCarrilloA']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-272557805,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","It would be nice if the new subcommand got the bundle-add --list-bundles feature added to it as well (as an option) to keep the very similar features in a single place. Note this causes the need for the bundle-list subcommand to support a lot of the other common swupd options.
Should have tests for this change too.",True,{'THUMBS_UP': ['https://github.com/MarioCarrilloA']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-272558657,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","@bryteise I like that idea. bundle-list lists the installed bundles, and bundle-list --all could list all available bundles, with identical output to bundle-add --list.",True,"{'THUMBS_UP': ['https://github.com/bryteise', 'https://github.com/MarioCarrilloA']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/MarioCarrilloA,5,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-272565768,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","Thank you so much for feedback, I am going to work in a new commit about man page, and once these changes are merged, I am going to work in to move bundle-add --list to bundle-list sub-command :)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/MarioCarrilloA,6,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-272573144,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.",@phmccarty @sofar @bryteise documentation commit done :),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/sofar,7,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-273307737,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","I'm OK with this as-is, but the question remains who will add the requested additional --all command.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,175,2017-01-13T18:10:58Z,2017-01-18T17:52:50Z,2017-01-18T19:21:53Z,MERGED,True,116,0,8,https://github.com/MarioCarrilloA,Add new bundle-list sub-command,3,[],https://github.com/clearlinux/swupd-client/pull/175,https://github.com/MarioCarrilloA,8,https://github.com/clearlinux/swupd-client/pull/175#issuecomment-273320704,"This group of patches add a new sub-command to swupd ""bundle-list"", this sub-command allows to show which bundles are installed in the local system.","@sofar I will add it, once this request has been merged :)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,176,2017-01-24T21:40:39Z,2017-01-31T20:38:31Z,2017-01-31T20:38:31Z,MERGED,True,136,36,21,https://github.com/MarioCarrilloA,"Move [-l, --list] option to ""bundle-list"" sub-command",4,[],https://github.com/clearlinux/swupd-client/pull/176,https://github.com/MarioCarrilloA,1,https://github.com/clearlinux/swupd-client/pull/176,"This group of patches allow that bundle-list gets [-l, --list] option from ""bundle-add"", furthermore this option is renamed as [-a, --all] in order to keep coherence and semantic.","This group of patches allow that bundle-list gets [-l, --list] option from ""bundle-add"", furthermore this option is renamed as [-a, --all] in order to keep coherence and semantic.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,176,2017-01-24T21:40:39Z,2017-01-31T20:38:31Z,2017-01-31T20:38:31Z,MERGED,True,136,36,21,https://github.com/MarioCarrilloA,"Move [-l, --list] option to ""bundle-list"" sub-command",4,[],https://github.com/clearlinux/swupd-client/pull/176,https://github.com/MarioCarrilloA,2,https://github.com/clearlinux/swupd-client/pull/176#issuecomment-275141935,"This group of patches allow that bundle-list gets [-l, --list] option from ""bundle-add"", furthermore this option is renamed as [-a, --all] in order to keep coherence and semantic.",@phmccarty done :) thanks,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,176,2017-01-24T21:40:39Z,2017-01-31T20:38:31Z,2017-01-31T20:38:31Z,MERGED,True,136,36,21,https://github.com/MarioCarrilloA,"Move [-l, --list] option to ""bundle-list"" sub-command",4,[],https://github.com/clearlinux/swupd-client/pull/176,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/176#issuecomment-275469740,"This group of patches allow that bundle-list gets [-l, --list] option from ""bundle-add"", furthermore this option is renamed as [-a, --all] in order to keep coherence and semantic.",Can you rebase this to latest master?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,176,2017-01-24T21:40:39Z,2017-01-31T20:38:31Z,2017-01-31T20:38:31Z,MERGED,True,136,36,21,https://github.com/MarioCarrilloA,"Move [-l, --list] option to ""bundle-list"" sub-command",4,[],https://github.com/clearlinux/swupd-client/pull/176,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/176#issuecomment-276484665,"This group of patches allow that bundle-list gets [-l, --list] option from ""bundle-add"", furthermore this option is renamed as [-a, --all] in order to keep coherence and semantic.",+1 for updating tests too.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,177,2017-01-30T19:57:29Z,2017-01-31T20:39:11Z,2017-11-30T23:31:23Z,MERGED,True,1,511,171,https://github.com/phmccarty,Remove .signed files in functional tests,2,[],https://github.com/clearlinux/swupd-client/pull/177,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/177,"These files have never been used by the functional tests, so they can be safely removed from the tree.","These files have never been used by the functional tests, so they can be safely removed from the tree.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,177,2017-01-30T19:57:29Z,2017-01-31T20:39:11Z,2017-11-30T23:31:23Z,MERGED,True,1,511,171,https://github.com/phmccarty,Remove .signed files in functional tests,2,[],https://github.com/clearlinux/swupd-client/pull/177,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/177#issuecomment-276173963,"These files have never been used by the functional tests, so they can be safely removed from the tree.",Yaay!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,177,2017-01-30T19:57:29Z,2017-01-31T20:39:11Z,2017-11-30T23:31:23Z,MERGED,True,1,511,171,https://github.com/phmccarty,Remove .signed files in functional tests,2,[],https://github.com/clearlinux/swupd-client/pull/177,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/177#issuecomment-276484882,"These files have never been used by the functional tests, so they can be safely removed from the tree.",Thank you +10,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,178,2017-01-31T21:49:20Z,2017-02-01T19:03:44Z,2017-02-01T19:03:44Z,MERGED,True,73,4,3,https://github.com/MarioCarrilloA,Fix swupd options for bundle-list --all unit test,2,[],https://github.com/clearlinux/swupd-client/pull/178,https://github.com/MarioCarrilloA,1,https://github.com/clearlinux/swupd-client/pull/178,"The swupd unit tests need a group of
options for execution environment, this
var was missed.
Signed-off-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com","The swupd unit tests need a group of
options for execution environment, this
var was missed.
Signed-off-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,178,2017-01-31T21:49:20Z,2017-02-01T19:03:44Z,2017-02-01T19:03:44Z,MERGED,True,73,4,3,https://github.com/MarioCarrilloA,Fix swupd options for bundle-list --all unit test,2,[],https://github.com/clearlinux/swupd-client/pull/178,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/178#issuecomment-276507805,"The swupd unit tests need a group of
options for execution environment, this
var was missed.
Signed-off-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com","It looks like bundle-list doesn't support the -S/--statedir option, according to test results.",True,{'THUMBS_UP': ['https://github.com/MarioCarrilloA']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,178,2017-01-31T21:49:20Z,2017-02-01T19:03:44Z,2017-02-01T19:03:44Z,MERGED,True,73,4,3,https://github.com/MarioCarrilloA,Fix swupd options for bundle-list --all unit test,2,[],https://github.com/clearlinux/swupd-client/pull/178,https://github.com/MarioCarrilloA,3,https://github.com/clearlinux/swupd-client/pull/178#issuecomment-276510020,"The swupd unit tests need a group of
options for execution environment, this
var was missed.
Signed-off-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com","@phmccarty yes, this var uses some options that swupd bundle-list does not support, I will send a new set of patches for that",True,{'HOORAY': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,178,2017-01-31T21:49:20Z,2017-02-01T19:03:44Z,2017-02-01T19:03:44Z,MERGED,True,73,4,3,https://github.com/MarioCarrilloA,Fix swupd options for bundle-list --all unit test,2,[],https://github.com/clearlinux/swupd-client/pull/178,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/178#issuecomment-276748765,"The swupd unit tests need a group of
options for execution environment, this
var was missed.
Signed-off-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com","+1, thanks for the quick fix!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,179,2017-02-01T18:25:37Z,2017-02-02T01:39:24Z,2017-02-02T03:03:19Z,MERGED,True,20,48,5,https://github.com/ikeydoherty,clr-boot-manager fixes,3,[],https://github.com/clearlinux/swupd-client/pull/179,https://github.com/ikeydoherty,1,https://github.com/clearlinux/swupd-client/pull/179,"This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.","This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,179,2017-02-01T18:25:37Z,2017-02-02T01:39:24Z,2017-02-02T03:03:19Z,MERGED,True,20,48,5,https://github.com/ikeydoherty,clr-boot-manager fixes,3,[],https://github.com/clearlinux/swupd-client/pull/179,https://github.com/ikeydoherty,2,https://github.com/clearlinux/swupd-client/pull/179#issuecomment-276739415,"This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.",Well then.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,179,2017-02-01T18:25:37Z,2017-02-02T01:39:24Z,2017-02-02T03:03:19Z,MERGED,True,20,48,5,https://github.com/ikeydoherty,clr-boot-manager fixes,3,[],https://github.com/clearlinux/swupd-client/pull/179,https://github.com/ikeydoherty,3,https://github.com/clearlinux/swupd-client/pull/179#issuecomment-276739843,"This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.",Redoing.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,179,2017-02-01T18:25:37Z,2017-02-02T01:39:24Z,2017-02-02T03:03:19Z,MERGED,True,20,48,5,https://github.com/ikeydoherty,clr-boot-manager fixes,3,[],https://github.com/clearlinux/swupd-client/pull/179,https://github.com/ikeydoherty,4,https://github.com/clearlinux/swupd-client/pull/179#issuecomment-276755107,"This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.",Force pushed new set,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,179,2017-02-01T18:25:37Z,2017-02-02T01:39:24Z,2017-02-02T03:03:19Z,MERGED,True,20,48,5,https://github.com/ikeydoherty,clr-boot-manager fixes,3,[],https://github.com/clearlinux/swupd-client/pull/179,https://github.com/ikeydoherty,5,https://github.com/clearlinux/swupd-client/pull/179#issuecomment-276771891,"This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.",Oooo I know why it failed for me before - I suffer the umask issue on my host.. :),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,179,2017-02-01T18:25:37Z,2017-02-02T01:39:24Z,2017-02-02T03:03:19Z,MERGED,True,20,48,5,https://github.com/ikeydoherty,clr-boot-manager fixes,3,[],https://github.com/clearlinux/swupd-client/pull/179,https://github.com/ikeydoherty,6,https://github.com/clearlinux/swupd-client/pull/179#issuecomment-276855361,"This change adds a minor code-styling fix, but more importantly it moves swupd-client away from using the legacy compatibility scripts inside clr-boot-manager, enforcing direct usage of it.
Note that a potential issue with the previous behaviour is the compatibility scripts do not contain a bin prefix, i.e. $root/usr/bin/*.sh invoke clr-boot-manager update $*, meaning the host side tool is
employed rather than the rootfs one.",Merci,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,180,2017-02-01T20:48:30Z,2017-02-02T19:38:51Z,2017-02-02T19:42:45Z,MERGED,True,115,0,3,https://github.com/ikeydoherty,Add support for automated building within docker environment.,1,[],https://github.com/clearlinux/swupd-client/pull/180,https://github.com/ikeydoherty,1,https://github.com/clearlinux/swupd-client/pull/180,"This change adds a simple ""./continous.sh"" script which will allow
developers to test their changes against ""clearlinux:latest"" within a
clean Docker container.
If the container does not already exist, it will be created on demand.
Future builds will be done near instantly within the container.
Signed-off-by: Ikey Doherty michael.i.doherty@intel.com","This change adds a simple ""./continous.sh"" script which will allow
developers to test their changes against ""clearlinux:latest"" within a
clean Docker container.
If the container does not already exist, it will be created on demand.
Future builds will be done near instantly within the container.
Signed-off-by: Ikey Doherty michael.i.doherty@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,180,2017-02-01T20:48:30Z,2017-02-02T19:38:51Z,2017-02-02T19:42:45Z,MERGED,True,115,0,3,https://github.com/ikeydoherty,Add support for automated building within docker environment.,1,[],https://github.com/clearlinux/swupd-client/pull/180,https://github.com/ikeydoherty,2,https://github.com/clearlinux/swupd-client/pull/180#issuecomment-276777972,"This change adds a simple ""./continous.sh"" script which will allow
developers to test their changes against ""clearlinux:latest"" within a
clean Docker container.
If the container does not already exist, it will be created on demand.
Future builds will be done near instantly within the container.
Signed-off-by: Ikey Doherty michael.i.doherty@intel.com",Note: Creating the initial container does take a fair amount of time. Extra bundles were added to compensate for the sudo and curl binary requirements.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,180,2017-02-01T20:48:30Z,2017-02-02T19:38:51Z,2017-02-02T19:42:45Z,MERGED,True,115,0,3,https://github.com/ikeydoherty,Add support for automated building within docker environment.,1,[],https://github.com/clearlinux/swupd-client/pull/180,https://github.com/ikeydoherty,3,https://github.com/clearlinux/swupd-client/pull/180#issuecomment-276782176,"This change adds a simple ""./continous.sh"" script which will allow
developers to test their changes against ""clearlinux:latest"" within a
clean Docker container.
If the container does not already exist, it will be created on demand.
Future builds will be done near instantly within the container.
Signed-off-by: Ikey Doherty michael.i.doherty@intel.com","Entirely random and off topic observation: Does that green icon next to ""All checks have passed"" (not the tick) remind anyone else of Steam?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,180,2017-02-01T20:48:30Z,2017-02-02T19:38:51Z,2017-02-02T19:42:45Z,MERGED,True,115,0,3,https://github.com/ikeydoherty,Add support for automated building within docker environment.,1,[],https://github.com/clearlinux/swupd-client/pull/180,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/180#issuecomment-277059638,"This change adds a simple ""./continous.sh"" script which will allow
developers to test their changes against ""clearlinux:latest"" within a
clean Docker container.
If the container does not already exist, it will be created on demand.
Future builds will be done near instantly within the container.
Signed-off-by: Ikey Doherty michael.i.doherty@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,180,2017-02-01T20:48:30Z,2017-02-02T19:38:51Z,2017-02-02T19:42:45Z,MERGED,True,115,0,3,https://github.com/ikeydoherty,Add support for automated building within docker environment.,1,[],https://github.com/clearlinux/swupd-client/pull/180,https://github.com/ikeydoherty,5,https://github.com/clearlinux/swupd-client/pull/180#issuecomment-277061009,"This change adds a simple ""./continous.sh"" script which will allow
developers to test their changes against ""clearlinux:latest"" within a
clean Docker container.
If the container does not already exist, it will be created on demand.
Future builds will be done near instantly within the container.
Signed-off-by: Ikey Doherty michael.i.doherty@intel.com",Merci!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,181,2017-02-03T22:34:00Z,2017-02-07T21:41:06Z,2017-02-07T21:41:06Z,MERGED,True,1,0,1,https://github.com/fandeli,Fix swupd_lock file descriptor leaking,1,[],https://github.com/clearlinux/swupd-client/pull/181,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/181,"The swupd_lock is not properly closed
when the work is done with bundle-list
subcommand.","The swupd_lock is not properly closed
when the work is done with bundle-list
subcommand.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,181,2017-02-03T22:34:00Z,2017-02-07T21:41:06Z,2017-02-07T21:41:06Z,MERGED,True,1,0,1,https://github.com/fandeli,Fix swupd_lock file descriptor leaking,1,[],https://github.com/clearlinux/swupd-client/pull/181,https://github.com/fandeli,2,https://github.com/clearlinux/swupd-client/pull/181#issuecomment-277381317,"The swupd_lock is not properly closed
when the work is done with bundle-list
subcommand.",Was having a break and found this little sucker so I went and fix it ;),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,181,2017-02-03T22:34:00Z,2017-02-07T21:41:06Z,2017-02-07T21:41:06Z,MERGED,True,1,0,1,https://github.com/fandeli,Fix swupd_lock file descriptor leaking,1,[],https://github.com/clearlinux/swupd-client/pull/181,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/181#issuecomment-277387389,"The swupd_lock is not properly closed
when the work is done with bundle-list
subcommand.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,181,2017-02-03T22:34:00Z,2017-02-07T21:41:06Z,2017-02-07T21:41:06Z,MERGED,True,1,0,1,https://github.com/fandeli,Fix swupd_lock file descriptor leaking,1,[],https://github.com/clearlinux/swupd-client/pull/181,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/181#issuecomment-278149331,"The swupd_lock is not properly closed
when the work is done with bundle-list
subcommand.",Nice catch :) ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,182,2017-02-07T22:22:36Z,2017-02-27T19:40:12Z,2017-10-20T18:46:21Z,MERGED,True,3,16,3,https://github.com/tmarcu,Change certpath to be full path of certificate,1,[],https://github.com/clearlinux/swupd-client/pull/182,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/182,"The mixer and image creator treat the certpath as the full path of the
certificate filename, and swupd should too. If someone is overriding the
certificate with the cert path option, use the supplied string and don't
append a pre-defined name to it.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The mixer and image creator treat the certpath as the full path of the
certificate filename, and swupd should too. If someone is overriding the
certificate with the cert path option, use the supplied string and don't
append a pre-defined name to it.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,184,2017-02-24T21:31:09Z,2017-03-23T01:09:06Z,2017-11-30T23:31:27Z,CLOSED,False,10,8,1,https://github.com/phmccarty,Refresh bash completion script,1,[],https://github.com/clearlinux/swupd-client/pull/184,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/184,"The scripts/swupd-completion.sh script can be run from the top source
directory to regenerate the completion script (swupd.bash).","The scripts/swupd-completion.sh script can be run from the top source
directory to regenerate the completion script (swupd.bash).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,184,2017-02-24T21:31:09Z,2017-03-23T01:09:06Z,2017-11-30T23:31:27Z,CLOSED,False,10,8,1,https://github.com/phmccarty,Refresh bash completion script,1,[],https://github.com/clearlinux/swupd-client/pull/184,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/184#issuecomment-282415923,"The scripts/swupd-completion.sh script can be run from the top source
directory to regenerate the completion script (swupd.bash).",Should this be something done as part of make dist perhaps?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,184,2017-02-24T21:31:09Z,2017-03-23T01:09:06Z,2017-11-30T23:31:27Z,CLOSED,False,10,8,1,https://github.com/phmccarty,Refresh bash completion script,1,[],https://github.com/clearlinux/swupd-client/pull/184,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/184#issuecomment-282417676,"The scripts/swupd-completion.sh script can be run from the top source
directory to regenerate the completion script (swupd.bash).",I added it to the release process steps.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,185,2017-02-25T00:36:59Z,2017-02-27T19:36:24Z,2017-02-27T19:36:24Z,MERGED,True,16,0,1,https://github.com/fandeli,fix memory corruption on multiple swupd_init call,1,[],https://github.com/clearlinux/swupd-client/pull/185,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/185,"When swupd_init() is called more than once in
the same supwd run, pointer corruption ocurs on
some global variables causing memory corruption
and finally a SIGABRT. This patch fixes that
condition by properly setting all globals to
NULL when swupd_deinit() is called; or more
properly free_globals().","When swupd_init() is called more than once in
the same supwd run, pointer corruption ocurs on
some global variables causing memory corruption
and finally a SIGABRT. This patch fixes that
condition by properly setting all globals to
NULL when swupd_deinit() is called; or more
properly free_globals().",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/186,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/186#issuecomment-282785955,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","I haven't looked at this patch yet, but I did update the completion script in #184. swupd.bash is intended to be updated as part of the release process, but in recent releases this was not done.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/186#issuecomment-282790235,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","The patch removes the script for automatically generating the completion function (based on the help output) and replaces the function with a manually written one. I can certainly alter the automatic generation script to work in 2 parts, get the flags automatically from the --help output and then add extra completions based on the name, but I am not sure of the value now that swupd-client is fairly stable.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/186#issuecomment-283152628,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","@icarus-sparry I'm inclined to keep the script that just auto-generates it, so it can be automated at some point and not a user required action.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/icarus-sparry,5,https://github.com/clearlinux/swupd-client/pull/186#issuecomment-283175277,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Whilst there are advantages to doing this, there are also downsides.

1)      The script which does the generation has to be updated. This negates some of the advantage of automatic generation.

2)      You get completion of options which you no longer want, e.g. -l to bundle-add.

If you dont generate the script, there is no need to add code to do the automation of the generation.

From: tmarcu [mailto:notifications@github.com]
Sent: Tuesday, February 28, 2017 12:33 PM
To: clearlinux/swupd-client <swupd-client@noreply.github.com>
Cc: Sparry, Icarus W <icarus.w.sparry@intel.com>; Mention <mention@noreply.github.com>
Subject: Re: [clearlinux/swupd-client] Add package names to completion (#186)


@icarus-sparry<https://github.com/icarus-sparry> I'm inclined to keep the script that just auto-generates it, so it can be automated at some point and not a user required action.


You are receiving this because you were mentioned.
Reply to this email directly, view it on GitHub<#186 (comment)>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AUTyzzHPpImWj3bgzMILcg7IvsLe8Bt9ks5rhISLgaJpZM4MNTF3>.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/186#issuecomment-284223830,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,186,2017-02-27T16:10:56Z,2017-03-23T01:33:31Z,2017-08-31T22:57:57Z,CLOSED,False,98,180,3,https://github.com/icarus-sparry,Add package names to completion,4,[],https://github.com/clearlinux/swupd-client/pull/186,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/186#issuecomment-288590925,"Remove the script which creates the completion script based on the
output of swupd --help. It wasn't being used (e.g. the completion
didn't have bundle-list in it).
Restructure the completion script to use a case statement to list the
valid completion options. IMHO this makes the code easier to
understand.
Add in package name completion for bundle-add. This requires
/var/lib/swupd/XXXXX/Manifest.MoM to exist (where XXXXX is the
contents of /var/lib/swupd/version), be in the correct format
etc.
Add in package name completion for bundle-remove. This uses the
contents of /usr/share/clear/bundles to get the list of installed
bundles. It would be nice to use $(swupd bundle-list) but it aborts if
it is not being run as root, so this means you can't have completion
for ""sudo swupd bundle-remove"".
TODO: Fix bundle completion if --path is specified.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Merged in PR #192 to make Makefile happy.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,187,2017-02-28T02:39:10Z,2017-04-04T18:50:22Z,2017-04-04T18:50:22Z,MERGED,True,234,15,16,https://github.com/fandeli,Accept multiple bundles at bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/187,https://github.com/fandeli,1,https://github.com/clearlinux/swupd-client/pull/187,"This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.","This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,187,2017-02-28T02:39:10Z,2017-04-04T18:50:22Z,2017-04-04T18:50:22Z,MERGED,True,234,15,16,https://github.com/fandeli,Accept multiple bundles at bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/187,https://github.com/fandeli,2,https://github.com/clearlinux/swupd-client/pull/187#issuecomment-283100393,"This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.","failures I'm seeing are expected according to log, behavior changed little bit on bundle-remove so need to patch those tests accordingly. I'll take a look and send patches according new behavior.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,187,2017-02-28T02:39:10Z,2017-04-04T18:50:22Z,2017-04-04T18:50:22Z,MERGED,True,234,15,16,https://github.com/fandeli,Accept multiple bundles at bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/187,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/187#issuecomment-283151700,"This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.",Thank you! You may add them to this PR and force push over it when you get the tests patched if you want.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,187,2017-02-28T02:39:10Z,2017-04-04T18:50:22Z,2017-04-04T18:50:22Z,MERGED,True,234,15,16,https://github.com/fandeli,Accept multiple bundles at bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/187,https://github.com/fandeli,4,https://github.com/clearlinux/swupd-client/pull/187#issuecomment-286586555,"This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.",ready to go! all green ;),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,187,2017-02-28T02:39:10Z,2017-04-04T18:50:22Z,2017-04-04T18:50:22Z,MERGED,True,234,15,16,https://github.com/fandeli,Accept multiple bundles at bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/187,https://github.com/fandeli,5,https://github.com/clearlinux/swupd-client/pull/187#issuecomment-289160275,"This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.",If no further comments or concerns on this patch can we have it merged please?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,187,2017-02-28T02:39:10Z,2017-04-04T18:50:22Z,2017-04-04T18:50:22Z,MERGED,True,234,15,16,https://github.com/fandeli,Accept multiple bundles at bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/187,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/187#issuecomment-291596494,"This is a wrapper around remove_bundle()
to add consistency for bundle-remove
subcommand respect bundle-add that accepts
one or more bundles to be removed.
This must not be the optimal implementation
but it works fine and gives a better user
usage experience.",Merging and setting a new roadmap for refactoring the bundle code so this does not remain the implementation for bundle removes.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,188,2017-02-28T20:19:12Z,2017-02-28T20:27:45Z,2017-10-20T18:46:46Z,MERGED,True,4,194,8,https://github.com/tmarcu,Fix certificate issues with makefile,1,[],https://github.com/clearlinux/swupd-client/pull/188,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/188,"The client does not do certificate pinning anymore, and it should not provide
certificates. This patch removes the unused certificates and clarifies the
certpath option.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The client does not do certificate pinning anymore, and it should not provide
certificates. This patch removes the unused certificates and clarifies the
certpath option.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,188,2017-02-28T20:19:12Z,2017-02-28T20:27:45Z,2017-10-20T18:46:46Z,MERGED,True,4,194,8,https://github.com/tmarcu,Fix certificate issues with makefile,1,[],https://github.com/clearlinux/swupd-client/pull/188,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/188#issuecomment-283150548,"The client does not do certificate pinning anymore, and it should not provide
certificates. This patch removes the unused certificates and clarifies the
certpath option.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,189,2017-03-05T11:57:13Z,2017-03-29T16:42:22Z,2017-10-20T18:46:55Z,MERGED,True,192,20,7,https://github.com/tmarcu,Add verbose timing to swupd operation,1,[],https://github.com/clearlinux/swupd-client/pull/189,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/189,"This introduces a -t/--time option to update, verify, and bundle-add commands, displaying raw elapsed time and CPU process time for integral swupd operations within the given code paths.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","This introduces a -t/--time option to update, verify, and bundle-add commands, displaying raw elapsed time and CPU process time for integral swupd operations within the given code paths.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,190,2017-03-09T19:45:54Z,2017-03-20T18:11:48Z,2017-03-20T18:11:48Z,MERGED,True,980,806,20,https://github.com/ahkok,Convert docs to RST format,2,[],https://github.com/clearlinux/swupd-client/pull/190,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/190,"Two commits:

convert all docs from md to rst. Update Makefile.am
sync up output to newly generated roff files made by rst2man.py","Two commits:

convert all docs from md to rst. Update Makefile.am
sync up output to newly generated roff files made by rst2man.py",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,191,2017-03-21T01:07:49Z,2017-03-23T21:38:10Z,2017-10-20T18:48:33Z,CLOSED,False,56,10,1,https://github.com/tmarcu,Try to recover from invalid certificate date,1,[],https://github.com/clearlinux/swupd-client/pull/191,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/191,"The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the swupd binary itself,
and then the os-release file as backup, neither of which should have been
touched by any user except root.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the swupd binary itself,
and then the os-release file as backup, neither of which should have been
touched by any user except root.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,191,2017-03-21T01:07:49Z,2017-03-23T21:38:10Z,2017-10-20T18:48:33Z,CLOSED,False,56,10,1,https://github.com/tmarcu,Try to recover from invalid certificate date,1,[],https://github.com/clearlinux/swupd-client/pull/191,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/191#issuecomment-288808501,"The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the swupd binary itself,
and then the os-release file as backup, neither of which should have been
touched by any user except root.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","I don't like the idea of SWUPD setting the system time. Its purpose is to update files, not change system-wide settings... I would prefer that a warning be printed regarding a potential time skew, and then the user can fix their system time.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,191,2017-03-21T01:07:49Z,2017-03-23T21:38:10Z,2017-10-20T18:48:33Z,CLOSED,False,56,10,1,https://github.com/tmarcu,Try to recover from invalid certificate date,1,[],https://github.com/clearlinux/swupd-client/pull/191,https://github.com/tpepper,3,https://github.com/clearlinux/swupd-client/pull/191#issuecomment-288816307,"The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the swupd binary itself,
and then the os-release file as backup, neither of which should have been
touched by any user except root.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","I agree with Patrick.  I don't like setting the time.  I worry about the one case William calls out.  If a bad cert input causes the automation to incorrectly set the time, can you recover?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,191,2017-03-21T01:07:49Z,2017-03-23T21:38:10Z,2017-10-20T18:48:33Z,CLOSED,False,56,10,1,https://github.com/tmarcu,Try to recover from invalid certificate date,1,[],https://github.com/clearlinux/swupd-client/pull/191,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/191#issuecomment-288825100,"The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the swupd binary itself,
and then the os-release file as backup, neither of which should have been
touched by any user except root.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",If the cert is bad I would assume the system has already been compromised at that point.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,191,2017-03-21T01:07:49Z,2017-03-23T21:38:10Z,2017-10-20T18:48:33Z,CLOSED,False,56,10,1,https://github.com/tmarcu,Try to recover from invalid certificate date,1,[],https://github.com/clearlinux/swupd-client/pull/191,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/191#issuecomment-288868270,"The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the swupd binary itself,
and then the os-release file as backup, neither of which should have been
touched by any user except root.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",Closing and opening new branch based on previous discussions to separate this functionality out into its own binary.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,192,2017-03-23T01:25:52Z,2017-03-23T01:32:38Z,2017-10-20T18:46:49Z,MERGED,True,98,180,3,https://github.com/tmarcu,Iwjs/f/completion,4,[],https://github.com/clearlinux/swupd-client/pull/192,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/192,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,193,2017-03-23T16:29:27Z,2017-03-23T17:03:39Z,2017-03-23T17:03:45Z,MERGED,True,1,1,1,https://github.com/tpepper,clarify printf,1,[],https://github.com/clearlinux/swupd-client/pull/193,https://github.com/tpepper,1,https://github.com/clearlinux/swupd-client/pull/193,"I noticed this printf says something about getwd(), but that's not
actually being called directly there and that's not super useful to a
non-developer human anyway.  So I translated the function name to an
english description.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com","I noticed this printf says something about getwd(), but that's not
actually being called directly there and that's not super useful to a
non-developer human anyway.  So I translated the function name to an
english description.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,193,2017-03-23T16:29:27Z,2017-03-23T17:03:39Z,2017-03-23T17:03:45Z,MERGED,True,1,1,1,https://github.com/tpepper,clarify printf,1,[],https://github.com/clearlinux/swupd-client/pull/193,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/193#issuecomment-288789325,"I noticed this printf says something about getwd(), but that's not
actually being called directly there and that's not super useful to a
non-developer human anyway.  So I translated the function name to an
english description.
Signed-off-by: Tim Pepper timothy.c.pepper@linux.intel.com",+1 ty.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,194,2017-03-23T18:00:15Z,2017-03-24T22:27:57Z,2017-03-24T22:27:57Z,MERGED,True,22,20,2,https://github.com/icarus-sparry,Improved error reporting for adding bad bundle,1,[],https://github.com/clearlinux/swupd-client/pull/194,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/194,"Currently if you try and add a non existent bundle, e.g. ""foo"" you get
two lines of output
foo bundle name is invalid, skipping it...
bundle(s) already installed, exiting now
This is caused by the add_subscriptions function calling itself
recursivly but failing to pass up results in a meaningful way. This
change makes the return value of add_subscriptions be a bitmask so it
can signal errors and packages added distinctly.
I did think about changing this function to return a struct but
decided this was a step too far.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Currently if you try and add a non existent bundle, e.g. ""foo"" you get
two lines of output
foo bundle name is invalid, skipping it...
bundle(s) already installed, exiting now
This is caused by the add_subscriptions function calling itself
recursivly but failing to pass up results in a meaningful way. This
change makes the return value of add_subscriptions be a bitmask so it
can signal errors and packages added distinctly.
I did think about changing this function to return a struct but
decided this was a step too far.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,194,2017-03-23T18:00:15Z,2017-03-24T22:27:57Z,2017-03-24T22:27:57Z,MERGED,True,22,20,2,https://github.com/icarus-sparry,Improved error reporting for adding bad bundle,1,[],https://github.com/clearlinux/swupd-client/pull/194,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/194#issuecomment-288892270,"Currently if you try and add a non existent bundle, e.g. ""foo"" you get
two lines of output
foo bundle name is invalid, skipping it...
bundle(s) already installed, exiting now
This is caused by the add_subscriptions function calling itself
recursivly but failing to pass up results in a meaningful way. This
change makes the return value of add_subscriptions be a bitmask so it
can signal errors and packages added distinctly.
I did think about changing this function to return a struct but
decided this was a step too far.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Interesting approach!  +1 from me.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,194,2017-03-23T18:00:15Z,2017-03-24T22:27:57Z,2017-03-24T22:27:57Z,MERGED,True,22,20,2,https://github.com/icarus-sparry,Improved error reporting for adding bad bundle,1,[],https://github.com/clearlinux/swupd-client/pull/194,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/194#issuecomment-289157979,"Currently if you try and add a non existent bundle, e.g. ""foo"" you get
two lines of output
foo bundle name is invalid, skipping it...
bundle(s) already installed, exiting now
This is caused by the add_subscriptions function calling itself
recursivly but failing to pass up results in a meaningful way. This
change makes the return value of add_subscriptions be a bitmask so it
can signal errors and packages added distinctly.
I did think about changing this function to return a struct but
decided this was a step too far.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Great work +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,195,2017-03-24T18:51:40Z,2017-03-25T07:00:42Z,2017-03-25T07:00:42Z,MERGED,True,180,18,14,https://github.com/tmarcu,Try to recover from invalid certificate date,1,[],https://github.com/clearlinux/swupd-client/pull/195,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/195,"The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the versionstamp,
which should not have been touched by any user except root. If the time is
normal and verification fails, the cert cannot be trusted.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The system clock may be terribly off, especially on new hardware that has not
yet been calibrated. Updates rely on the certificate and system time being
sane to verify validity, so if a mismatch is found the certificate will
be deemed invalid and the update stopped. This patch attempts to fix the
system time to something sane using the time from the versionstamp,
which should not have been touched by any user except root. If the time is
normal and verification fails, the cert cannot be trusted.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,196,2017-03-27T18:37:34Z,2017-03-27T20:55:53Z,2017-03-27T21:01:25Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,Make the backward compatability check work,1,[],https://github.com/clearlinux/swupd-client/pull/196,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/196,"Use the correct variable BASH_VERSINFO, rather than BASH_VERSION
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Use the correct variable BASH_VERSINFO, rather than BASH_VERSION
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,197,2017-03-29T22:50:45Z,2017-04-04T18:48:45Z,2017-11-30T23:31:30Z,MERGED,True,37,13,1,https://github.com/phmccarty,Error handling fixes for fullfile downloads,7,[],https://github.com/clearlinux/swupd-client/pull/197,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/197,"This series addresses a couple of double frees encountered in error paths and also a ""hysteresis escape"" that was hitting these error paths.","This series addresses a couple of double frees encountered in error paths and also a ""hysteresis escape"" that was hitting these error paths.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,197,2017-03-29T22:50:45Z,2017-04-04T18:48:45Z,2017-11-30T23:31:30Z,MERGED,True,37,13,1,https://github.com/phmccarty,Error handling fixes for fullfile downloads,7,[],https://github.com/clearlinux/swupd-client/pull/197,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/197#issuecomment-290515738,"This series addresses a couple of double frees encountered in error paths and also a ""hysteresis escape"" that was hitting these error paths.","After further testing, I discovered that the hysteresis upper bound may often be exceeded, just not enough to run into any error conditions in most cases.
To improve behavior, I added a small buffer to the upper bound to reduce the possibility of retries kicking in, and I revised how the multi stack is emptied which results in a more balanced add/remove sequence from the stack.
I uploaded a revised patch series with these changes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,198,2017-03-31T02:37:46Z,2017-04-04T18:48:28Z,2017-10-20T18:46:56Z,MERGED,True,82,10,5,https://github.com/tmarcu,Remove bad or unusable Manifest content and retry,1,[],https://github.com/clearlinux/swupd-client/pull/198,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/198,"For various reasons - partial downloads, power failure, user exiting -
the /var/lib/swupd state directory may become corrupt. When this happens,
manifests can be rendered unusable, causing various errors in swupd such as
signature failures, or errors reading the manifest. This patch attempts to
avoid such things causing updates or verifies to fail by cleaning up the
Manifests artifacts of what it could not use, and re-downloading them to
try again.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","For various reasons - partial downloads, power failure, user exiting -
the /var/lib/swupd state directory may become corrupt. When this happens,
manifests can be rendered unusable, causing various errors in swupd such as
signature failures, or errors reading the manifest. This patch attempts to
avoid such things causing updates or verifies to fail by cleaning up the
Manifests artifacts of what it could not use, and re-downloading them to
try again.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,198,2017-03-31T02:37:46Z,2017-04-04T18:48:28Z,2017-10-20T18:46:56Z,MERGED,True,82,10,5,https://github.com/tmarcu,Remove bad or unusable Manifest content and retry,1,[],https://github.com/clearlinux/swupd-client/pull/198,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/198#issuecomment-290785427,"For various reasons - partial downloads, power failure, user exiting -
the /var/lib/swupd state directory may become corrupt. When this happens,
manifests can be rendered unusable, causing various errors in swupd such as
signature failures, or errors reading the manifest. This patch attempts to
avoid such things causing updates or verifies to fail by cleaning up the
Manifests artifacts of what it could not use, and re-downloading them to
try again.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",*Note that the manifest removal/retry only happens once because it doesn't signify a network failure. Those retry paths are handled separately in update and verify.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,198,2017-03-31T02:37:46Z,2017-04-04T18:48:28Z,2017-10-20T18:46:56Z,MERGED,True,82,10,5,https://github.com/tmarcu,Remove bad or unusable Manifest content and retry,1,[],https://github.com/clearlinux/swupd-client/pull/198,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/198#issuecomment-290909216,"For various reasons - partial downloads, power failure, user exiting -
the /var/lib/swupd state directory may become corrupt. When this happens,
manifests can be rendered unusable, causing various errors in swupd such as
signature failures, or errors reading the manifest. This patch attempts to
avoid such things causing updates or verifies to fail by cleaning up the
Manifests artifacts of what it could not use, and re-downloading them to
try again.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Tested Manifest corruption in header, body, and signature (MoM only) for both verify and update paths, and confirmed both operations succeeded in removing the bad files and replaced with correct ones, finishing their procedures fully.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,198,2017-03-31T02:37:46Z,2017-04-04T18:48:28Z,2017-10-20T18:46:56Z,MERGED,True,82,10,5,https://github.com/tmarcu,Remove bad or unusable Manifest content and retry,1,[],https://github.com/clearlinux/swupd-client/pull/198,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/198#issuecomment-291221188,"For various reasons - partial downloads, power failure, user exiting -
the /var/lib/swupd state directory may become corrupt. When this happens,
manifests can be rendered unusable, causing various errors in swupd such as
signature failures, or errors reading the manifest. This patch attempts to
avoid such things causing updates or verifies to fail by cleaning up the
Manifests artifacts of what it could not use, and re-downloading them to
try again.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1 from me,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,199,2017-04-04T05:54:48Z,2017-04-04T18:46:20Z,2017-08-31T22:57:58Z,MERGED,True,133,9,11,https://github.com/icarus-sparry,Improved return code for bundleadd + test,1,[],https://github.com/clearlinux/swupd-client/pull/199,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/199,"Arrange for ""bad names"" to give non-zero exit code
Arrange for ""do nothing"" in particular when packages are already
installed to give a zero return code.
This means that typos in names result in failures, but that trying to
add an existing package is fine.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Arrange for ""bad names"" to give non-zero exit code
Arrange for ""do nothing"" in particular when packages are already
installed to give a zero return code.
This means that typos in names result in failures, but that trying to
add an existing package is fine.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,201,2017-04-13T17:56:27Z,2017-04-18T00:10:35Z,2017-10-20T18:47:00Z,MERGED,True,13,1,4,https://github.com/tmarcu,Need to reexec systemd if it changed,1,[],https://github.com/clearlinux/swupd-client/pull/201,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/201,"We must not run these with --no-block because order must be preserved,
and critical components may need to be reexec'd, making this a core piece
of the swupd update process.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","We must not run these with --no-block because order must be preserved,
and critical components may need to be reexec'd, making this a core piece
of the swupd update process.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,201,2017-04-13T17:56:27Z,2017-04-18T00:10:35Z,2017-10-20T18:47:00Z,MERGED,True,13,1,4,https://github.com/tmarcu,Need to reexec systemd if it changed,1,[],https://github.com/clearlinux/swupd-client/pull/201,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/201#issuecomment-294607673,"We must not run these with --no-block because order must be preserved,
and critical components may need to be reexec'd, making this a core piece
of the swupd update process.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,202,2017-04-17T21:26:24Z,2017-04-19T23:42:00Z,2017-10-20T18:47:04Z,MERGED,True,57,36,4,https://github.com/tmarcu,Delta manifests,4,[],https://github.com/clearlinux/swupd-client/pull/202,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/202,"This patch-set enables delta file application for manifests, decreasing manifest download size by a factor of 150x or more in some cases.","This patch-set enables delta file application for manifests, decreasing manifest download size by a factor of 150x or more in some cases.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,202,2017-04-17T21:26:24Z,2017-04-19T23:42:00Z,2017-10-20T18:47:04Z,MERGED,True,57,36,4,https://github.com/tmarcu,Delta manifests,4,[],https://github.com/clearlinux/swupd-client/pull/202,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/202#issuecomment-295415162,"This patch-set enables delta file application for manifests, decreasing manifest download size by a factor of 150x or more in some cases.",Review completed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,203,2017-04-18T17:13:04Z,2017-04-19T17:12:52Z,2017-10-20T18:47:01Z,MERGED,True,16,59,25,https://github.com/tmarcu,Fix download/extract pack message,2,[],https://github.com/clearlinux/swupd-client/pull/203,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/203,"Swupd incorrectly says ""Downloading pack ..."" even if it does not
really download the pack. Fix this by saying downloading packs and only
printing if we downloaded a pack to extract.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Swupd incorrectly says ""Downloading pack ..."" even if it does not
really download the pack. Fix this by saying downloading packs and only
printing if we downloaded a pack to extract.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,203,2017-04-18T17:13:04Z,2017-04-19T17:12:52Z,2017-10-20T18:47:01Z,MERGED,True,16,59,25,https://github.com/tmarcu,Fix download/extract pack message,2,[],https://github.com/clearlinux/swupd-client/pull/203,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/203#issuecomment-294916460,"Swupd incorrectly says ""Downloading pack ..."" even if it does not
really download the pack. Fix this by saying downloading packs and only
printing if we downloaded a pack to extract.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The tests need to be updated to support the new printf's that are happening, ignore travis for the moment!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,203,2017-04-18T17:13:04Z,2017-04-19T17:12:52Z,2017-10-20T18:47:01Z,MERGED,True,16,59,25,https://github.com/tmarcu,Fix download/extract pack message,2,[],https://github.com/clearlinux/swupd-client/pull/203,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/203#issuecomment-295022741,"Swupd incorrectly says ""Downloading pack ..."" even if it does not
really download the pack. Fix this by saying downloading packs and only
printing if we downloaded a pack to extract.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,204,2017-04-18T21:08:13Z,2017-04-19T19:30:20Z,2017-11-30T23:31:32Z,MERGED,True,5,0,1,https://github.com/phmccarty,build: validate --with-formatid input,1,[],https://github.com/clearlinux/swupd-client/pull/204,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/204,"To ensure validity of the format number hardcoded in the binary, check
the supplied input against a regular expression using grep.
Note that the double square brackets are needed for the regex character
classes because square brackets are used for M4 quotation in Autoconf;
an extra pair of square brackets is needed to prevent them from being
stripped in the configure script.","To ensure validity of the format number hardcoded in the binary, check
the supplied input against a regular expression using grep.
Note that the double square brackets are needed for the regex character
classes because square brackets are used for M4 quotation in Autoconf;
an extra pair of square brackets is needed to prevent them from being
stripped in the configure script.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,205,2017-04-20T21:42:27Z,2017-04-20T23:34:27Z,2017-10-20T18:47:08Z,MERGED,True,17,20,2,https://github.com/tmarcu,Swupd fix,2,[],https://github.com/clearlinux/swupd-client/pull/205,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/205,"Swupd incorrectly handled the file structs when applying deltas to manifests, creating an incorrect hash that then cause updates to retry infinitely. This patch fixes the retry code, and also addresses the corruption in try_manifest_delta so file structs are properly created.","Swupd incorrectly handled the file structs when applying deltas to manifests, creating an incorrect hash that then cause updates to retry infinitely. This patch fixes the retry code, and also addresses the corruption in try_manifest_delta so file structs are properly created.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,206,2017-04-24T19:22:39Z,2017-05-09T19:49:43Z,2017-08-31T22:57:28Z,CLOSED,False,666,467,31,https://github.com/icarus-sparry,swupd verify --picky option,5,[],https://github.com/clearlinux/swupd-client/pull/206,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/206,"Two changes. The first changes printf( to fprintf(stderr, almost everywhere so diagnostics, warnings and errors can be separated from data (e.g. hash values for files).
Second change adds a ""swupd verify --picky"" to list to stdout all the files/directories under /usr which are not in the current manifest, ignoring /usr/local and /usr/lib/modules.","Two changes. The first changes printf( to fprintf(stderr, almost everywhere so diagnostics, warnings and errors can be separated from data (e.g. hash values for files).
Second change adds a ""swupd verify --picky"" to list to stdout all the files/directories under /usr which are not in the current manifest, ignoring /usr/local and /usr/lib/modules.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,207,2017-04-28T19:41:38Z,2017-04-28T21:38:54Z,2017-10-20T18:47:10Z,MERGED,True,13,1,2,https://github.com/tmarcu,Retry pack downloads on bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/207,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/207,"The download_subscribed_packs() could fail for network issues or other related
problems, and because the only option for getting new packs is by downloading
zero packs or fullfiles, swupd should retry to get the packs before falling
into the verify_fix_path flow which signifies pack downloads errored out.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The download_subscribed_packs() could fail for network issues or other related
problems, and because the only option for getting new packs is by downloading
zero packs or fullfiles, swupd should retry to get the packs before falling
into the verify_fix_path flow which signifies pack downloads errored out.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,207,2017-04-28T19:41:38Z,2017-04-28T21:38:54Z,2017-10-20T18:47:10Z,MERGED,True,13,1,2,https://github.com/tmarcu,Retry pack downloads on bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/207,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/207#issuecomment-298090408,"The download_subscribed_packs() could fail for network issues or other related
problems, and because the only option for getting new packs is by downloading
zero packs or fullfiles, swupd should retry to get the packs before falling
into the verify_fix_path flow which signifies pack downloads errored out.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Looks like an improvement to me, unfortunate we went straight to full files before.",True,{'LAUGH': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,210,2017-05-08T19:39:23Z,2017-05-08T21:26:29Z,2017-05-09T19:36:55Z,MERGED,True,0,1,1,https://github.com/tmarcu,Fix infinite signature failure loop,1,[],https://github.com/clearlinux/swupd-client/pull/210,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/210,"Unlike the regular manifest loading code, loading a MoM also requires signature
verification to succeed. We cannot reset the retries after a signature
failed because the manifest may load fine, but still fail verification,
resulting in endlessly loading and verifying the Manifest.MoM
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Unlike the regular manifest loading code, loading a MoM also requires signature
verification to succeed. We cannot reset the retries after a signature
failed because the manifest may load fine, but still fail verification,
resulting in endlessly loading and verifying the Manifest.MoM
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,210,2017-05-08T19:39:23Z,2017-05-08T21:26:29Z,2017-05-09T19:36:55Z,MERGED,True,0,1,1,https://github.com/tmarcu,Fix infinite signature failure loop,1,[],https://github.com/clearlinux/swupd-client/pull/210,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/210#issuecomment-299990788,"Unlike the regular manifest loading code, loading a MoM also requires signature
verification to succeed. We cannot reset the retries after a signature
failed because the manifest may load fine, but still fail verification,
resulting in endlessly loading and verifying the Manifest.MoM
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,212,2017-05-08T21:26:36Z,2017-05-09T16:40:48Z,2017-05-11T01:20:01Z,MERGED,True,30,13,7,https://github.com/tmarcu,Add support for new manifest header line,2,[],https://github.com/clearlinux/swupd-client/pull/212,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/212,"The swupd client should support parsing extra data in the case that a format
bump occurred, or other possibly breaking change, so that it can at least
notify the user of more action needing to be taken post update.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The swupd client should support parsing extra data in the case that a format
bump occurred, or other possibly breaking change, so that it can at least
notify the user of more action needing to be taken post update.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,212,2017-05-08T21:26:36Z,2017-05-09T16:40:48Z,2017-05-11T01:20:01Z,MERGED,True,30,13,7,https://github.com/tmarcu,Add support for new manifest header line,2,[],https://github.com/clearlinux/swupd-client/pull/212,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/212#issuecomment-300243767,"The swupd client should support parsing extra data in the case that a format
bump occurred, or other possibly breaking change, so that it can at least
notify the user of more action needing to be taken post update.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,213,2017-05-09T18:48:31Z,2017-05-09T19:12:40Z,2017-05-09T19:36:52Z,MERGED,True,464,462,25,https://github.com/tmarcu,"Convert printf to fprintf(stderr, almost everywhere",1,[],https://github.com/clearlinux/swupd-client/pull/213,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/213,"Write error and informative messages to stderr, only
write data to stdout so it can be piped to other programs.
Make stdout line buffered, rather than introduce race conditions into tests
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Write error and informative messages to stderr, only
write data to stdout so it can be piped to other programs.
Make stdout line buffered, rather than introduce race conditions into tests
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,214,2017-05-09T19:32:39Z,2017-05-09T19:33:03Z,2017-05-09T19:45:14Z,CLOSED,False,696,481,31,https://github.com/tmarcu,Swupd verify --picky,9,[],https://github.com/clearlinux/swupd-client/pull/214,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/214,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,215,2017-05-09T19:38:41Z,2017-05-09T19:53:15Z,2017-05-09T19:53:15Z,MERGED,True,187,1,4,https://github.com/tmarcu,Add verify --picky command,1,[],https://github.com/clearlinux/swupd-client/pull/215,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/215,"Add a ""swupd verify --picky"" command which lists files under
/usr (modified by the --path option) which are not listed in the
current manifest. Exceptions /usr/local and /usr/lib/modules. The
former to allow for local changes, the latter because the clear boot
manager owns that directory.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Add a ""swupd verify --picky"" command which lists files under
/usr (modified by the --path option) which are not listed in the
current manifest. Exceptions /usr/local and /usr/lib/modules. The
former to allow for local changes, the latter because the clear boot
manager owns that directory.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,216,2017-05-09T22:00:28Z,2017-05-17T22:28:45Z,2017-08-31T22:57:26Z,MERGED,True,155,0,6,https://github.com/icarus-sparry,PoC of swupd autoupdate command,1,[],https://github.com/clearlinux/swupd-client/pull/216,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/216,"""swupd autoupdate"" returns 0 if autoupdates are enabled.
""sudo autoupdate --enable"" will unmask swupd-update.service
""sudo autoupdate --disable"" will mask swupd-update.service
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","""swupd autoupdate"" returns 0 if autoupdates are enabled.
""sudo autoupdate --enable"" will unmask swupd-update.service
""sudo autoupdate --disable"" will mask swupd-update.service
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,216,2017-05-09T22:00:28Z,2017-05-17T22:28:45Z,2017-08-31T22:57:26Z,MERGED,True,155,0,6,https://github.com/icarus-sparry,PoC of swupd autoupdate command,1,[],https://github.com/clearlinux/swupd-client/pull/216,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/216#issuecomment-300314944,"""swupd autoupdate"" returns 0 if autoupdates are enabled.
""sudo autoupdate --enable"" will unmask swupd-update.service
""sudo autoupdate --disable"" will mask swupd-update.service
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Seems to work. I still need to think about tests. Enabling/disabling on a test system seems a bad idea. Perhaps run in a docker container?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,219,2017-05-23T00:14:01Z,2017-05-25T23:41:14Z,2017-10-20T18:45:57Z,MERGED,True,33,7,3,https://github.com/tmarcu,Add verify --fix --picky functionality,1,[],https://github.com/clearlinux/swupd-client/pull/219,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/219,"This is the basic implementation for a ""factory reset"" type of command.
It will take the functionality of verify --picky and act on the files found
as verify --fix does with files found mismatching in the manifest.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","This is the basic implementation for a ""factory reset"" type of command.
It will take the functionality of verify --picky and act on the files found
as verify --fix does with files found mismatching in the manifest.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/220,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-311222227,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","+1 for the code, have you tested this at all yet?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-311482985,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","@tmarcu Yes, I did some manual tests, and they passed. I would add new functional tests, but we always pass --format=staging right now, so the test library will need some rethink first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/tpepper,4,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-311524444,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","Do you see value in allowing a --force-fix-to-incompatible-format type override flag, even if the default sensibly becomes only moving within a given format?  It might trash the system.  But it might also fix an otherwise trashed system.  Arguably once fix repairs to a version within a given format, an update is expected to work though so, maybe no need unless that two step update becomes too onerous.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/tpepper,5,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-311724186,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","Another thought on the --force ability:  If I'm running a mix, I might have a different format (eg: default is 1).  If there's no override, I can't verify/fix/force myself between an ""official"" (non-mix) build and a ""mixer"" build.  That's a potentially handy thing to allow.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-311735223,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","I agree that we should add a --force option to override the default enforcement. Maybe we can just reuse the existing --force option?
@tmarcu Can you comment about the mixer consideration @tpepper mentioned above? I'm not sure of the details, especially with your new mixer integration changes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-316857561,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","@phmccarty I think this should be an override-able feature with the general --force, at most. If you're on a mix you will not be forcing over it 'cause swupd will see the format it's in and be happy. However, there are cases where it would be nice not to be hard limited on ignoring the barrier.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-321693247,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","@phmccarty regarding your comment about always passing --format=staging there now exists a $SWUPD_OPTS_NO_FMT that allows you to pass all the opts except the format flag, which you can then set yourself.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/phmccarty,9,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-324473133,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.","Uploaded a revised patch set to enable the existing -x/--force option for overriding the format error checking, and adding two new functional tests for the error check and the override capability.
EDIT: updated PR description to summarize the patch series. See commit descriptions for more detail.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/tmarcu,10,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-324734912,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,220,2017-05-25T19:19:19Z,2017-08-30T18:12:51Z,2017-11-30T23:31:36Z,MERGED,True,238,1,26,https://github.com/phmccarty,verify: enforce format transitions,3,[],https://github.com/clearlinux/swupd-client/pull/220,https://github.com/matthewrsj,11,https://github.com/clearlinux/swupd-client/pull/220#issuecomment-326074271,"Add error checking to enforce format boundaries when using swupd verify -m VER. Also, enable the -x/--force option to bypass the error checking, and add two new functional tests.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,222,2017-06-05T19:20:58Z,2017-06-05T19:27:07Z,2017-06-05T19:27:07Z,MERGED,True,1,1,1,https://github.com/albertomurillo,Add -Y option to parseargs argument,1,[],https://github.com/clearlinux/swupd-client/pull/222,https://github.com/albertomurillo,1,https://github.com/clearlinux/swupd-client/pull/222,"--picky option was being recognized by swupd verify but not
its equivalent -Y
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com","--picky option was being recognized by swupd verify but not
its equivalent -Y
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,222,2017-06-05T19:20:58Z,2017-06-05T19:27:07Z,2017-06-05T19:27:07Z,MERGED,True,1,1,1,https://github.com/albertomurillo,Add -Y option to parseargs argument,1,[],https://github.com/clearlinux/swupd-client/pull/222,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/222#issuecomment-306278930,"--picky option was being recognized by swupd verify but not
its equivalent -Y
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,223,2017-06-07T23:08:12Z,2017-06-27T00:56:04Z,2017-11-30T23:31:35Z,MERGED,True,2,2,1,https://github.com/phmccarty,Fix hashdump invocation in bsdiff testsuite,1,[],https://github.com/clearlinux/swupd-client/pull/223,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/223,"The --basepath option for hashdump was renamed to --path a while back,
so fix up the creatediffs script accordingly.","The --basepath option for hashdump was renamed to --path a while back,
so fix up the creatediffs script accordingly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/224,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-310472553,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",Please ignore travis for this first iteration...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tpepper,3,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-313150550,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","Some of the commits could use commit messages.  Like ""Fix compliant manifest check""...what was broken?  I can see it based on the patch, but review is easier if the break+fix are described and the code clearly matches the description.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tpepper,4,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-313153671,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","For local mix content, what's the trust requirement?  If /usr/share/mix is the place, who creates that and enforces non-administrative users cannot mutate its contents?",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tpepper,5,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-313157514,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","The overall PR message could also use more description of the architecture...what's a mix, the sub-use cases this is enabling for how a mix and non-mix content are merged together at runtime on a swupd client system.",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,6,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-318513089,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","Squashed into more manageable commits, 7 total now, and all comments addressed in the code as appropriate.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-320321713,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",Rebased onto latest master.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-334228520,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",This will also need usage documentation somewhere,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,9,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-334626110,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","Fixed a double free bug and tested this again from scratch on my actual system -> add package, migrate to mix, bundle add, run new package, remove bundle. Will throw out some documentation for this, but what format would you like it in? Man page? Readme?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/phmccarty,10,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-334627194,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",@tmarcu Maybe a swupd-mixer man page in section 7? The man pages under docs/ are written in rst and automatically converted to man pages during the build.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,11,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-334627319,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.","@phmccarty Sounds good, I can do that and I will do a page for the mixer docs page on clearlinux.org as well I think.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,12,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-335265890,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",Will push this tmarcu/clear-linux-documentation@5c9e9f3 out as well once this PR is merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/matthewrsj,13,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-341788234,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",+1 from me except for you still need to add a blurb about --allow-mix-collisions to the man page.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,14,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-341790267,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",Added,True,{'HOORAY': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/matthewrsj,15,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-341791121,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,224,2017-06-22T19:02:35Z,2017-11-03T18:50:09Z,2017-11-03T19:03:51Z,MERGED,True,834,98,23,https://github.com/tmarcu,Mixer integration,16,[],https://github.com/clearlinux/swupd-client/pull/224,https://github.com/tmarcu,16,https://github.com/clearlinux/swupd-client/pull/224#issuecomment-341797941,"This patch set introduces functionality for swupd to handle content that is locally built, and allows it to multiplex between upstream content and local user additive data. In the curent state of swupd, the only method of adding custom user content is by using the Mixer tool to create a custom image, and then acting as the OSV over it. Adding content to an official upstream image is not officially supported.
This patch enables users to effortlessly add their own bundles to an already running, official Clear Linux image, without needing to mix their own version from scratch.
The client will automatically detect if user content exists in /usr/share/mix, and appropriately attempt to load it for an update, verify, or bundle operation. It takes the content in /usr/share/mix, and merges the mix Manifest.MoM with the official Manifest.MoM, such that swupd only has to consume a single MoM per usual. The merged MoM contains all upstream data, and all custom data the client will update, and is signed by a custom user cert only if the upstream MoM verifies succesfully, ensuring continued security.
Should the client detect that there is a newer upstream release, it will automatically regenerate an updated Manifest.MoM to update itself even if the user has not updated their custom bundles or OS version.",,True,{'HOORAY': ['https://github.com/phmccarty']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/225,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.","We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/ahkok,2,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311131553,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.",s/18/16/,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311219270,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.",@ahkok  Can you check why test/functional/checkupdate/no-server-content/test.bats is failing? Does make check run on your system?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/ahkok,4,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311480648,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.","Removed the service unit change, for now, from this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/ahkok,5,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311481390,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.","I don't understand why make check fails (it does for me, locally, as well).
The check that fails is run sudo sh -c ""$SWUPD check-update $SWUPD_OPTS_NO_CERT""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/ahkok,6,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311506398,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.",Updated make check with the new expected output. That fIxes that.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/ahkok,7,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311732160,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.","Thanks @phmccarty, I fixed up those 2 comments.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,225,2017-06-26T17:23:15Z,2017-07-20T23:18:34Z,2017-07-20T23:18:34Z,MERGED,True,12,8,5,https://github.com/ahkok,Differentiate between various early network failures.,1,[],https://github.com/clearlinux/swupd-client/pull/225,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/225#issuecomment-311734258,"We draw a hard line with error codes, such that:
Error code 16 is reserved for failures resulting from the basic
network check. Any call to check_network() that fails will
return this error code. No other error path returns this
error code.
Additionally, check_network() is called in every normal code path.
All other, possibly network related issues, return a different
error code. If the basic network check succeeds, but e.g. pack
downloads fail, we return a new (23) error code so that we
can better establish the conditions through telemetry and
determine whether the error is on the client or the server,
which is highly likely with this new error code 23.
Subsequently, for automated updates, we can choose to ignore
update failures if the automated periodical updates fail
due to no network being available. Calling the program
from a shell will still produce an error code, as normal.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,226,2017-07-17T21:43:25Z,2017-07-17T22:49:29Z,2018-10-20T09:01:28Z,MERGED,True,10,0,1,https://github.com/busykai,Sort bundle-list output.,1,[],https://github.com/clearlinux/swupd-client/pull/226,https://github.com/busykai,1,https://github.com/clearlinux/swupd-client/pull/226,Sort bundle-list output alphabetically.,Sort bundle-list output alphabetically.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,226,2017-07-17T21:43:25Z,2017-07-17T22:49:29Z,2018-10-20T09:01:28Z,MERGED,True,10,0,1,https://github.com/busykai,Sort bundle-list output.,1,[],https://github.com/clearlinux/swupd-client/pull/226,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/226#issuecomment-315898954,Sort bundle-list output alphabetically.,+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,227,2017-07-19T20:31:38Z,2017-07-27T17:15:40Z,2017-07-27T18:50:04Z,CLOSED,False,6,0,1,https://github.com/albertomurillo,Rerun swupd until there are no new version available,1,[],https://github.com/clearlinux/swupd-client/pull/227,https://github.com/albertomurillo,1,https://github.com/clearlinux/swupd-client/pull/227,"swupd needs to be run multiple times when there are format bumps.
This PR reruns swupd after a successful update until there are no
new updates available on the server.
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com","swupd needs to be run multiple times when there are format bumps.
This PR reruns swupd after a successful update until there are no
new updates available on the server.
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,227,2017-07-19T20:31:38Z,2017-07-27T17:15:40Z,2017-07-27T18:50:04Z,CLOSED,False,6,0,1,https://github.com/albertomurillo,Rerun swupd until there are no new version available,1,[],https://github.com/clearlinux/swupd-client/pull/227,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/227#issuecomment-316862109,"swupd needs to be run multiple times when there are format bumps.
This PR reruns swupd after a successful update until there are no
new updates available on the server.
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com","-1
@albertomurillo Thanks for the PR, but this won't work for various reasons.
Specifically, we HAVE to re-exec swupd instead of just recursing or using the same process. If we go through a format bump, swupd could have undergone a breaking change and the current running process may not be able to read manifests part of the new format. The certificate could have also changed in which case the running swupd will not be able to update and verify the new MoM.
I think this approach could work if instead of re-cursing, we re-exec'd at the end point so the newly installed swupd will be used,and it will be able to handle all of the above problems. Otherwise we would be running swupd from a version older than the one we updated to.
We can also only re-exec if the update was successful, otherwise we cannot guarantee the new swupd was installed correctly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,227,2017-07-19T20:31:38Z,2017-07-27T17:15:40Z,2017-07-27T18:50:04Z,CLOSED,False,6,0,1,https://github.com/albertomurillo,Rerun swupd until there are no new version available,1,[],https://github.com/clearlinux/swupd-client/pull/227,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/227#issuecomment-316869158,"swupd needs to be run multiple times when there are format bumps.
This PR reruns swupd after a successful update until there are no
new updates available on the server.
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com","I agree with @tmarcu that this can only work if swupd is re-exec'd, because (a) swupd may have updated and we want to run the newer version, and/or (b) swupd introduced incompatible changes after the update as part of a format bump. These incompatible changes can be any of the items Tudor mentioned.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,227,2017-07-19T20:31:38Z,2017-07-27T17:15:40Z,2017-07-27T18:50:04Z,CLOSED,False,6,0,1,https://github.com/albertomurillo,Rerun swupd until there are no new version available,1,[],https://github.com/clearlinux/swupd-client/pull/227,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/227#issuecomment-318427666,"swupd needs to be run multiple times when there are format bumps.
This PR reruns swupd after a successful update until there are no
new updates available on the server.
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com",Proper implementation found in #228,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,227,2017-07-19T20:31:38Z,2017-07-27T17:15:40Z,2017-07-27T18:50:04Z,CLOSED,False,6,0,1,https://github.com/albertomurillo,Rerun swupd until there are no new version available,1,[],https://github.com/clearlinux/swupd-client/pull/227,https://github.com/albertomurillo,5,https://github.com/clearlinux/swupd-client/pull/227#issuecomment-318453014,"swupd needs to be run multiple times when there are format bumps.
This PR reruns swupd after a successful update until there are no
new updates available on the server.
Signed-off-by: Alberto Murillo Silva alberto.murillo.silva@intel.com",@tmarcu awesome!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,228,2017-07-26T00:11:00Z,2017-07-29T06:19:55Z,2017-08-08T21:20:31Z,MERGED,True,601,20,55,https://github.com/matthewrsj,Re-execute swupd update for format bumps,5,[],https://github.com/clearlinux/swupd-client/pull/228,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/228,"When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future","When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,228,2017-07-26T00:11:00Z,2017-07-29T06:19:55Z,2017-08-08T21:20:31Z,MERGED,True,601,20,55,https://github.com/matthewrsj,Re-execute swupd update for format bumps,5,[],https://github.com/clearlinux/swupd-client/pull/228,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/228#issuecomment-317910256,"When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future",Travis can't copy the files I want copied. I'll look at this tomorrow.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,228,2017-07-26T00:11:00Z,2017-07-29T06:19:55Z,2017-08-08T21:20:31Z,MERGED,True,601,20,55,https://github.com/matthewrsj,Re-execute swupd update for format bumps,5,[],https://github.com/clearlinux/swupd-client/pull/228,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/228#issuecomment-317938217,"When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future",It was some .gitignore strangeness brought on by excluding swupd but needing /usr/share/defaults/swupd/format. Unfortunately I couldn't negate that rule with ! as explained in this stackoverflow answer. I just copy it into place at test time to get around this.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,228,2017-07-26T00:11:00Z,2017-07-29T06:19:55Z,2017-08-08T21:20:31Z,MERGED,True,601,20,55,https://github.com/matthewrsj,Re-execute swupd update for format bumps,5,[],https://github.com/clearlinux/swupd-client/pull/228,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/228#issuecomment-318142430,"When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future",Of course the test won't run if I don't add it to the Makefile. Fixed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,228,2017-07-26T00:11:00Z,2017-07-29T06:19:55Z,2017-08-08T21:20:31Z,MERGED,True,601,20,55,https://github.com/matthewrsj,Re-execute swupd update for format bumps,5,[],https://github.com/clearlinux/swupd-client/pull/228,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/228#issuecomment-318462208,"When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future",Last commit treats post update actions as a list so we aren't restricted to only one possible post update action in the future.,True,"{'HOORAY': ['https://github.com/tmarcu'], 'THUMBS_UP': ['https://github.com/tmarcu']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,228,2017-07-26T00:11:00Z,2017-07-29T06:19:55Z,2017-08-08T21:20:31Z,MERGED,True,601,20,55,https://github.com/matthewrsj,Re-execute swupd update for format bumps,5,[],https://github.com/clearlinux/swupd-client/pull/228,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/228#issuecomment-318515861,"When a device is out of date by more than a format bump re-exec swupd
update until the device version matches the server version. This is
achieved by reading the ""actions"" field in the Manifest.MoM, which is
yet to be implemented in swupd-server. When ""update"" is specified in the
actions of the current manifest and the current update is successful,
swupd will re-exec itself with the same flags it was originally called
with.
A functional test has also been added.
Notes:

The actions field still needs to be implemented in swupd-server
This PR does not check for consistency between /usr/lib/os-release and the version file in swupd's statedir. so errors can occur if a build is released that does not update that file (unlikely). That can be changed in this PR or the future",Comments addressed and squashed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,229,2017-08-03T23:56:36Z,2017-08-17T22:37:16Z,2017-08-17T22:37:16Z,MERGED,True,74,5,22,https://github.com/matthewrsj,Add basic progress status for long-running tasks,4,[],https://github.com/clearlinux/swupd-client/pull/229,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/229,"Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.","Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,229,2017-08-03T23:56:36Z,2017-08-17T22:37:16Z,2017-08-17T22:37:16Z,MERGED,True,74,5,22,https://github.com/matthewrsj,Add basic progress status for long-running tasks,4,[],https://github.com/clearlinux/swupd-client/pull/229,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/229#issuecomment-320120789,"Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.","I initially had a more complex solution that displayed an actual progress bar, but thought the percentage was simpler and gave more information.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,229,2017-08-03T23:56:36Z,2017-08-17T22:37:16Z,2017-08-17T22:37:16Z,MERGED,True,74,5,22,https://github.com/matthewrsj,Add basic progress status for long-running tasks,4,[],https://github.com/clearlinux/swupd-client/pull/229,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/229#issuecomment-320322573,"Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.","An even easier solution would be to print something along the lines of:
Starting download of remaining update content. This may take a while...
.......................... <continually append dots to this line every ~N seconds>
or append whatever character you choose for the progress bar. The chroot builder and server do this because it just sits there doing tons of file IO, but at least you see that some output is getting updated and it is not frozen.
_()_/",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,229,2017-08-03T23:56:36Z,2017-08-17T22:37:16Z,2017-08-17T22:37:16Z,MERGED,True,74,5,22,https://github.com/matthewrsj,Add basic progress status for long-running tasks,4,[],https://github.com/clearlinux/swupd-client/pull/229,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/229#issuecomment-321881463,"Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.","@tmarcu @phmccarty thoughts? This now prints a dot . for each 10 files when output is redirected so that control characters are not printed to log files, tests, etc.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,229,2017-08-03T23:56:36Z,2017-08-17T22:37:16Z,2017-08-17T22:37:16Z,MERGED,True,74,5,22,https://github.com/matthewrsj,Add basic progress status for long-running tasks,4,[],https://github.com/clearlinux/swupd-client/pull/229,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/229#issuecomment-323177904,"Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.",Comments addressed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,229,2017-08-03T23:56:36Z,2017-08-17T22:37:16Z,2017-08-17T22:37:16Z,MERGED,True,74,5,22,https://github.com/matthewrsj,Add basic progress status for long-running tasks,4,[],https://github.com/clearlinux/swupd-client/pull/229,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/229#issuecomment-323210421,"Add a basic progress indication for a couple potentially long-running
swupd tasks (download_pack and add_missing_files). The progress
indication is displayed as a percentage:
...85%

It overwrites its own line so the progress will update in place. It may
be interrupted by other swupd output:
...45%
Extracting os-core pack for version 10000
...50%
Extracting os-core-update pack for version 9000
...55%

The progress indication will then resume updating in place, on the same
line.
This progress is only displayed when outputting to a TTY, and will not
output anything when the output is being redirected. This is nice for
testing and logging, but means that these progress updates will not be
caught by processes that capture swupd output, such as ister.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
I'd like to hear thoughts on this approach. A possible work-around for hiding the progress updates from calling processes is to log the progress to a file when not in a tty.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/230,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com","A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/230#issuecomment-321692580,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Rebased to latest master,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/230#issuecomment-322316343,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Two latest commits add the --deps BUNDLE subcommand to bundle-list. It allows users to list the nested included bundles for BUNDLE and can give them an idea of what they are about to bundle-add.
Example:
 > swupd bundle-list --deps os-core-update-dev
swupd-client bundle list 3.10.0
   Copyright (C) 2012-2016 Intel Corporation

Bundles included by os-core-update-dev:

perl-basic
dev-utils
os-core-dev
os-core
os-core-update",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/230#issuecomment-322339270,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Fixes #183,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/230#issuecomment-323178215,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Comments addressed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/230#issuecomment-325428432,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Comments addressed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,230,2017-08-07T19:01:46Z,2017-08-31T16:50:51Z,2017-08-31T16:51:00Z,MERGED,True,1089,40,125,https://github.com/matthewrsj,Print bundle dependencies when failing to remove,5,[],https://github.com/clearlinux/swupd-client/pull/230,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/230#issuecomment-326159674,"A bundle will fail to be removed from the filesystem when other bundles
require that bundle as a dependency. Print a list of each of these
bundles along with the error message.
Also  add --has-dep=BUNDLE argument will display a tree representing all
installed bundles that recursively include BUNDLE.
One may pass the --all argument as well to list the dependency tree for
BUNDLE including all installable bundles available on the server.
Example output without --all:
Installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * mixer
    |-- os-clr-on-clr

Example output with --all:
Attempting to download version string to memory
All installable and installed bundles that have os-installer as a dependency:
format:
 # * is-required-by
 #   |-- is-required-by
 # * is-also-required-by
 # ...

  * clr-devops
  * mixer
    |-- os-clr-on-clr
        |-- os-clr-on-clr-dev
    |-- clr-devops
    |-- os-clr-on-clr-dev

Signed-off-by: Matthew Johnson matthew.johnson@intel.com","+1 from me, you could smash the deps commits into one if you'd like as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,231,2017-08-07T19:11:24Z,2017-08-07T21:23:31Z,2017-08-08T21:19:52Z,MERGED,True,4,4,4,https://github.com/matthewrsj,Fix typo in clr_bundle_rm.c,1,[],https://github.com/clearlinux/swupd-client/pull/231,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/231,"succesfully -> successfully
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","succesfully -> successfully
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,232,2017-08-08T20:57:13Z,2017-08-08T22:20:17Z,2017-08-08T22:20:24Z,MERGED,True,17,0,2,https://github.com/matthewrsj,Wait for test server to become available before testing,1,[],https://github.com/clearlinux/swupd-client/pull/232,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/232,"Check that the simple test server in the checkupdate/slow-server/ test
is available before actually running the swupd command. This check is
done by testing the return status of a curl command on the server up to
ten times until successful.
Since this is an historically touchy test, output an additional
debug.log in the test directory with much more verbose logging (using
set -x).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Check that the simple test server in the checkupdate/slow-server/ test
is available before actually running the swupd command. This check is
done by testing the return status of a curl command on the server up to
ten times until successful.
Since this is an historically touchy test, output an additional
debug.log in the test directory with much more verbose logging (using
set -x).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,232,2017-08-08T20:57:13Z,2017-08-08T22:20:17Z,2017-08-08T22:20:24Z,MERGED,True,17,0,2,https://github.com/matthewrsj,Wait for test server to become available before testing,1,[],https://github.com/clearlinux/swupd-client/pull/232,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/232#issuecomment-321084458,"Check that the simple test server in the checkupdate/slow-server/ test
is available before actually running the swupd command. This check is
done by testing the return status of a curl command on the server up to
ten times until successful.
Since this is an historically touchy test, output an additional
debug.log in the test directory with much more verbose logging (using
set -x).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,232,2017-08-08T20:57:13Z,2017-08-08T22:20:17Z,2017-08-08T22:20:24Z,MERGED,True,17,0,2,https://github.com/matthewrsj,Wait for test server to become available before testing,1,[],https://github.com/clearlinux/swupd-client/pull/232,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/232#issuecomment-321085019,"Check that the simple test server in the checkupdate/slow-server/ test
is available before actually running the swupd command. This check is
done by testing the return status of a curl command on the server up to
ten times until successful.
Since this is an historically touchy test, output an additional
debug.log in the test directory with much more verbose logging (using
set -x).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Ah, one thing I noticed. It would also be nice to add debug.log to the .gitignore.",True,{'THUMBS_UP': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,232,2017-08-08T20:57:13Z,2017-08-08T22:20:17Z,2017-08-08T22:20:24Z,MERGED,True,17,0,2,https://github.com/matthewrsj,Wait for test server to become available before testing,1,[],https://github.com/clearlinux/swupd-client/pull/232,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/232#issuecomment-321086236,"Check that the simple test server in the checkupdate/slow-server/ test
is available before actually running the swupd command. This check is
done by testing the return status of a curl command on the server up to
ten times until successful.
Since this is an historically touchy test, output an additional
debug.log in the test directory with much more verbose logging (using
set -x).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","You are right @phmccarty, added to gitignore",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,232,2017-08-08T20:57:13Z,2017-08-08T22:20:17Z,2017-08-08T22:20:24Z,MERGED,True,17,0,2,https://github.com/matthewrsj,Wait for test server to become available before testing,1,[],https://github.com/clearlinux/swupd-client/pull/232,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/232#issuecomment-321086473,"Check that the simple test server in the checkupdate/slow-server/ test
is available before actually running the swupd command. This check is
done by testing the return status of a curl command on the server up to
ten times until successful.
Since this is an historically touchy test, output an additional
debug.log in the test directory with much more verbose logging (using
set -x).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,233,2017-08-09T17:40:48Z,2017-08-10T22:34:00Z,2017-08-10T22:34:04Z,MERGED,True,69,17,48,https://github.com/matthewrsj,Add status checks for test swupd commands,5,[],https://github.com/clearlinux/swupd-client/pull/233,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/233,"Adds status checks for each swupd command called in the functional
tests. At this point several of these tests fail due to some successful
commands returning error statuses.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
First commit should have test failures. I will push the fixes for those failures shortly.
Four following commits fix one previously-failing test each.","Adds status checks for each swupd command called in the functional
tests. At this point several of these tests fail due to some successful
commands returning error statuses.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
First commit should have test failures. I will push the fixes for those failures shortly.
Four following commits fix one previously-failing test each.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,233,2017-08-09T17:40:48Z,2017-08-10T22:34:00Z,2017-08-10T22:34:04Z,MERGED,True,69,17,48,https://github.com/matthewrsj,Add status checks for test swupd commands,5,[],https://github.com/clearlinux/swupd-client/pull/233,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/233#issuecomment-321390641,"Adds status checks for each swupd command called in the functional
tests. At this point several of these tests fail due to some successful
commands returning error statuses.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
First commit should have test failures. I will push the fixes for those failures shortly.
Four following commits fix one previously-failing test each.",+1 from me,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,235,2017-08-17T19:20:45Z,2017-08-17T22:28:07Z,2017-08-17T22:28:07Z,MERGED,True,105,37,9,https://github.com/icarus-sparry,Ensure state_dir is a directory and owned by root,1,[],https://github.com/clearlinux/swupd-client/pull/235,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/235,"As the state_dir (normally /var/lib/swupd) contains things like the
downloaded bundles, it is important that there is no access to
non-root users who could potentially explot races to replace files
between them being checked and them being installed.
Ensure that the state_dir is root owned, and mode 0700, as well as the
critical directories below it.
Note that a proper fix would involve using chdir to move into the
directory and only use relative paths. This would prevent faulty
permissions higher up the directory tree being exploited. It might
be possible to use openat(2) to prevent this exploitation.
Add a test to ensure that the enforcement is taking place.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","As the state_dir (normally /var/lib/swupd) contains things like the
downloaded bundles, it is important that there is no access to
non-root users who could potentially explot races to replace files
between them being checked and them being installed.
Ensure that the state_dir is root owned, and mode 0700, as well as the
critical directories below it.
Note that a proper fix would involve using chdir to move into the
directory and only use relative paths. This would prevent faulty
permissions higher up the directory tree being exploited. It might
be possible to use openat(2) to prevent this exploitation.
Add a test to ensure that the enforcement is taking place.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,235,2017-08-17T19:20:45Z,2017-08-17T22:28:07Z,2017-08-17T22:28:07Z,MERGED,True,105,37,9,https://github.com/icarus-sparry,Ensure state_dir is a directory and owned by root,1,[],https://github.com/clearlinux/swupd-client/pull/235,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/235#issuecomment-323210033,"As the state_dir (normally /var/lib/swupd) contains things like the
downloaded bundles, it is important that there is no access to
non-root users who could potentially explot races to replace files
between them being checked and them being installed.
Ensure that the state_dir is root owned, and mode 0700, as well as the
critical directories below it.
Note that a proper fix would involve using chdir to move into the
directory and only use relative paths. This would prevent faulty
permissions higher up the directory tree being exploited. It might
be possible to use openat(2) to prevent this exploitation.
Add a test to ensure that the enforcement is taking place.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","If we decide to use this elsewhere for other directories (other than state dir) in the future, we can add a log print at that time.
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,236,2017-08-22T00:38:30Z,2017-08-22T18:00:27Z,2018-06-08T21:05:13Z,MERGED,True,3,2,1,https://github.com/cmarcelo,Don't accept trailing characters when validating numbers for --format,1,[],https://github.com/clearlinux/swupd-client/pull/236,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/236,"Fixes #142.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com","Fixes #142.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,236,2017-08-22T00:38:30Z,2017-08-22T18:00:27Z,2018-06-08T21:05:13Z,MERGED,True,3,2,1,https://github.com/cmarcelo,Don't accept trailing characters when validating numbers for --format,1,[],https://github.com/clearlinux/swupd-client/pull/236,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/236#issuecomment-324084247,"Fixes #142.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com","+1 for the change.
Please update the commit message to explain why this change was necessary. e.g. strtoull saves invalid trailing characters to endptr and will not set errno when leading characters represent a valid number.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,236,2017-08-22T00:38:30Z,2017-08-22T18:00:27Z,2018-06-08T21:05:13Z,MERGED,True,3,2,1,https://github.com/cmarcelo,Don't accept trailing characters when validating numbers for --format,1,[],https://github.com/clearlinux/swupd-client/pull/236,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/236#issuecomment-324084330,"Fixes #142.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com","accidentally closed the PR, sorry",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,236,2017-08-22T00:38:30Z,2017-08-22T18:00:27Z,2018-06-08T21:05:13Z,MERGED,True,3,2,1,https://github.com/cmarcelo,Don't accept trailing characters when validating numbers for --format,1,[],https://github.com/clearlinux/swupd-client/pull/236,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/236#issuecomment-324104556,"Fixes #142.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,236,2017-08-22T00:38:30Z,2017-08-22T18:00:27Z,2018-06-08T21:05:13Z,MERGED,True,3,2,1,https://github.com/cmarcelo,Don't accept trailing characters when validating numbers for --format,1,[],https://github.com/clearlinux/swupd-client/pull/236,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/236#issuecomment-324104899,"Fixes #142.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",thanks @cmarcelo!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,239,2017-08-31T21:32:14Z,2017-08-31T22:52:59Z,2017-09-22T23:38:32Z,CLOSED,False,108,37,9,https://github.com/icarus-sparry,F/createdirs,2,[],https://github.com/clearlinux/swupd-client/pull/239,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/239,Added a better test than just seeing that swupd_rm didn't return an error.,Added a better test than just seeing that swupd_rm didn't return an error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,239,2017-08-31T21:32:14Z,2017-08-31T22:52:59Z,2017-09-22T23:38:32Z,CLOSED,False,108,37,9,https://github.com/icarus-sparry,F/createdirs,2,[],https://github.com/clearlinux/swupd-client/pull/239,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/239#issuecomment-326427789,Added a better test than just seeing that swupd_rm didn't return an error.,"The change looks good, but you have the original commit in here as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,240,2017-08-31T22:52:33Z,2017-08-31T23:13:22Z,2017-08-31T23:13:40Z,MERGED,True,8,5,1,https://github.com/icarus-sparry,Test a statedir is removed directly,1,[],https://github.com/clearlinux/swupd-client/pull/240,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/240,"Don't use the return value from swupd_rm, which is poorly defined, but
test directly that the file no longer exists.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Don't use the return value from swupd_rm, which is poorly defined, but
test directly that the file no longer exists.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,240,2017-08-31T22:52:33Z,2017-08-31T23:13:22Z,2017-08-31T23:13:40Z,MERGED,True,8,5,1,https://github.com/icarus-sparry,Test a statedir is removed directly,1,[],https://github.com/clearlinux/swupd-client/pull/240,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/240#issuecomment-326444701,"Don't use the return value from swupd_rm, which is poorly defined, but
test directly that the file no longer exists.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,241,2017-09-01T16:47:54Z,2017-09-13T01:13:03Z,2017-09-13T01:13:11Z,MERGED,True,16,1,1,https://github.com/matthewrsj,Add initial systemctl check for autoupdate,1,[],https://github.com/clearlinux/swupd-client/pull/241,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/241,"In a container systemctl does not work, and /usr/bin/systemctl fails as
expected with ""Failed to connect to bus: No such file or directory.""
Because of this, swupd autoupdate will not work either. However,
""systemctl is-enabled ..."" will not fail, even though it should.
Add an additional check to make sure /usr/bin/systemctl is working
before checking if swupd-update.service is-enabled. Report that swupd
was ""Unable to determine autoupdate status"" if this check fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I tested this by applying the change in a docker container. It reported that it was unable to determine autoupdate status as expected. If anyone has better ideas for how to test this let me know.","In a container systemctl does not work, and /usr/bin/systemctl fails as
expected with ""Failed to connect to bus: No such file or directory.""
Because of this, swupd autoupdate will not work either. However,
""systemctl is-enabled ..."" will not fail, even though it should.
Add an additional check to make sure /usr/bin/systemctl is working
before checking if swupd-update.service is-enabled. Report that swupd
was ""Unable to determine autoupdate status"" if this check fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I tested this by applying the change in a docker container. It reported that it was unable to determine autoupdate status as expected. If anyone has better ideas for how to test this let me know.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,241,2017-09-01T16:47:54Z,2017-09-13T01:13:03Z,2017-09-13T01:13:11Z,MERGED,True,16,1,1,https://github.com/matthewrsj,Add initial systemctl check for autoupdate,1,[],https://github.com/clearlinux/swupd-client/pull/241,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/241#issuecomment-328960991,"In a container systemctl does not work, and /usr/bin/systemctl fails as
expected with ""Failed to connect to bus: No such file or directory.""
Because of this, swupd autoupdate will not work either. However,
""systemctl is-enabled ..."" will not fail, even though it should.
Add an additional check to make sure /usr/bin/systemctl is working
before checking if swupd-update.service is-enabled. Report that swupd
was ""Unable to determine autoupdate status"" if this check fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I tested this by applying the change in a docker container. It reported that it was unable to determine autoupdate status as expected. If anyone has better ideas for how to test this let me know.",WEXITSTATUS(rc) is now checked.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,241,2017-09-01T16:47:54Z,2017-09-13T01:13:03Z,2017-09-13T01:13:11Z,MERGED,True,16,1,1,https://github.com/matthewrsj,Add initial systemctl check for autoupdate,1,[],https://github.com/clearlinux/swupd-client/pull/241,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/241#issuecomment-329018458,"In a container systemctl does not work, and /usr/bin/systemctl fails as
expected with ""Failed to connect to bus: No such file or directory.""
Because of this, swupd autoupdate will not work either. However,
""systemctl is-enabled ..."" will not fail, even though it should.
Add an additional check to make sure /usr/bin/systemctl is working
before checking if swupd-update.service is-enabled. Report that swupd
was ""Unable to determine autoupdate status"" if this check fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I tested this by applying the change in a docker container. It reported that it was unable to determine autoupdate status as expected. If anyone has better ideas for how to test this let me know.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,242,2017-09-01T18:31:02Z,2017-09-12T18:48:45Z,2017-09-12T18:48:45Z,MERGED,True,201,0,23,https://github.com/matthewrsj,Require --force or --picky when verifying to a different version,2,[],https://github.com/clearlinux/swupd-client/pull/242,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/242,"When running verify --fix with -m specifying a different version than
the current OS version, require --picky to enforce management of files
under /usr or require --force as an override. Adding --picky can solve
issues such as issue #238 where fixing backward caused glibc library
confusion.
Add functional tests as well.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Addresses #238","When running verify --fix with -m specifying a different version than
the current OS version, require --picky to enforce management of files
under /usr or require --force as an override. Adding --picky can solve
issues such as issue #238 where fixing backward caused glibc library
confusion.
Add functional tests as well.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Addresses #238",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,242,2017-09-01T18:31:02Z,2017-09-12T18:48:45Z,2017-09-12T18:48:45Z,MERGED,True,201,0,23,https://github.com/matthewrsj,Require --force or --picky when verifying to a different version,2,[],https://github.com/clearlinux/swupd-client/pull/242,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/242#issuecomment-328941324,"When running verify --fix with -m specifying a different version than
the current OS version, require --picky to enforce management of files
under /usr or require --force as an override. Adding --picky can solve
issues such as issue #238 where fixing backward caused glibc library
confusion.
Add functional tests as well.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Addresses #238",@phmccarty any other comments?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,242,2017-09-01T18:31:02Z,2017-09-12T18:48:45Z,2017-09-12T18:48:45Z,MERGED,True,201,0,23,https://github.com/matthewrsj,Require --force or --picky when verifying to a different version,2,[],https://github.com/clearlinux/swupd-client/pull/242,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/242#issuecomment-328943513,"When running verify --fix with -m specifying a different version than
the current OS version, require --picky to enforce management of files
under /usr or require --force as an override. Adding --picky can solve
issues such as issue #238 where fixing backward caused glibc library
confusion.
Add functional tests as well.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Addresses #238","Nope, +1 from me.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,243,2017-09-07T15:26:44Z,2017-09-11T21:51:31Z,2017-09-11T21:51:32Z,MERGED,True,9,0,1,https://github.com/matthewrsj,RFC: Print warning when systemd not operable,1,[],https://github.com/clearlinux/swupd-client/pull/243,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/243,"When running swupd in a container systemd is not operable and fails with
a ""Failed to connect to bus"" error. Instead of printing these errors
directly check if systemd is operable at all and print a warning if not,
then return early from the update_triggers.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
swupd is never able to run in a container due to systemd not being present. Is this the right approach, warning and exit? I don't think it is reasonable to say updates failed every time in the container when it is just the post-update scripts that are being run.
However, with those post-update commands never being run in a container can we call the update complete?","When running swupd in a container systemd is not operable and fails with
a ""Failed to connect to bus"" error. Instead of printing these errors
directly check if systemd is operable at all and print a warning if not,
then return early from the update_triggers.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
swupd is never able to run in a container due to systemd not being present. Is this the right approach, warning and exit? I don't think it is reasonable to say updates failed every time in the container when it is just the post-update scripts that are being run.
However, with those post-update commands never being run in a container can we call the update complete?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,243,2017-09-07T15:26:44Z,2017-09-11T21:51:31Z,2017-09-11T21:51:32Z,MERGED,True,9,0,1,https://github.com/matthewrsj,RFC: Print warning when systemd not operable,1,[],https://github.com/clearlinux/swupd-client/pull/243,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/243#issuecomment-328659838,"When running swupd in a container systemd is not operable and fails with
a ""Failed to connect to bus"" error. Instead of printing these errors
directly check if systemd is operable at all and print a warning if not,
then return early from the update_triggers.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
swupd is never able to run in a container due to systemd not being present. Is this the right approach, warning and exit? I don't think it is reasonable to say updates failed every time in the container when it is just the post-update scripts that are being run.
However, with those post-update commands never being run in a container can we call the update complete?",Suggestions addressed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,243,2017-09-07T15:26:44Z,2017-09-11T21:51:31Z,2017-09-11T21:51:32Z,MERGED,True,9,0,1,https://github.com/matthewrsj,RFC: Print warning when systemd not operable,1,[],https://github.com/clearlinux/swupd-client/pull/243,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/243#issuecomment-328664329,"When running swupd in a container systemd is not operable and fails with
a ""Failed to connect to bus"" error. Instead of printing these errors
directly check if systemd is operable at all and print a warning if not,
then return early from the update_triggers.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC
swupd is never able to run in a container due to systemd not being present. Is this the right approach, warning and exit? I don't think it is reasonable to say updates failed every time in the container when it is just the post-update scripts that are being run.
However, with those post-update commands never being run in a container can we call the update complete?",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,244,2017-09-07T22:47:45Z,2017-09-08T15:57:16Z,2017-09-08T15:57:16Z,MERGED,True,1,1,1,https://github.com/matthewrsj,Add newline to informational print,1,[],https://github.com/clearlinux/swupd-client/pull/244,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/244,"Add newline so progress updates are printed correctly. Instead of this:
...10%File /file was not in a pack
...11%

Print a newline before the message:
...10%
File /file was not in a pack
...11%

Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Add newline so progress updates are printed correctly. Instead of this:
...10%File /file was not in a pack
...11%

Print a newline before the message:
...10%
File /file was not in a pack
...11%

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,244,2017-09-07T22:47:45Z,2017-09-08T15:57:16Z,2017-09-08T15:57:16Z,MERGED,True,1,1,1,https://github.com/matthewrsj,Add newline to informational print,1,[],https://github.com/clearlinux/swupd-client/pull/244,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/244#issuecomment-327962191,"Add newline so progress updates are printed correctly. Instead of this:
...10%File /file was not in a pack
...11%

Print a newline before the message:
...10%
File /file was not in a pack
...11%

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,246,2017-09-11T21:01:38Z,2017-09-15T17:44:33Z,2017-09-15T17:44:33Z,MERGED,True,301,6,37,https://github.com/matthewrsj,Add --no-boot-update flag for container usage,2,[],https://github.com/clearlinux/swupd-client/pull/246,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/246,"Since clr-boot-manager does not work in a container add the
--no-boot-update option to allow installation into a container to skip
the boot partition management.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Also add functional tests.","Since clr-boot-manager does not work in a container add the
--no-boot-update option to allow installation into a container to skip
the boot partition management.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Also add functional tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,246,2017-09-11T21:01:38Z,2017-09-15T17:44:33Z,2017-09-15T17:44:33Z,MERGED,True,301,6,37,https://github.com/matthewrsj,Add --no-boot-update flag for container usage,2,[],https://github.com/clearlinux/swupd-client/pull/246,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/246#issuecomment-329267776,"Since clr-boot-manager does not work in a container add the
--no-boot-update option to allow installation into a container to skip
the boot partition management.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Also add functional tests.",Rebased to the latest master to insure bundleadd tests still pass with latest bundleadd changes.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,246,2017-09-11T21:01:38Z,2017-09-15T17:44:33Z,2017-09-15T17:44:33Z,MERGED,True,301,6,37,https://github.com/matthewrsj,Add --no-boot-update flag for container usage,2,[],https://github.com/clearlinux/swupd-client/pull/246,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/246#issuecomment-329822866,"Since clr-boot-manager does not work in a container add the
--no-boot-update option to allow installation into a container to skip
the boot partition management.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Also add functional tests.",apply_heuristics() now called for bundle-add.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,246,2017-09-11T21:01:38Z,2017-09-15T17:44:33Z,2017-09-15T17:44:33Z,MERGED,True,301,6,37,https://github.com/matthewrsj,Add --no-boot-update flag for container usage,2,[],https://github.com/clearlinux/swupd-client/pull/246,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/246#issuecomment-329850419,"Since clr-boot-manager does not work in a container add the
--no-boot-update option to allow installation into a container to skip
the boot partition management.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Also add functional tests.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,247,2017-09-12T00:50:04Z,2017-09-12T18:46:30Z,2017-11-01T03:20:04Z,MERGED,True,50,14,17,https://github.com/tmarcu,Do hash checks for bundle add,3,[],https://github.com/clearlinux/swupd-client/pull/247,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/247,"Hash check every file before adding it to the file system.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Hash check every file before adding it to the file system.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,247,2017-09-12T00:50:04Z,2017-09-12T18:46:30Z,2017-11-01T03:20:04Z,MERGED,True,50,14,17,https://github.com/tmarcu,Do hash checks for bundle add,3,[],https://github.com/clearlinux/swupd-client/pull/247,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/247#issuecomment-328929267,"Hash check every file before adding it to the file system.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",FYI @tmarcu and @phmccarty I'm working on fixing the tests. It looks like a few code changes need to be made. I can make those if you don't mind @tmarcu .,True,"{'LAUGH': ['https://github.com/tmarcu'], 'HOORAY': ['https://github.com/tmarcu'], 'THUMBS_UP': ['https://github.com/tmarcu', 'https://github.com/phmccarty']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,247,2017-09-12T00:50:04Z,2017-09-12T18:46:30Z,2017-11-01T03:20:04Z,MERGED,True,50,14,17,https://github.com/tmarcu,Do hash checks for bundle add,3,[],https://github.com/clearlinux/swupd-client/pull/247,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/247#issuecomment-328943055,"Hash check every file before adding it to the file system.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,247,2017-09-12T00:50:04Z,2017-09-12T18:46:30Z,2017-11-01T03:20:04Z,MERGED,True,50,14,17,https://github.com/tmarcu,Do hash checks for bundle add,3,[],https://github.com/clearlinux/swupd-client/pull/247,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/247#issuecomment-328947858,"Hash check every file before adding it to the file system.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",+1 from the past,True,{'LAUGH': ['https://github.com/phmccarty']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/248,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-328932101,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","I agree that the current progress message state for packs is subpar, but I would rather see progress messages only for packs that have been downloaded.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-328978615,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","I see what you mean. The reason I added in the progress messages for all packs is because the (pack n of N) got confusing when the n would jump over unchanged packs and N isn't representative of the number of packs actually being processed.
Any suggestions?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-329005890,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","You could check for pack existence first. Then you could iterate over the list of packs detected and output something like:
Downloading 5 packs
[1/5] Downloading c-basic pack for build 12000...
[1/5] Extracting pack...
[2/5] Downloading os-core pack for build 12010...
[2/5] Extracting pack...
...

Edit: Another case: Consider that 10 delta packs should be downloaded for an update from 10 to 20, but only 2 of them exist. Then swupd would print:
Downloading 2 packs
[1/2] Downloading ...
[1/2] Extracting ...
[2/2] Downloading ...
[2/2] Extracting ...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-329821701,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@phmccarty that looks much nicer. Updated to that.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-329852495,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Thanks @matthewrsj. I like the new formatting of the messages better. However, ""Downloading ..."" is still printed whenever packs do not exist, and this is what has been confusing to end users.
Do you agree that the message should not be printed when delta/zero packs do not exist?
A possible way to implement this, accounting for missing packs, is described in my previous comment.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-329855190,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","I do agree.
I don't see the difference in your previous comment between the first example and the example in your edit. Is that not the same case?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-329855708,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","There is no difference, but I just wanted to clarify that ""N"" in ""Downloading N packs ..."" is the number of packs that exist. The original example did not mention it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-329857221,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Right.  OK I updated it so that the message is not printed at all when there are zero packs to download. Other than that, this will only print the specific Downloading... and Extracting... messages for the packs that need to be downloaded.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,248,2017-09-12T16:40:42Z,2017-09-19T16:43:35Z,2017-09-19T16:43:35Z,CLOSED,False,79,21,26,https://github.com/matthewrsj,Special handling for pack download/extract progress,2,[],https://github.com/clearlinux/swupd-client/pull/248,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/248#issuecomment-330600090,"Printing a percentage status for pack download and extraction is
somewhat meaningless, since the list will not be very long and output is
already sufficiently verbose.
Instead, update the pack fprintfs to include the current and total
number of packs. Print the pack name for every pack, not just those that
are being extracted so that the ""(pack n of N)"" message is meaningful.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Closing this for now until I figure out my errors. Opened #255 to track.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,268,2017-09-22T22:50:49Z,2017-09-25T21:11:03Z,2017-09-25T21:12:28Z,MERGED,True,6,3,1,https://github.com/icarus-sparry,"Fix for issue 260, make portability",1,[],https://github.com/clearlinux/swupd-client/pull/268,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/268,"Use = rather than := on the line. It is only an efficiency gain.
replace patsubst and filter with a new variable and standard
substitution.
Replace %-style pattern with suffix rule.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Use = rather than := on the line. It is only an efficiency gain.
replace patsubst and filter with a new variable and standard
substitution.
Replace %-style pattern with suffix rule.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,268,2017-09-22T22:50:49Z,2017-09-25T21:11:03Z,2017-09-25T21:12:28Z,MERGED,True,6,3,1,https://github.com/icarus-sparry,"Fix for issue 260, make portability",1,[],https://github.com/clearlinux/swupd-client/pull/268,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/268#issuecomment-332010154,"Use = rather than := on the line. It is only an efficiency gain.
replace patsubst and filter with a new variable and standard
substitution.
Replace %-style pattern with suffix rule.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","+1, thanks!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,268,2017-09-22T22:50:49Z,2017-09-25T21:11:03Z,2017-09-25T21:12:28Z,MERGED,True,6,3,1,https://github.com/icarus-sparry,"Fix for issue 260, make portability",1,[],https://github.com/clearlinux/swupd-client/pull/268,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/268#issuecomment-332013953,"Use = rather than := on the line. It is only an efficiency gain.
replace patsubst and filter with a new variable and standard
substitution.
Replace %-style pattern with suffix rule.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,269,2017-09-22T23:24:16Z,2017-09-25T21:05:33Z,2017-09-25T21:07:54Z,MERGED,True,4,1,1,https://github.com/icarus-sparry,"fix for issue 261, compiler warning",1,[],https://github.com/clearlinux/swupd-client/pull/269,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/269,"glibc marks system() as a function whose return value should not be
ignored, which is generally reasonable. In this case we do want to
ignore the return value. Just casting to vooid is not enough to stop
the gcc warning. So instead we use the value in an if statement with
an empty body, which we trust the optimizer to remove so there is no
run time penalty.
The alternative solution would be to use
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored ""-Wwarn_unused_result""
system(log_cmd);
#pragma GCC diagnostic pop
but that is rather gcc specific.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","glibc marks system() as a function whose return value should not be
ignored, which is generally reasonable. In this case we do want to
ignore the return value. Just casting to vooid is not enough to stop
the gcc warning. So instead we use the value in an if statement with
an empty body, which we trust the optimizer to remove so there is no
run time penalty.
The alternative solution would be to use
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored ""-Wwarn_unused_result""
system(log_cmd);
#pragma GCC diagnostic pop
but that is rather gcc specific.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,269,2017-09-22T23:24:16Z,2017-09-25T21:05:33Z,2017-09-25T21:07:54Z,MERGED,True,4,1,1,https://github.com/icarus-sparry,"fix for issue 261, compiler warning",1,[],https://github.com/clearlinux/swupd-client/pull/269,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/269#issuecomment-332012462,"glibc marks system() as a function whose return value should not be
ignored, which is generally reasonable. In this case we do want to
ignore the return value. Just casting to vooid is not enough to stop
the gcc warning. So instead we use the value in an if statement with
an empty body, which we trust the optimizer to remove so there is no
run time penalty.
The alternative solution would be to use
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored ""-Wwarn_unused_result""
system(log_cmd);
#pragma GCC diagnostic pop
but that is rather gcc specific.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","I don't really like it but it's better than assigning to an __attribute__((unused)) that I've seen suggested elsewhere. Also better than the macros to silence it there.
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,270,2017-09-25T22:06:56Z,2017-09-28T18:27:02Z,2017-09-28T18:27:02Z,MERGED,True,5,5,4,https://github.com/matthewrsj,Fix compiler warnings,3,[],https://github.com/clearlinux/swupd-client/pull/270,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/270,"Fixes compiler warnings in clr_bundle_rm.c and check_update.c.
Also fixes tests and improves error message for check_network()
failure in check_update.c.","Fixes compiler warnings in clr_bundle_rm.c and check_update.c.
Also fixes tests and improves error message for check_network()
failure in check_update.c.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,270,2017-09-25T22:06:56Z,2017-09-28T18:27:02Z,2017-09-28T18:27:02Z,MERGED,True,5,5,4,https://github.com/matthewrsj,Fix compiler warnings,3,[],https://github.com/clearlinux/swupd-client/pull/270,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/270#issuecomment-332585235,"Fixes compiler warnings in clr_bundle_rm.c and check_update.c.
Also fixes tests and improves error message for check_network()
failure in check_update.c.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/272,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.","Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332344594,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.","You seem to be checking in a couple binary delta files, but it looks like those are automatically added during the test setup?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332355738,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.","I don't believe they are generated during the test setup, they are copied from web-dir to staged. We definitely could do with some better tooling around creating tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332573127,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.","We definitely could do with some better tooling around creating tests.

Agree, see #258
Instead of adding the delta packs, you can just add the files to the web-dir/20/staged directory.
I also noticed you aren't checking the output with a lines-checked file.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/icarus-sparry,5,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332632704,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.","I think that checking the output with a ""lines-checked"" adds very little value, and just adds to future maintenance issues. The test checks that the files which should be renamed are removed, and the new ones are present, which is the thing we are trying to test, not that we are outputting the correct copyright message.
OK, will rework the test to not use the delta files but have staged ascii files instead.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/icarus-sparry,6,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332650666,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.","If we don't have the delta files, how do we know that we are actually doing the rename, rather than just doing normal processing of adding files from staging and removing them from target-dir?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332659193,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.",@icarus-sparry let's stick with deltas,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-332659697,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.",lgtm and the test gives me confidence that this is actually working. I would like one more +1 on this before merging though.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,272,2017-09-26T02:01:52Z,2017-10-02T20:13:28Z,2017-10-02T20:13:28Z,MERGED,True,353,12,16,https://github.com/icarus-sparry,Fix + test for renames,3,[],https://github.com/clearlinux/swupd-client/pull/272,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/272#issuecomment-333611238,"Not sure what people think of putting in binary files for the bsdiff.
Factored as 3 patches, updated swupdlib.bash functionality, a test for rename, and the fix for rename.",@phmccarty review ping,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/klihub,1,https://github.com/clearlinux/swupd-client/pull/274,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.","Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/274#issuecomment-332244039,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.",Looks like sourceforge is down https://twitter.com/sfnet_ops/status/912673956712341514 which explains the Travis error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/klihub,3,https://github.com/clearlinux/swupd-client/pull/274#issuecomment-332311126,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.","Updated accordingly. Then again, now that I stopped also thinking about what I'm doing, I guess you'd like more something like this (since you seem to keep pre-generated man pages in the repo):
.rst:
	rst2man.py ""$<"" > ""$@.tmp"" && \
	        mv -f ""$@.tmp"" ""$(dir $<)/$(notdir $@)""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/icarus-sparry,4,https://github.com/clearlinux/swupd-client/pull/274#issuecomment-332323318,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.","No actually. Icarus's rule of Makefiles is that a rule should generate exactly $@, nothing more (and hopefully nothing less, with obvious exceptions for .PHONY targets). If you don't then make will get confused, and will either do too much or too little work.
This kind of rule is easy to specify in GNUmake with % pattern rules, but I just submitted a fix for #260 so I am reluctant to add them back in.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/klihub,5,https://github.com/clearlinux/swupd-client/pull/274#issuecomment-332425747,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.",Let's just then make sure the output dir exists.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/274#issuecomment-332920422,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.",This lgtm unless @icarus-sparry has any other comments?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,274,2017-09-26T15:03:42Z,2017-09-28T18:18:46Z,2017-09-28T18:18:46Z,MERGED,True,2,1,1,https://github.com/klihub,Fix (doc) build failure for separate src and build dirs.,1,[],https://github.com/clearlinux/swupd-client/pull/274,https://github.com/icarus-sparry,7,https://github.com/clearlinux/swupd-client/pull/274#issuecomment-332921156,"Without this patch, if the docs are not up to date generating them fails if separate src and build dirs are used.",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,279,2017-09-26T20:10:59Z,2017-09-28T15:59:50Z,2017-09-28T17:59:26Z,MERGED,True,32,16,8,https://github.com/icarus-sparry,F/275,3,[],https://github.com/clearlinux/swupd-client/pull/279,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/279,"2 progress meter related changes, as 3 patches.


Fix the fix-missing-file so it doesn't get upset with extra dots coming out partway through other output. This will happen when we flush the progress meter.


Make the progress meter more accurate, and show 100% at the end of each step.  Issue #275


Flush the non interactive progress meter, Issue #256 - adding this breaks the fix-missing-file.","2 progress meter related changes, as 3 patches.


Fix the fix-missing-file so it doesn't get upset with extra dots coming out partway through other output. This will happen when we flush the progress meter.


Make the progress meter more accurate, and show 100% at the end of each step.  Issue #275


Flush the non interactive progress meter, Issue #256 - adding this breaks the fix-missing-file.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,279,2017-09-26T20:10:59Z,2017-09-28T15:59:50Z,2017-09-28T17:59:26Z,MERGED,True,32,16,8,https://github.com/icarus-sparry,F/275,3,[],https://github.com/clearlinux/swupd-client/pull/279,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/279#issuecomment-332609529,"2 progress meter related changes, as 3 patches.


Fix the fix-missing-file so it doesn't get upset with extra dots coming out partway through other output. This will happen when we flush the progress meter.


Make the progress meter more accurate, and show 100% at the end of each step.  Issue #275


Flush the non interactive progress meter, Issue #256 - adding this breaks the fix-missing-file.",Please rebase to latest master to fix CI error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,279,2017-09-26T20:10:59Z,2017-09-28T15:59:50Z,2017-09-28T17:59:26Z,MERGED,True,32,16,8,https://github.com/icarus-sparry,F/275,3,[],https://github.com/clearlinux/swupd-client/pull/279,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/279#issuecomment-332662817,"2 progress meter related changes, as 3 patches.


Fix the fix-missing-file so it doesn't get upset with extra dots coming out partway through other output. This will happen when we flush the progress meter.


Make the progress meter more accurate, and show 100% at the end of each step.  Issue #275


Flush the non interactive progress meter, Issue #256 - adding this breaks the fix-missing-file.","+1, I'll merge this after the code style fix is made.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,279,2017-09-26T20:10:59Z,2017-09-28T15:59:50Z,2017-09-28T17:59:26Z,MERGED,True,32,16,8,https://github.com/icarus-sparry,F/275,3,[],https://github.com/clearlinux/swupd-client/pull/279,https://github.com/icarus-sparry,4,https://github.com/clearlinux/swupd-client/pull/279#issuecomment-332676555,"2 progress meter related changes, as 3 patches.


Fix the fix-missing-file so it doesn't get upset with extra dots coming out partway through other output. This will happen when we flush the progress meter.


Make the progress meter more accurate, and show 100% at the end of each step.  Issue #275


Flush the non interactive progress meter, Issue #256 - adding this breaks the fix-missing-file.",Style updated. It does strike me that we should be sending progress meters to stderr (i.e. the terminal) rather than stdout to maybe be consumed by another program.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,279,2017-09-26T20:10:59Z,2017-09-28T15:59:50Z,2017-09-28T17:59:26Z,MERGED,True,32,16,8,https://github.com/icarus-sparry,F/275,3,[],https://github.com/clearlinux/swupd-client/pull/279,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/279#issuecomment-332882834,"2 progress meter related changes, as 3 patches.


Fix the fix-missing-file so it doesn't get upset with extra dots coming out partway through other output. This will happen when we flush the progress meter.


Make the progress meter more accurate, and show 100% at the end of each step.  Issue #275


Flush the non interactive progress meter, Issue #256 - adding this breaks the fix-missing-file.",I agree. #294 open.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,281,2017-09-26T22:55:20Z,2017-09-28T19:34:50Z,2017-09-28T19:35:33Z,MERGED,True,0,6,1,https://github.com/phmccarty,Support IPv6 in download code,1,[],https://github.com/clearlinux/swupd-client/pull/281,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/281,"Fixes #200
Because swupd-client uses libcurl, and my guess is that libcurl has
supported IPv6 for a long time, I don't see any reason to restrict
downloads to IPv4 only.","Fixes #200
Because swupd-client uses libcurl, and my guess is that libcurl has
supported IPv6 for a long time, I don't see any reason to restrict
downloads to IPv4 only.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,281,2017-09-26T22:55:20Z,2017-09-28T19:34:50Z,2017-09-28T19:35:33Z,MERGED,True,0,6,1,https://github.com/phmccarty,Support IPv6 in download code,1,[],https://github.com/clearlinux/swupd-client/pull/281,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/281#issuecomment-332609452,"Fixes #200
Because swupd-client uses libcurl, and my guess is that libcurl has
supported IPv6 for a long time, I don't see any reason to restrict
downloads to IPv4 only.",Please rebase to latest master to fix CI error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,281,2017-09-26T22:55:20Z,2017-09-28T19:34:50Z,2017-09-28T19:35:33Z,MERGED,True,0,6,1,https://github.com/phmccarty,Support IPv6 in download code,1,[],https://github.com/clearlinux/swupd-client/pull/281,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/281#issuecomment-332939747,"Fixes #200
Because swupd-client uses libcurl, and my guess is that libcurl has
supported IPv6 for a long time, I don't see any reason to restrict
downloads to IPv4 only.",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,281,2017-09-26T22:55:20Z,2017-09-28T19:34:50Z,2017-09-28T19:35:33Z,MERGED,True,0,6,1,https://github.com/phmccarty,Support IPv6 in download code,1,[],https://github.com/clearlinux/swupd-client/pull/281,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/281#issuecomment-332941224,"Fixes #200
Because swupd-client uses libcurl, and my guess is that libcurl has
supported IPv6 for a long time, I don't see any reason to restrict
downloads to IPv4 only.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,282,2017-09-27T00:03:48Z,2017-09-28T18:21:59Z,2017-10-11T18:01:46Z,MERGED,True,62,51,1,https://github.com/icarus-sparry,Add progress updates for Verifying files,1,[],https://github.com/clearlinux/swupd-client/pull/282,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/282,"Fixes #276
Refactor fixing a single file into its own routine, then call it in a
loop with print_progress.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Fixes #276
Refactor fixing a single file into its own routine, then call it in a
loop with print_progress.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,282,2017-09-27T00:03:48Z,2017-09-28T18:21:59Z,2017-10-11T18:01:46Z,MERGED,True,62,51,1,https://github.com/icarus-sparry,Add progress updates for Verifying files,1,[],https://github.com/clearlinux/swupd-client/pull/282,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/282#issuecomment-332575155,"Fixes #276
Refactor fixing a single file into its own routine, then call it in a
loop with print_progress.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","This looks mostly good, but please run make compliant to fix style issues.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,282,2017-09-27T00:03:48Z,2017-09-28T18:21:59Z,2017-10-11T18:01:46Z,MERGED,True,62,51,1,https://github.com/icarus-sparry,Add progress updates for Verifying files,1,[],https://github.com/clearlinux/swupd-client/pull/282,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/282#issuecomment-332609383,"Fixes #276
Refactor fixing a single file into its own routine, then call it in a
loop with print_progress.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Please rebase to latest master to fix CI error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,282,2017-09-27T00:03:48Z,2017-09-28T18:21:59Z,2017-10-11T18:01:46Z,MERGED,True,62,51,1,https://github.com/icarus-sparry,Add progress updates for Verifying files,1,[],https://github.com/clearlinux/swupd-client/pull/282,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/282#issuecomment-332922065,"Fixes #276
Refactor fixing a single file into its own routine, then call it in a
loop with print_progress.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,284,2017-09-27T00:51:38Z,2017-09-28T18:26:41Z,2017-10-11T18:01:15Z,MERGED,True,11,2,1,https://github.com/icarus-sparry,compiler warnings in xattrs,1,[],https://github.com/clearlinux/swupd-client/pull/284,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/284,"Fixes #262
Define silly little function to get gcc to shut up about unused
parameters.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Fixes #262
Define silly little function to get gcc to shut up about unused
parameters.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,284,2017-09-27T00:51:38Z,2017-09-28T18:26:41Z,2017-10-11T18:01:15Z,MERGED,True,11,2,1,https://github.com/icarus-sparry,compiler warnings in xattrs,1,[],https://github.com/clearlinux/swupd-client/pull/284,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/284#issuecomment-332609291,"Fixes #262
Define silly little function to get gcc to shut up about unused
parameters.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Please rebase to latest master to fix CI error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,284,2017-09-27T00:51:38Z,2017-09-28T18:26:41Z,2017-10-11T18:01:15Z,MERGED,True,11,2,1,https://github.com/icarus-sparry,compiler warnings in xattrs,1,[],https://github.com/clearlinux/swupd-client/pull/284,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/284#issuecomment-332923363,"Fixes #262
Define silly little function to get gcc to shut up about unused
parameters.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,287,2017-09-27T11:38:05Z,2017-10-31T23:19:56Z,2017-10-31T23:19:56Z,CLOSED,False,7,7,5,https://github.com/pohly,show tar errors,1,[],https://github.com/clearlinux/swupd-client/pull/287,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/287,"Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.","Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,287,2017-09-27T11:38:05Z,2017-10-31T23:19:56Z,2017-10-31T23:19:56Z,CLOSED,False,7,7,5,https://github.com/pohly,show tar errors,1,[],https://github.com/clearlinux/swupd-client/pull/287,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/287#issuecomment-332563706,"Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.","@tmarcu @phmccarty tar errors were originally redirected to /dev/null to silence the slew of time stamp is in the future errors correct?
Maybe this could be made optional with a --verbose flag? That flag could also absorb the --verbose-time flag.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,287,2017-09-27T11:38:05Z,2017-10-31T23:19:56Z,2017-10-31T23:19:56Z,CLOSED,False,7,7,5,https://github.com/pohly,show tar errors,1,[],https://github.com/clearlinux/swupd-client/pull/287,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/287#issuecomment-332586152,"Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.","@matthewrsj Yes, that's the primary reason for silencing tar. Many upstream projects ship files with timestamps that are skewed...
IMO, a solution here needs to silence tar warnings but not tar errors.",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,287,2017-09-27T11:38:05Z,2017-10-31T23:19:56Z,2017-10-31T23:19:56Z,CLOSED,False,7,7,5,https://github.com/pohly,show tar errors,1,[],https://github.com/clearlinux/swupd-client/pull/287,https://github.com/pohly,4,https://github.com/clearlinux/swupd-client/pull/287#issuecomment-332849117,"Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.","Looks like the right solution will be to call libarchive directly (issue #285) and then control which errors need to be printed inside swupd code.
If that is taking too long to implement, then showing stderr for a ""--verbose"" flag in the meantime would be useful. It would also be useful to show all GET requests when such a flag is given.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,287,2017-09-27T11:38:05Z,2017-10-31T23:19:56Z,2017-10-31T23:19:56Z,CLOSED,False,7,7,5,https://github.com/pohly,show tar errors,1,[],https://github.com/clearlinux/swupd-client/pull/287,https://github.com/tmarcu,5,https://github.com/clearlinux/swupd-client/pull/287#issuecomment-340831437,"Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.",@pohly Any updates on this?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,287,2017-09-27T11:38:05Z,2017-10-31T23:19:56Z,2017-10-31T23:19:56Z,CLOSED,False,7,7,5,https://github.com/pohly,show tar errors,1,[],https://github.com/clearlinux/swupd-client/pull/287,https://github.com/pohly,6,https://github.com/clearlinux/swupd-client/pull/287#issuecomment-340879382,"Sending all tar stderr to /dev/null makes it hard to determine why
something failed.
This is particularly relevant for the issues we still do not fully
understand in clearlinux/swupd-server#48.
I also needed this to see that I was simply running out of disk space
during a test.","@tmarcu As far as I am concerned, you can close this issue and implement something else instead. I don't have plans to change on this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,288,2017-09-27T11:40:46Z,2017-09-28T22:03:32Z,2017-09-28T22:03:32Z,MERGED,True,10,38,5,https://github.com/pohly,support mixing http and file URLs,1,[],https://github.com/clearlinux/swupd-client/pull/288,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/288,"I need this in the context of the script that implements
#249: it works around
the lack of the ""-m"" parameter for ""swupd
update"" (#257) by
creationg a local directory with ""version/format/latest"" and
using that via file://, while the actual content comes via http://.","I need this in the context of the script that implements
#249: it works around
the lack of the ""-m"" parameter for ""swupd
update"" (#257) by
creationg a local directory with ""version/format/latest"" and
using that via file://, while the actual content comes via http://.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,288,2017-09-27T11:40:46Z,2017-09-28T22:03:32Z,2017-09-28T22:03:32Z,MERGED,True,10,38,5,https://github.com/pohly,support mixing http and file URLs,1,[],https://github.com/clearlinux/swupd-client/pull/288,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/288#issuecomment-332970383,"I need this in the context of the script that implements
#249: it works around
the lack of the ""-m"" parameter for ""swupd
update"" (#257) by
creationg a local directory with ""version/format/latest"" and
using that via file://, while the actual content comes via http://.","So will this still be necessary after adding a -m parameter for update, or is this just a temporary workaround?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,288,2017-09-27T11:40:46Z,2017-09-28T22:03:32Z,2017-09-28T22:03:32Z,MERGED,True,10,38,5,https://github.com/pohly,support mixing http and file URLs,1,[],https://github.com/clearlinux/swupd-client/pull/288,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/288#issuecomment-332972074,"I need this in the context of the script that implements
#249: it works around
the lack of the ""-m"" parameter for ""swupd
update"" (#257) by
creationg a local directory with ""version/format/latest"" and
using that via file://, while the actual content comes via http://.","I'm inclined to +1 this anyways, since it seems silly to require both URLs use the same protocol just for the existing logic.
@phmccarty do you recall if there was another reason for requiring each to be the same protocol?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,288,2017-09-27T11:40:46Z,2017-09-28T22:03:32Z,2017-09-28T22:03:32Z,MERGED,True,10,38,5,https://github.com/pohly,support mixing http and file URLs,1,[],https://github.com/clearlinux/swupd-client/pull/288,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/288#issuecomment-332973514,"I need this in the context of the script that implements
#249: it works around
the lack of the ""-m"" parameter for ""swupd
update"" (#257) by
creationg a local directory with ""version/format/latest"" and
using that via file://, while the actual content comes via http://.",@matthewrsj There is no technical reason for forbidding the protocol mix.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,288,2017-09-27T11:40:46Z,2017-09-28T22:03:32Z,2017-09-28T22:03:32Z,MERGED,True,10,38,5,https://github.com/pohly,support mixing http and file URLs,1,[],https://github.com/clearlinux/swupd-client/pull/288,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/288#issuecomment-332976606,"I need this in the context of the script that implements
#249: it works around
the lack of the ""-m"" parameter for ""swupd
update"" (#257) by
creationg a local directory with ""version/format/latest"" and
using that via file://, while the actual content comes via http://.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,290,2017-09-27T17:40:59Z,2017-09-27T18:11:55Z,2017-09-27T18:11:59Z,MERGED,True,3,3,1,https://github.com/matthewrsj,Travis: Use github as upstream for check,1,[],https://github.com/clearlinux/swupd-client/pull/290,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/290,"Recent outages to sourceforge break Travis CI runs. Use the github
release instead and update to the latest version of libcheck (0.11.0).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Recent outages to sourceforge break Travis CI runs. Use the github
release instead and update to the latest version of libcheck (0.11.0).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,290,2017-09-27T17:40:59Z,2017-09-27T18:11:55Z,2017-09-27T18:11:59Z,MERGED,True,3,3,1,https://github.com/matthewrsj,Travis: Use github as upstream for check,1,[],https://github.com/clearlinux/swupd-client/pull/290,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/290#issuecomment-332603138,"Recent outages to sourceforge break Travis CI runs. Use the github
release instead and update to the latest version of libcheck (0.11.0).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@phmccarty this will fix our CI issues,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,290,2017-09-27T17:40:59Z,2017-09-27T18:11:55Z,2017-09-27T18:11:59Z,MERGED,True,3,3,1,https://github.com/matthewrsj,Travis: Use github as upstream for check,1,[],https://github.com/clearlinux/swupd-client/pull/290,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/290#issuecomment-332606528,"Recent outages to sourceforge break Travis CI runs. Use the github
release instead and update to the latest version of libcheck (0.11.0).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Cool! Can you mention that you have also bumped the libcheck version for Travis?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,290,2017-09-27T17:40:59Z,2017-09-27T18:11:55Z,2017-09-27T18:11:59Z,MERGED,True,3,3,1,https://github.com/matthewrsj,Travis: Use github as upstream for check,1,[],https://github.com/clearlinux/swupd-client/pull/290,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/290#issuecomment-332607028,"Recent outages to sourceforge break Travis CI runs. Use the github
release instead and update to the latest version of libcheck (0.11.0).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@phmccarty donezo,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,290,2017-09-27T17:40:59Z,2017-09-27T18:11:55Z,2017-09-27T18:11:59Z,MERGED,True,3,3,1,https://github.com/matthewrsj,Travis: Use github as upstream for check,1,[],https://github.com/clearlinux/swupd-client/pull/290,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/290#issuecomment-332607913,"Recent outages to sourceforge break Travis CI runs. Use the github
release instead and update to the latest version of libcheck (0.11.0).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,291,2017-09-28T07:47:33Z,2017-09-29T00:21:38Z,2017-09-29T00:21:43Z,CLOSED,False,98,1,3,https://github.com/busykai,DO NOT MERGE: Rough draft of fallback capath support.,1,[],https://github.com/clearlinux/swupd-client/pull/291,https://github.com/busykai,1,https://github.com/clearlinux/swupd-client/pull/291,"@tmarcu, @phmccarty, @matthewrsj
this is to support fallback trust sources for https connectivity in swupd, so that if the default trust store (configured in curl) does not work, it would try alternatives. this way, we protect the critical path for Clear Linux to be able to peform an update.
this PR is rather just an illustration to the two questions that i have:


i'd like to suggest an alternative way of checking connectivity. currently check_network() (from src/version.c is being used which internally fetches the version file, actually. instead, i propose that we have specialized swupd_curl_check_network() which, when called, also pick the appropriate trust store and if connection could not be established. additionally (this is not present yet in this PR), i think swupd_curl_check_network() could also be called immediately on swupd_curl_init().


do you think we also need to make it a runtime command-line option? i noticed that most, if not all, build configuration options have their command-line analogs.","@tmarcu, @phmccarty, @matthewrsj
this is to support fallback trust sources for https connectivity in swupd, so that if the default trust store (configured in curl) does not work, it would try alternatives. this way, we protect the critical path for Clear Linux to be able to peform an update.
this PR is rather just an illustration to the two questions that i have:


i'd like to suggest an alternative way of checking connectivity. currently check_network() (from src/version.c is being used which internally fetches the version file, actually. instead, i propose that we have specialized swupd_curl_check_network() which, when called, also pick the appropriate trust store and if connection could not be established. additionally (this is not present yet in this PR), i think swupd_curl_check_network() could also be called immediately on swupd_curl_init().


do you think we also need to make it a runtime command-line option? i noticed that most, if not all, build configuration options have their command-line analogs.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,291,2017-09-28T07:47:33Z,2017-09-29T00:21:38Z,2017-09-29T00:21:43Z,CLOSED,False,98,1,3,https://github.com/busykai,DO NOT MERGE: Rough draft of fallback capath support.,1,[],https://github.com/clearlinux/swupd-client/pull/291,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/291#issuecomment-332912074,"@tmarcu, @phmccarty, @matthewrsj
this is to support fallback trust sources for https connectivity in swupd, so that if the default trust store (configured in curl) does not work, it would try alternatives. this way, we protect the critical path for Clear Linux to be able to peform an update.
this PR is rather just an illustration to the two questions that i have:


i'd like to suggest an alternative way of checking connectivity. currently check_network() (from src/version.c is being used which internally fetches the version file, actually. instead, i propose that we have specialized swupd_curl_check_network() which, when called, also pick the appropriate trust store and if connection could not be established. additionally (this is not present yet in this PR), i think swupd_curl_check_network() could also be called immediately on swupd_curl_init().


do you think we also need to make it a runtime command-line option? i noticed that most, if not all, build configuration options have their command-line analogs.","instead, i propose that we have specialized swupd_curl_check_network() which, when called, also pick the appropriate trust store and if connection could not be established.

+1, that's a good idea

additionally (this is not present yet in this PR), i think swupd_curl_check_network() could also be called immediately on swupd_curl_init().

Hmm, would have to be careful here, since some commands do not need network and should therefore not check for network.

do you think we also need to make it a runtime command-line option? i noticed that most, if not all, build configuration options have their command-line analogs.

This seems more like a configuration option than a runtime command-line option to me, but @phmccarty might have a different view.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,291,2017-09-28T07:47:33Z,2017-09-29T00:21:38Z,2017-09-29T00:21:43Z,CLOSED,False,98,1,3,https://github.com/busykai,DO NOT MERGE: Rough draft of fallback capath support.,1,[],https://github.com/clearlinux/swupd-client/pull/291,https://github.com/busykai,3,https://github.com/clearlinux/swupd-client/pull/291#issuecomment-332921621,"@tmarcu, @phmccarty, @matthewrsj
this is to support fallback trust sources for https connectivity in swupd, so that if the default trust store (configured in curl) does not work, it would try alternatives. this way, we protect the critical path for Clear Linux to be able to peform an update.
this PR is rather just an illustration to the two questions that i have:


i'd like to suggest an alternative way of checking connectivity. currently check_network() (from src/version.c is being used which internally fetches the version file, actually. instead, i propose that we have specialized swupd_curl_check_network() which, when called, also pick the appropriate trust store and if connection could not be established. additionally (this is not present yet in this PR), i think swupd_curl_check_network() could also be called immediately on swupd_curl_init().


do you think we also need to make it a runtime command-line option? i noticed that most, if not all, build configuration options have their command-line analogs.","thanks @matthewrsj!

Hmm, would have to be careful here, since some commands do not need network and should therefore not check for network.

Yes, you're right. It's better to have explicit checks on the code path where it's actually needed.

This seems more like a configuration option than a runtime command-line option to me

OK, so it does to me, but runtime does not exclude build-time. I'll just implement it in a way so it would be easy to add a runtime analogue.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,297,2017-09-28T20:04:45Z,2017-09-28T20:18:12Z,2017-11-30T23:32:08Z,MERGED,True,10,6,1,https://github.com/phmccarty,Fix compiler warnings in search.c,1,[],https://github.com/clearlinux/swupd-client/pull/297,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/297,"Fixes #265
The calls to strstr() and strcasestr() in file_search() from search.c
result in compiler warnings when -Wnonnull is specified, because GCC's
""nonnull"" attribute applies to these functions.
The logic from the file_search() call sites prevent NULL pointers from
being passed to these functions, but to protect against future
refactoring introducing this bug, check that the appropriate pointers
are non-NULL before calling the string functions.","Fixes #265
The calls to strstr() and strcasestr() in file_search() from search.c
result in compiler warnings when -Wnonnull is specified, because GCC's
""nonnull"" attribute applies to these functions.
The logic from the file_search() call sites prevent NULL pointers from
being passed to these functions, but to protect against future
refactoring introducing this bug, check that the appropriate pointers
are non-NULL before calling the string functions.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,297,2017-09-28T20:04:45Z,2017-09-28T20:18:12Z,2017-11-30T23:32:08Z,MERGED,True,10,6,1,https://github.com/phmccarty,Fix compiler warnings in search.c,1,[],https://github.com/clearlinux/swupd-client/pull/297,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/297#issuecomment-332951892,"Fixes #265
The calls to strstr() and strcasestr() in file_search() from search.c
result in compiler warnings when -Wnonnull is specified, because GCC's
""nonnull"" attribute applies to these functions.
The logic from the file_search() call sites prevent NULL pointers from
being passed to these functions, but to protect against future
refactoring introducing this bug, check that the appropriate pointers
are non-NULL before calling the string functions.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/busykai,1,https://github.com/clearlinux/swupd-client/pull/299,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP","A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/299#issuecomment-333185836,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP",You have a lot of test failures due to output checking. This can be fixed in this case by removing the Attempting to download version string to memory from most (all?) of the lines-checked files in tests/functional/*/*/ directories,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/busykai,3,https://github.com/clearlinux/swupd-client/pull/299#issuecomment-333193153,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP","@matthewrsj, thank you! i should have read your comment. now i figured it myself too. :)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/busykai,4,https://github.com/clearlinux/swupd-client/pull/299#issuecomment-333217905,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP","@matthewrsj, I addressed the issues with the tests. finally, this ""attempting to download"" appears in the places where it makes sense! :)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/busykai,5,https://github.com/clearlinux/swupd-client/pull/299#issuecomment-333602422,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP","@tmarcu, @icarus-sparry cleaned up allocation/reallocation.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/busykai,6,https://github.com/clearlinux/swupd-client/pull/299#issuecomment-333608086,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP","@matthewrsj, done!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,299,2017-09-29T09:15:32Z,2017-10-02T18:30:49Z,2017-10-03T18:45:11Z,MERGED,True,176,88,67,https://github.com/busykai,Implement fallback CApath support.,1,[],https://github.com/clearlinux/swupd-client/pull/299,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/299#issuecomment-333609599,"A colon-separated list of alternative CApath options can be passed to
swupd-client at the configuration time using --with-fallback-capaths
option.
In runtime, fallback CApath support is implemented as part of the
connectivity check. The implementation will try the default (built into
curl) and then will iterate through the list in the order they were
specified. It is done only once on the first call.
The code is reorganized to keep the connectivity check inside curl
wrapper:

Deleted check_network implementation from version.c
Removed have_network global (globals.c)
Scoped swupd_curl_test_resume to curl.c
Change use of check_network to swupd_curl_check_network

Also:

Fixed an issue where SSL was only enabled if a URL was matching the
content URL

@tmarcu, @matthewrsj please review ASAP","@busykai looks good to me, please squash your commits and I'll +1. @icarus-sparry has he addressed all your feedback (looks like you still have open requests according to the github UI).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,301,2017-10-02T17:41:41Z,2017-10-02T18:12:42Z,2017-10-02T18:31:50Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,Portability for Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/301,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/301,"Fixes #300
Do not use GNU Make 'dir' function, instead use shell dirname command.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Fixes #300
Do not use GNU Make 'dir' function, instead use shell dirname command.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,301,2017-10-02T17:41:41Z,2017-10-02T18:12:42Z,2017-10-02T18:31:50Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,Portability for Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/301,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/301#issuecomment-333610306,"Fixes #300
Do not use GNU Make 'dir' function, instead use shell dirname command.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",You have a typo in your commit message.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,301,2017-10-02T17:41:41Z,2017-10-02T18:12:42Z,2017-10-02T18:31:50Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,Portability for Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/301,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/301#issuecomment-333613458,"Fixes #300
Do not use GNU Make 'dir' function, instead use shell dirname command.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","With typos like this, it is helpful to spell out exactly what I am looking for for for for. If I double a word I am likely to not see it as doubled when I read it, as I ""know"" what the message is supposed to say.",True,{'LAUGH': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,301,2017-10-02T17:41:41Z,2017-10-02T18:12:42Z,2017-10-02T18:31:50Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,Portability for Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/301,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/301#issuecomment-333618224,"Fixes #300
Do not use GNU Make 'dir' function, instead use shell dirname command.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,301,2017-10-02T17:41:41Z,2017-10-02T18:12:42Z,2017-10-02T18:31:50Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,Portability for Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/301,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/301#issuecomment-333622381,"Fixes #300
Do not use GNU Make 'dir' function, instead use shell dirname command.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1 (belated),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,308,2017-10-05T21:20:14Z,2017-10-05T21:48:32Z,2017-10-05T22:16:00Z,MERGED,True,0,1,1,https://github.com/busykai,Fix incorrect cycle.,1,[],https://github.com/clearlinux/swupd-client/pull/308,https://github.com/busykai,1,https://github.com/clearlinux/swupd-client/pull/308,Remove the increment left-over from changing from while to for.,Remove the increment left-over from changing from while to for.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,308,2017-10-05T21:20:14Z,2017-10-05T21:48:32Z,2017-10-05T22:16:00Z,MERGED,True,0,1,1,https://github.com/busykai,Fix incorrect cycle.,1,[],https://github.com/clearlinux/swupd-client/pull/308,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/308#issuecomment-334601543,Remove the increment left-over from changing from while to for.,"+1, easy to overlook",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/aaronovz1,1,https://github.com/clearlinux/swupd-client/pull/309,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/aaronovz1,2,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-334862916,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","In our particular Yocto setup we do not ship with manuals so there is no need to build them. The change has manuals built as default, but allows user to disable them if they don't need them. This also resolves the issue I am seeing since version 3.12.3 (commit ff16281) which causes build issues in Yocto because rst2man.py is not found.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/pohly,3,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335251309,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","Additional information: depending on the random time stamps assigned to the .rst input files and the man page output files after a git checkout, make sometimes invokes rst2man.py and sometimes it doesn't. This is independent of Yocto, but probably doesn't normally get noticed because rst2man.py is present (without being checked for by configure).
I think a clean solution would be to have a --with-rst2man configure option. If set or found, make rules for re-generating the man pages are active. If not, the pre-generated ones are used instead.
Installing man pages is orthogonal to that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/icarus-sparry,4,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335252201,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","In an ideal world, the man pages would not be stored in the repo, but instead generated from the restructured text source files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/pohly,5,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335254858,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","On Mon, 2017-10-09 at 18:45 +0000, icarus-sparry wrote:
 In an ideal world, the man pages would not be stored in the repo, but
 instead generated from the restructured text source files.
Then remove them and add a --enable-manpages configure option as
@aaronovz1 suggested. However, then configure should check for the
presence of rst2man.py when enabled (better fail early instead of
during compilation).


 
 





 {""api_version"":""1.0"",""publisher"":{""api_key"":""05dde50f1d1a384dd78767c5
 5493e4bb"",""name"":""GitHub""},""entity"":{""external_key"":""github/clearlinu
 x/swupd-client"",""title"":""clearlinux/swupd-client"",""subtitle"":""GitHub
 repository"",""main_image_url"":""https://cloud.githubusercontent.com/ass
 ets/143418/17495839/a5054eac-5d88-11e6-95fc-
 7290892c7bb5.png"",""avatar_image_url"":""https://cloud.githubusercontent
 .com/assets/143418/15842166/7c72db34-2c0b-11e6-9aed-
 b52498112777.png"",""action"":{""name"":""Open in
 GitHub"",""url"":""https://github.com/clearlinux/swupd-
 ***@***.***
 sparry in #309: In an ideal world, the man pages would not be stored
 in the repo, but instead generated from the restructured text source
 files.""}],""action"":{""name"":""View Pull
 Request"",""url"":""https://github.com/clearlinux/swupd-
 client/pull/309#issuecomment-335252201""}}}",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335627873,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","I think I would agree with @pohly here and say we shouldn't be building man pages unless passed --enable-manpages.
Could this PR be updated to work the other way around, with --enable-manpages instead of --disable-manpages and have the default be to not make the manpages?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/aaronovz1,7,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335628259,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated",Sure. I can swap it if that is final decision.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335628979,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","@matthewrsj I think it's nicer to build/install man pages by default. If the required deps to build docs are not available, then a --disable-manpages option can skip the process entirely.",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/icarus-sparry,9,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-335631474,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","I agree with @phmccarty, my expectation is that a unix package comes with manual pages. As I see it, we have a series of choices to make

Is the master source of the man pages in ReStructuredText format or not.
If it is, then do we want pre-generated man pages in the repo for places which don't have rst2man.py.
If we do have pre-generated pages,  we probably want some additional hooks to ensure that the pages are up-to-date, maybe adding them to the ""compliant"" target, and not running it by default.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/tmarcu,10,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-340832972,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","Dealing with a couple other packages recently..it's very frustrating when the package/man pages don't ship together in a sane way. I'd support adding a --disable-manpages option, though.
@icarus-sparry is there something we could have like the build target you added to always update the swupd-cmdline options during make?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/matthewrsj,11,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-341153379,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","Sure, I defer to the majority, --disable-manpages works. I'll wait for @icarus-sparry to respond to @tmarcu.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/icarus-sparry,12,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-341163689,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","This problem shows the limitation of make depending just on timestamps, rather than the contents of the files.. There are ways around it, essentially adding another file containing checksums of the files and checking that into the repo. It can even  handle cases like where rst2man.py is not present provided that the restructured text source files are not altered.
It does require that people who do update the manual source files do do a build before the final checkin.
I will code it up.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/ahkok,13,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-365013469,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated","I coded up the man pages and the way they're included in the build system used.
Specifically, they man pages should be included in compiled form in the make dist target and present in the release tarballs, which is what yocto should use and anyone who is using swupd-client in a distro.
The problem is that you're building from git.
$ make dist
...
$ tar tvf swupd-client-3.14.5.tar.gz |grep docs
drwxr-xr-x 1000/1000         0 2018-02-12 10:17 swupd-client-3.14.5/docs/
-rw-r--r-- 1000/1000      1404 2017-03-09 11:27 swupd-client-3.14.5/docs/swupd-update.timer.4
-rw-r--r-- 1000/1000      2014 2018-01-17 13:01 swupd-client-3.14.5/docs/swupd-add-pkg.4
-rw-r--r-- 1000/1000      1412 2017-03-09 11:27 swupd-client-3.14.5/docs/check-update.service.4
-rw-r--r-- 1000/1000      2081 2017-03-09 11:27 swupd-client-3.14.5/docs/update-triggers.target.4
-rw-r--r-- 1000/1000     13506 2018-02-12 10:16 swupd-client-3.14.5/docs/swupd.1
-rw-r--r-- 1000/1000      1575 2017-03-09 11:27 swupd-client-3.14.5/docs/swupd-update.service.4
-rw-r--r-- 1000/1000      1419 2017-03-09 11:27 swupd-client-3.14.5/docs/check-update.timer.4

Solution: use the release tarballs instead.
I don't support changing the way we do this. Distributions should use release tarballs or recreate the man pages that match the version of the code they distribute, and if they modify the code, they should recreate the man pages, or, they are obviously already patching the code and can patch out the man page bits themselves.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,309,2017-10-06T18:14:51Z,2018-02-27T20:42:15Z,2018-02-27T20:42:15Z,CLOSED,False,28,10,2,https://github.com/aaronovz1,Allow manpage generation to be optional,1,[],https://github.com/clearlinux/swupd-client/pull/309,https://github.com/matthewrsj,14,https://github.com/clearlinux/swupd-client/pull/309#issuecomment-369018982,"In a Yocto build environment we don't have rst2man.py and builds fail.
This allows a workaround and more flexibility in what is generated",After @ahkok's comment I'm inclined to close this PR for now until we can agree on a solution or if one is even needed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/310,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.","The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/310#issuecomment-335308861,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.",I restarted the Travis build to work around the issue of rst2man.py not being installed (see #311).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/310#issuecomment-335601691,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.",I amended the last commit according the Icarus's feedback.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/310#issuecomment-335626819,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.",^^ rst2man.py not found again.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/310#issuecomment-335631010,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.","I retriggered the Travis run, and it succeeds now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/icarus-sparry,6,https://github.com/clearlinux/swupd-client/pull/310#issuecomment-336158700,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,310,2017-10-06T22:21:44Z,2017-10-12T17:40:38Z,2017-11-30T23:31:59Z,MERGED,True,75,17,4,https://github.com/phmccarty,test: implement validation for lines-checked; improve check_lines() error reporting,8,[],https://github.com/clearlinux/swupd-client/pull/310,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/310#issuecomment-336212099,"The output line checking for functional tests should ensure that lines from lines-checked do not match any patterns in ignore-list.
Also, fix an issue with the update/rename test and improve check_lines() error reporting to account for ignore-list.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,311,2017-10-09T22:35:12Z,2017-10-31T23:27:51Z,2017-11-30T23:32:02Z,MERGED,True,3,0,1,https://github.com/phmccarty,travis: install rst2man dependency,1,[],https://github.com/clearlinux/swupd-client/pull/311,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/311,"Because rst2man.py is called when the timestamps on *.rst are newer than
their associated man pages, we need to have rst2man.py just in case we
hit this condition for the build.","Because rst2man.py is called when the timestamps on *.rst are newer than
their associated man pages, we need to have rst2man.py just in case we
hit this condition for the build.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,311,2017-10-09T22:35:12Z,2017-10-31T23:27:51Z,2017-11-30T23:32:02Z,MERGED,True,3,0,1,https://github.com/phmccarty,travis: install rst2man dependency,1,[],https://github.com/clearlinux/swupd-client/pull/311,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/311#issuecomment-335309078,"Because rst2man.py is called when the timestamps on *.rst are newer than
their associated man pages, we need to have rst2man.py just in case we
hit this condition for the build.",We ought to delete the man pages from the repo or else scrap the idea of using rst2man. The current middle ground of guess what timestamps git is going to give you is just wrong.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,311,2017-10-09T22:35:12Z,2017-10-31T23:27:51Z,2017-11-30T23:32:02Z,MERGED,True,3,0,1,https://github.com/phmccarty,travis: install rst2man dependency,1,[],https://github.com/clearlinux/swupd-client/pull/311,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/311#issuecomment-335324003,"Because rst2man.py is called when the timestamps on *.rst are newer than
their associated man pages, we need to have rst2man.py just in case we
hit this condition for the build.","@icarus-sparry That's a good point. I would be in favor of removing the static copies of the man pages, leaving them to be generated on the fly, but only when rst2man is installed (see discussion in #309).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,311,2017-10-09T22:35:12Z,2017-10-31T23:27:51Z,2017-11-30T23:32:02Z,MERGED,True,3,0,1,https://github.com/phmccarty,travis: install rst2man dependency,1,[],https://github.com/clearlinux/swupd-client/pull/311,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/311#issuecomment-340936672,"Because rst2man.py is called when the timestamps on *.rst are newer than
their associated man pages, we need to have rst2man.py just in case we
hit this condition for the build.","+1,  seeing this error in another PR reminded me this one was open.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,314,2017-10-10T20:47:37Z,2017-10-10T22:34:48Z,2017-10-11T18:00:00Z,MERGED,True,1,0,1,https://github.com/icarus-sparry,Do not delete /usr/lib/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/314,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/314,"Add /lib/kernel as the files to skip in addition to /lib/modules as
these are managed by clear-boot-manager.
Fixes #313
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Add /lib/kernel as the files to skip in addition to /lib/modules as
these are managed by clear-boot-manager.
Fixes #313
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,314,2017-10-10T20:47:37Z,2017-10-10T22:34:48Z,2017-10-11T18:00:00Z,MERGED,True,1,0,1,https://github.com/icarus-sparry,Do not delete /usr/lib/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/314,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/314#issuecomment-335603151,"Add /lib/kernel as the files to skip in addition to /lib/modules as
these are managed by clear-boot-manager.
Fixes #313
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,314,2017-10-10T20:47:37Z,2017-10-10T22:34:48Z,2017-10-11T18:00:00Z,MERGED,True,1,0,1,https://github.com/icarus-sparry,Do not delete /usr/lib/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/314,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/314#issuecomment-335628112,"Add /lib/kernel as the files to skip in addition to /lib/modules as
these are managed by clear-boot-manager.
Fixes #313
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,318,2017-10-13T00:12:12Z,2017-10-16T21:16:32Z,2017-10-16T21:16:38Z,MERGED,True,1097,7,67,https://github.com/matthewrsj,Implement ghost file handling,3,[],https://github.com/clearlinux/swupd-client/pull/318,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/318,"Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317","Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,318,2017-10-13T00:12:12Z,2017-10-16T21:16:32Z,2017-10-16T21:16:38Z,MERGED,True,1097,7,67,https://github.com/matthewrsj,Implement ghost file handling,3,[],https://github.com/clearlinux/swupd-client/pull/318,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/318#issuecomment-336521618,"Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317","@icarus-sparry that's a good point. We should not be deleting ghosted files during --fix. I also think we should not be deleting files during --picky either, since the initial use case for ghosted files is boot files, which we never want to delete.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,318,2017-10-13T00:12:12Z,2017-10-16T21:16:32Z,2017-10-16T21:16:38Z,MERGED,True,1097,7,67,https://github.com/matthewrsj,Implement ghost file handling,3,[],https://github.com/clearlinux/swupd-client/pull/318,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/318#issuecomment-336588824,"Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317","@icarus-sparry @phmccarty ghosted files now ignored during verify --fix and verify --fix --picky. The tests I added should demonstrate that.
I would like to get this change in before next Tuesday if possible.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,318,2017-10-13T00:12:12Z,2017-10-16T21:16:32Z,2017-10-16T21:16:38Z,MERGED,True,1097,7,67,https://github.com/matthewrsj,Implement ghost file handling,3,[],https://github.com/clearlinux/swupd-client/pull/318,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/318#issuecomment-336600959,"Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317","I seem to have lost my test cleanups with the various rebasing and force pushing I did (I had one or two git issues, sorry). I'll clean it up and let you know when I'm done.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,318,2017-10-13T00:12:12Z,2017-10-16T21:16:32Z,2017-10-16T21:16:38Z,MERGED,True,1097,7,67,https://github.com/matthewrsj,Implement ghost file handling,3,[],https://github.com/clearlinux/swupd-client/pull/318,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/318#issuecomment-336640367,"Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317",Test cleanup done.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,318,2017-10-13T00:12:12Z,2017-10-16T21:16:32Z,2017-10-16T21:16:38Z,MERGED,True,1097,7,67,https://github.com/matthewrsj,Implement ghost file handling,3,[],https://github.com/clearlinux/swupd-client/pull/318,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/318#issuecomment-336968432,"Implement handling of ghosted files in manifests via the 'g' flag. These
files are treated the same as deleted files except that they are not
actually deleted during the update. This allows ghosted files to serve
as the basis for renames while not actually being deleted by swupd.
An example of where this is useful is with kernel files, which are
deleted from /usr/lib/kernel/ by clr-boot-manager but should still be
marked as deleted to utilize the rename functionality.
Adds functional tests as well.
Fixes #317",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,319,2017-10-16T22:39:05Z,2017-10-19T16:46:14Z,2017-11-30T23:31:57Z,MERGED,True,0,2,1,https://github.com/phmccarty,Remove unused check_network() declaration,1,[],https://github.com/clearlinux/swupd-client/pull/319,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/319,"The check_network() function definition was recently removed, but the
declaration remained. Remove the declaration as well.","The check_network() function definition was recently removed, but the
declaration remained. Remove the declaration as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,319,2017-10-16T22:39:05Z,2017-10-19T16:46:14Z,2017-11-30T23:31:57Z,MERGED,True,0,2,1,https://github.com/phmccarty,Remove unused check_network() declaration,1,[],https://github.com/clearlinux/swupd-client/pull/319,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/319#issuecomment-337967953,"The check_network() function definition was recently removed, but the
declaration remained. Remove the declaration as well.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,321,2017-10-19T00:02:04Z,2017-10-19T16:51:10Z,2017-10-19T16:51:24Z,MERGED,True,26,4,6,https://github.com/matthewrsj,Fix re-exec capabilities over format bumps,1,[],https://github.com/clearlinux/swupd-client/pull/321,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/321,"Instead of relying on swupd-server to put the post-update action in the
correct manifest and in the correct format, do the format change
detection on the client.
Fixes #320
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Instead of relying on swupd-server to put the post-update action in the
correct manifest and in the correct format, do the format change
detection on the client.
Fixes #320
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,321,2017-10-19T00:02:04Z,2017-10-19T16:51:10Z,2017-10-19T16:51:24Z,MERGED,True,26,4,6,https://github.com/matthewrsj,Fix re-exec capabilities over format bumps,1,[],https://github.com/clearlinux/swupd-client/pull/321,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/321#issuecomment-337767751,"Instead of relying on swupd-server to put the post-update action in the
correct manifest and in the correct format, do the format change
detection on the client.
Fixes #320
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,324,2017-10-20T22:00:55Z,2017-10-23T19:22:43Z,2017-11-30T23:31:52Z,MERGED,True,8,2,1,https://github.com/phmccarty,Pretty print check_network error messages,2,[],https://github.com/clearlinux/swupd-client/pull/324,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/324,"This line of code is a recent addition, and I think it is more helpful for the end user to see the pretty-printed curl error message in addition to the error number.","This line of code is a recent addition, and I think it is more helpful for the end user to see the pretty-printed curl error message in addition to the error number.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,324,2017-10-20T22:00:55Z,2017-10-23T19:22:43Z,2017-11-30T23:31:52Z,MERGED,True,8,2,1,https://github.com/phmccarty,Pretty print check_network error messages,2,[],https://github.com/clearlinux/swupd-client/pull/324,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/324#issuecomment-338333169,"This line of code is a recent addition, and I think it is more helpful for the end user to see the pretty-printed curl error message in addition to the error number.",Could you fix the other two curl error printfs to be consistent with this one? Right now curl errors are printed three different ways in the code base.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,324,2017-10-20T22:00:55Z,2017-10-23T19:22:43Z,2017-11-30T23:31:52Z,MERGED,True,8,2,1,https://github.com/phmccarty,Pretty print check_network error messages,2,[],https://github.com/clearlinux/swupd-client/pull/324,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/324#issuecomment-338333923,"This line of code is a recent addition, and I think it is more helpful for the end user to see the pretty-printed curl error message in addition to the error number.","I think I would rather add a curl error wrapper function. I'll do that, but maybe not today.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,324,2017-10-20T22:00:55Z,2017-10-23T19:22:43Z,2017-11-30T23:31:52Z,MERGED,True,8,2,1,https://github.com/phmccarty,Pretty print check_network error messages,2,[],https://github.com/clearlinux/swupd-client/pull/324,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/324#issuecomment-338768549,"This line of code is a recent addition, and I think it is more helpful for the end user to see the pretty-printed curl error message in addition to the error number.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,326,2017-10-26T21:47:47Z,2017-10-26T23:21:29Z,2017-10-27T06:02:42Z,MERGED,True,2,2,1,https://github.com/icarus-sparry,More a constant time check before a O(n) check,1,[],https://github.com/clearlinux/swupd-client/pull/326,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/326,"Hopefully will drop yet another cubic operation to quadratic
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Hopefully will drop yet another cubic operation to quadratic
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,326,2017-10-26T21:47:47Z,2017-10-26T23:21:29Z,2017-10-27T06:02:42Z,MERGED,True,2,2,1,https://github.com/icarus-sparry,More a constant time check before a O(n) check,1,[],https://github.com/clearlinux/swupd-client/pull/326,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/326#issuecomment-339812747,"Hopefully will drop yet another cubic operation to quadratic
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,326,2017-10-26T21:47:47Z,2017-10-26T23:21:29Z,2017-10-27T06:02:42Z,MERGED,True,2,2,1,https://github.com/icarus-sparry,More a constant time check before a O(n) check,1,[],https://github.com/clearlinux/swupd-client/pull/326,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/326#issuecomment-339880831,"Hopefully will drop yet another cubic operation to quadratic
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",Dropped the time to do an update in a test from 313 seconds to 20.5 seconds.,True,{'THUMBS_UP': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,327,2017-10-31T20:42:46Z,2017-12-01T01:15:41Z,2017-12-01T01:15:49Z,MERGED,True,205,48,9,https://github.com/matthewrsj,Use libarchive instead of calling out to tar,2,[],https://github.com/clearlinux/swupd-client/pull/327,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/327,"Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,327,2017-10-31T20:42:46Z,2017-12-01T01:15:41Z,2017-12-01T01:15:49Z,MERGED,True,205,48,9,https://github.com/matthewrsj,Use libarchive instead of calling out to tar,2,[],https://github.com/clearlinux/swupd-client/pull/327,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/327#issuecomment-340908417,"Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Having trouble getting libarchive installed in the Travis environment.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,327,2017-10-31T20:42:46Z,2017-12-01T01:15:41Z,2017-12-01T01:15:49Z,MERGED,True,205,48,9,https://github.com/matthewrsj,Use libarchive instead of calling out to tar,2,[],https://github.com/clearlinux/swupd-client/pull/327,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/327#issuecomment-340935811,"Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","*closed by mistake, oops
Fixes #285",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,327,2017-10-31T20:42:46Z,2017-12-01T01:15:41Z,2017-12-01T01:15:49Z,MERGED,True,205,48,9,https://github.com/matthewrsj,Use libarchive instead of calling out to tar,2,[],https://github.com/clearlinux/swupd-client/pull/327,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/327#issuecomment-340947878,"Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,327,2017-10-31T20:42:46Z,2017-12-01T01:15:41Z,2017-12-01T01:15:49Z,MERGED,True,205,48,9,https://github.com/matthewrsj,Use libarchive instead of calling out to tar,2,[],https://github.com/clearlinux/swupd-client/pull/327,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/327#issuecomment-341195927,"Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Resolves #280 as well.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,327,2017-10-31T20:42:46Z,2017-12-01T01:15:41Z,2017-12-01T01:15:49Z,MERGED,True,205,48,9,https://github.com/matthewrsj,Use libarchive instead of calling out to tar,2,[],https://github.com/clearlinux/swupd-client/pull/327,https://github.com/pohly,6,https://github.com/clearlinux/swupd-client/pull/327#issuecomment-345667935,"Use libarchive in order to make use of its security features and avoid
calling out to tar via a shell. The TAR_COMMAND is still used in
staging.c to complete the copy when a hardlink fails.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","On Fri, 2017-11-17 at 20:10 +0000, Matthew Johnson wrote

 What should we be doing if this fails? Just set r and continue trying
 to free the write and close and free the read?
Yes. Basically untarring has failed and the caller needs to be alerted
about that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,329,2017-11-01T17:51:01Z,2017-11-29T20:54:39Z,2017-11-29T20:54:39Z,CLOSED,False,3,4,1,https://github.com/matthewrsj,Do not fail on verifytime failure,1,[],https://github.com/clearlinux/swupd-client/pull/329,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/329,"Fixes #234
Fixes #289
The verifytime program is a helper program used by swupd to correct
certain time skews. If verifytime fails, however, this should not be a
failure for swupd. Swupd should continue to try and verify the signature
if possible. Instead of failing print out a warning to give the user a
hint to why their signature verification may fail.
The use case this solves is when the /usr/share/clear/versionstamp file
does not exist, verifytime will fail even if the system time is in an OK
state.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixes #234
Fixes #289
The verifytime program is a helper program used by swupd to correct
certain time skews. If verifytime fails, however, this should not be a
failure for swupd. Swupd should continue to try and verify the signature
if possible. Instead of failing print out a warning to give the user a
hint to why their signature verification may fail.
The use case this solves is when the /usr/share/clear/versionstamp file
does not exist, verifytime will fail even if the system time is in an OK
state.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,329,2017-11-01T17:51:01Z,2017-11-29T20:54:39Z,2017-11-29T20:54:39Z,CLOSED,False,3,4,1,https://github.com/matthewrsj,Do not fail on verifytime failure,1,[],https://github.com/clearlinux/swupd-client/pull/329,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/329#issuecomment-341208586,"Fixes #234
Fixes #289
The verifytime program is a helper program used by swupd to correct
certain time skews. If verifytime fails, however, this should not be a
failure for swupd. Swupd should continue to try and verify the signature
if possible. Instead of failing print out a warning to give the user a
hint to why their signature verification may fail.
The use case this solves is when the /usr/share/clear/versionstamp file
does not exist, verifytime will fail even if the system time is in an OK
state.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","I'm not sure I agree with this, it has to be a failure to enforce certificate expiration. Letting it fail later on is just prolonging the exit path, assuming the certificate is correct still, which is why this check exists as the first thing in swupd_init() before anything else happens and not wasting time. If it continues and the time mismatches it will never get to verifying the signature because it checks the certificate validity range against the system time.
Maybe something can be changed in verifytime.c, or you can choose a more persistent file to read from?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,329,2017-11-01T17:51:01Z,2017-11-29T20:54:39Z,2017-11-29T20:54:39Z,CLOSED,False,3,4,1,https://github.com/matthewrsj,Do not fail on verifytime failure,1,[],https://github.com/clearlinux/swupd-client/pull/329,https://github.com/phmccarty,3,https://github.com/clearlinux/swupd-client/pull/329#issuecomment-341213219,"Fixes #234
Fixes #289
The verifytime program is a helper program used by swupd to correct
certain time skews. If verifytime fails, however, this should not be a
failure for swupd. Swupd should continue to try and verify the signature
if possible. Instead of failing print out a warning to give the user a
hint to why their signature verification may fail.
The use case this solves is when the /usr/share/clear/versionstamp file
does not exist, verifytime will fail even if the system time is in an OK
state.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","The argument here is that verifytime should be considered completely optional for swupd-client. Therefore, its exit status is irrelevant for swupd to take action on. If verifytime is able to fix the system time, great, report a warning and try to continue.
@tmarcu I'm not sure what you mean by ""enforcing certification expiration""... Can you elaborate on that?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,329,2017-11-01T17:51:01Z,2017-11-29T20:54:39Z,2017-11-29T20:54:39Z,CLOSED,False,3,4,1,https://github.com/matthewrsj,Do not fail on verifytime failure,1,[],https://github.com/clearlinux/swupd-client/pull/329,https://github.com/tmarcu,4,https://github.com/clearlinux/swupd-client/pull/329#issuecomment-341546064,"Fixes #234
Fixes #289
The verifytime program is a helper program used by swupd to correct
certain time skews. If verifytime fails, however, this should not be a
failure for swupd. Swupd should continue to try and verify the signature
if possible. Instead of failing print out a warning to give the user a
hint to why their signature verification may fail.
The use case this solves is when the /usr/share/clear/versionstamp file
does not exist, verifytime will fail even if the system time is in an OK
state.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","In the general case, with swupd running on Clear, that file will always exist. However, if we are trying to support multiple OSes, then we should implement the more pedantic version of verifytime, as seen in the comment on verifytime.c. The current state was an initial fix that works for Clear, however the intended implementation is to not check any file (like versionstamp) and instead query some nameservers or such to get a real time, and use those times to get an accurate system time. That removes the dependency on any file, and keeps verifytime as the short circuit, which it was intended to be.
With the exception of bundle-list, all swupd commands need network, and if the system time is bad, it is guaranteed to fail signature verification, so we should always exit early if verifytime fails with the new (and more robust) implementation.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,329,2017-11-01T17:51:01Z,2017-11-29T20:54:39Z,2017-11-29T20:54:39Z,CLOSED,False,3,4,1,https://github.com/matthewrsj,Do not fail on verifytime failure,1,[],https://github.com/clearlinux/swupd-client/pull/329,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/329#issuecomment-347993099,"Fixes #234
Fixes #289
The verifytime program is a helper program used by swupd to correct
certain time skews. If verifytime fails, however, this should not be a
failure for swupd. Swupd should continue to try and verify the signature
if possible. Instead of failing print out a warning to give the user a
hint to why their signature verification may fail.
The use case this solves is when the /usr/share/clear/versionstamp file
does not exist, verifytime will fail even if the system time is in an OK
state.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Closing. #340 opened to track improvements to verifytime.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,330,2017-11-01T18:52:04Z,2017-11-02T16:06:58Z,2017-11-02T16:09:29Z,MERGED,True,25,4,3,https://github.com/icarus-sparry,Fix generation of swupd.bash,1,[],https://github.com/clearlinux/swupd-client/pull/330,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/330,"When output was changed to stderr for user output, this broke
automatic generation of the bash completion function.
Add suitable redirection to the generation script to capture stderr.
Add test to check the generated file looks reasonable.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","When output was changed to stderr for user output, this broke
automatic generation of the bash completion function.
Add suitable redirection to the generation script to capture stderr.
Add test to check the generated file looks reasonable.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,330,2017-11-01T18:52:04Z,2017-11-02T16:06:58Z,2017-11-02T16:09:29Z,MERGED,True,25,4,3,https://github.com/icarus-sparry,Fix generation of swupd.bash,1,[],https://github.com/clearlinux/swupd-client/pull/330,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/330#issuecomment-341275387,"When output was changed to stderr for user output, this broke
automatic generation of the bash completion function.
Add suitable redirection to the generation script to capture stderr.
Add test to check the generated file looks reasonable.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,330,2017-11-01T18:52:04Z,2017-11-02T16:06:58Z,2017-11-02T16:09:29Z,MERGED,True,25,4,3,https://github.com/icarus-sparry,Fix generation of swupd.bash,1,[],https://github.com/clearlinux/swupd-client/pull/330,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/330#issuecomment-341471841,"When output was changed to stderr for user output, this broke
automatic generation of the bash completion function.
Add suitable redirection to the generation script to capture stderr.
Add test to check the generated file looks reasonable.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,331,2017-11-01T22:01:08Z,2017-11-02T16:07:40Z,2017-11-02T16:07:44Z,MERGED,True,285,5,34,https://github.com/matthewrsj,Add --no-scripts flag to skip post-update scripts,2,[],https://github.com/clearlinux/swupd-client/pull/331,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/331,"Add the --no-scripts flag to update, verify, and bundle-add commands to
allow users to skip the post update scripts for these commands. This is
useful when running in environments when systemctl is not available such
as containers.
Fixes #286","Add the --no-scripts flag to update, verify, and bundle-add commands to
allow users to skip the post update scripts for these commands. This is
useful when running in environments when systemctl is not available such
as containers.
Fixes #286",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,332,2017-11-02T21:57:37Z,2017-11-03T18:45:40Z,2017-11-03T18:45:40Z,MERGED,True,113,0,12,https://github.com/matthewrsj,Remove hash-mismatched file in full-download loop,2,[],https://github.com/clearlinux/swupd-client/pull/332,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/332,"Fixes #325
Fullfile download will fail when downloading if it encounters the file
already existing in state directory but the file's hash is mismatching.
Instead of failing on this case remove that file and download it again.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixes #325
Fullfile download will fail when downloading if it encounters the file
already existing in state directory but the file's hash is mismatching.
Instead of failing on this case remove that file and download it again.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,332,2017-11-02T21:57:37Z,2017-11-03T18:45:40Z,2017-11-03T18:45:40Z,MERGED,True,113,0,12,https://github.com/matthewrsj,Remove hash-mismatched file in full-download loop,2,[],https://github.com/clearlinux/swupd-client/pull/332,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/332#issuecomment-341575395,"Fixes #325
Fullfile download will fail when downloading if it encounters the file
already existing in state directory but the file's hash is mismatching.
Instead of failing on this case remove that file and download it again.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1 on the fix. Can you add a functional test?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,332,2017-11-02T21:57:37Z,2017-11-03T18:45:40Z,2017-11-03T18:45:40Z,MERGED,True,113,0,12,https://github.com/matthewrsj,Remove hash-mismatched file in full-download loop,2,[],https://github.com/clearlinux/swupd-client/pull/332,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/332#issuecomment-341791315,"Fixes #325
Fullfile download will fail when downloading if it encounters the file
already existing in state directory but the file's hash is mismatching.
Instead of failing on this case remove that file and download it again.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,333,2017-11-03T18:25:20Z,2017-11-03T18:31:35Z,2017-11-03T18:34:15Z,MERGED,True,4,2,1,https://github.com/icarus-sparry,"Fix build break for ""make dist""",1,[],https://github.com/clearlinux/swupd-client/pull/333,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/333,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,333,2017-11-03T18:25:20Z,2017-11-03T18:31:35Z,2017-11-03T18:34:15Z,MERGED,True,4,2,1,https://github.com/icarus-sparry,"Fix build break for ""make dist""",1,[],https://github.com/clearlinux/swupd-client/pull/333,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/333#issuecomment-341790005,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,334,2017-11-09T22:21:21Z,2017-11-14T23:24:51Z,2017-11-14T23:24:51Z,MERGED,True,64,31,2,https://github.com/bryteise,Replace systemctl and pre-update commands,1,[],https://github.com/clearlinux/swupd-client/pull/334,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/334,"Instead of hardcoding systemctl commands to run post-update triggers,
add the ability to configure an executable path to be used when swupd
completes its update process. Similarly replace the use of a hardcoded
pre-update script path with a configurable executable path.","Instead of hardcoding systemctl commands to run post-update triggers,
add the ability to configure an executable path to be used when swupd
completes its update process. Similarly replace the use of a hardcoded
pre-update script path with a configurable executable path.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,334,2017-11-09T22:21:21Z,2017-11-14T23:24:51Z,2017-11-14T23:24:51Z,MERGED,True,64,31,2,https://github.com/bryteise,Replace systemctl and pre-update commands,1,[],https://github.com/clearlinux/swupd-client/pull/334,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/334#issuecomment-344390628,"Instead of hardcoding systemctl commands to run post-update triggers,
add the ability to configure an executable path to be used when swupd
completes its update process. Similarly replace the use of a hardcoded
pre-update script path with a configurable executable path.",Updated,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,334,2017-11-09T22:21:21Z,2017-11-14T23:24:51Z,2017-11-14T23:24:51Z,MERGED,True,64,31,2,https://github.com/bryteise,Replace systemctl and pre-update commands,1,[],https://github.com/clearlinux/swupd-client/pull/334,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/334#issuecomment-344434102,"Instead of hardcoding systemctl commands to run post-update triggers,
add the ability to configure an executable path to be used when swupd
completes its update process. Similarly replace the use of a hardcoded
pre-update script path with a configurable executable path.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,1,https://github.com/clearlinux/swupd-client/pull/337,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,2,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347113776,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","@matthewrsj I tried to investigate the ""make check"" error, but I'm probably missing something in my local setup, because for me all tests fail. Are there instructions for running these tests?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347230325,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","@pohly The tests are written using the BATS testing framework. which is a set of bash scripts. You can run for example test/functional/bundlelist/none-has-deps/test.bats to just run a single test. Simplified, the test.bats file is run through 'sed' to process lines starting '@test' to convert these into bash functions, and then these functions are called in turn whilst bash has the '-e' flag set so anything which returns a non-zero return code causes the test to fail. run is a predefined function in this environment which captures the output and return code into variables and returns 0, so you can use that for things you expect to fail or you want to inspect.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,4,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347241079,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","My tests failed because the swupd executable did not find libbsdiff.so.1 because it wasn't installed in the standard search path. Running the tests did not show that.
Regarding the test/functional/verify/fix-version-mismatch failure in Travis: that's because I changed the output that the test checks for in ""lines-checked"". Fixed.
Running test/functional/verify/fix-version-mismatch/test.bats printed a diff that isn't visible in the Travis build log. Perhaps bats should be invoked differently so that it dumps errors instead of storing them locally?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347248062,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","Perhaps bats should be invoked differently so that it dumps errors instead of storing them locally?

This should have been visible in the travis build log. If any test fails the command cat test-suite.log is run, which should show that diff. I can't see the failed run in travis to identify if there was an issue with that or not.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/phmccarty,6,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347283238,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","You can view the test-suite.log in Travis for failed builds by expanding the last section of the Travis build log. It would be nice to expand that section by default, but last time I looked into Travis configuration, I couldn't figure out how to get it working.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,7,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347287959,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","On Mon, 2017-11-27 at 18:44 +0000, Patrick McCarty wrote:
 You can view the test-suite.log in Travis for failed builds by
 expanding the last section of the Travis build log. It would be nice
 to expand that section by default, but last time I looked into Travis
 configuration, I couldn't figure out how to get it working.
Indeed, the failure is there when one knows where to look:
https://travis-ci.org/clearlinux/swupd-client/builds/306780184#L5895",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,8,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347658625,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.",Force-pushed the revised commit.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,9,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347846311,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.",Revised patch pushed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-347966412,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","Please run make compliant on your branch to identify code style issues. These fixes are very minor but I would have to do it before the next release anyways.
This is a good change. LGTM except for the one question I had.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,11,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348108477,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","On Wed, 2017-11-29 at 19:11 +0000, Matthew Johnson wrote:
 @matthewrsj commented on this pull request.
 +	assert(!picky_whitelist);
 Why fail here if picky_whitelist is set?
Because then memory would be leaked. Earlier I had code there that did
a regfree(), but as that code never would be executed now, I removed it
and replaced it with the assert().
  You only call compile_whitelist at one point so I don't see how it
 could be set.
That's exactly the point of an assert: verify that an assumption is
correct.

As you said, the function only gets called once and thus
picky_whitelist should be NULL. The assert() documents that and (at
least in debug builds) causes a noticable failure when that assumption
is violated.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,12,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348151453,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","On Wed, 2017-11-29 at 19:17 +0000, Matthew Johnson wrote:
 Please run make compliant on your branch to identify code style
 issues.
Done, force pushed. I ended up changing also one otherwise unmodified
line (the one with realloc) because that's what clang-format suggested.
 These fixes are very minor but I would have to do it before the next
 release anyways.
I've added another commit with a fix for something that I hadn't
touched.

With that commit, ""make compliant"" passes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/matthewrsj,13,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348269391,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","The assert() documents that and (at least in debug builds) causes a noticable failure when that assumption is violated.

Alright.

I've added another commit with a fix for something that I hadn't touched.

I've noticed that make compliant will sometimes catch new things when new code is added or old code is changed. Thanks for fixing the new error.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/pohly,14,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348294183,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","On Thu, 2017-11-30 at 18:03 +0000, Matthew Johnson wrote:
 +			if (optarg[0] != '/') {
 +				fprintf(stderr, ""--picky-tree must
 be an absolute path, for example /usr"");

 Need a \n here. I'm seeing this:

 --picky-tree must be an absolute path, for example /usrUsage:
 swupd verify [OPTION...]
I've made that \n\n (same as in the other error messages). Force-
pushed.


 
 





 {""api_version"":""1.0"",""publisher"":{""api_key"":""05dde50f1d1a384dd78767c5
 5493e4bb"",""name"":""GitHub""},""entity"":{""external_key"":""github/clearlinu
 x/swupd-client"",""title"":""clearlinux/swupd-client"",""subtitle"":""GitHub
 repository"",""main_image_url"":""https://cloud.githubusercontent.com/ass
 ets/143418/17495839/a5054eac-5d88-11e6-95fc-
 7290892c7bb5.png"",""avatar_image_url"":""https://cloud.githubusercontent
 .com/assets/143418/15842166/7c72db34-2c0b-11e6-9aed-
 b52498112777.png"",""action"":{""name"":""Open in
 GitHub"",""url"":""https://github.com/clearlinux/swupd-
 ***@***.***
 rsj requested changes on #337""}],""action"":{""name"":""View Pull
 Request"",""url"":""https://github.com/clearlinux/swupd-
 client/pull/337#pullrequestreview-80275134""}}}",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/matthewrsj,15,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348363244,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.",+1 from me. @icarus-sparry looks like you still have an outstanding review when I look at the Reviewers section. Do you have any further comments?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/icarus-sparry,16,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348369389,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.",I am happy,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,337,2017-11-24T14:15:33Z,2017-12-01T01:15:10Z,2017-12-01T01:15:10Z,MERGED,True,211,50,5,https://github.com/pohly,Extra picky,3,[],https://github.com/clearlinux/swupd-client/pull/337,https://github.com/icarus-sparry,17,https://github.com/clearlinux/swupd-client/pull/337#issuecomment-348369441,"This is needed for A/B partitioning. If you can, please review soon, because then I don't need to add unmerged patches to meta-swupd.","I am happy.
+1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,341,2017-12-01T17:33:57Z,2017-12-01T17:40:19Z,2017-12-01T17:40:23Z,MERGED,True,1,1,1,https://github.com/matthewrsj,Link libarchive into libswupd,1,[],https://github.com/clearlinux/swupd-client/pull/341,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/341,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,341,2017-12-01T17:33:57Z,2017-12-01T17:40:19Z,2017-12-01T17:40:23Z,MERGED,True,1,1,1,https://github.com/matthewrsj,Link libarchive into libswupd,1,[],https://github.com/clearlinux/swupd-client/pull/341,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/341#issuecomment-348558205,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,342,2017-12-01T17:54:26Z,2017-12-01T19:00:03Z,2017-12-01T19:00:08Z,MERGED,True,3,1565,8,https://github.com/matthewrsj,Remove redundant libraries linked into swupd binary,3,[],https://github.com/clearlinux/swupd-client/pull/342,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/342,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,349,2017-12-04T23:28:47Z,2017-12-14T00:47:15Z,2017-12-14T00:47:15Z,MERGED,True,7,0,1,https://github.com/miguelinux,heuristics: do not ignore /usr/src/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/349,https://github.com/miguelinux,1,https://github.com/clearlinux/swupd-client/pull/349,"Linux kernel sources are shipped in the /usr/src/kernel/<kernel_version>
directory. So, it need to be added as an exception in the is_state()
function.
Fixes #348
Debugged-by: Ornelas Aguayo, Jesus jesus.ornelas.aguayo@intel.com
Debugged-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com
Signed-off-by: Miguel Bernal Marin miguel.bernal.marin@linux.intel.com","Linux kernel sources are shipped in the /usr/src/kernel/<kernel_version>
directory. So, it need to be added as an exception in the is_state()
function.
Fixes #348
Debugged-by: Ornelas Aguayo, Jesus jesus.ornelas.aguayo@intel.com
Debugged-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com
Signed-off-by: Miguel Bernal Marin miguel.bernal.marin@linux.intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,349,2017-12-04T23:28:47Z,2017-12-14T00:47:15Z,2017-12-14T00:47:15Z,MERGED,True,7,0,1,https://github.com/miguelinux,heuristics: do not ignore /usr/src/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/349,https://github.com/miguelinux,2,https://github.com/clearlinux/swupd-client/pull/349#issuecomment-349452447,"Linux kernel sources are shipped in the /usr/src/kernel/<kernel_version>
directory. So, it need to be added as an exception in the is_state()
function.
Fixes #348
Debugged-by: Ornelas Aguayo, Jesus jesus.ornelas.aguayo@intel.com
Debugged-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com
Signed-off-by: Miguel Bernal Marin miguel.bernal.marin@linux.intel.com","@matthewrsj I've updated the patch
Could you review it?  please.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,349,2017-12-04T23:28:47Z,2017-12-14T00:47:15Z,2017-12-14T00:47:15Z,MERGED,True,7,0,1,https://github.com/miguelinux,heuristics: do not ignore /usr/src/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/349,https://github.com/miguelinux,3,https://github.com/clearlinux/swupd-client/pull/349#issuecomment-349460375,"Linux kernel sources are shipped in the /usr/src/kernel/<kernel_version>
directory. So, it need to be added as an exception in the is_state()
function.
Fixes #348
Debugged-by: Ornelas Aguayo, Jesus jesus.ornelas.aguayo@intel.com
Debugged-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com
Signed-off-by: Miguel Bernal Marin miguel.bernal.marin@linux.intel.com","Well, they are not boot files, they are source files to do some development.
As I understand, the issue is in the server not in the client.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,349,2017-12-04T23:28:47Z,2017-12-14T00:47:15Z,2017-12-14T00:47:15Z,MERGED,True,7,0,1,https://github.com/miguelinux,heuristics: do not ignore /usr/src/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/349,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/349#issuecomment-349463449,"Linux kernel sources are shipped in the /usr/src/kernel/<kernel_version>
directory. So, it need to be added as an exception in the is_state()
function.
Fixes #348
Debugged-by: Ornelas Aguayo, Jesus jesus.ornelas.aguayo@intel.com
Debugged-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com
Signed-off-by: Miguel Bernal Marin miguel.bernal.marin@linux.intel.com","Ah, if they are not boot files that is different. Essentially they are just normal files, so you need to do this same change in the server.
This change is still needed in client, but a very similar change is needed in server as well. It would be best to get server up-to-date first (fix inside to outside) in my opinion.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,349,2017-12-04T23:28:47Z,2017-12-14T00:47:15Z,2017-12-14T00:47:15Z,MERGED,True,7,0,1,https://github.com/miguelinux,heuristics: do not ignore /usr/src/kernel,1,[],https://github.com/clearlinux/swupd-client/pull/349,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/349#issuecomment-351572763,"Linux kernel sources are shipped in the /usr/src/kernel/<kernel_version>
directory. So, it need to be added as an exception in the is_state()
function.
Fixes #348
Debugged-by: Ornelas Aguayo, Jesus jesus.ornelas.aguayo@intel.com
Debugged-by: Mario Alfredo Carrillo Arevalo mario.alfredo.c.arevalo@intel.com
Signed-off-by: Miguel Bernal Marin miguel.bernal.marin@linux.intel.com","+1, I'm opening #354 to track removing heuristic matching from the client.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,353,2017-12-13T21:57:51Z,2017-12-14T00:00:06Z,2017-12-14T00:00:10Z,MERGED,True,13,13,6,https://github.com/matthewrsj,Do not try to resume failed bundle-add pack downloads,1,[],https://github.com/clearlinux/swupd-client/pull/353,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/353,"Fixes #352
This operation is fragile and can cause errors if a zero pack download
is interrupted resulting in an incomplete tar archive. A user reported
that having the incomplete pack around prevented the pack from being
re-downloaded and the content was incorrect so the bundle-add was not
completing. Instead of trying to resume a bundle-add pack download just
remove the old file and try again.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixes #352
This operation is fragile and can cause errors if a zero pack download
is interrupted resulting in an incomplete tar archive. A user reported
that having the incomplete pack around prevented the pack from being
re-downloaded and the content was incorrect so the bundle-add was not
completing. Instead of trying to resume a bundle-add pack download just
remove the old file and try again.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,356,2018-01-03T00:22:41Z,2018-01-04T01:11:36Z,2018-01-04T01:11:36Z,MERGED,True,3,0,1,https://github.com/phmccarty,Fix double free issue,1,[],https://github.com/clearlinux/swupd-client/pull/356,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/356,"In commit e18eb69, retrieve_manifests() was refactored to support the mixer integration feature, but it introduced a double free of the ""filename"" pointer when following certain code paths.
One code path to reproduce the issue is when a Manifest.MoM is not present in the state directory, and swupd_curl_check_network() fails.  A free(filename) was being called immediately before swupd_curl_check_network(), and then again after jumping to the ""out"" label for the error condition.
Resolve the issue by resetting the filename pointer to NULL after freeing the memory to prevent a later double free. I also reset the url pointer to NULL at the second call site for similar reasoning.","In commit e18eb69, retrieve_manifests() was refactored to support the mixer integration feature, but it introduced a double free of the ""filename"" pointer when following certain code paths.
One code path to reproduce the issue is when a Manifest.MoM is not present in the state directory, and swupd_curl_check_network() fails.  A free(filename) was being called immediately before swupd_curl_check_network(), and then again after jumping to the ""out"" label for the error condition.
Resolve the issue by resetting the filename pointer to NULL after freeing the memory to prevent a later double free. I also reset the url pointer to NULL at the second call site for similar reasoning.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,360,2018-01-04T02:00:37Z,2018-01-04T15:26:30Z,2018-01-04T15:26:30Z,MERGED,True,3,1,3,https://github.com/phmccarty,Fix tests that are lacking chown reverts,1,[],https://github.com/clearlinux/swupd-client/pull/360,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/360,"Most of the functional tests properly reverted the chown operations in teardown(), but three of them were missing the reverts.","Most of the functional tests properly reverted the chown operations in teardown(), but three of them were missing the reverts.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,361,2018-01-11T00:47:55Z,2018-01-11T22:45:46Z,2018-01-11T22:45:46Z,MERGED,True,7,5,2,https://github.com/phmccarty,Fix some memory leaks,2,[],https://github.com/clearlinux/swupd-client/pull/361,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/361,See the individual commits...,See the individual commits...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,362,2018-01-12T20:53:11Z,2018-01-12T21:55:57Z,2018-01-12T23:05:29Z,MERGED,True,1,1,1,https://github.com/cmarcelo,Fix warning message in archives,1,[],https://github.com/clearlinux/swupd-client/pull/362,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/362,"Need to pass the same struct used in the operation to the
_archive_check_err helper.
This fixes issue of some Warnings appearing with ""(null)"" message,
since the writer did not had an error string associated.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com","Need to pass the same struct used in the operation to the
_archive_check_err helper.
This fixes issue of some Warnings appearing with ""(null)"" message,
since the writer did not had an error string associated.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,362,2018-01-12T20:53:11Z,2018-01-12T21:55:57Z,2018-01-12T23:05:29Z,MERGED,True,1,1,1,https://github.com/cmarcelo,Fix warning message in archives,1,[],https://github.com/clearlinux/swupd-client/pull/362,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/362#issuecomment-357351299,"Need to pass the same struct used in the operation to the
_archive_check_err helper.
This fixes issue of some Warnings appearing with ""(null)"" message,
since the writer did not had an error string associated.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",Good catch! +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,362,2018-01-12T20:53:11Z,2018-01-12T21:55:57Z,2018-01-12T23:05:29Z,MERGED,True,1,1,1,https://github.com/cmarcelo,Fix warning message in archives,1,[],https://github.com/clearlinux/swupd-client/pull/362,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/362#issuecomment-357359566,"Need to pass the same struct used in the operation to the
_archive_check_err helper.
This fixes issue of some Warnings appearing with ""(null)"" message,
since the writer did not had an error string associated.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,365,2018-01-17T21:26:20Z,2018-01-17T21:39:39Z,2018-01-17T21:39:39Z,MERGED,True,5,0,1,https://github.com/ahkok,Call clr-service-restart.,1,[],https://github.com/clearlinux/swupd-client/pull/365,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/365,"See: https://github.com/clearlinux/clr-service-restart
If present, clr-service-restart can be used to dynamically determine
whether running daemons need a restart based on whether they have
been updated, or whether they are holding references to library code
that has been replaced on disk.
This is synchronous - the units that do need restarted are restarted
and their startup status is verified afterwards. Each restart is
printed on the screen to display what is happening. If a failure
happens, and the unit is a unit provided by the OS vendor, a telemetry
record is created.
Right now only whitelisted units are restarted automatically, and
there are no whitelisted units at this time. These will be slowly
added over time as we understand and learn which units are considered
'safe' to restart, and which ones are not 'safe'.","See: https://github.com/clearlinux/clr-service-restart
If present, clr-service-restart can be used to dynamically determine
whether running daemons need a restart based on whether they have
been updated, or whether they are holding references to library code
that has been replaced on disk.
This is synchronous - the units that do need restarted are restarted
and their startup status is verified afterwards. Each restart is
printed on the screen to display what is happening. If a failure
happens, and the unit is a unit provided by the OS vendor, a telemetry
record is created.
Right now only whitelisted units are restarted automatically, and
there are no whitelisted units at this time. These will be slowly
added over time as we understand and learn which units are considered
'safe' to restart, and which ones are not 'safe'.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,366,2018-01-18T23:19:40Z,2018-01-19T18:31:16Z,2018-01-19T18:31:20Z,MERGED,True,235,299,27,https://github.com/matthewrsj,Add free_string function and use everywhere,1,[],https://github.com/clearlinux/swupd-client/pull/366,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/366,"Fixes #357
Add free_string() function to insure code is consistently resetting
pointers to NULL after resetting dynamic memory. Use this helper
everywhere strings are being freed.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixes #357
Add free_string() function to insure code is consistently resetting
pointers to NULL after resetting dynamic memory. Use this helper
everywhere strings are being freed.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,366,2018-01-18T23:19:40Z,2018-01-19T18:31:16Z,2018-01-19T18:31:20Z,MERGED,True,235,299,27,https://github.com/matthewrsj,Add free_string function and use everywhere,1,[],https://github.com/clearlinux/swupd-client/pull/366,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/366#issuecomment-359048912,"Fixes #357
Add free_string() function to insure code is consistently resetting
pointers to NULL after resetting dynamic memory. Use this helper
everywhere strings are being freed.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Found some additional comparisons and assignments to NULL that could be removed. This should be good to go now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,366,2018-01-18T23:19:40Z,2018-01-19T18:31:16Z,2018-01-19T18:31:20Z,MERGED,True,235,299,27,https://github.com/matthewrsj,Add free_string function and use everywhere,1,[],https://github.com/clearlinux/swupd-client/pull/366,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/366#issuecomment-359050732,"Fixes #357
Add free_string() function to insure code is consistently resetting
pointers to NULL after resetting dynamic memory. Use this helper
everywhere strings are being freed.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Merging this...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,367,2018-01-19T00:25:20Z,2018-01-23T22:05:33Z,2018-01-23T22:05:35Z,MERGED,True,65,0,2,https://github.com/matthewrsj,Add missing flags to man page,1,[],https://github.com/clearlinux/swupd-client/pull/367,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/367,"The following flags have been added to the man page
--no-scripts
--nosigcheck
--ignore-time
--certpath
--time
--no-boot-update
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","The following flags have been added to the man page
--no-scripts
--nosigcheck
--ignore-time
--certpath
--time
--no-boot-update
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,367,2018-01-19T00:25:20Z,2018-01-23T22:05:33Z,2018-01-23T22:05:35Z,MERGED,True,65,0,2,https://github.com/matthewrsj,Add missing flags to man page,1,[],https://github.com/clearlinux/swupd-client/pull/367,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/367#issuecomment-358827485,"The following flags have been added to the man page
--no-scripts
--nosigcheck
--ignore-time
--certpath
--time
--no-boot-update
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Fixes #335,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,367,2018-01-19T00:25:20Z,2018-01-23T22:05:33Z,2018-01-23T22:05:35Z,MERGED,True,65,0,2,https://github.com/matthewrsj,Add missing flags to man page,1,[],https://github.com/clearlinux/swupd-client/pull/367,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/367#issuecomment-359947123,"The following flags have been added to the man page
--no-scripts
--nosigcheck
--ignore-time
--certpath
--time
--no-boot-update
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixed, merging.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,368,2018-01-25T07:06:14Z,2018-01-25T18:02:45Z,2018-02-08T01:06:04Z,MERGED,True,58,1,6,https://github.com/cmarcelo,Add info command to show OS version and URLs,1,[],https://github.com/clearlinux/swupd-client/pull/368,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/368,"Fixes #218.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com","Fixes #218.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,368,2018-01-25T07:06:14Z,2018-01-25T18:02:45Z,2018-02-08T01:06:04Z,MERGED,True,58,1,6,https://github.com/cmarcelo,Add info command to show OS version and URLs,1,[],https://github.com/clearlinux/swupd-client/pull/368,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/368#issuecomment-360380100,"Fixes #218.
Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com","@matthewrsj this is not exactly what the issue asked for (info content_url), but similar because shows all the relevant information.
It helps a little bit when using mixes.",True,{'HOORAY': ['https://github.com/mrkz']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,369,2018-01-25T07:11:11Z,2018-01-25T17:48:59Z,2018-02-08T01:06:04Z,MERGED,True,2,2,1,https://github.com/cmarcelo,Use same style for all the command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/369,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/369,Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com,Signed-off-by: Caio Marcelo de Oliveira Filho caio.oliveira@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,372,2018-01-26T17:46:17Z,2018-01-29T16:54:05Z,2018-01-29T16:54:12Z,MERGED,True,197,14,28,https://github.com/matthewrsj,Properly handle bundle-add hash check failures,1,[],https://github.com/clearlinux/swupd-client/pull/372,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/372,"Fixes #252
Fixes #370
Fixes #371
When failing to add bundle with a file with the wrong hash remove the
file and fall back to the verify_fix_path. Improve warnings so they
don't look like errors until they are actually errors.
Add tests so we don't regress in this regard.","Fixes #252
Fixes #370
Fixes #371
When failing to add bundle with a file with the wrong hash remove the
file and fall back to the verify_fix_path. Improve warnings so they
don't look like errors until they are actually errors.
Add tests so we don't regress in this regard.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,374,2018-02-01T17:42:02Z,2018-02-01T18:02:46Z,2018-02-01T19:03:03Z,MERGED,True,18,0,1,https://github.com/bryteise,Make a container check before running clr-boot-manager,1,[],https://github.com/clearlinux/swupd-client/pull/374,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/374,"Add a check to see if an update is being run in a container (and is
updating the rootfs) using systemd-detect-virt -c. If the update is
being run in a container skip running the clr-boot-manager update
since it will fail.","Add a check to see if an update is being run in a container (and is
updating the rootfs) using systemd-detect-virt -c. If the update is
being run in a container skip running the clr-boot-manager update
since it will fail.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,374,2018-02-01T17:42:02Z,2018-02-01T18:02:46Z,2018-02-01T19:03:03Z,MERGED,True,18,0,1,https://github.com/bryteise,Make a container check before running clr-boot-manager,1,[],https://github.com/clearlinux/swupd-client/pull/374,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/374#issuecomment-362350570,"Add a check to see if an update is being run in a container (and is
updating the rootfs) using systemd-detect-virt -c. If the update is
being run in a container skip running the clr-boot-manager update
since it will fail.",Fixes #359,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,375,2018-02-07T01:32:05Z,2018-02-07T02:21:05Z,2018-02-08T01:06:05Z,MERGED,True,3,15,1,https://github.com/cmarcelo,Remove redundant check and string creation in try_delta(),1,[],https://github.com/clearlinux/swupd-client/pull/375,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/375,"The function do_delta() is only called by try_delta() and both were
creating the string with the name of the staged file and performing
the file exists check. Pass the name to do_delta() and remove the
check.
This should not change the behavior.","The function do_delta() is only called by try_delta() and both were
creating the string with the name of the staged file and performing
the file exists check. Pass the name to do_delta() and remove the
check.
This should not change the behavior.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,376,2018-02-09T18:01:52Z,2018-02-10T01:44:13Z,2018-02-13T06:29:45Z,MERGED,True,2,4,1,https://github.com/cmarcelo,Fix invalid call to stat when FALLBACK_CAPATHS is empty,1,[],https://github.com/clearlinux/swupd-client/pull/376,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/376,"Loop wasn't taking into account the constant being set but empty. In
that case tok was set to NULL and stat was called with it. Replace
'do-while' with a 'while' to also perform the check the first time.","Loop wasn't taking into account the constant being set but empty. In
that case tok was set to NULL and stat was called with it. Replace
'do-while' with a 'while' to also perform the check the first time.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,376,2018-02-09T18:01:52Z,2018-02-10T01:44:13Z,2018-02-13T06:29:45Z,MERGED,True,2,4,1,https://github.com/cmarcelo,Fix invalid call to stat when FALLBACK_CAPATHS is empty,1,[],https://github.com/clearlinux/swupd-client/pull/376,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/376#issuecomment-364513482,"Loop wasn't taking into account the constant being set but empty. In
that case tok was set to NULL and stat was called with it. Replace
'do-while' with a 'while' to also perform the check the first time.",+1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,377,2018-02-09T18:02:17Z,2018-02-10T05:22:01Z,2018-02-13T06:29:36Z,MERGED,True,43,64,3,https://github.com/cmarcelo,Various small fixes to bundle-list command,4,[],https://github.com/clearlinux/swupd-client/pull/377,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/377,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,377,2018-02-09T18:02:17Z,2018-02-10T05:22:01Z,2018-02-13T06:29:36Z,MERGED,True,43,64,3,https://github.com/cmarcelo,Various small fixes to bundle-list command,4,[],https://github.com/clearlinux/swupd-client/pull/377,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/377#issuecomment-364626797,,commit 1: +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,377,2018-02-09T18:02:17Z,2018-02-10T05:22:01Z,2018-02-13T06:29:36Z,MERGED,True,43,64,3,https://github.com/cmarcelo,Various small fixes to bundle-list command,4,[],https://github.com/clearlinux/swupd-client/pull/377,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/377#issuecomment-364626826,,commit 2: +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,377,2018-02-09T18:02:17Z,2018-02-10T05:22:01Z,2018-02-13T06:29:36Z,MERGED,True,43,64,3,https://github.com/cmarcelo,Various small fixes to bundle-list command,4,[],https://github.com/clearlinux/swupd-client/pull/377,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/377#issuecomment-364627359,,commit 3: +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,377,2018-02-09T18:02:17Z,2018-02-10T05:22:01Z,2018-02-13T06:29:36Z,MERGED,True,43,64,3,https://github.com/cmarcelo,Various small fixes to bundle-list command,4,[],https://github.com/clearlinux/swupd-client/pull/377,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/377#issuecomment-364627393,,"Ha, ignore my comment on commit 3, +1 for all.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/379,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-365096457,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","@matthewrsj @icarus-sparry ready for a review pass.
I'm still working in: (a) adding one extra functional test   (b) check if we can simplify consolidate_files logic to ignore is_rename, so we can stop reading it. The latter likely will end up in a patch of its own.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,3,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-365163910,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Pushed a new version with a second commit that removes is_rename and make simplifications in consolidate_files.
@phmccarty could you take a look in these two commit messages? I've looked into past work (even before github) to try to figure out the reasoning behind some code that is being removed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,4,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-365793423,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Pushed new version. Changes:

Per request, removing every file in the directory.
Moved the ""is this a good filename"" logic to a function.
Using a local buffer for both from and to, make it easier to understand. The impact should be negligible.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,5,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-366327225,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","can you add a functional test?

Done.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-367105546,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Ugh, sorry about the merge commit. I tried github's ""update branch"" button.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,7,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-367122467,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",Rebased and repushed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-367123037,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Thanks @cmarcelo, sorry about that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-368963543,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",@phmccarty ping,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-370532109,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",@tmarcu @icarus-sparry looking for one more review before merging this.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,11,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-371268117,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",Ping again. Would still like an additional review for this big change.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/icarus-sparry,12,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-376274268,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","NUL is the ASCII character represented by '\0'.
NULL is a value of 0, used in pointer comparisons.",True,{'HOORAY': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,13,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-376597186,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","looks like @cmarcelo addressed comments, so you guys can do another review pass. (@phmccarty @tmarcu @icarus-sparry)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,14,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-378669019,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Rebased.
@tmarcu is there any other change you want suggest for this PR? (Asking because GitHub says you have outstanding requested changes :-)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,15,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-380983956,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",Ping,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,16,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-381012645,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Did a quick test to see if performance was impacted too much by this change.
Procedure:
# system on 21810
# 21 bundles update from 21810 to 21820 (on my system)
sudo swupd update  # system swupd update to 21820
sudo swupd verify --fix --picky -m 21810
sudo swupd clean --all
sudo ./swupd update  # locally built swupd from this PR
sudo swupd verify --fix --picky -m 21810
sudo swupd clean --all

I did the above 5 times and recorded update time for system swupd and local swupd. These were the results:



system
local




19.8
30.8


21.9
30.9


34.7
26.6


32.1
21.2


20.6
33.7



system avg: 25.82 s
local avg: 28.64 s
difference: 2.82 s
With the variation I saw in just doing 10 updates I believe this is insignificant. The TODO can wait until after this PR is merged.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,17,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-381227382,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.","Thanks for doing the measurements, I'll try to replicate them locally, instrumenting only the specific part of the execution, to get rid of noise caused by network.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/cmarcelo,18,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-381293012,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",Rebased and addressed Matthew comments.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,379,2018-02-12T23:15:21Z,2018-04-14T02:07:32Z,2018-06-08T21:06:15Z,MERGED,True,508,285,23,https://github.com/cmarcelo,"Apply all possible deltas from the pack, not only renames",3,[],https://github.com/clearlinux/swupd-client/pull/379,https://github.com/matthewrsj,19,https://github.com/clearlinux/swupd-client/pull/379#issuecomment-381296239,"Consider all deltas from a pack instead of only those who are involved
in a rename. This will allow the server to make better packs
regardless of the from/to version, with the possibility of a delta to
a file that was not necessarily marked with the rename flag.
This makes deltapeer member of file unused, so it was removed. The
peer member continues to be used for its original role: mapping the
same files (same filename) between two manifests, usually the state of
the local system and some new version to be installed.",Doing a last test on my system before merging...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,380,2018-02-13T06:38:01Z,2018-02-14T17:31:37Z,2018-02-25T03:03:42Z,MERGED,True,11,23,1,https://github.com/cmarcelo,Remove now unnecessary variables from Makefile.am,1,[],https://github.com/clearlinux/swupd-client/pull/380,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/380,"Now that all the commands are together in a single binary there's no
much reason to keep various different variables for each. Just
enumerate all the sources as part of swupd_SOURCES.","Now that all the commands are together in a single binary there's no
much reason to keep various different variables for each. Just
enumerate all the sources as part of swupd_SOURCES.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,381,2018-02-13T06:43:23Z,2018-02-13T17:37:02Z,2018-02-25T03:03:42Z,MERGED,True,0,1,1,https://github.com/cmarcelo,Remove unused variable,1,[],https://github.com/clearlinux/swupd-client/pull/381,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/381,"Should have been removed in
2111507 (""Don't show OS version after
the bundles""), but escaped.","Should have been removed in
2111507 (""Don't show OS version after
the bundles""), but escaped.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,382,2018-02-13T09:49:27Z,2018-02-14T17:26:51Z,2018-02-25T03:03:42Z,MERGED,True,9,1,1,https://github.com/cmarcelo,Forbid certain state_dir values to prevent disasters,1,[],https://github.com/clearlinux/swupd-client/pull/382,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/382,"During initialization swupd may delete the state_dir to ensure it is
in the right shape. That means that by accident, passing ""-S /"" to any
command is dangerous.
Since neither /, /usr or /var are really useful as state dirs, let's
prevent some damage by not allowing them.","During initialization swupd may delete the state_dir to ensure it is
in the right shape. That means that by accident, passing ""-S /"" to any
command is dangerous.
Since neither /, /usr or /var are really useful as state dirs, let's
prevent some damage by not allowing them.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,382,2018-02-13T09:49:27Z,2018-02-14T17:26:51Z,2018-02-25T03:03:42Z,MERGED,True,9,1,1,https://github.com/cmarcelo,Forbid certain state_dir values to prevent disasters,1,[],https://github.com/clearlinux/swupd-client/pull/382,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/382#issuecomment-365210485,"During initialization swupd may delete the state_dir to ensure it is
in the right shape. That means that by accident, passing ""-S /"" to any
command is dangerous.
Since neither /, /usr or /var are really useful as state dirs, let's
prevent some damage by not allowing them.",@icarus-sparry thoughts on how to improve this? (Or if we should not),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,383,2018-02-13T21:48:18Z,2018-02-27T17:46:20Z,2018-03-26T21:56:36Z,MERGED,True,397,0,4,https://github.com/cmarcelo,Add 'swupd clean' command,1,[],https://github.com/clearlinux/swupd-client/pull/383,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/383,"This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.","This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,383,2018-02-13T21:48:18Z,2018-02-27T17:46:20Z,2018-03-26T21:56:36Z,MERGED,True,397,0,4,https://github.com/cmarcelo,Add 'swupd clean' command,1,[],https://github.com/clearlinux/swupd-client/pull/383,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/383#issuecomment-365825926,"This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.",This is missing Manifest*delta in statedir files. I'll add those later if the idea gets accepted.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,383,2018-02-13T21:48:18Z,2018-02-27T17:46:20Z,2018-03-26T21:56:36Z,MERGED,True,397,0,4,https://github.com/cmarcelo,Add 'swupd clean' command,1,[],https://github.com/clearlinux/swupd-client/pull/383,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/383#issuecomment-366373188,"This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.",@cmarcelo we have conflicts here.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,383,2018-02-13T21:48:18Z,2018-02-27T17:46:20Z,2018-03-26T21:56:36Z,MERGED,True,397,0,4,https://github.com/cmarcelo,Add 'swupd clean' command,1,[],https://github.com/clearlinux/swupd-client/pull/383,https://github.com/cmarcelo,4,https://github.com/clearlinux/swupd-client/pull/383#issuecomment-368095067,"This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.",Ping,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,383,2018-02-13T21:48:18Z,2018-02-27T17:46:20Z,2018-03-26T21:56:36Z,MERGED,True,397,0,4,https://github.com/cmarcelo,Add 'swupd clean' command,1,[],https://github.com/clearlinux/swupd-client/pull/383,https://github.com/cmarcelo,5,https://github.com/clearlinux/swupd-client/pull/383#issuecomment-368262952,"This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.","This is missing Manifest*delta in statedir files.

Removing those now. One improvement would be always remove those regardless of the date.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,383,2018-02-13T21:48:18Z,2018-02-27T17:46:20Z,2018-03-26T21:56:36Z,MERGED,True,397,0,4,https://github.com/cmarcelo,Add 'swupd clean' command,1,[],https://github.com/clearlinux/swupd-client/pull/383,https://github.com/cmarcelo,6,https://github.com/clearlinux/swupd-client/pull/383#issuecomment-368262963,"This command removes old files from statedir. The interface is a bit
opaque so there will be room to modify the policy later.
By default it will delete staged files that are older than
DAYS_TO_KEEP_FILES. For manifests this heuristic is not good as older
manifests might still be used for the current OS version being run, so
also ensure that those do not get deleted. This prevents 'swupd
search' to redownload files.
The default behavior should be suitable to use in combination with
automatic updates, to control the size of state dir. There is also an
--all option to remove all the state files regardless of dates and
usage.
To avoid ""disasters"" in case some paths are set wrong, the command
explicitly delete patterns of files create by swupd.","Thanks for the review, Icarus.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,384,2018-02-15T17:53:06Z,2018-02-16T16:31:32Z,2018-02-25T03:03:42Z,MERGED,True,9,0,1,https://github.com/cmarcelo,"Fix ""Hardlink target error"" when extracting",1,[],https://github.com/clearlinux/swupd-client/pull/384,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/384,"In some cases packs may include files with entries of type ""hard
link"", that refer to previous files in the pack. Libarchive was
failing since it couldn't find the previous file in disk to archive,
because we change its output path.
Adjusting the hardlink target path (when it exists) fix the
issue. This is also what bsdtar does.
This patch was tested by simulating the update that goes from 19460 to
19580 with the desktop pack installed (that contains one hardlink in
the pack used by this update).
Fixes #351.","In some cases packs may include files with entries of type ""hard
link"", that refer to previous files in the pack. Libarchive was
failing since it couldn't find the previous file in disk to archive,
because we change its output path.
Adjusting the hardlink target path (when it exists) fix the
issue. This is also what bsdtar does.
This patch was tested by simulating the update that goes from 19460 to
19580 with the desktop pack installed (that contains one hardlink in
the pack used by this update).
Fixes #351.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,385,2018-02-15T18:00:10Z,2018-02-15T18:51:01Z,2018-03-06T20:07:14Z,MERGED,True,2,0,1,https://github.com/tmarcu,swupd-add-pkg: Fix upstream url not being filled in,1,[],https://github.com/clearlinux/swupd-client/pull/385,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/385,"The script should be calling init-mix to fully and correctly setup the mix
directory. Without this, the upstream url was never being recorded, and the
yum-mix.conf did not get the URL substituted during chroots phase.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The script should be calling init-mix to fully and correctly setup the mix
directory. Without this, the upstream url was never being recorded, and the
yum-mix.conf did not get the URL substituted during chroots phase.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,385,2018-02-15T18:00:10Z,2018-02-15T18:51:01Z,2018-03-06T20:07:14Z,MERGED,True,2,0,1,https://github.com/tmarcu,swupd-add-pkg: Fix upstream url not being filled in,1,[],https://github.com/clearlinux/swupd-client/pull/385,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/385#issuecomment-366010502,"The script should be calling init-mix to fully and correctly setup the mix
directory. Without this, the upstream url was never being recorded, and the
yum-mix.conf did not get the URL substituted during chroots phase.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",NOTE This will have to be updated when the new mixer is released.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,386,2018-02-15T18:39:12Z,2018-02-15T19:30:16Z,2018-03-06T20:07:13Z,MERGED,True,2,2,1,https://github.com/tmarcu,bundle.c: Fix bundle-add/remove,1,[],https://github.com/clearlinux/swupd-client/pull/386,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/386,"Just because /usr/share/mix exists, don't assume that it has good
content. Check that there is content and we successfully moved to a mix
before trying to use any content out of it.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Just because /usr/share/mix exists, don't assume that it has good
content. Check that there is content and we successfully moved to a mix
before trying to use any content out of it.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/387,@fenrus75 wrote this patch. Opening for review.,@fenrus75 wrote this patch. Opening for review.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367176872,@fenrus75 wrote this patch. Opening for review.,+1 (I can't approve the PR as the PR author though),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367427928,@fenrus75 wrote this patch. Opening for review.,"OK, I'll iterate on this.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/icarus-sparry,4,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367436244,@fenrus75 wrote this patch. Opening for review.,"I think that the search should look for regular expressions, rather than fixed strings.
I think that there should be an indication if the results are truncated at 5 or if that is all there is.
I think that we should have the existing ability to list all the matches, rather than just limiting it to at most 5 matches in at most 5 bundles.
I look forward to reading the documentation explaining the reasoning behind the scoring rules.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367447498,@fenrus75 wrote this patch. Opening for review.,"I think that the search should look for regular expressions, rather than fixed strings.

That would be a good improvement for the future. Let's open an issue. #388

I think that there should be an indication if the results are truncated at 5 or if that is all there is.
I think that we should have the existing ability to list all the matches, rather than just limiting it to at most 5 matches in at most 5 bundles.

How about a flag like --all-results that will display all the results, maybe the way they used to be displayed so that a machine can parse it better?

I look forward to reading the documentation explaining the reasoning behind the scoring rules.

For now these are just experimental heuristics that can be updated over time. I'll add comments with the reasoning behind them as relayed by @fenrus75",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367449391,@fenrus75 wrote this patch. Opening for review.,Opened #388 #389 and #390 for future improvements.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367450987,@fenrus75 wrote this patch. Opening for review.,Also #391,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,387,2018-02-21T00:03:53Z,2018-02-22T01:45:29Z,2018-02-22T06:14:03Z,MERGED,True,213,11,7,https://github.com/matthewrsj,Improve swupd search output,5,[],https://github.com/clearlinux/swupd-client/pull/387,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/387#issuecomment-367494395,@fenrus75 wrote this patch. Opening for review.,"@tmarcu @icarus-sparry I made some updates, please review again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/396,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367802473,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390",I rarely use search X(. I'd expect the order to be consistent however regardless of a bundle being installed or not.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367803783,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390",@bryteise are you aware of how things are scored now? Order is managed internally to search.c now with a relevancy score. Do you think whether a bundle is installed or not should not affect that score or do you object to the entire approach?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367805587,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","The score approach is fine, I'm not convinced about the installed changing score because I like the order to be generally static; i.e if I found it once and I look in the same place by doing the same thing I'll generally see it (updating the scoring algorithm is fine though, just updating score based on system state I'm not convinced I like yet).",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367806306,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","just updating score based on system state I'm not convinced I like yet

Good point. @icarus-sparry, @fenrus75, peanut gallery any comments?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/bryteise,6,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367807016,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","I think to the pundles case could exacerbate the problem too. If I had a lot of pundles installed and then wanted to check for something that is closely related to another thing I searched for before and installed, if I don't see the original thing I had got in my search it would confuse me.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367807408,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","+1 for keeping consistency between searches unless new bundles are added that change the scoring. @bryteise pundles would change it the same as adding a small, more appopriate bundle though. So it should change the order IMO when pundles or new bundles are added that contain the same content.",True,"{'THUMBS_UP': ['https://github.com/matthewrsj', 'https://github.com/bryteise']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/bryteise,8,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367808819,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","@tmarcu I am completely fine with new server content changing order as well as new content should be scored correctly.
I am a little worried that pundles will be slightly annoying if the includes are limited in that we'll start to see a ton of matches for common libraries and the like with search.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367809180,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","pundles will be slightly annoying if the includes are limited

A good reason to implement #393",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/icarus-sparry,10,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367809414,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","I agree with @bryteise about having the bundle installed shouldn't affect if something is shown or not.
When we have pundles I think this scoring approach and only showing 5 bundles is going to be pretty annoying. The good thing is that the pundle having the file will be listed first. Allowing regular expressions and allowing overrides of the 5 & 5 will help to allow someone who knows what they are doing to get useful data out when the defaults fail. Having an indication that the data is truncated will provide a clue to the expert that they need to work around the defaults.",True,{'THUMBS_UP': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/matthewrsj,11,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367810129,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390","Ok, I'm convinced that if we ever do decide to reduce score based on whether or not it is installed (client state) it needs some more thought. I'll remove it from this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,396,2018-02-22T19:53:42Z,2018-02-23T01:49:09Z,2018-02-23T01:49:12Z,MERGED,True,7,1,1,https://github.com/matthewrsj,search: special handling for installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/396,https://github.com/matthewrsj,12,https://github.com/clearlinux/swupd-client/pull/396#issuecomment-367850991,"Show indication that bundle is installed.
When displaying a search result for a bundle display ""installed"" next to bundles that have been added to the system.


Reduce score for installed bundles.
The assumption here is that users use the search feature when they are looking for a bundle to install a certain file. For this case already installed bundles are not what the user is looking for so reduce the score by half.
@icarus-sparry has already expressed concern with the second patch. Anyone else use the search functionality to figure out which installed bundles they should remove?


Fixes #390",This is ready for review now then.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/397,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.","When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/397#issuecomment-367889583,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.","Implementation: I haven't peeked into the details, but one suggestion is to not try to do that calculation at the time of one file being added, but later on, after you did a pass through all the bundles (i.e. do not parse manifests again, store the information you need from this first loop). While you do the first pass, you can keep track of each bundle size & includes, and use that for your calculation. Having a ""load_manifest_headers()"" function like you suggested also works, but since we are parsing the entire manifests anyway (to walk the files), it seems we could do without it.
Interface: One important information is the amount we will have to download, so I wonder if the output should only take into account the included bundles not installed (I haven't verified if the recurse function is already doing this for you or not).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/cmarcelo,3,https://github.com/clearlinux/swupd-client/pull/397#issuecomment-367892005,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.",I meant extra installed size instead of download size.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/397#issuecomment-368067551,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.","one suggestion is to not try to do that calculation at the time of one file being added, but later on, after you did a pass through all the bundles (i.e. do not parse manifests again, store the information you need from this first loop).

This calculation is currently only done for each new bundle that has a hit, not every time a file is added.

One important information is the amount we will have to download, so I wonder if the output should only take into account the included bundles not installed (I haven't verified if the recurse function is already doing this for you or not).

I should have mentioned this was my plan. This PR is not complete, I just wanted to open it for comments. My plan is to say installed size: x for installed bundles and size to install: x for bundles that are not installed.
I have a couple ideas that I'll try. I'll reopen this when it is ready.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/cmarcelo,5,https://github.com/clearlinux/swupd-client/pull/397#issuecomment-368068016,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.","This calculation is currently only done for each new bundle that has a hit, not every time a file is added.

I know. :)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/cmarcelo,6,https://github.com/clearlinux/swupd-client/pull/397#issuecomment-368068290,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.","size to install: x for bundles that are not installed.

Nice!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,397,2018-02-23T01:48:49Z,2018-02-23T23:42:43Z,2018-02-23T23:42:48Z,CLOSED,False,22,8,1,https://github.com/matthewrsj,RFC: Report real contentsize for swupd search bundles,1,[],https://github.com/clearlinux/swupd-client/pull/397,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/397#issuecomment-368070935,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
RFC: looking for ways to make this faster. This is considerably slower when we have to recurse all the manifests for their includes. I only do this recursion once for each bundle that we hit but the slowdown is still noticeable. Maybe an option on  load_manifest() to only load the header information and not the entire file list.","While you do the first pass, you can keep track of each bundle size & includes, and use that for your calculation.

Ok I see what you are saying, but the issue here is that we may not actually parse all the manifests if --scope is o. I suppose in that case we don't have to print the bundle size though.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,399,2018-02-23T23:57:50Z,2018-03-07T19:59:37Z,2018-03-07T19:59:42Z,MERGED,True,131,18,3,https://github.com/matthewrsj,Report real contentsize for swupd search bundles,2,[],https://github.com/clearlinux/swupd-client/pull/399,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/399,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting. For bundles that
are not installed on the client system, this skips any installed
includes and only reports contentsize for uninstalled includes. For
bundles that are installed on the system calculate the entire
contentsize for all includes and report this as the ""installed size"" of
the bundle.
When the scope is 'o' (one hit only) do not print size information.
Since only the first hit was taken it is unlikely that contentsize was
calculated for all that bundle's includes.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I performed a quick analysis on performance of tracking the included contentsizes to see if there was much of a slowdown with this patch applied. For each search term I ran the search five times both before and after applying the patch. The results show there is no significant performance difference.



search term
with patch
without patch




curl
0.73s
0.71s


/usr/bin/curl
0.84s
0.81s


/usr/share/clear/bundles/os-clr-on-clr
0.90s
0.91s



Fixes #389","When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting. For bundles that
are not installed on the client system, this skips any installed
includes and only reports contentsize for uninstalled includes. For
bundles that are installed on the system calculate the entire
contentsize for all includes and report this as the ""installed size"" of
the bundle.
When the scope is 'o' (one hit only) do not print size information.
Since only the first hit was taken it is unlikely that contentsize was
calculated for all that bundle's includes.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I performed a quick analysis on performance of tracking the included contentsizes to see if there was much of a slowdown with this patch applied. For each search term I ran the search five times both before and after applying the patch. The results show there is no significant performance difference.



search term
with patch
without patch




curl
0.73s
0.71s


/usr/bin/curl
0.84s
0.81s


/usr/share/clear/bundles/os-clr-on-clr
0.90s
0.91s



Fixes #389",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,399,2018-02-23T23:57:50Z,2018-03-07T19:59:37Z,2018-03-07T19:59:42Z,MERGED,True,131,18,3,https://github.com/matthewrsj,Report real contentsize for swupd search bundles,2,[],https://github.com/clearlinux/swupd-client/pull/399,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/399#issuecomment-368174739,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting. For bundles that
are not installed on the client system, this skips any installed
includes and only reports contentsize for uninstalled includes. For
bundles that are installed on the system calculate the entire
contentsize for all includes and report this as the ""installed size"" of
the bundle.
When the scope is 'o' (one hit only) do not print size information.
Since only the first hit was taken it is unlikely that contentsize was
calculated for all that bundle's includes.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I performed a quick analysis on performance of tracking the included contentsizes to see if there was much of a slowdown with this patch applied. For each search term I ran the search five times both before and after applying the patch. The results show there is no significant performance difference.



search term
with patch
without patch




curl
0.73s
0.71s


/usr/bin/curl
0.84s
0.81s


/usr/share/clear/bundles/os-clr-on-clr
0.90s
0.91s



Fixes #389","Hrm similar to my thoughts on search order, size changing by what is installed on the system is a little weird. Maybe this is okay though I see a scenario of: Have bundles a, b, and c add bundle d which requires the rest; new system add bundle d but didn't expect a, b and c coming along for the ride since it was smaller in the search results.
Maybe a flag for show size without dependencies? Normally dependencies aren't considered for other packaging systems so this might be an odd default.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,399,2018-02-23T23:57:50Z,2018-03-07T19:59:37Z,2018-03-07T19:59:42Z,MERGED,True,131,18,3,https://github.com/matthewrsj,Report real contentsize for swupd search bundles,2,[],https://github.com/clearlinux/swupd-client/pull/399,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/399#issuecomment-368175239,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting. For bundles that
are not installed on the client system, this skips any installed
includes and only reports contentsize for uninstalled includes. For
bundles that are installed on the system calculate the entire
contentsize for all includes and report this as the ""installed size"" of
the bundle.
When the scope is 'o' (one hit only) do not print size information.
Since only the first hit was taken it is unlikely that contentsize was
calculated for all that bundle's includes.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I performed a quick analysis on performance of tracking the included contentsizes to see if there was much of a slowdown with this patch applied. For each search term I ran the search five times both before and after applying the patch. The results show there is no significant performance difference.



search term
with patch
without patch




curl
0.73s
0.71s


/usr/bin/curl
0.84s
0.81s


/usr/share/clear/bundles/os-clr-on-clr
0.90s
0.91s



Fixes #389","Maybe a flag for show size without dependencies?

But this is meaningless.
I don't think it is unreasonable to report what the installation size will be in the current system. The messaging is clear enough (I think) to show that the displayed bundle size if for what will be installed on the system.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,399,2018-02-23T23:57:50Z,2018-03-07T19:59:37Z,2018-03-07T19:59:42Z,MERGED,True,131,18,3,https://github.com/matthewrsj,Report real contentsize for swupd search bundles,2,[],https://github.com/clearlinux/swupd-client/pull/399,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/399#issuecomment-368175911,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting. For bundles that
are not installed on the client system, this skips any installed
includes and only reports contentsize for uninstalled includes. For
bundles that are installed on the system calculate the entire
contentsize for all includes and report this as the ""installed size"" of
the bundle.
When the scope is 'o' (one hit only) do not print size information.
Since only the first hit was taken it is unlikely that contentsize was
calculated for all that bundle's includes.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I performed a quick analysis on performance of tracking the included contentsizes to see if there was much of a slowdown with this patch applied. For each search term I ran the search five times both before and after applying the patch. The results show there is no significant performance difference.



search term
with patch
without patch




curl
0.73s
0.71s


/usr/bin/curl
0.84s
0.81s


/usr/share/clear/bundles/os-clr-on-clr
0.90s
0.91s



Fixes #389","Thinking a little more, it makes more sense to me to change bundle-add so it displays a confirmation dialog after listing the bundles being added and their individual sizes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,399,2018-02-23T23:57:50Z,2018-03-07T19:59:37Z,2018-03-07T19:59:42Z,MERGED,True,131,18,3,https://github.com/matthewrsj,Report real contentsize for swupd search bundles,2,[],https://github.com/clearlinux/swupd-client/pull/399,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/399#issuecomment-368182913,"When reporting bundles for swupd search include their included bundles'
contentsizes as well for more accurate size reporting. For bundles that
are not installed on the client system, this skips any installed
includes and only reports contentsize for uninstalled includes. For
bundles that are installed on the system calculate the entire
contentsize for all includes and report this as the ""installed size"" of
the bundle.
When the scope is 'o' (one hit only) do not print size information.
Since only the first hit was taken it is unlikely that contentsize was
calculated for all that bundle's includes.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
I performed a quick analysis on performance of tracking the included contentsizes to see if there was much of a slowdown with this patch applied. For each search term I ran the search five times both before and after applying the patch. The results show there is no significant performance difference.



search term
with patch
without patch




curl
0.73s
0.71s


/usr/bin/curl
0.84s
0.81s


/usr/share/clear/bundles/os-clr-on-clr
0.90s
0.91s



Fixes #389",+1 after @matthewrsj came over and explained all the things to my Friday head.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,402,2018-02-27T19:36:54Z,2018-03-22T21:38:47Z,2018-03-22T21:38:48Z,CLOSED,False,0,15,2,https://github.com/matthewrsj,Remove root requirement for check-update,1,[],https://github.com/clearlinux/swupd-client/pull/402,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/402,"Also removes a call to update an unused motd file. The motd is now
managed differently in Clear Linux and the MOTD_FILE does not even exist
where it expects it to. Since this was the only reason root was required
just remove the functionality entirely.
Fixes #398 (the best we can do for now)
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Also removes a call to update an unused motd file. The motd is now
managed differently in Clear Linux and the MOTD_FILE does not even exist
where it expects it to. Since this was the only reason root was required
just remove the functionality entirely.
Fixes #398 (the best we can do for now)
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,402,2018-02-27T19:36:54Z,2018-03-22T21:38:47Z,2018-03-22T21:38:48Z,CLOSED,False,0,15,2,https://github.com/matthewrsj,Remove root requirement for check-update,1,[],https://github.com/clearlinux/swupd-client/pull/402,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/402#issuecomment-369006528,"Also removes a call to update an unused motd file. The motd is now
managed differently in Clear Linux and the MOTD_FILE does not even exist
where it expects it to. Since this was the only reason root was required
just remove the functionality entirely.
Fixes #398 (the best we can do for now)
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",I see this calling read_versions which calls get_latest_version and get_latest_version attempts to write to the statedir which makes me think this is not a happy thing (I think it should fail in swupd_download_file_start which attempts to open the statedir file).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,402,2018-02-27T19:36:54Z,2018-03-22T21:38:47Z,2018-03-22T21:38:48Z,CLOSED,False,0,15,2,https://github.com/matthewrsj,Remove root requirement for check-update,1,[],https://github.com/clearlinux/swupd-client/pull/402,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/402#issuecomment-369009030,"Also removes a call to update an unused motd file. The motd is now
managed differently in Clear Linux and the MOTD_FILE does not even exist
where it expects it to. Since this was the only reason root was required
just remove the functionality entirely.
Fixes #398 (the best we can do for now)
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","But that only addresses a subset of the problem. Processes running with the old ID also need to be restarted, which is harder.

Hmm, you appear to be right, but my testing shows otherwise...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,402,2018-02-27T19:36:54Z,2018-03-22T21:38:47Z,2018-03-22T21:38:48Z,CLOSED,False,0,15,2,https://github.com/matthewrsj,Remove root requirement for check-update,1,[],https://github.com/clearlinux/swupd-client/pull/402,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/402#issuecomment-375466303,"Also removes a call to update an unused motd file. The motd is now
managed differently in Clear Linux and the MOTD_FILE does not even exist
where it expects it to. Since this was the only reason root was required
just remove the functionality entirely.
Fixes #398 (the best we can do for now)
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Closing this as it is not a significant improvement, and priority should be #403",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,405,2018-02-28T01:21:07Z,2018-02-28T01:36:47Z,2018-03-06T20:07:16Z,CLOSED,False,5,2,1,https://github.com/tmarcu,Update to new Mixer 4.0.*,1,[],https://github.com/clearlinux/swupd-client/pull/405,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/405,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,406,2018-03-01T19:01:11Z,2018-03-02T01:10:01Z,2018-03-02T01:10:01Z,MERGED,True,36,31,1,https://github.com/tmarcu,Update to new Mixer 4.0.*,1,[],https://github.com/clearlinux/swupd-client/pull/406,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/406,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,406,2018-03-01T19:01:11Z,2018-03-02T01:10:01Z,2018-03-02T01:10:01Z,MERGED,True,36,31,1,https://github.com/tmarcu,Update to new Mixer 4.0.*,1,[],https://github.com/clearlinux/swupd-client/pull/406,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/406#issuecomment-369713186,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,"OK, tested with simple package and new mixer using all --new options,
mix builds successfully
swupd update --migrate succeeds
swupd bundle-add mybundle succeeds
run program it installs
swupd bundle-remove mybundle removes data
run program fails as expected
swupd verify --fix --picky --force -m  -C /usr/share/clear/update-ca/Swupd_Root.pem

brings system back to VER without needing to remove any other metadata *",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,407,2018-03-06T19:43:31Z,2018-03-06T20:04:52Z,2018-03-06T20:07:11Z,MERGED,True,3,2,1,https://github.com/tmarcu,Add mixer-integration awareness to bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/407,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/407,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,408,2018-03-06T19:50:05Z,2018-03-07T20:08:13Z,2018-03-07T20:08:16Z,MERGED,True,77,14,1,https://github.com/matthewrsj,search: display all results by default,2,[],https://github.com/clearlinux/swupd-client/pull/408,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/408,"Instead of silently truncating search results to 5 files per 5 bundles
make the default search output a full list grouped by bundle. This
output will only be sorted by increasing bundle size.
Add a -t, --top=NUM argument to tell search to truncate results at NUM
files and NUM bundles. This option attempts to display the top results
based on a set of heuristics.
When truncating results due to --top add a message when the file or
bundle results are cut off.
Add the -m, --csv flag to output all search results in CSV format:
/file/result,bundle-name
This PR is based on #399. Ignore the first commit for this patchset. Only merge this after #399 has been merged.","Instead of silently truncating search results to 5 files per 5 bundles
make the default search output a full list grouped by bundle. This
output will only be sorted by increasing bundle size.
Add a -t, --top=NUM argument to tell search to truncate results at NUM
files and NUM bundles. This option attempts to display the top results
based on a set of heuristics.
When truncating results due to --top add a message when the file or
bundle results are cut off.
Add the -m, --csv flag to output all search results in CSV format:
/file/result,bundle-name
This PR is based on #399. Ignore the first commit for this patchset. Only merge this after #399 has been merged.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,408,2018-03-06T19:50:05Z,2018-03-07T20:08:13Z,2018-03-07T20:08:16Z,MERGED,True,77,14,1,https://github.com/matthewrsj,search: display all results by default,2,[],https://github.com/clearlinux/swupd-client/pull/408,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/408#issuecomment-370906400,"Instead of silently truncating search results to 5 files per 5 bundles
make the default search output a full list grouped by bundle. This
output will only be sorted by increasing bundle size.
Add a -t, --top=NUM argument to tell search to truncate results at NUM
files and NUM bundles. This option attempts to display the top results
based on a set of heuristics.
When truncating results due to --top add a message when the file or
bundle results are cut off.
Add the -m, --csv flag to output all search results in CSV format:
/file/result,bundle-name
This PR is based on #399. Ignore the first commit for this patchset. Only merge this after #399 has been merged.","Fixes #391
Fixes #392
Fixes #393",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,409,2018-03-13T17:55:53Z,2018-03-14T22:24:44Z,2018-03-14T22:24:44Z,MERGED,True,41,15,1,https://github.com/tmarcu,Fix swupd-add-pkg,1,[],https://github.com/clearlinux/swupd-client/pull/409,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/409,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,409,2018-03-13T17:55:53Z,2018-03-14T22:24:44Z,2018-03-14T22:24:44Z,MERGED,True,41,15,1,https://github.com/tmarcu,Fix swupd-add-pkg,1,[],https://github.com/clearlinux/swupd-client/pull/409,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/409#issuecomment-372760251,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,Also need to remove from Makefile.am,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,409,2018-03-13T17:55:53Z,2018-03-14T22:24:44Z,2018-03-14T22:24:44Z,MERGED,True,41,15,1,https://github.com/tmarcu,Fix swupd-add-pkg,1,[],https://github.com/clearlinux/swupd-client/pull/409,https://github.com/tmarcu,3,https://github.com/clearlinux/swupd-client/pull/409#issuecomment-372768641,Signed-off-by: Tudor Marcu tudor.marcu@intel.com,@matthewrsj Fixed this to just include the fixes required for it for the time being.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,411,2018-03-16T23:55:03Z,2018-03-17T00:13:12Z,2018-03-19T17:49:43Z,MERGED,True,1,1,1,https://github.com/tmarcu,Grep pkg,1,[],https://github.com/clearlinux/swupd-client/pull/411,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/411,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,414,2018-03-18T19:31:19Z,2018-03-19T21:42:23Z,2018-03-19T21:49:57Z,MERGED,True,218,110,123,https://github.com/icarus-sparry,Fix for issue 412,4,[],https://github.com/clearlinux/swupd-client/pull/414,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/414,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,414,2018-03-18T19:31:19Z,2018-03-19T21:42:23Z,2018-03-19T21:49:57Z,MERGED,True,218,110,123,https://github.com/icarus-sparry,Fix for issue 412,4,[],https://github.com/clearlinux/swupd-client/pull/414,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/414#issuecomment-374363504,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,"You have to update the test you added to report ""more than 4 million"" instead of ""more than a million""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,415,2018-03-22T02:35:09Z,2018-03-26T18:23:05Z,2018-03-26T18:23:06Z,MERGED,True,130,174,8,https://github.com/icarus-sparry,Completion,2,[],https://github.com/clearlinux/swupd-client/pull/415,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/415,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,415,2018-03-22T02:35:09Z,2018-03-26T18:23:05Z,2018-03-26T18:23:06Z,MERGED,True,130,174,8,https://github.com/icarus-sparry,Completion,2,[],https://github.com/clearlinux/swupd-client/pull/415,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/415#issuecomment-375160674,,"The first change is actually a bug fix, if we have a lot of bundles (think pundles) the list-bundles outputs random garbage.
To reproduce, as root do
   cd /usr/share/clear/bundles
   for i in {1..1000} ; do touch XXX$i ; done
   swupd bundle-list
   # note the junk
   rm XXX[0-9]*
   swupd bundle-list
   # Note you still have junk
   cd ..
   cp -rp bundles{,.new}
   rm -rf bundles
   mv bundles{.new,}

The second patch saves a copy of the MoM in /usr/share/clear/bundles/.MoM, makes the completion code use it. It also checks in the completion code directly, rather than generating it, removes the generation script, and adds some crude filename completion to swupd hashdump, the latter is still a WIP.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,415,2018-03-22T02:35:09Z,2018-03-26T18:23:05Z,2018-03-26T18:23:06Z,MERGED,True,130,174,8,https://github.com/icarus-sparry,Completion,2,[],https://github.com/clearlinux/swupd-client/pull/415,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/415#issuecomment-375458449,,lgtm after you update the bundledir reading logic to ignore all dotfiles.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,416,2018-03-30T17:31:16Z,2018-03-30T17:38:59Z,2018-03-30T17:38:59Z,MERGED,True,1,1,1,https://github.com/icarus-sparry,"Fix a ""preposterous check",1,[],https://github.com/clearlinux/swupd-client/pull/416,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/416,"2*10^12 rather than 2*10^9
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","2*10^12 rather than 2*10^9
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,417,2018-03-30T17:34:14Z,2018-03-30T18:41:42Z,2018-03-30T18:41:42Z,MERGED,True,4,4,1,https://github.com/ahkok,Reduce the time between version checks.,1,[],https://github.com/clearlinux/swupd-client/pull/417,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/417,"We know these are cheap and our CDN takes care of the actual
bulk of the bandwith.
Spread the update checks between 45min0sec and 1hr33mins
effectively.","We know these are cheap and our CDN takes care of the actual
bulk of the bandwith.
Spread the update checks between 45min0sec and 1hr33mins
effectively.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,418,2018-04-02T23:21:20Z,2018-04-03T18:02:57Z,2018-06-08T21:06:15Z,MERGED,True,37,38,9,https://github.com/cmarcelo,Stop creating a separate libswupd,2,[],https://github.com/clearlinux/swupd-client/pull/418,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/418,The only code using this library that I was aware of was ported to not depend on it (it was using the hash functions).,The only code using this library that I was aware of was ported to not depend on it (it was using the hash functions).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,419,2018-04-03T15:59:59Z,2018-04-03T16:12:47Z,2018-06-08T21:05:13Z,MERGED,True,2,1,1,https://github.com/cmarcelo,clean: fix returning garbage in failure cases,1,[],https://github.com/clearlinux/swupd-client/pull/419,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/419,"The variable contents was not being properly set when early failures
happen in read_mom_contents.
Found with clang static analyzer.","The variable contents was not being properly set when early failures
happen in read_mom_contents.
Found with clang static analyzer.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,420,2018-04-03T17:48:40Z,2018-04-03T17:58:14Z,2018-06-08T21:05:13Z,MERGED,True,7,7,1,https://github.com/cmarcelo,list: fix cloning lists of strings,1,[],https://github.com/clearlinux/swupd-client/pull/420,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/420,"The clone of strings lists was creating a copy of the items and adding
to the list, but still keeping the old ones around. Change the
function to just clone the items. This was causing invalid reads when
doing swupd search for a term that has matches, and causing crashes
for some users.
For the record, one of the valgrind reports:
==30978== Invalid read of size 1
==30978==    at 0x51FF680: __strcmp_ssse3 (in /usr/lib64/haswell/libc-2.27.so)
==30978==    by 0x407C1B: calculate_size (search.c:194)
==30978==    by 0x407C62: calculate_size (search.c:219)
==30978==    by 0x407C62: calculate_size (search.c:219)
==30978==    by 0x4075CD: apply_size_penalty (search.c:240)
==30978==    by 0x4075CD: do_search (search.c:715)
==30978==    by 0x4075CD: search_main (search.c:898)
==30978==    by 0x50B4B36: (below main) (libc-start.c:308)
==30978==  Address 0x65484b0 is 16 bytes before an unallocated block of size 0 in arena ""client""","The clone of strings lists was creating a copy of the items and adding
to the list, but still keeping the old ones around. Change the
function to just clone the items. This was causing invalid reads when
doing swupd search for a term that has matches, and causing crashes
for some users.
For the record, one of the valgrind reports:
==30978== Invalid read of size 1
==30978==    at 0x51FF680: __strcmp_ssse3 (in /usr/lib64/haswell/libc-2.27.so)
==30978==    by 0x407C1B: calculate_size (search.c:194)
==30978==    by 0x407C62: calculate_size (search.c:219)
==30978==    by 0x407C62: calculate_size (search.c:219)
==30978==    by 0x4075CD: apply_size_penalty (search.c:240)
==30978==    by 0x4075CD: do_search (search.c:715)
==30978==    by 0x4075CD: search_main (search.c:898)
==30978==    by 0x50B4B36: (below main) (libc-start.c:308)
==30978==  Address 0x65484b0 is 16 bytes before an unallocated block of size 0 in arena ""client""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,421,2018-04-04T16:39:28Z,2018-04-06T15:52:06Z,2018-06-08T21:05:13Z,MERGED,True,2,2,1,https://github.com/cmarcelo,clean: fix missing argument in function,1,[],https://github.com/clearlinux/swupd-client/pull/421,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/421,"It worked because state_dir is a global, but let's follow the same
approach as other functions and take the state directory as an
argument.","It worked because state_dir is a global, but let's follow the same
approach as other functions and take the state directory as an
argument.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/gvancuts,1,https://github.com/clearlinux/swupd-client/pull/422,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com","Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/422#issuecomment-381295881,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com",Can you please run make to generate the swupd.1 man page and check that file in as well?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/gvancuts,3,https://github.com/clearlinux/swupd-client/pull/422#issuecomment-381328849,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com","@matthewrsj , done.
As a side note, I could not figure out how to get ./autogen.sh to successfully run on either Fedora or Clearlinux... I was always getting the following error:
<snip>
checking whether gcc understands -c and -o together... (cached) yes
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for bsdiff... no
configure: error: Package requirements (bsdiff) were not met:

No package 'bsdiff' found

Consider adjusting the PKG_CONFIG_PATH environment variable if you
installed software in a non-standard prefix.

Alternatively, you may set the environment variables bsdiff_CFLAGS
and bsdiff_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details.

Do you know what I could have been missing?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/422#issuecomment-381334575,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com","Well, you seem to be missing the bsdiff package (https://github.com/clearlinux.bsdiff). In Clear Linux this means you just need to swupd bundle add os-core-update-dev. This bundle will give you all the build dependencies necessary to build swupd-client. In fedora you will have to manually install all the necessary packages.
Re: this PR. All the other subcommands only call out the flags specific to that subcommand and not all the flags that are global to all subcommands. I think I would prefer to reorganize the man page to make this more obvious rather than copying around the globals to each subcommand.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/gvancuts,5,https://github.com/clearlinux/swupd-client/pull/422#issuecomment-381358645,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com","Re: this PR. All the other subcommands only call out the flags specific to that subcommand and not all the flags that are global to all subcommands. I think I would prefer to reorganize the man page to make this more obvious rather than copying around the globals to each subcommand.

Makes sense to me. I have removed all options that are global so only -m, --manifest and -x, --force are effectively added to the man page. I had a doubt as to whether I should keep -x, --force as there is a similar option that's global (-f, --force) but given the short version is different, I have kept it in (and I'm assuming they are slightly different?)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/gvancuts,6,https://github.com/clearlinux/swupd-client/pull/422#issuecomment-381358783,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com","Well, you seem to be missing the bsdiff package (https://github.com/clearlinux.bsdiff). In Clear Linux this means you just need to swupd bundle add os-core-update-dev. This bundle will give you all the build dependencies necessary to build swupd-client. In fedora you will have to manually install all the necessary packages.

That's it, I had os-core-update and missed the fact I also needed os-core-update-dev. As for Fedora, the tool is installed (bsdiff) but there is no package providing this library, is this a specificity of the bsdiff Clearlinux fork? (I did not realise this package had been forked for Clearlinux, thanks for the pointer).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,422,2018-04-13T09:41:52Z,2018-04-14T23:28:10Z,2018-04-14T23:28:11Z,MERGED,True,50,27,2,https://github.com/gvancuts,"Update ""swupd verify"" documentation to cover all options",1,[],https://github.com/clearlinux/swupd-client/pull/422,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/422#issuecomment-381367916,"Add ""swupd verify"" options that were missing from the documentation
(swupd.1.rst) but listed by the tool when calling ""swupd verify -h"".
The order was also slightly changed to be identical to the order used
by ""swupd verify -h"".
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com",We do need the clearlinux fork for bsdiff. There are several optimizations and built-in failure cases that we need. @phmccarty is the maintainer of that project.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,423,2018-04-14T00:08:01Z,2018-04-14T00:18:00Z,2018-06-08T21:05:14Z,MERGED,True,4,4,1,https://github.com/cmarcelo,Fix wrong results when printing time stats,1,[],https://github.com/clearlinux/swupd-client/pull/423,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/423,"The output is milliseconds, so tv_sec needs to be multiplied by
1000. Also format the output so the names are aligned.","The output is milliseconds, so tv_sec needs to be multiplied by
1000. Also format the output so the names are aligned.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,424,2018-04-14T01:56:11Z,2018-04-15T03:35:00Z,2018-06-08T21:06:16Z,MERGED,True,390,374,9,https://github.com/cmarcelo,"Allow to use ""update -m M""",4,[],https://github.com/clearlinux/swupd-client/pull/424,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/424,See commit messages for details.,See commit messages for details.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,424,2018-04-14T01:56:11Z,2018-04-15T03:35:00Z,2018-06-08T21:06:16Z,MERGED,True,390,374,9,https://github.com/cmarcelo,"Allow to use ""update -m M""",4,[],https://github.com/clearlinux/swupd-client/pull/424,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/424#issuecomment-381369599,See commit messages for details.,"Updated manual, removed TODO.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,424,2018-04-14T01:56:11Z,2018-04-15T03:35:00Z,2018-06-08T21:06:16Z,MERGED,True,390,374,9,https://github.com/cmarcelo,"Allow to use ""update -m M""",4,[],https://github.com/clearlinux/swupd-client/pull/424,https://github.com/cmarcelo,3,https://github.com/clearlinux/swupd-client/pull/424#issuecomment-381370772,See commit messages for details.,"To check that I'd try to retrieve the Manifest.MoM of the version, which is essentially what the program is currently doing. It seems ""wrong"" because it is retrying, but I guess the reason to retry in the first place was to avoid transient errors.
I can do something else, I'm not really sure what: maybe if there is a requested version, we have a different error message?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,424,2018-04-14T01:56:11Z,2018-04-15T03:35:00Z,2018-06-08T21:06:16Z,MERGED,True,390,374,9,https://github.com/cmarcelo,"Allow to use ""update -m M""",4,[],https://github.com/clearlinux/swupd-client/pull/424,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/424#issuecomment-381370843,See commit messages for details.,Maybe if the return code is 404 don't try again. I can't think of a time when 404 would be a transient error.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,424,2018-04-14T01:56:11Z,2018-04-15T03:35:00Z,2018-06-08T21:06:16Z,MERGED,True,390,374,9,https://github.com/cmarcelo,"Allow to use ""update -m M""",4,[],https://github.com/clearlinux/swupd-client/pull/424,https://github.com/cmarcelo,5,https://github.com/clearlinux/swupd-client/pull/424#issuecomment-381373297,See commit messages for details.,Added an extra patch that avoids the retries in the case mentioned.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,424,2018-04-14T01:56:11Z,2018-04-15T03:35:00Z,2018-06-08T21:06:16Z,MERGED,True,390,374,9,https://github.com/cmarcelo,"Allow to use ""update -m M""",4,[],https://github.com/clearlinux/swupd-client/pull/424,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/424#issuecomment-381377630,See commit messages for details.,"lgtm, thanks @cmarcelo",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,426,2018-04-16T17:42:00Z,2018-04-25T00:37:14Z,2018-04-27T13:58:45Z,MERGED,True,31,3,3,https://github.com/icarus-sparry,Add test to ensure man pages are up to date,1,[],https://github.com/clearlinux/swupd-client/pull/426,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/426,"Current idea is to have the manual pages stored in the repo in nroff
format, as well as restructured test format. Users can just use the
nroff. Add test to ensure that the pages match.
Fixes #316
Fixes #425
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Current idea is to have the manual pages stored in the repo in nroff
format, as well as restructured test format. Users can just use the
nroff. Add test to ensure that the pages match.
Fixes #316
Fixes #425
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,426,2018-04-16T17:42:00Z,2018-04-25T00:37:14Z,2018-04-27T13:58:45Z,MERGED,True,31,3,3,https://github.com/icarus-sparry,Add test to ensure man pages are up to date,1,[],https://github.com/clearlinux/swupd-client/pull/426,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/426#issuecomment-382808082,"Current idea is to have the manual pages stored in the repo in nroff
format, as well as restructured test format. Users can just use the
nroff. Add test to ensure that the pages match.
Fixes #316
Fixes #425
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","The second patch does some whitespace fixes to the first. Squash that chunk into the first patch -- or just squash both patches if you prefer.
LGTM.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,426,2018-04-16T17:42:00Z,2018-04-25T00:37:14Z,2018-04-27T13:58:45Z,MERGED,True,31,3,3,https://github.com/icarus-sparry,Add test to ensure man pages are up to date,1,[],https://github.com/clearlinux/swupd-client/pull/426,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/426#issuecomment-382834700,"Current idea is to have the manual pages stored in the repo in nroff
format, as well as restructured test format. Users can just use the
nroff. Add test to ensure that the pages match.
Fixes #316
Fixes #425
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Yes, I plan to squash both together if the changes are accepted.
I need to add emacs modelines to the files to stop the need to do the whitespace change as I switch editors!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,427,2018-04-19T18:31:10Z,2018-04-25T00:39:19Z,2018-04-25T15:58:55Z,MERGED,True,10,21,5,https://github.com/cmarcelo,Avoid retries in local downloads for manifests and packs,1,[],https://github.com/clearlinux/swupd-client/pull/427,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/427,"If content_url is local, do not attempt certain certain download
retries. I've focused on changing only the spots that caused 'make
check' to sleep as a first step. But I agree the retry logic needs
some extra care as posted in #221.
This patch reduces the time of running 'make check' in my system from
2m44s to 24s.","If content_url is local, do not attempt certain certain download
retries. I've focused on changing only the spots that caused 'make
check' to sleep as a first step. But I agree the retry logic needs
some extra care as posted in #221.
This patch reduces the time of running 'make check' in my system from
2m44s to 24s.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/428,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384091378,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,I realize this needs man page updates.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384123209,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,Man page section added.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/fenrus75,4,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384134821,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"So if we are going to support mirrors we need to do this smart, basically
1) Only for Mom and packs, but never use the mirror for fullfiles; full
files are our safety fallback.
  (We can debate the MoM since the MoM is tiny AND security sensitive.
Actually I think I prefer the MoM and signature to not come from the
mirror. so mirror is only for packs)
2) Once we get a 404, we should retry the non-mirror URL
3) If the non-mirror URL then succeeds, when should from then on no longer
use the mirror
4) if we get a hash mismatch anywhere, we must stop using the mirror (e.g.
assume compromised mirror)

Mirrors get stale at times, and we must survive even in the light of a
stale or malicious mirror

On Tue, Apr 24, 2018 at 6:32 PM, icarus-sparry ***@***.***> wrote:
 ***@***.**** commented on this pull request.
 ------------------------------

 In src/mirror.c
 <#428 (comment)>
 :

 > +	return swupd_rm(fullpath);
 +}
 +
 +static int write_to_path(char *content, char *path)
 +{
 +	char *dir, *tmp = NULL;
 +	string_or_die(&tmp, ""%s"", path);
 +	dir = dirname(tmp);
 +	/* attempt to  make the directory
 +	 * ignore EEXIST errors */
 +	int ret = mkdir(dir, S_IRWXU);
 +	char *cmd;
 +	string_or_die(&cmd, ""mkdir -p %s"", dir);
 +	ret = system(cmd);
 +	if (ret) {
 +		free_string(&cmd);

 Could just

  ret = system(cmd);
  free_string(&cmd);
  free_string(&tmp);
  if (ret) {
       return ret;
  }

 
 You are receiving this because your review was requested.
 Reply to this email directly, view it on GitHub
 <#428 (review)>,
 or mute the thread
 <https://github.com/notifications/unsubscribe-auth/ABPeFYUQZhnS_fLBL_rkbmnwEyObCYQOks5tr9IzgaJpZM4TieJC>
 .",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/fenrus75,5,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384135533,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"I also think we should not provide a mirror for versionurl.
versionurl is like 10 bytes of content, not worth the mirror, but letting someone go stale is a security risk",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384136146,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"@fenrus75 I understand your concerns, but this is in response to an issue seen by users working with Clear Linux in PRC. They are seeing extremely long update and installation times (like, do an install over the weekend type times). I'm willing to talk about a better approach as a next step but I think we should fix their issues first without coming up with a solution that ""picks and chooses"" where their content should come from.
Also, if someone decides to use a mirror, I think it is fair to say they are accepting any risks associated with using the mirror. In the specific use-case I'm addressing they know they can trust the mirror they are using. I'm of the opinion that if a user sets a mirror all content should come from the mirror and not unexpectedly fall back to the CDN.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/icarus-sparry,7,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384136879,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"I think I disagree with all of @fenrus75 points. Presumably the reason for mirrors is to improve bandwidth or work around censorship issues. So let us consider someone who has 1000 machines to update behind a low bandwidth external connection.

Why shouldn't mirrors be used for fullfiles? The hash check still protects the content.
The fact that a mirror is missing one file doesn't mean that it is not still useful for other files.
If we get something from the non-mirror, this doesn't imply that that we want all 1000 machines all getting everything via the slow link.
Obviously we shouldn't use anything with a hash mismatch. But one file being wrong (perhaps the mirror was being updated and the file was not being changed atomically) does not invalidate all the other files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/fenrus75,8,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384143799,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"the point of a mirror is we fall back.
if you don't want a fallback you just do -u and use the url period....

we really should fall back.

in terms of long times, that is presumably all about packs... since those
are big. version files etc are tiny. it's the packs that are huge.

On Tue, Apr 24, 2018 at 6:54 PM, Matthew Johnson ***@***.***> wrote:
 @fenrus75 <https://github.com/fenrus75> I understand your concerns, but
 this is in response to an issue seen by users working with Clear Linux in
 PRC. They are seeing extremely long update and installation times (like, do
 an install over the weekend type times). I'm willing to talk about a better
 approach as a next step but I think we should fix their issues first
 without coming up with a solution that ""picks and chooses"" where their
 content should come from.

 Also, if someone decides to use a mirror, I think it is fair to say they
 are accepting any risks associated with using the mirror. In the specific
 use-case I'm addressing they know they can trust the mirror they are using.
 I'm of the opinion that if a user sets a mirror all content should come
 from the mirror and not unexpectedly fall back to the CDN.

 
 You are receiving this because you were mentioned.
 Reply to this email directly, view it on GitHub
 <#428 (comment)>,
 or mute the thread
 <https://github.com/notifications/unsubscribe-auth/ABPeFYtTrm-mmAlsjbYNs3p-qoioGt5Yks5tr9dcgaJpZM4TieJC>
 .",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/bryteise,9,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384169673,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,Hrm so I imagine that the major pain point is install (otherwise -u would be the easy fix) so packs only seems to make sense to me. We can always reassess at a later point if we need something else too.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384358869,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"After speaking with @fenrus75 this morning we agree this is an acceptable first step. In short-term plans we want to WARN the user if their mirror is out of date and potentially IGNORE the mirror if it becomes too far out of date, maybe a month or two, since this indicates a dead mirror.
Another interesting short-term plan can be to auto-detect a mirror using gethostbyname for linux-ftp and use that automatically if configured to do so.
Slightly longer-term we can provide the fallbacks to CDN, potentially a different mirror for packs-only, etc.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/nesiusra,11,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384393014,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"I disagree that the point of mirroring is to fall back. The point of mirroring is nearly always to improve performance by using a cacheing pattern that protects clients from a suboptimal network experience while in-turn protecting a suboptimal network link from the clients trying to all move the same content over that link.
This is feature that lets system owners manage their systems and computing environment. I'm fine with swupd falling-back to the default source as long as we let people opt-out of that the way we let them opt-out of privacy filtering for telemetrics, etc...   Personally I'd prefer to allow admins to opt-in to auto-fallback.",True,"{'THUMBS_UP': ['https://github.com/matthewrsj', 'https://github.com/icarus-sparry']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/nesiusra,12,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384414714,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,Just a brainstorm... perhaps our mirror file should be a list of mirrors consulted in-order.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/icarus-sparry,13,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-384436826,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"Just a brainstorm... perhaps our mirror file should be a list of mirrors consulted in-order.

perfectly reasonable suggestion. More extreme brainstorming -  We could add grouping of mirrors, doing http HEAD requests in parallel and picking the fastest - building and testing this could take me to retirement :-)",True,"{'HOORAY': ['https://github.com/matthewrsj'], 'LAUGH': ['https://github.com/matthewrsj', 'https://github.com/nesiusra']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/matthewrsj,14,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-385487956,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,@icarus-sparry ping.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,428,2018-04-24T21:47:32Z,2018-04-30T21:25:58Z,2018-05-01T16:40:51Z,MERGED,True,330,18,9,https://github.com/matthewrsj,Provide a configurable mirror URL setting,4,[],https://github.com/clearlinux/swupd-client/pull/428,https://github.com/cmarcelo,15,https://github.com/clearlinux/swupd-client/pull/428#issuecomment-385718697,Provide a mechanism and CLI subcommand to allow users to set a configurable mirror URL on their system. See individual commit messages for more details.,"@matthewrsj
(I'm kind of late on this one, so let me know if its better to create a new thread to discuss this)
I'd suggest the configuration allow us to specify mirror(s) for specific URLs, instead of a general mirror that will apply always. So instead of having a file:
# /etc/swupd/mirror_contenturl
https://example.com/clear-mirror/

I'd prefer having a file that sort of looked like:
# /etc/swupd/mirrors
https://cdn.download.clearlinux.org/update/ -> https://example.com/clear-mirror/

As a consequence, not extra file is needed for the versionurl, as it can be specified in another line.
# /etc/swupd/mirrors
https://cdn.download.clearlinux.org/update/ -> https://example.com/clear-mirror/
https://download.clearlinux.org/update/ -> https://example.com/clear-mirror/

The main advantage would be: if I move to a mix (and back), I don't need to get the /etc/swupd/ files out of the way.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,429,2018-04-26T17:12:20Z,2018-04-27T18:59:25Z,2018-04-27T18:59:25Z,CLOSED,False,5,0,1,https://github.com/bwarden,heuristics: do not ignore /usr/src/linux-*,1,[],https://github.com/clearlinux/swupd-client/pull/429,https://github.com/bwarden,1,https://github.com/clearlinux/swupd-client/pull/429,"Kernel build support files go under /usr/src/linux-$(uname -r), so
ensure that all files matching /usr/src/linux-* are not ignored.
Related to clearlinux/mixer-tools#265","Kernel build support files go under /usr/src/linux-$(uname -r), so
ensure that all files matching /usr/src/linux-* are not ignored.
Related to clearlinux/mixer-tools#265",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,429,2018-04-26T17:12:20Z,2018-04-27T18:59:25Z,2018-04-27T18:59:25Z,CLOSED,False,5,0,1,https://github.com/bwarden,heuristics: do not ignore /usr/src/linux-*,1,[],https://github.com/clearlinux/swupd-client/pull/429,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/429#issuecomment-384722219,"Kernel build support files go under /usr/src/linux-$(uname -r), so
ensure that all files matching /usr/src/linux-* are not ignored.
Related to clearlinux/mixer-tools#265","+1 on the code, needs corresponding update to CBM before merge.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,429,2018-04-26T17:12:20Z,2018-04-27T18:59:25Z,2018-04-27T18:59:25Z,CLOSED,False,5,0,1,https://github.com/bwarden,heuristics: do not ignore /usr/src/linux-*,1,[],https://github.com/clearlinux/swupd-client/pull/429,https://github.com/bwarden,3,https://github.com/clearlinux/swupd-client/pull/429#issuecomment-385063812,"Kernel build support files go under /usr/src/linux-$(uname -r), so
ensure that all files matching /usr/src/linux-* are not ignored.
Related to clearlinux/mixer-tools#265","Looks like this is no longer needed, as I've moved the files under /usr/lib/modules",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,430,2018-04-27T22:04:35Z,2018-04-30T21:54:24Z,2018-04-30T21:54:28Z,MERGED,True,71,69,52,https://github.com/matthewrsj,Handle stale mirrors,4,[],https://github.com/clearlinux/swupd-client/pull/430,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/430,"Handle updates against configured mirrors by warning or unsetting
out-of-date mirrors. If a mirror is only slightly out of date warn the
user that the mirror is stale but continue normal operations. If a
mirror is out of date by a large range (arbitrary difference of 500, or
about a month and a half) simply unset the mirror and continue using the
upstream url.","Handle updates against configured mirrors by warning or unsetting
out-of-date mirrors. If a mirror is only slightly out of date warn the
user that the mirror is stale but continue normal operations. If a
mirror is out of date by a large range (arbitrary difference of 500, or
about a month and a half) simply unset the mirror and continue using the
upstream url.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,430,2018-04-27T22:04:35Z,2018-04-30T21:54:24Z,2018-04-30T21:54:28Z,MERGED,True,71,69,52,https://github.com/matthewrsj,Handle stale mirrors,4,[],https://github.com/clearlinux/swupd-client/pull/430,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/430#issuecomment-385105897,"Handle updates against configured mirrors by warning or unsetting
out-of-date mirrors. If a mirror is only slightly out of date warn the
user that the mirror is stale but continue normal operations. If a
mirror is out of date by a large range (arbitrary difference of 500, or
about a month and a half) simply unset the mirror and continue using the
upstream url.","This PR is based on #428, only the last three commits are relevant.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,430,2018-04-27T22:04:35Z,2018-04-30T21:54:24Z,2018-04-30T21:54:28Z,MERGED,True,71,69,52,https://github.com/matthewrsj,Handle stale mirrors,4,[],https://github.com/clearlinux/swupd-client/pull/430,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/430#issuecomment-385487677,"Handle updates against configured mirrors by warning or unsetting
out-of-date mirrors. If a mirror is only slightly out of date warn the
user that the mirror is stale but continue normal operations. If a
mirror is out of date by a large range (arbitrary difference of 500, or
about a month and a half) simply unset the mirror and continue using the
upstream url.","@icarus-sparry I addressed comments, there are now 4 relevant commits in this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,431,2018-04-30T16:25:55Z,2018-04-30T18:10:22Z,2018-04-30T18:10:59Z,MERGED,True,21,14,9,https://github.com/matthewrsj,Return meaningful errors for SSL Cert failures,1,[],https://github.com/clearlinux/swupd-client/pull/431,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/431,"Add a specific printf and separate failure code to indicate SSL cert
failures. This return code (24) will be returned to telemetry as well to
indicate this specific failure.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Add a specific printf and separate failure code to indicate SSL cert
failures. This return code (24) will be returned to telemetry as well to
indicate this specific failure.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,431,2018-04-30T16:25:55Z,2018-04-30T18:10:22Z,2018-04-30T18:10:59Z,MERGED,True,21,14,9,https://github.com/matthewrsj,Return meaningful errors for SSL Cert failures,1,[],https://github.com/clearlinux/swupd-client/pull/431,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/431#issuecomment-385453153,"Add a specific printf and separate failure code to indicate SSL cert
failures. This return code (24) will be returned to telemetry as well to
indicate this specific failure.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Travis failing due to out-of-date cert on download.clearlinux.org, to test you'll have to check out this branch and run the tests locally.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,431,2018-04-30T16:25:55Z,2018-04-30T18:10:22Z,2018-04-30T18:10:59Z,MERGED,True,21,14,9,https://github.com/matthewrsj,Return meaningful errors for SSL Cert failures,1,[],https://github.com/clearlinux/swupd-client/pull/431,https://github.com/busykai,3,https://github.com/clearlinux/swupd-client/pull/431#issuecomment-385471730,"Add a specific printf and separate failure code to indicate SSL cert
failures. This return code (24) will be returned to telemetry as well to
indicate this specific failure.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,431,2018-04-30T16:25:55Z,2018-04-30T18:10:22Z,2018-04-30T18:10:59Z,MERGED,True,21,14,9,https://github.com/matthewrsj,Return meaningful errors for SSL Cert failures,1,[],https://github.com/clearlinux/swupd-client/pull/431,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/431#issuecomment-385480055,"Add a specific printf and separate failure code to indicate SSL cert
failures. This return code (24) will be returned to telemetry as well to
indicate this specific failure.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Did we ever get any further with documenting the return codes?

No we did not.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,431,2018-04-30T16:25:55Z,2018-04-30T18:10:22Z,2018-04-30T18:10:59Z,MERGED,True,21,14,9,https://github.com/matthewrsj,Return meaningful errors for SSL Cert failures,1,[],https://github.com/clearlinux/swupd-client/pull/431,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/431#issuecomment-385481983,"Add a specific printf and separate failure code to indicate SSL cert
failures. This return code (24) will be returned to telemetry as well to
indicate this specific failure.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Travis passes now that the certs are updated.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,1,https://github.com/clearlinux/swupd-client/pull/435,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,2,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-386217302,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",No testing has been performed yet.  Looking to start a discussion.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-388214277,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",@gtkramer are you still going to iterate on this?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,4,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-388909450,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","@matthewrsj, yes, I didn't have time last week, but I'm working on this today.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,5,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-395596529,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",Doing testing today,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,6,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-396433093,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","@matthewrsj, @icarus-sparry, @mbelluzzo I think this looks better?  I just need to add functional tests.  To check if I hit all of the modifications required to support client SSL certificates, how could I supply one to use for running the functional tests?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,7,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-401971028,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","Regarding functional testing, we could probably port a stripped down version of this quick-and-dirty python web server from python2 to python3. Then we might be able to add all the functional tests we need for each of the major commands?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,8,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-401973653,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","@matthewrsj any objections to changing the path for SSL_CLIENT_CERT from ""/usr/share/clear/update-ca/Swupd_Ssl_Client.pem"" to ""/etc/swupd/client.crt""?  Then this could be something that is added as a part of a post-nonchroot script with ister, and doesn't need distributed as a part of the content of the distribution.  It would give certificate distribution authorities the flexibility to grant certificates to users, or create a generic one that allows swupd to authenticate out of the box to get protected content; based on however their DevOps flow needs to work.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-401975798,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",@gtkramer yes I feel much more comfortable with that suggestion than putting it under /usr,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-401975820,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","sorry, didn't mean to close.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/tmarcu,11,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-409298010,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",@gtkramer is this still something that is needed or should we close this now?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/matthewrsj,12,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-409298560,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",@tmarcu @gtkramer is passing this off to someone else who is working on it currently.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/aaronovz1,13,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-409302926,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",Is this essentially support for hostkey verification? I am asking in ticket #508 for clarification on how to use it and it looked like it was partly broken.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/jwakre,14,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-409771160,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","@gtkramer @matthewrsj I am writing functional tests for the client certificates using a webserver, but I don't have a good way for swupd to trust my webserver. Currently, I can authenticate my webserver by configuring swupd to add an alternative trust location (./autogen --with-fallback-capaths ...) and rebuild swupd. I would prefer another method that doesn't require a special swupd configuration and rebuild. Below are a few other ideas:


Add a feature to swupd to specify alternative capaths at runtime.


Add a feature to swupd that allows it to create insecure server connections when specified.


Add the webserver's certificate to the host's trust store. Can this be mocked in a test environment?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/matthewrsj,15,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-410793582,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com","We discussed in IRC, but for the peanut gallery I have no problem with adding --with-fallback-capaths to testing.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,435,2018-05-03T07:38:29Z,2018-08-17T20:16:07Z,2018-08-17T20:16:07Z,CLOSED,False,49,0,2,https://github.com/gtkramer,Use a SSL client certificate if provided,1,[],https://github.com/clearlinux/swupd-client/pull/435,https://github.com/gtkramer,16,https://github.com/clearlinux/swupd-client/pull/435#issuecomment-413976978,"To support clients that need to authenticate with a web server
hosting protected content, a SSL certificate should be
presented for all curl requests if provided.
Signed-off-by: George Kramer george.kramer@live.com",@jwakre has picked this up and finished the remaining integration bits.  Many thanks for the assist here!  Closing this PR and letting @jwakre open another one for the final merge.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,436,2018-05-08T22:37:38Z,2018-05-08T23:03:19Z,2018-05-08T23:03:23Z,MERGED,True,0,6395,71,https://github.com/matthewrsj,Remove bsdifftests from swupd-client,1,[],https://github.com/clearlinux/swupd-client/pull/436,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/436,"These tests are not run and do not belong in the swupd-client
repository.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","These tests are not run and do not belong in the swupd-client
repository.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,438,2018-05-08T23:38:14Z,2018-05-08T23:45:16Z,2018-05-08T23:52:46Z,MERGED,True,1,1,1,https://github.com/bwarden,Set mirror override path perm to 0755,1,[],https://github.com/clearlinux/swupd-client/pull/438,https://github.com/bwarden,1,https://github.com/clearlinux/swupd-client/pull/438,"When /etc/swupd is created to hold mirror URL override files, set the
permissions to 0755.
Fixes #437","When /etc/swupd is created to hold mirror URL override files, set the
permissions to 0755.
Fixes #437",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,439,2018-05-09T00:06:27Z,2018-05-09T23:51:24Z,2018-05-09T23:51:24Z,MERGED,True,143,24,7,https://github.com/bwarden,Let umask sort out mirror conf dir perms,2,[],https://github.com/clearlinux/swupd-client/pull/439,https://github.com/bwarden,1,https://github.com/clearlinux/swupd-client/pull/439,"Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.","Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,439,2018-05-09T00:06:27Z,2018-05-09T23:51:24Z,2018-05-09T23:51:24Z,MERGED,True,143,24,7,https://github.com/bwarden,Let umask sort out mirror conf dir perms,2,[],https://github.com/clearlinux/swupd-client/pull/439,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/439#issuecomment-387787173,"Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.","@icarus-sparry the man pages test is failing, even though he hasn't updated the man pages?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,439,2018-05-09T00:06:27Z,2018-05-09T23:51:24Z,2018-05-09T23:51:24Z,MERGED,True,143,24,7,https://github.com/bwarden,Let umask sort out mirror conf dir perms,2,[],https://github.com/clearlinux/swupd-client/pull/439,https://github.com/icarus-sparry,3,https://github.com/clearlinux/swupd-client/pull/439#issuecomment-387802590,"Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.","Hmm. So the test shows that the 'make' command ran rst2man to update swupd.1, and then git  diff-index --quiet showed that the checked in file differed from the one in docs.
Maybe I can't write tests?
Maybe docutils has been updated so rst2man produces different output?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,439,2018-05-09T00:06:27Z,2018-05-09T23:51:24Z,2018-05-09T23:51:24Z,MERGED,True,143,24,7,https://github.com/bwarden,Let umask sort out mirror conf dir perms,2,[],https://github.com/clearlinux/swupd-client/pull/439,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/439#issuecomment-387805898,"Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.",Re-running travis seems to make the test pass...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,439,2018-05-09T00:06:27Z,2018-05-09T23:51:24Z,2018-05-09T23:51:24Z,MERGED,True,143,24,7,https://github.com/bwarden,Let umask sort out mirror conf dir perms,2,[],https://github.com/clearlinux/swupd-client/pull/439,https://github.com/bwarden,5,https://github.com/clearlinux/swupd-client/pull/439#issuecomment-387811080,"Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.","I'm working through some corner cases for pre-existence of /etc/swupd. Once I have the tests implemented and passing, I'll update this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,439,2018-05-09T00:06:27Z,2018-05-09T23:51:24Z,2018-05-09T23:51:24Z,MERGED,True,143,24,7,https://github.com/bwarden,Let umask sort out mirror conf dir perms,2,[],https://github.com/clearlinux/swupd-client/pull/439,https://github.com/bwarden,6,https://github.com/clearlinux/swupd-client/pull/439#issuecomment-387886550,"Set /etc/swupd permissions to 0777 to let the default umask policy
handle stripping bits appropriately.",Cleaned up and squashed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,440,2018-05-10T17:48:56Z,2018-05-10T21:52:11Z,2018-05-10T21:52:15Z,MERGED,True,43,39,3,https://github.com/matthewrsj,swupd-add-pkg: remove sudo invocations,1,[],https://github.com/clearlinux/swupd-client/pull/440,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/440,"Instead of doing this behind the user's back expect them to do it
themselves. This also removes the inconsistencies of running some
commands with sudo -E and others without -E. If users want to provide -E
let them do it themselves.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Instead of doing this behind the user's back expect them to do it
themselves. This also removes the inconsistencies of running some
commands with sudo -E and others without -E. If users want to provide -E
let them do it themselves.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,440,2018-05-10T17:48:56Z,2018-05-10T21:52:11Z,2018-05-10T21:52:15Z,MERGED,True,43,39,3,https://github.com/matthewrsj,swupd-add-pkg: remove sudo invocations,1,[],https://github.com/clearlinux/swupd-client/pull/440,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/440#issuecomment-388143692,"Instead of doing this behind the user's back expect them to do it
themselves. This also removes the inconsistencies of running some
commands with sudo -E and others without -E. If users want to provide -E
let them do it themselves.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@icarus-sparry I updated the man page.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,440,2018-05-10T17:48:56Z,2018-05-10T21:52:11Z,2018-05-10T21:52:15Z,MERGED,True,43,39,3,https://github.com/matthewrsj,swupd-add-pkg: remove sudo invocations,1,[],https://github.com/clearlinux/swupd-client/pull/440,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/440#issuecomment-388146442,"Instead of doing this behind the user's back expect them to do it
themselves. This also removes the inconsistencies of running some
commands with sudo -E and others without -E. If users want to provide -E
let them do it themselves.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@bktan8 this will resolve the issue you were seeing where swupd-add-pkg was ignoring the -E flag.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,442,2018-05-14T16:19:27Z,2018-05-14T18:05:34Z,2018-05-14T18:06:43Z,MERGED,True,4,30,16,https://github.com/matthewrsj,Remove copyright header messages,2,[],https://github.com/clearlinux/swupd-client/pull/442,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/442,"swupd-client is properly open sourced and licensed. The copyright header
is unnecessary, confusing, and causes issues for scripts parsing output.","swupd-client is properly open sourced and licensed. The copyright header
is unnecessary, confusing, and causes issues for scripts parsing output.",True,{'HOORAY': ['https://github.com/cmarcelo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,442,2018-05-14T16:19:27Z,2018-05-14T18:05:34Z,2018-05-14T18:06:43Z,MERGED,True,4,30,16,https://github.com/matthewrsj,Remove copyright header messages,2,[],https://github.com/clearlinux/swupd-client/pull/442,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/442#issuecomment-388906316,"swupd-client is properly open sourced and licensed. The copyright header
is unnecessary, confusing, and causes issues for scripts parsing output.","@phmccarty done, done, and done.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,443,2018-05-14T19:37:09Z,2018-05-14T19:52:35Z,2018-05-14T19:52:38Z,MERGED,True,8,10,3,https://github.com/matthewrsj,Move copyright_header to main.c,1,[],https://github.com/clearlinux/swupd-client/pull/443,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/443,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,444,2018-05-14T23:27:09Z,2018-05-15T18:35:20Z,2018-05-15T18:35:24Z,MERGED,True,12,31,2,https://github.com/matthewrsj,Update mixer integration to use latest features,1,[],https://github.com/clearlinux/swupd-client/pull/444,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/444,"Update mixer integration to key off the .valid-mix flag file to check if
a mix exists. Also update the .clearversion filename to upstreamurl (it
has changed in upstream).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Update mixer integration to key off the .valid-mix flag file to check if
a mix exists. Also update the .clearversion filename to upstreamurl (it
has changed in upstream).
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,453,2018-05-18T23:41:14Z,2018-05-22T22:08:40Z,2018-05-22T22:08:40Z,MERGED,True,26,12,9,https://github.com/icarus-sparry,Fix findstatic warnings,2,[],https://github.com/clearlinux/swupd-client/pull/453,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/453,"Fixes #448
Make a number of functions static, and bodge around the extra symbol
that gcc adds (__gnu_lto_v1) when compiling with -flto=4
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Fixes #448
Make a number of functions static, and bodge around the extra symbol
that gcc adds (__gnu_lto_v1) when compiling with -flto=4
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,453,2018-05-18T23:41:14Z,2018-05-22T22:08:40Z,2018-05-22T22:08:40Z,MERGED,True,26,12,9,https://github.com/icarus-sparry,Fix findstatic warnings,2,[],https://github.com/clearlinux/swupd-client/pull/453,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/453#issuecomment-390363097,"Fixes #448
Make a number of functions static, and bodge around the extra symbol
that gcc adds (__gnu_lto_v1) when compiling with -flto=4
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","If this is going to be copied elsewhere, then maybe I should add __gnu_lto_slim as a magic symbol as well.
Need to think if travis needs to to a ""make install"" step as well, or just run the perl scripts/findstatic.pl */*.o | grep -v Checking || : step.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,457,2018-05-23T15:51:23Z,2018-05-23T16:30:17Z,2018-05-23T16:30:21Z,MERGED,True,3,0,1,https://github.com/matthewrsj,swupd-add-pkg: write valid-mix flag file,1,['bug'],https://github.com/clearlinux/swupd-client/pull/457,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/457,"swupd-client expects a .valid-mix file to exist in MIX_DIR when a valid
mix exists. Create this file after creating the mix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","swupd-client expects a .valid-mix file to exist in MIX_DIR when a valid
mix exists. Create this file after creating the mix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,459,2018-05-23T20:31:18Z,2018-05-23T21:35:52Z,2018-05-23T21:35:54Z,MERGED,True,18,10,2,https://github.com/matthewrsj,Fix automatic mix updates for mixer integration,2,[],https://github.com/clearlinux/swupd-client/pull/459,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/459,"When a new upstream version is detected the new local mixer build must
be done before manifest uniqueness is checked. This is due to the fact
that os-core can change in the upstream version, so it has to be
re-built locally against the upstream content in order to avoid false
positives for file colisions.
Also add additional files are files that change on the system due to the
local mix. Add these to the ignore list for file colision checks.
Fixes #446","When a new upstream version is detected the new local mixer build must
be done before manifest uniqueness is checked. This is due to the fact
that os-core can change in the upstream version, so it has to be
re-built locally against the upstream content in order to avoid false
positives for file colisions.
Also add additional files are files that change on the system due to the
local mix. Add these to the ignore list for file colision checks.
Fixes #446",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,460,2018-05-31T18:10:25Z,2018-05-31T18:40:41Z,2018-07-03T20:48:28Z,MERGED,True,5,0,1,https://github.com/otaviobp,Update: Fix memory leak on subscription list,1,[],https://github.com/clearlinux/swupd-client/pull/460,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/460,"If current_subs was cloned free the list structure. Free the list
and subscription data otherwise.
Fixes issue #363","If current_subs was cloned free the list structure. Free the list
and subscription data otherwise.
Fixes issue #363",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,463,2018-06-01T19:07:58Z,2018-06-01T19:17:47Z,2018-10-19T16:43:23Z,MERGED,True,0,252,10,https://github.com/mbelluzzo,Minimal req,2,[],https://github.com/clearlinux/swupd-client/pull/463,https://github.com/mbelluzzo,1,https://github.com/clearlinux/swupd-client/pull/463,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/464,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394514905,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","root authored and evil-brain committed
Did you do sudo git commit or something?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394527705,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","There is something strange going on here, for some reason this is always skipping signature verification on my system:
$ sudo vim /var/lib/swupd/22750/Manifest.MoM   # remove a bunch of lines
$ sudo swupd search -b pip3                    # using system swupd
Searching for 'pip3'
Signature check failed!
140669383295104:error:04091068:rsa routines:INT_RSA_VERIFY:bad signature:rsa_sign.c:278:
140669383295104:error:21071069:PKCS7 routines:PKCS7_signatureVerify:signature failure:pk7_doit.c:1141:
140669383295104:error:21075069:PKCS7 routines:PKCS7_verify:signature failure:pk7_smime.c:400:
Warning: Removing corrupt Manifest.MoM artifacts and re-downloading...
Bundle python3-basic	[installed]	(218 MB on system)
	/usr/bin/pip3.6
	/usr/bin/pip3

Bundle python2-basic	[installed]	(379 MB on system)
	/usr/bin/pip3.6
	/usr/bin/pip3

$ sudo vim /var/lib/swupd/22750/Manifest.MoM  # remove a bunch of lines
$ sudo ./swupd search -b pip3                 # using swupd from this PR
Searching for 'pip3'

Search term not found.  # <-- expected only if no signature check is being performed since I removed a bunch of lines from the MoM

I only expect it not to perform the signature check if I pass the '-n' option. How are you testing this?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394543053,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Are you using --enable-signature-verification when running configure?
This patch looks good to me and I am not seeing the problem you reported. I didn't test this patch exhaustively, but I can do it tomorrow if you are still having issues.",True,{'LAUGH': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394543224,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Ha, that's almost certainly my issue. I'll look at this again tomorrow. Thanks.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394543375,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","And if the signature is enable and the -n in informed you are suppose to see this warning message:
FAILED TO VERIFY SIGNATURE OF Manifest.MoM. Operation proceeding due to --nosigcheck, but system security may be compromised",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394767568,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",Is there any reason to have the --enable-signature-verification disabled as default? I think it would be better to enable it.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/phmccarty,8,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394769287,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","The idea was for swupd-client to work without signature verification by default. This lowers the barrier to entry to getting up and running with the project, since swupd can work just fine without that code enabled.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394770361,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","ok, it makes sense.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,464,2018-06-04T22:01:43Z,2018-06-05T16:36:16Z,2018-10-25T17:05:07Z,MERGED,True,6,1,1,https://github.com/evil-brain,search: Add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/464,https://github.com/evil-brain,10,https://github.com/clearlinux/swupd-client/pull/464#issuecomment-394781004,"Fixes #454
Added the -n/--nosigcheck parameter to search, based on the other subcommands that
already have nosigcheck.
I tested this by invalidating Swupd_Root.pem and testing the failing
and passing cases - without nosigcheck and with nosigcheck
respectively.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Did you do sudo git commit or something?

I did this on my test VM where I only had a root login, so I did run git commit as root... I also forgot set my git user/e-mail and had to amend.
I've got a new system now, with a non-root user - so I won't be doing this again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,465,2018-06-04T23:53:29Z,2018-06-08T17:43:10Z,2018-07-03T20:47:25Z,MERGED,True,223,215,42,https://github.com/otaviobp,Consolidate full files downloads,5,[],https://github.com/clearlinux/swupd-client/pull/465,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/465,"Consolidate full files downloads from verify and update.
Use the consolidated function on bundle-add
I'm still working on verify --install

Related to #447","Consolidate full files downloads from verify and update.
Use the consolidated function on bundle-add
I'm still working on verify --install

Related to #447",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,465,2018-06-04T23:53:29Z,2018-06-08T17:43:10Z,2018-07-03T20:47:25Z,MERGED,True,223,215,42,https://github.com/otaviobp,Consolidate full files downloads,5,[],https://github.com/clearlinux/swupd-client/pull/465,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/465#issuecomment-395237591,"Consolidate full files downloads from verify and update.
Use the consolidated function on bundle-add
I'm still working on verify --install

Related to #447",Github messes up the git history. 56ecaf0 comes after 277781c,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,465,2018-06-04T23:53:29Z,2018-06-08T17:43:10Z,2018-07-03T20:47:25Z,MERGED,True,223,215,42,https://github.com/otaviobp,Consolidate full files downloads,5,[],https://github.com/clearlinux/swupd-client/pull/465,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/465#issuecomment-395496215,"Consolidate full files downloads from verify and update.
Use the consolidated function on bundle-add
I'm still working on verify --install

Related to #447","Branch updated with fixes:

Improving comment of function check_files_hash()
Fixing style issues reported by make compliant
Fixing missing brackets",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,466,2018-06-04T23:54:14Z,2018-06-05T16:37:47Z,2018-07-03T20:48:28Z,MERGED,True,7,18,2,https://github.com/otaviobp,minor Fixes,2,[],https://github.com/clearlinux/swupd-client/pull/466,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/466,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,467,2018-06-05T16:22:13Z,2018-06-05T18:29:46Z,2018-07-03T20:48:30Z,MERGED,True,18,18,14,https://github.com/otaviobp,Update: Change log order to have a clearer output,1,[],https://github.com/clearlinux/swupd-client/pull/467,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/467,"Message informing that the system was successfully updated should be
the last message. Having a message that looks like an error as the
last message in an update can be confusing for users.","Message informing that the system was successfully updated should be
the last message. Having a message that looks like an error as the
last message in an update can be confusing for users.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,467,2018-06-05T16:22:13Z,2018-06-05T18:29:46Z,2018-07-03T20:48:30Z,MERGED,True,18,18,14,https://github.com/otaviobp,Update: Change log order to have a clearer output,1,[],https://github.com/clearlinux/swupd-client/pull/467,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/467#issuecomment-394775415,"Message informing that the system was successfully updated should be
the last message. Having a message that looks like an error as the
last message in an update can be confusing for users.","Needs the tests updated.
Open question is if we should enhance the test framework to allow out of order messages so changes like this don't cause churn in the tests?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,467,2018-06-05T16:22:13Z,2018-06-05T18:29:46Z,2018-07-03T20:48:30Z,MERGED,True,18,18,14,https://github.com/otaviobp,Update: Change log order to have a clearer output,1,[],https://github.com/clearlinux/swupd-client/pull/467,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/467#issuecomment-394778040,"Message informing that the system was successfully updated should be
the last message. Having a message that looks like an error as the
last message in an update can be confusing for users.","Open question is if we should enhance the test framework to allow out of order messages so changes like this don't cause churn in the tests?

Sounds like a good feature. There's a lot that could be done to improve the test framework.
+1 after tests are updated (can just re-order output for now)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,467,2018-06-05T16:22:13Z,2018-06-05T18:29:46Z,2018-07-03T20:48:30Z,MERGED,True,18,18,14,https://github.com/otaviobp,Update: Change log order to have a clearer output,1,[],https://github.com/clearlinux/swupd-client/pull/467,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/467#issuecomment-394780166,"Message informing that the system was successfully updated should be
the last message. Having a message that looks like an error as the
last message in an update can be confusing for users.","Sorry, I forgot about that. I'll fix it",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,467,2018-06-05T16:22:13Z,2018-06-05T18:29:46Z,2018-07-03T20:48:30Z,MERGED,True,18,18,14,https://github.com/otaviobp,Update: Change log order to have a clearer output,1,[],https://github.com/clearlinux/swupd-client/pull/467,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/467#issuecomment-394790251,"Message informing that the system was successfully updated should be
the last message. Having a message that looks like an error as the
last message in an update can be confusing for users.",tests fixed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,468,2018-06-05T17:16:58Z,2018-06-05T23:38:38Z,2018-07-03T20:48:31Z,MERGED,True,5,5,3,https://github.com/otaviobp,Remove #warnings from code. Use TODO instead,1,[],https://github.com/clearlinux/swupd-client/pull/468,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/468,"All #warnings messages on swupd code were related to tasks to be performed
in the future and not real code warnings. Using the TODO comment, that is
already used for other tasks.
It's too annoying to see warning messages on compile time and having them
makes a bit harder to noticed when we are introducing real compiler warnings.","All #warnings messages on swupd code were related to tasks to be performed
in the future and not real code warnings. Using the TODO comment, that is
already used for other tasks.
It's too annoying to see warning messages on compile time and having them
makes a bit harder to noticed when we are introducing real compiler warnings.",True,{'THUMBS_UP': ['https://github.com/cmarcelo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,468,2018-06-05T17:16:58Z,2018-06-05T23:38:38Z,2018-07-03T20:48:31Z,MERGED,True,5,5,3,https://github.com/otaviobp,Remove #warnings from code. Use TODO instead,1,[],https://github.com/clearlinux/swupd-client/pull/468,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/468#issuecomment-394792643,"All #warnings messages on swupd code were related to tasks to be performed
in the future and not real code warnings. Using the TODO comment, that is
already used for other tasks.
It's too annoying to see warning messages on compile time and having them
makes a bit harder to noticed when we are introducing real compiler warnings.",See also: #452.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,470,2018-06-05T18:02:37Z,2018-06-05T18:23:10Z,2018-06-08T21:06:15Z,MERGED,True,4,0,1,https://github.com/cmarcelo,Report when a pack is missing using telemetry,1,[],https://github.com/clearlinux/swupd-client/pull/470,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/470,Fixes #450.,Fixes #450.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,471,2018-06-05T22:18:18Z,2018-06-06T18:47:02Z,2018-07-03T20:48:32Z,MERGED,True,76,101,10,https://github.com/otaviobp,Curl: Fixes and api improvements,6,[],https://github.com/clearlinux/swupd-client/pull/471,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/471,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,471,2018-06-05T22:18:18Z,2018-06-06T18:47:02Z,2018-07-03T20:48:32Z,MERGED,True,76,101,10,https://github.com/otaviobp,Curl: Fixes and api improvements,6,[],https://github.com/clearlinux/swupd-client/pull/471,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/471#issuecomment-394886559,,"OCD nit, Curl is capitalized in the second commit subject.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,471,2018-06-05T22:18:18Z,2018-06-06T18:47:02Z,2018-07-03T20:48:32Z,MERGED,True,76,101,10,https://github.com/otaviobp,Curl: Fixes and api improvements,6,[],https://github.com/clearlinux/swupd-client/pull/471,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/471#issuecomment-394893891,,I especially like the API improvement.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,471,2018-06-05T22:18:18Z,2018-06-06T18:47:02Z,2018-07-03T20:48:32Z,MERGED,True,76,101,10,https://github.com/otaviobp,Curl: Fixes and api improvements,6,[],https://github.com/clearlinux/swupd-client/pull/471,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/471#issuecomment-395126547,,"Branch updated fixing:

s/Curl/curl/
don't use alloca anymore",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,472,2018-06-06T19:44:24Z,2018-06-08T17:49:22Z,2018-06-08T17:49:22Z,MERGED,True,168,201,7,https://github.com/castulo,Refactor bundle-remove to handle multiple bundles,5,[],https://github.com/clearlinux/swupd-client/pull/472,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/472,"The current remove_bundle() function was designed to only be called
once, but for multiple bundle removals, it is currently called
multiple times.
This commit refactors this function so the bundle removal code can
handle multiple bundles at once.
Fixes #449","The current remove_bundle() function was designed to only be called
once, but for multiple bundle removals, it is currently called
multiple times.
This commit refactors this function so the bundle removal code can
handle multiple bundles at once.
Fixes #449",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,472,2018-06-06T19:44:24Z,2018-06-08T17:49:22Z,2018-06-08T17:49:22Z,MERGED,True,168,201,7,https://github.com/castulo,Refactor bundle-remove to handle multiple bundles,5,[],https://github.com/clearlinux/swupd-client/pull/472,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/472#issuecomment-395213135,"The current remove_bundle() function was designed to only be called
once, but for multiple bundle removals, it is currently called
multiple times.
This commit refactors this function so the bundle removal code can
handle multiple bundles at once.
Fixes #449",Thanks for your review @otaviobp,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,472,2018-06-06T19:44:24Z,2018-06-08T17:49:22Z,2018-06-08T17:49:22Z,MERGED,True,168,201,7,https://github.com/castulo,Refactor bundle-remove to handle multiple bundles,5,[],https://github.com/clearlinux/swupd-client/pull/472,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/472#issuecomment-395834065,"The current remove_bundle() function was designed to only be called
once, but for multiple bundle removals, it is currently called
multiple times.
This commit refactors this function so the bundle removal code can
handle multiple bundles at once.
Fixes #449",@icarus-sparry and @otaviobp any further comments?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,473,2018-06-07T17:32:50Z,2018-06-07T21:06:56Z,2018-06-08T21:05:13Z,CLOSED,False,1,1,1,https://github.com/cmarcelo,clean: use ctime instead of mtime,1,[],https://github.com/clearlinux/swupd-client/pull/473,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/473,"The ctime will represent the time the files were downloaded, instead
of the mtime generated at build time (which sometimes is the time of
build, but sometimes is not).
Fixes an issue reported by Otavio.","The ctime will represent the time the files were downloaded, instead
of the mtime generated at build time (which sometimes is the time of
build, but sometimes is not).
Fixes an issue reported by Otavio.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,473,2018-06-07T17:32:50Z,2018-06-07T21:06:56Z,2018-06-08T21:05:13Z,CLOSED,False,1,1,1,https://github.com/cmarcelo,clean: use ctime instead of mtime,1,[],https://github.com/clearlinux/swupd-client/pull/473,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/473#issuecomment-395502962,"The ctime will represent the time the files were downloaded, instead
of the mtime generated at build time (which sometimes is the time of
build, but sometimes is not).
Fixes an issue reported by Otavio.",Related to #378 (comment),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,473,2018-06-07T17:32:50Z,2018-06-07T21:06:56Z,2018-06-08T21:05:13Z,CLOSED,False,1,1,1,https://github.com/cmarcelo,clean: use ctime instead of mtime,1,[],https://github.com/clearlinux/swupd-client/pull/473,https://github.com/cmarcelo,3,https://github.com/clearlinux/swupd-client/pull/473#issuecomment-395504214,"The ctime will represent the time the files were downloaded, instead
of the mtime generated at build time (which sometimes is the time of
build, but sometimes is not).
Fixes an issue reported by Otavio.",@otaviobp,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,473,2018-06-07T17:32:50Z,2018-06-07T21:06:56Z,2018-06-08T21:05:13Z,CLOSED,False,1,1,1,https://github.com/cmarcelo,clean: use ctime instead of mtime,1,[],https://github.com/clearlinux/swupd-client/pull/473,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/473#issuecomment-395513154,"The ctime will represent the time the files were downloaded, instead
of the mtime generated at build time (which sometimes is the time of
build, but sometimes is not).
Fixes an issue reported by Otavio.",+1. Works for me,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,474,2018-06-07T17:52:47Z,2018-06-08T17:21:54Z,2018-07-03T20:48:34Z,MERGED,True,11,3,3,https://github.com/otaviobp,Enforce braces on single line ifs in make compliant,2,[],https://github.com/clearlinux/swupd-client/pull/474,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/474,"There's no way to inforce braces on single line ifs using clang-format.
Adding a grep to look for ifs without a bracket so we can at least
warn users about that.","There's no way to inforce braces on single line ifs using clang-format.
Adding a grep to look for ifs without a bracket so we can at least
warn users about that.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,476,2018-06-07T21:27:44Z,2018-06-08T17:37:17Z,2018-06-08T21:05:13Z,MERGED,True,7,16,1,https://github.com/cmarcelo,clean: do not keep content around,1,[],https://github.com/clearlinux/swupd-client/pull/476,https://github.com/cmarcelo,1,https://github.com/clearlinux/swupd-client/pull/476,"Instead of keeping recent content around, just delete all the files,
with exception of the latest relevant Manifests.","Instead of keeping recent content around, just delete all the files,
with exception of the latest relevant Manifests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,476,2018-06-07T21:27:44Z,2018-06-08T17:37:17Z,2018-06-08T21:05:13Z,MERGED,True,7,16,1,https://github.com/cmarcelo,clean: do not keep content around,1,[],https://github.com/clearlinux/swupd-client/pull/476,https://github.com/cmarcelo,2,https://github.com/clearlinux/swupd-client/pull/476#issuecomment-395571063,"Instead of keeping recent content around, just delete all the files,
with exception of the latest relevant Manifests.","Updating swupd clean to follow the discussion in #378.
@otaviobp could you take a look at this one?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,476,2018-06-07T21:27:44Z,2018-06-08T17:37:17Z,2018-06-08T21:05:13Z,MERGED,True,7,16,1,https://github.com/cmarcelo,clean: do not keep content around,1,[],https://github.com/clearlinux/swupd-client/pull/476,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/476#issuecomment-395576335,"Instead of keeping recent content around, just delete all the files,
with exception of the latest relevant Manifests.",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,479,2018-06-09T12:43:59Z,2018-06-12T20:28:04Z,2018-06-12T20:28:04Z,MERGED,True,187,38,48,https://github.com/fenrus75,Optimize bundle-add,10,[],https://github.com/clearlinux/swupd-client/pull/479,https://github.com/fenrus75,1,https://github.com/clearlinux/swupd-client/pull/479,"Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles","Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,479,2018-06-09T12:43:59Z,2018-06-12T20:28:04Z,2018-06-12T20:28:04Z,MERGED,True,187,38,48,https://github.com/fenrus75,Optimize bundle-add,10,[],https://github.com/clearlinux/swupd-client/pull/479,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/479#issuecomment-396289861,"Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles","Fixes #478
I'll look into test failures today.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,479,2018-06-09T12:43:59Z,2018-06-12T20:28:04Z,2018-06-12T20:28:04Z,MERGED,True,187,38,48,https://github.com/fenrus75,Optimize bundle-add,10,[],https://github.com/clearlinux/swupd-client/pull/479,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/479#issuecomment-396326135,"Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles","Ah, many tests are failing due to output-matching for pack downloads. In many cases packs aren't being attempted because they provide less than 5 files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,479,2018-06-09T12:43:59Z,2018-06-12T20:28:04Z,2018-06-12T20:28:04Z,MERGED,True,187,38,48,https://github.com/fenrus75,Optimize bundle-add,10,[],https://github.com/clearlinux/swupd-client/pull/479,https://github.com/icarus-sparry,4,https://github.com/clearlinux/swupd-client/pull/479#issuecomment-396328466,"Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles",Another argument for improving our test tooling.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,479,2018-06-09T12:43:59Z,2018-06-12T20:28:04Z,2018-06-12T20:28:04Z,MERGED,True,187,38,48,https://github.com/fenrus75,Optimize bundle-add,10,[],https://github.com/clearlinux/swupd-client/pull/479,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/479#issuecomment-396708386,"Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles",@matthewrsj One thing I'm worried about with this change is that the pack download and extraction might not being used in any tests. Do we have some tests where the 0-pack is used still?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,479,2018-06-09T12:43:59Z,2018-06-12T20:28:04Z,2018-06-12T20:28:04Z,MERGED,True,187,38,48,https://github.com/fenrus75,Optimize bundle-add,10,[],https://github.com/clearlinux/swupd-client/pull/479,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/479#issuecomment-396708593,"Don't install files that are already present
Don't parse the whole Manifest-tree of all installed manifest unless and until error recovery is required

with these changes a swupd bundle-add git becomes a 416 msec thing of which +/- 200 msec is the sync() and 180 or so msec are the triggers
Raw elapsed time stats:
0.76 ms: Add bundles and recurse
3.28 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
236.81 ms: Installing bundle(s) files onto filesystem
CPU process time stats:
0.75 ms: Add bundles and recurse
3.27 ms: Consolidate files from bundles
0.03 ms: Download packs
0.05 ms: Download missing files
0.35 ms: Installing bundle(s) files onto filesystem
Raw elapsed time stats:
0.00 ms: Prepend bundles to list
416.82 ms: Install bundles
CPU process time stats:
0.00 ms: Prepend bundles to list
4.99 ms: Install bundles","I'll check, and if not I'll add some bundles with more files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,481,2018-06-11T21:50:11Z,2018-06-12T18:29:59Z,2018-07-03T20:48:21Z,MERGED,True,10,7,1,https://github.com/otaviobp,fullfile: Fix double free,1,[],https://github.com/clearlinux/swupd-client/pull/481,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/481,"String that is reused later shoudn't be freed.
Fix double free reported on issue #480","String that is reused later shoudn't be freed.
Fix double free reported on issue #480",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,483,2018-06-11T23:43:31Z,2018-06-12T18:29:36Z,2018-06-12T18:29:39Z,MERGED,True,2,1,1,https://github.com/matthewrsj,Add os-core index to mixin state,1,[],https://github.com/clearlinux/swupd-client/pull/483,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/483,"Mixin re-creates the os-core bundle when creating a local mix. This
causes the corresponding os-core-update-index bundle-info file to have
changes to the metadata listed inside. Treate this as mixin state and do
not check hashes for this file.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Mixin re-creates the os-core bundle when creating a local mix. This
causes the corresponding os-core-update-index bundle-info file to have
changes to the metadata listed inside. Treate this as mixin state and do
not check hashes for this file.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,485,2018-06-12T00:03:56Z,2018-06-13T21:47:37Z,2018-06-13T21:47:37Z,MERGED,True,77,56,25,https://github.com/castulo,Be consistent in bundle-add/bundle-remove error messages,2,[],https://github.com/clearlinux/swupd-client/pull/485,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/485,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,487,2018-06-12T20:55:58Z,2018-06-14T20:04:32Z,2018-07-03T20:48:21Z,MERGED,True,203,79,15,https://github.com/otaviobp,Resume download,5,[],https://github.com/clearlinux/swupd-client/pull/487,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/487,"Resume download isn't working. I found this problem while working on pack downloads.
Also:

Improve the way resume support is detected
use download resume in bundle-add too.","Resume download isn't working. I found this problem while working on pack downloads.
Also:

Improve the way resume support is detected
use download resume in bundle-add too.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,487,2018-06-12T20:55:58Z,2018-06-14T20:04:32Z,2018-07-03T20:48:21Z,MERGED,True,203,79,15,https://github.com/otaviobp,Resume download,5,[],https://github.com/clearlinux/swupd-client/pull/487,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/487#issuecomment-396998562,"Resume download isn't working. I found this problem while working on pack downloads.
Also:

Improve the way resume support is detected
use download resume in bundle-add too.",You have a very simple merge conflict with bundle.c,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,487,2018-06-12T20:55:58Z,2018-06-14T20:04:32Z,2018-07-03T20:48:21Z,MERGED,True,203,79,15,https://github.com/otaviobp,Resume download,5,[],https://github.com/clearlinux/swupd-client/pull/487,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/487#issuecomment-397409560,"Resume download isn't working. I found this problem while working on pack downloads.
Also:

Improve the way resume support is detected
use download resume in bundle-add too.",Branch updated addressing the reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,487,2018-06-12T20:55:58Z,2018-06-14T20:04:32Z,2018-07-03T20:48:21Z,MERGED,True,203,79,15,https://github.com/otaviobp,Resume download,5,[],https://github.com/clearlinux/swupd-client/pull/487,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/487#issuecomment-397421485,"Resume download isn't working. I found this problem while working on pack downloads.
Also:

Improve the way resume support is detected
use download resume in bundle-add too.",thanks @otaviobp,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,488,2018-06-12T21:41:32Z,2018-06-13T16:23:47Z,2018-07-03T20:47:56Z,MERGED,True,14,3,1,https://github.com/otaviobp,bundle-list: Let any user to run swupd bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/488,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/488,"As /usr/share/clear/bundles has read permissions for everyone, we can
let regular users to run ""swupd bundle-list"". If a path_prefix is
informed and the user don't have access to it, it will fail printing
an error message.","As /usr/share/clear/bundles has read permissions for everyone, we can
let regular users to run ""swupd bundle-list"". If a path_prefix is
informed and the user don't have access to it, it will fail printing
an error message.",True,{'HEART': ['https://github.com/mbelluzzo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,492,2018-06-14T21:50:16Z,2018-06-14T22:01:24Z,2018-06-14T22:01:24Z,MERGED,True,20,9,7,https://github.com/otaviobp,Fixing a bunch of memory leaks,6,[],https://github.com/clearlinux/swupd-client/pull/492,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/492,Some people were complaining about memory leaks in swupd. I fixed the ones I found using -fsanitize=address and running the tests.,Some people were complaining about memory leaks in swupd. I fixed the ones I found using -fsanitize=address and running the tests.,True,{'HOORAY': ['https://github.com/lpereira']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,494,2018-06-15T16:43:28Z,2018-06-15T23:32:11Z,2018-06-15T23:32:14Z,MERGED,True,7,5,1,https://github.com/matthewrsj,verify: Ignore mix state when fixing to version,1,[],https://github.com/clearlinux/swupd-client/pull/494,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/494,"The --fix flag is not supported for mixed systems due to special
handling of some os-core files being required, which is not currently
done. Until this is done and mixer state is handled properly ignore any
mixer related state when performing a verify --fix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #493
@bktan8","The --fix flag is not supported for mixed systems due to special
handling of some os-core files being required, which is not currently
done. Until this is done and mixer state is handled properly ignore any
mixer related state when performing a verify --fix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #493
@bktan8",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,494,2018-06-15T16:43:28Z,2018-06-15T23:32:11Z,2018-06-15T23:32:14Z,MERGED,True,7,5,1,https://github.com/matthewrsj,verify: Ignore mix state when fixing to version,1,[],https://github.com/clearlinux/swupd-client/pull/494,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/494#issuecomment-397702126,"The --fix flag is not supported for mixed systems due to special
handling of some os-core files being required, which is not currently
done. Until this is done and mixer state is handled properly ignore any
mixer related state when performing a verify --fix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #493
@bktan8","If content_url == DEFAULT_CONTENTURL the patch will have no effect because the if condition was already true before the patch. So I'm assuming that the problem occurs only when content_url != DEFAULT_CONTENTURL. And for that case:
This will fail:
sudo -E swupd verify --picky -m 23000 -C /usr/share/clear/update-ca/Swupd_Root.pem

And this will work:
sudo -E swupd verify --fix --picky -m 23000 -C /usr/share/clear/update-ca/Swupd_Root.pem

Can you test that?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,494,2018-06-15T16:43:28Z,2018-06-15T23:32:11Z,2018-06-15T23:32:14Z,MERGED,True,7,5,1,https://github.com/matthewrsj,verify: Ignore mix state when fixing to version,1,[],https://github.com/clearlinux/swupd-client/pull/494,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/494#issuecomment-397736960,"The --fix flag is not supported for mixed systems due to special
handling of some os-core files being required, which is not currently
done. Until this is done and mixer state is handled properly ignore any
mixer related state when performing a verify --fix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #493
@bktan8","@otaviobp I'm thinking of going with another approach (slightly) of ignoring mix state when version != get_current_version(NULL), effectively disallowing version-specific verification against local mixes.
This does not, and is not intended to, fix the overall issue of messy mixer integration. We need a way to allow users to get back to upstream and I think this is the fastest way to do it.
There is a larger issue that the mixer state is messy and there are a couple of different indicators for swupd to figure out if it is on a mix or not. This definitely needs to be cleaned up and if you have ideas for a cleaner architecture I'd love to see that proposal.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,494,2018-06-15T16:43:28Z,2018-06-15T23:32:11Z,2018-06-15T23:32:14Z,MERGED,True,7,5,1,https://github.com/matthewrsj,verify: Ignore mix state when fixing to version,1,[],https://github.com/clearlinux/swupd-client/pull/494,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/494#issuecomment-397758715,"The --fix flag is not supported for mixed systems due to special
handling of some os-core files being required, which is not currently
done. Until this is done and mixer state is handled properly ignore any
mixer related state when performing a verify --fix.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #493
@bktan8","I found this approach a lot better then the other one. And it's working for me now.
And +1 for removing the url_comparison.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,495,2018-06-16T04:07:49Z,2018-06-18T23:09:43Z,2018-06-18T23:09:47Z,MERGED,True,36,26,3,https://github.com/matthewrsj,clean: separate into callable function and use in update,1,['enhancement'],https://github.com/clearlinux/swupd-client/pull/495,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/495,"Separate the main statedir clean functionality into a callable function
and call it after performing an update. This helps clean up unused
files that bloat the state directory on a regular basis and helps
prevent the state directory from getting into a weird state over
updates.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #378","Separate the main statedir clean functionality into a callable function
and call it after performing an update. This helps clean up unused
files that bloat the state directory on a regular basis and helps
prevent the state directory from getting into a weird state over
updates.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #378",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,495,2018-06-16T04:07:49Z,2018-06-18T23:09:43Z,2018-06-18T23:09:47Z,MERGED,True,36,26,3,https://github.com/matthewrsj,clean: separate into callable function and use in update,1,['enhancement'],https://github.com/clearlinux/swupd-client/pull/495,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/495#issuecomment-398184496,"Separate the main statedir clean functionality into a callable function
and call it after performing an update. This helps clean up unused
files that bloat the state directory on a regular basis and helps
prevent the state directory from getting into a weird state over
updates.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Fixes #378",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,496,2018-06-16T04:28:42Z,2018-06-18T16:15:02Z,2018-06-18T16:15:06Z,MERGED,True,8,1,1,https://github.com/matthewrsj,delta: improve delta failure message,1,['enhancement'],https://github.com/clearlinux/swupd-client/pull/496,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/496,"When delta application failed due to swupd being unable to calculate the
hash of the from file or a hash-mismatch against what was expected print
an error message that indicates there is a corrupted file.
Fixes #469
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","When delta application failed due to swupd being unable to calculate the
hash of the from file or a hash-mismatch against what was expected print
an error message that indicates there is a corrupted file.
Fixes #469
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,497,2018-06-16T05:02:43Z,2018-06-18T17:50:42Z,2018-06-18T20:23:03Z,MERGED,True,72,1,3,https://github.com/matthewrsj,manpages: add return-code documentation,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/497,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/497,"Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,497,2018-06-16T05:02:43Z,2018-06-18T17:50:42Z,2018-06-18T20:23:03Z,MERGED,True,72,1,3,https://github.com/matthewrsj,manpages: add return-code documentation,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/497,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/497#issuecomment-398134437,"Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",+1. That's a great improvement to the docs,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,497,2018-06-16T05:02:43Z,2018-06-18T17:50:42Z,2018-06-18T20:23:03Z,MERGED,True,72,1,3,https://github.com/matthewrsj,manpages: add return-code documentation,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/497,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/497#issuecomment-398139175,"Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","The file docs/swupd.1 is generated automatically, right? Can't we remove it from the repository, along with the other manpages?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,497,2018-06-16T05:02:43Z,2018-06-18T17:50:42Z,2018-06-18T20:23:03Z,MERGED,True,72,1,3,https://github.com/matthewrsj,manpages: add return-code documentation,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/497,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/497#issuecomment-398139485,"Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Read discussion here: #316,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,497,2018-06-16T05:02:43Z,2018-06-18T17:50:42Z,2018-06-18T20:23:03Z,MERGED,True,72,1,3,https://github.com/matthewrsj,manpages: add return-code documentation,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/497,https://github.com/icarus-sparry,5,https://github.com/clearlinux/swupd-client/pull/497#issuecomment-398139967,"Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Yes it is generated. No you can not remove it, as we do not require people building from scratch to have the tool to do the generation. Ah, I see @matthewrsj beat me to adding the reference.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,497,2018-06-16T05:02:43Z,2018-06-18T17:50:42Z,2018-06-18T20:23:03Z,MERGED,True,72,1,3,https://github.com/matthewrsj,manpages: add return-code documentation,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/497,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/497#issuecomment-398183253,"Additionally remove the unused EPREP_MOUNT error code.
Fixes #296
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",My bad. I didn't know about that discussion. It's ok then,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,501,2018-06-25T20:02:29Z,2018-06-29T15:23:53Z,2018-06-29T15:23:53Z,MERGED,True,53,0,4,https://github.com/evil-brain,Add free space check before adding bundles,1,[],https://github.com/clearlinux/swupd-client/pull/501,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/501,"Prevoiusly, when running bundle-add there was no check in
place to verify free storage before attempting to add the
new bundle.
Added this check, a warning message, and a flag to ignore
the message if desired.
Some functionality from search was moved out and is re-used
for calculating bundle sizes.
related to issue #266
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Prevoiusly, when running bundle-add there was no check in
place to verify free storage before attempting to add the
new bundle.
Added this check, a warning message, and a flag to ignore
the message if desired.
Some functionality from search was moved out and is re-used
for calculating bundle sizes.
related to issue #266
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,501,2018-06-25T20:02:29Z,2018-06-29T15:23:53Z,2018-06-29T15:23:53Z,MERGED,True,53,0,4,https://github.com/evil-brain,Add free space check before adding bundles,1,[],https://github.com/clearlinux/swupd-client/pull/501,https://github.com/evil-brain,2,https://github.com/clearlinux/swupd-client/pull/501#issuecomment-401190350,"Prevoiusly, when running bundle-add there was no check in
place to verify free storage before attempting to add the
new bundle.
Added this check, a warning message, and a flag to ignore
the message if desired.
Some functionality from search was moved out and is re-used
for calculating bundle sizes.
related to issue #266
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","V2 uploaded.
There is an issue with the error handling (beyond just my changes) - jumping to 'out' can still print 'successfully installed bundles'. Should I file a new report? I figured it was kind of out of scope for these changes...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,501,2018-06-25T20:02:29Z,2018-06-29T15:23:53Z,2018-06-29T15:23:53Z,MERGED,True,53,0,4,https://github.com/evil-brain,Add free space check before adding bundles,1,[],https://github.com/clearlinux/swupd-client/pull/501,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/501#issuecomment-401190570,"Prevoiusly, when running bundle-add there was no check in
place to verify free storage before attempting to add the
new bundle.
Added this check, a warning message, and a flag to ignore
the message if desired.
Some functionality from search was moved out and is re-used
for calculating bundle sizes.
related to issue #266
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Should I file a new report?

Yep, and if you know how to fix it assign it to yourself. Otherwise leave open for discussion.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,501,2018-06-25T20:02:29Z,2018-06-29T15:23:53Z,2018-06-29T15:23:53Z,MERGED,True,53,0,4,https://github.com/evil-brain,Add free space check before adding bundles,1,[],https://github.com/clearlinux/swupd-client/pull/501,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/501#issuecomment-401221106,"Prevoiusly, when running bundle-add there was no check in
place to verify free storage before attempting to add the
new bundle.
Added this check, a warning message, and a flag to ignore
the message if desired.
Some functionality from search was moved out and is re-used
for calculating bundle sizes.
related to issue #266
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",+1. Lgtm now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/502,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-400140436,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","This PR is a work in progress but I'd like to receive feedback about it.
Also, the test ""add-multiple"" is failing because is is not installing the bundles correctly, there must still be bugs in the creation of the test environment, but I've been banging my head against the wall trying to resolve them with no luck, so any pointers would also be appreciated.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-400491868,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","I found what the problem was with the new ""add-multiple"" test. The test was adding a couple of bundles, and one of those bundles included this file ""/etc/systemd/file2"", but turns out as part of the heuristics of the bundle install the file was being filtered out in the installation process because it is in a directory that are not considered ""stateless"". I just modified the test to add a file in a directory not filtered.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-401201767,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","@castulo you need to add the bundleadd_v2 tests to the Makefile.am so they are actually run (line 111, alphabetical order).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-401414560,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","@matthewrsj I left the tests in bundleadd_v2 out of the Makefile on purpose for now so they are not run just yet. Those tests are not completely ready, I'm still reworking the check_lines function so all those tests need to have that validation added to them.
Also, my idea is that we no longer need to add each test individually to the Makefile, that seems like a lot of work for something that is not necessary, we can just run something like ""bats /my/dir/with/tests"" and bats should be able to discover all the tests in that path by itself.
Finally, once the tests in bundeladd_v2/ are ready and reviewed to make sure they cover the same as the tests in bundleadd/, then we can remove bundleadd/ and rename bundled_v2/ as bundleadd/.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-404331296,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","@icarus-sparry I'm starting to review this now, but I'd appreciate any comments you have on the bash bits.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-406323843,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","You need to install the realpath dependency to the travis environment:
diff --git a/.travis.yml b/.travis.yml
index 0fe0e4f..7f86f0a 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -24,6 +24,7 @@ install:
         - tar -xvf v3.3.1.tar.gz
         - pushd libarchive-3.3.1 && autoreconf -fi && ./configure --prefix=/usr && make && sudo make install && popd
         - sudo apt-get install python3-docutils
+        - sudo apt-get install realpath
         - sudo ln -s /usr/share/docutils/scripts/python3/rst2man /usr/bin/rst2man.py
 
 # Ubuntu's default umask is 0002, but this break's swupd hash calculations.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-406325613,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","You also need to add this line in the .gitignore
diff --git a/.gitignore b/.gitignore
index b632f70..6d2fc3c 100644
--- a/.gitignore
+++ b/.gitignore
@@ -59,4 +59,5 @@ test/functional/*/*/debug.log
 test/functional/*/*/state
 test/functional/*/*/lines-output
 test/functional/*/*/target-dir/usr/share/clear/bundles/.MoM
+test/functional/*/*.log
 verifytime",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-406328517,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258","Other than that, +1 (travis should pass then).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-407193841,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258",@icarus-sparry you have a pending requested changes review. Has your review been addressed?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,502,2018-06-26T00:37:36Z,2018-07-25T17:52:38Z,2018-07-25T17:52:38Z,MERGED,True,2928,1,41,https://github.com/castulo,Add new test library testlib,9,[],https://github.com/clearlinux/swupd-client/pull/502,https://github.com/matthewrsj,11,https://github.com/clearlinux/swupd-client/pull/502#issuecomment-407840419,"Work In Progress
The old way of creating new tests require a lot of manual steps to
create the test resources needed to run the tests. This commit is
part of a series of commits to improve the workflow for creation of
new tests.
This commit introduces a new test library that aims to replace the
old swupdlib.bash library which provides many funtions to create
new test resources easily.
The following functions were added in this commit:

generate_random_content
generate_random_name
validate_path
validate_item
validate_param
create_dir
create_file
create_link
create_tar
create_manifest
add_to_manifest
create_test_environment
destroy_test_environment
create_bundle
set_env_variables
sign_manifest

The tests in bundleadd_v2 would eventually replace those in bundleadd
Related to issue #258",3... 2... 1... SOLD to the merge god,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,504,2018-06-27T23:12:26Z,2018-07-04T14:03:54Z,2018-07-16T21:44:19Z,MERGED,True,1,1,1,https://github.com/otaviobp,test: Use different ports for tests to avoid colision,1,[],https://github.com/clearlinux/swupd-client/pull/504,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/504,"When running all tests at the same time using make -j check,
update/slow-server and check-update/slow server were trying to start
the slow server at the same port.","When running all tests at the same time using make -j check,
update/slow-server and check-update/slow server were trying to start
the slow server at the same port.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,504,2018-06-27T23:12:26Z,2018-07-04T14:03:54Z,2018-07-16T21:44:19Z,MERGED,True,1,1,1,https://github.com/otaviobp,test: Use different ports for tests to avoid colision,1,[],https://github.com/clearlinux/swupd-client/pull/504,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/504#issuecomment-402299133,"When running all tests at the same time using make -j check,
update/slow-server and check-update/slow server were trying to start
the slow server at the same port.",I closed that by accident.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,504,2018-06-27T23:12:26Z,2018-07-04T14:03:54Z,2018-07-16T21:44:19Z,MERGED,True,1,1,1,https://github.com/otaviobp,test: Use different ports for tests to avoid colision,1,[],https://github.com/clearlinux/swupd-client/pull/504,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/504#issuecomment-402488609,"When running all tests at the same time using make -j check,
update/slow-server and check-update/slow server were trying to start
the slow server at the same port.","So this just ups the range of ports that it tries by 1, so there is still a large overlap of ports that it tries. I guess this is fine though since it solves the issue of trying to start on the same port at the same time. The usual case is the first port will be free.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,507,2018-06-29T16:06:58Z,2018-07-06T23:42:08Z,2018-07-16T21:44:21Z,CLOSED,False,364,221,20,https://github.com/otaviobp,Download,8,[],https://github.com/clearlinux/swupd-client/pull/507,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/507,"Pull request with some fixes and some preparation to the fix of #298.
Please, consider a careful review of ""5322aff: download: remove mutex lock in single thread code"" because I don't know the reason the mutex lock was added to that file and I may have missed something.
Another point I'd like to be carefully reviewed is the ""curl: Set fallback CA paths in swupd_curl_init()"" commit. Is there any reason we needed to check the connection using swupd_curl_check_network() in a moment different from when we called swupd_curl_init()?","Pull request with some fixes and some preparation to the fix of #298.
Please, consider a careful review of ""5322aff: download: remove mutex lock in single thread code"" because I don't know the reason the mutex lock was added to that file and I may have missed something.
Another point I'd like to be carefully reviewed is the ""curl: Set fallback CA paths in swupd_curl_init()"" commit. Is there any reason we needed to check the connection using swupd_curl_check_network() in a moment different from when we called swupd_curl_init()?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,507,2018-06-29T16:06:58Z,2018-07-06T23:42:08Z,2018-07-16T21:44:21Z,CLOSED,False,364,221,20,https://github.com/otaviobp,Download,8,[],https://github.com/clearlinux/swupd-client/pull/507,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/507#issuecomment-401440656,"Pull request with some fixes and some preparation to the fix of #298.
Please, consider a careful review of ""5322aff: download: remove mutex lock in single thread code"" because I don't know the reason the mutex lock was added to that file and I may have missed something.
Another point I'd like to be carefully reviewed is the ""curl: Set fallback CA paths in swupd_curl_init()"" commit. Is there any reason we needed to check the connection using swupd_curl_check_network() in a moment different from when we called swupd_curl_init()?","Please, consider a careful review of ""5322aff: download: remove mutex lock in single thread code"" because I don't know the reason the mutex lock was added to that file and I may have missed something.

You didn't miss anything. This part of the code used to be multithreaded, but it predates the Github git history for the repo. So, removing the mutex locks is safe.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,507,2018-06-29T16:06:58Z,2018-07-06T23:42:08Z,2018-07-16T21:44:21Z,CLOSED,False,364,221,20,https://github.com/otaviobp,Download,8,[],https://github.com/clearlinux/swupd-client/pull/507,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/507#issuecomment-402235716,"Pull request with some fixes and some preparation to the fix of #298.
Please, consider a careful review of ""5322aff: download: remove mutex lock in single thread code"" because I don't know the reason the mutex lock was added to that file and I may have missed something.
Another point I'd like to be carefully reviewed is the ""curl: Set fallback CA paths in swupd_curl_init()"" commit. Is there any reason we needed to check the connection using swupd_curl_check_network() in a moment different from when we called swupd_curl_init()?","On Tue, 2018-07-03 at 08:31 -0700, Matthew Johnson wrote:
 @matthewrsj commented on this pull request.
 curl: Aborting on invalid parameter is a bit too much: +1 on the
 change, but the commit message is confusing. This isn't an invalid
 parameter, this indicates that curl hasn't been initialized (it isn't
 in the parameter list).
My bad. I'll fix the commit message

 
 You are receiving this because you authored the thread.
 Reply to this email directly, view it on GitHub, or mute the thread.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,507,2018-06-29T16:06:58Z,2018-07-06T23:42:08Z,2018-07-16T21:44:21Z,CLOSED,False,364,221,20,https://github.com/otaviobp,Download,8,[],https://github.com/clearlinux/swupd-client/pull/507,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/507#issuecomment-402241069,"Pull request with some fixes and some preparation to the fix of #298.
Please, consider a careful review of ""5322aff: download: remove mutex lock in single thread code"" because I don't know the reason the mutex lock was added to that file and I may have missed something.
Another point I'd like to be carefully reviewed is the ""curl: Set fallback CA paths in swupd_curl_init()"" commit. Is there any reason we needed to check the connection using swupd_curl_check_network() in a moment different from when we called swupd_curl_init()?",Sent new version addressing the suggestions,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,509,2018-06-29T21:06:07Z,2018-06-29T21:23:22Z,2018-10-25T17:04:51Z,MERGED,True,21,0,2,https://github.com/evil-brain,manpage: Add --skip-diskspace-check to bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/509,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/509,"Added a description for the new --skip-diskspace-check flag
to the bundle-add section of the swupd manpage.
Fixes #506
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Added a description for the new --skip-diskspace-check flag
to the bundle-add section of the swupd manpage.
Fixes #506
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,512,2018-07-03T01:15:00Z,2018-07-13T23:27:55Z,2018-07-13T23:27:55Z,MERGED,True,8,1,1,https://github.com/castulo,Fix output message in bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/512,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/512,"There is a bug in bundle-add that causes the wrong output message to
be shown when a bundle fails to be installed due to not being able to
download a file that is part of the bundle.
This commit fixes the logic so messages are shown correctly.
Fixes #511","There is a bug in bundle-add that causes the wrong output message to
be shown when a bundle fails to be installed due to not being able to
download a file that is part of the bundle.
This commit fixes the logic so messages are shown correctly.
Fixes #511",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,512,2018-07-03T01:15:00Z,2018-07-13T23:27:55Z,2018-07-13T23:27:55Z,MERGED,True,8,1,1,https://github.com/castulo,Fix output message in bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/512,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/512#issuecomment-404966957,"There is a bug in bundle-add that causes the wrong output message to
be shown when a bundle fails to be installed due to not being able to
download a file that is part of the bundle.
This commit fixes the logic so messages are shown correctly.
Fixes #511","I ran the following tests in this patch (these tests were created using the new test library, they will be included as soon as the test library is approved and merged):
 bundle-add output: adding one bundle
 bundle-add output: adding multiple bundles
 bundle-add output: adding one bundle that is already added
 bundle-add output: adding one bundle that does not exist
 bundle-add output: adding multiple bundles, all invalid, both non existent
 bundle-add output: adding multiple bundles, all invalid, both already added
 bundle-add output: adding multiple bundles, all invalid, one already added, one invalid
 bundle-add output: adding multiple bundles, one valid, one already added
 bundle-add output: adding multiple bundles, one valid, one non existent
 bundle-add output: adding multiple bundles, one valid, one already added, one non existent
 bundle-add output: adding multiple bundles, one valid, one invalid, one already installed, one with a missing file",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,512,2018-07-03T01:15:00Z,2018-07-13T23:27:55Z,2018-07-13T23:27:55Z,MERGED,True,8,1,1,https://github.com/castulo,Fix output message in bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/512,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/512#issuecomment-404970231,"There is a bug in bundle-add that causes the wrong output message to
be shown when a bundle fails to be installed due to not being able to
download a file that is part of the bundle.
This commit fixes the logic so messages are shown correctly.
Fixes #511","Hmm, actually I just found one scenario where this logic won't work quite well, I'll give it another thought.

Everything good or should I still hold off?",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,512,2018-07-03T01:15:00Z,2018-07-13T23:27:55Z,2018-07-13T23:27:55Z,MERGED,True,8,1,1,https://github.com/castulo,Fix output message in bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/512,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/512#issuecomment-404978315,"There is a bug in bundle-add that causes the wrong output message to
be shown when a bundle fails to be installed due to not being able to
download a file that is part of the bundle.
This commit fixes the logic so messages are shown correctly.
Fixes #511",@matthewrsj everything looks good now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,514,2018-07-05T20:46:12Z,2018-07-10T23:09:18Z,2018-07-10T23:09:19Z,MERGED,True,0,9,2,https://github.com/aaronovz1,Remove dev build version check,2,[],https://github.com/clearlinux/swupd-client/pull/514,https://github.com/aaronovz1,1,https://github.com/clearlinux/swupd-client/pull/514,Fix for #513,Fix for #513,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,514,2018-07-05T20:46:12Z,2018-07-10T23:09:18Z,2018-07-10T23:09:19Z,MERGED,True,0,9,2,https://github.com/aaronovz1,Remove dev build version check,2,[],https://github.com/clearlinux/swupd-client/pull/514,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/514#issuecomment-402852545,Fix for #513,+1 but please rebase and drop the merge commit,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,515,2018-07-06T23:47:31Z,2018-07-13T23:15:43Z,2018-07-16T21:44:16Z,MERGED,True,885,649,51,https://github.com/otaviobp,Parallel downloads,11,[],https://github.com/clearlinux/swupd-client/pull/515,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/515,"Make the parallel downloader generic. Currently still using it only to download fullfiles, but it's ready to be used for any other downloads. Download resumes is still not supported and I added a warning for that.
And sorry for the large commit. I was really hard to think in a way to do this changes in smaller steps.","Make the parallel downloader generic. Currently still using it only to download fullfiles, but it's ready to be used for any other downloads. Download resumes is still not supported and I added a warning for that.
And sorry for the large commit. I was really hard to think in a way to do this changes in smaller steps.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,515,2018-07-06T23:47:31Z,2018-07-13T23:15:43Z,2018-07-16T21:44:16Z,MERGED,True,885,649,51,https://github.com/otaviobp,Parallel downloads,11,[],https://github.com/clearlinux/swupd-client/pull/515,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/515#issuecomment-404213150,"Make the parallel downloader generic. Currently still using it only to download fullfiles, but it's ready to be used for any other downloads. Download resumes is still not supported and I added a warning for that.
And sorry for the large commit. I was really hard to think in a way to do this changes in smaller steps.",Please run make compliant against this branch.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,515,2018-07-06T23:47:31Z,2018-07-13T23:15:43Z,2018-07-16T21:44:16Z,MERGED,True,885,649,51,https://github.com/otaviobp,Parallel downloads,11,[],https://github.com/clearlinux/swupd-client/pull/515,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/515#issuecomment-404331017,"Make the parallel downloader generic. Currently still using it only to download fullfiles, but it's ready to be used for any other downloads. Download resumes is still not supported and I added a warning for that.
And sorry for the large commit. I was really hard to think in a way to do this changes in smaller steps.",just a few comments. For the most part the implementation looks very good. Address or respond to my comments and I'll approve.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,515,2018-07-06T23:47:31Z,2018-07-13T23:15:43Z,2018-07-16T21:44:16Z,MERGED,True,885,649,51,https://github.com/otaviobp,Parallel downloads,11,[],https://github.com/clearlinux/swupd-client/pull/515,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/515#issuecomment-404972610,"Make the parallel downloader generic. Currently still using it only to download fullfiles, but it's ready to be used for any other downloads. Download resumes is still not supported and I added a warning for that.
And sorry for the large commit. I was really hard to think in a way to do this changes in smaller steps.",New version with reported problems fixed and I run make compliant.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,517,2018-07-10T17:38:41Z,2018-07-10T23:08:48Z,2018-07-10T23:08:48Z,MERGED,True,0,7,4,https://github.com/castulo,Removing unnecesary code to untrack bundles,1,[],https://github.com/clearlinux/swupd-client/pull/517,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/517,"Every bundle includes a tracking file which tells the OS the
bundle is installed, every bundle has this tracking file as
part of its manifest. When removing a bundle from a system,
all the files that are part of that bundle, and are not needed,
for any other bundle are removed, including the tracking file.
This patch removes a function call that is intended to remove
the tracking bundle from the system, since it is not necessary,
by the time the code calls that function, all files from the
manifest that can be removed are already removed, and this includes
the tracking file.
This patch also modifies a few tests to reflect the change in the
command output.","Every bundle includes a tracking file which tells the OS the
bundle is installed, every bundle has this tracking file as
part of its manifest. When removing a bundle from a system,
all the files that are part of that bundle, and are not needed,
for any other bundle are removed, including the tracking file.
This patch removes a function call that is intended to remove
the tracking bundle from the system, since it is not necessary,
by the time the code calls that function, all files from the
manifest that can be removed are already removed, and this includes
the tracking file.
This patch also modifies a few tests to reflect the change in the
command output.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,517,2018-07-10T17:38:41Z,2018-07-10T23:08:48Z,2018-07-10T23:08:48Z,MERGED,True,0,7,4,https://github.com/castulo,Removing unnecesary code to untrack bundles,1,[],https://github.com/clearlinux/swupd-client/pull/517,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/517#issuecomment-403939337,"Every bundle includes a tracking file which tells the OS the
bundle is installed, every bundle has this tracking file as
part of its manifest. When removing a bundle from a system,
all the files that are part of that bundle, and are not needed,
for any other bundle are removed, including the tracking file.
This patch removes a function call that is intended to remove
the tracking bundle from the system, since it is not necessary,
by the time the code calls that function, all files from the
manifest that can be removed are already removed, and this includes
the tracking file.
This patch also modifies a few tests to reflect the change in the
command output.",This makes sense to me. +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,518,2018-07-13T17:08:21Z,2018-07-13T23:28:11Z,2018-07-13T23:28:19Z,MERGED,True,117,4,4,https://github.com/matthewrsj,bundle: track manually installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/518,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/518,"Track bundles that the user manually installs by creating a tracking
state file in the state directory at <state_dir>/bundles/<bundle_name>.
Do not track bundles that are added as dependencies (includes) of the
manually-installed bundle.
These tracking files can be used in the future for recursive
bundle-removes and potentially updates that change the includes tree for
a manually installed bundle. Implementing the tracking now so clients
can start to get some history on their systems.
If the <state_dir>/bundles directory is empty or does not exist, copy
the system bundle tracking directory (/usr/share/clear/bundles by
default) wholesale into the state bundle tracking directory. This
provides a baseline for swupd to start tracking future bundle-adds
without making any assumptions about the system state.
Remove the tracking file when the bundle is bundle-removed if that
tracking file exists.
Does not report any errors as future functionality that uses this state
must be very careful about only using the tracking files if

the directory is populated
some base bundles exist (probably just os-core)

Fixes #477
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Track bundles that the user manually installs by creating a tracking
state file in the state directory at <state_dir>/bundles/<bundle_name>.
Do not track bundles that are added as dependencies (includes) of the
manually-installed bundle.
These tracking files can be used in the future for recursive
bundle-removes and potentially updates that change the includes tree for
a manually installed bundle. Implementing the tracking now so clients
can start to get some history on their systems.
If the <state_dir>/bundles directory is empty or does not exist, copy
the system bundle tracking directory (/usr/share/clear/bundles by
default) wholesale into the state bundle tracking directory. This
provides a baseline for swupd to start tracking future bundle-adds
without making any assumptions about the system state.
Remove the tracking file when the bundle is bundle-removed if that
tracking file exists.
Does not report any errors as future functionality that uses this state
must be very careful about only using the tracking files if

the directory is populated
some base bundles exist (probably just os-core)

Fixes #477
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/519,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-404983399,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",+10 for the ignore lines removal. Now we really have to make sure travis passes :),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405289640,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Now we really have to make sure travis passes :)

Shoot",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405661587,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","+1 for the PR, but I would merge the 2 commits in a single one (and wait for successful tests, obviously).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/icarus-sparry,5,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405762281,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","@otaviobp So my current plan is to remove the dummy commit and the revert of it, reorder the 4 remaining patches to move the two which affect the travis.yml file before the two which affect the storing and reporting of the file descriptor leaks. I am happy to squash the latter two together but @matthewrsj liked them apart. Then do a force push of all 4.",True,{'THUMBS_UP': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405973584,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",@icarus-sparry +1 once you do that.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/icarus-sparry,7,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405993064,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","Interesting, the patch order displayed in GH is not the order of the patches I have pushed. The green tick for the checks is on the latest one.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405995544,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com","@icarus-sparry I learned recently that github sorts by author date, not by actual sequence of the commits. ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,519,2018-07-13T20:14:15Z,2018-07-18T19:21:14Z,2018-07-18T20:00:00Z,MERGED,True,83,36,5,https://github.com/icarus-sparry,fix file descriptor leak check.,5,[],https://github.com/clearlinux/swupd-client/pull/519,https://github.com/icarus-sparry,9,https://github.com/clearlinux/swupd-client/pull/519#issuecomment-405999844,"The readlink call was being used inefficiently (it has a lousy api).
Close extra file descriptors that are passed in to us, so we don't
complain if they are open at the end.
Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com",@matthewrsj Thank you. Rewrote all the author dates.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,520,2018-07-13T22:30:04Z,2018-07-13T22:56:20Z,2018-07-13T22:56:23Z,MERGED,True,7,0,1,https://github.com/matthewrsj,autoupdate: print policy warning when disabling,1,[],https://github.com/clearlinux/swupd-client/pull/520,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/520,"It may be a violation of the user's IT policy to disable automatic
updates because of the security implications of an out-of-date system.
Print a warning when the user does this.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","It may be a violation of the user's IT policy to disable automatic
updates because of the security implications of an out-of-date system.
Print a warning when the user does this.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,521,2018-07-14T00:16:33Z,2018-07-14T00:34:19Z,2018-07-16T21:44:14Z,MERGED,True,47,86,11,https://github.com/otaviobp,Aborts and error handling,6,[],https://github.com/clearlinux/swupd-client/pull/521,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/521,"Use strdup_or_die instead of strdup + abort when possible
Adding some aborts() on out of memory errors
Removing unnecessary aborts().
Improve error handling on check_manifests_uniqueness()
Improvements on mk_full_filename()","Use strdup_or_die instead of strdup + abort when possible
Adding some aborts() on out of memory errors
Removing unnecessary aborts().
Improve error handling on check_manifests_uniqueness()
Improvements on mk_full_filename()",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/523,"Using parallel download API do download packs in parallel.
Closes #298","Using parallel download API do download packs in parallel.
Closes #298",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406629966,"Using parallel download API do download packs in parallel.
Closes #298","For enhancements such as this please include some sort of analysis of the performance improvements in the PR itself.
I performed some very limited testing on my system updating from 23820 -> 23830 with the following bundles installed:
ansible            dev-utils-dev  kvm-host           os-core-update-dev     storage-utils-dev
bootloader         editors        libX11client       os-core-update-index*  sudo
c-basic            editors-dev    mail-utils         os-installer           sysadmin-basic
cockpit            emacs          mail-utils-dev     p11-kit                sysadmin-basic-dev
containers-basic   ethtool        mixer              package-utils          sysadmin-remote
desktop            git            network-basic      perl-basic             telemetrics
desktop-apps       go-basic       network-basic-dev  perl-basic-dev         user-basic
desktop-assets     go-basic-dev   openssh-server     python2-basic          vim
desktop-autostart  iproute2       openssl            python3-basic          web-server-basic
desktop-gnomelibs  joe            os-clr-on-clr      python-basic           which
desktop-i3         jq             os-core            redis-native           wpa_supplicant
desktop-locales    kernel-native  os-core-dev        shells                 xemacs
dev-utils          koji           os-core-update     storage-utils

I performed five updates each with the current client and the client from this PR



current
new




18.8s
16.0s


19.8s
17.0s


18.6s
16.8s


22.3s
17.0s


17.7s
16.8s


19.4s avg
16.7s avg



So ~14% speedup from this very limited test. Very nice. Clearly most of the time taken is in the pack extraction phase though.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406632520,"Using parallel download API do download packs in parallel.
Closes #298",This appears to work with mixin integration as well. Thank you very much for ensuring that @otaviobp,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/aaronovz1,4,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406655624,"Using parallel download API do download packs in parallel.
Closes #298",@matthewrsj if pack extraction is a bottleneck would there be benefit in doing them in parallel as well with some kind of async task processor?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406656539,"Using parallel download API do download packs in parallel.
Closes #298","@aaronovz1 pack extraction is actually done via a callback on the download itself, so it should be happening asynchronously already. Correct @otaviobp?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406662535,"Using parallel download API do download packs in parallel.
Closes #298",@aaronovz1 @matthewrsj Downloads are performed in parallel by curl. Extraction are executed in the main thread and are executed one by one. The major reason we see gain in performance is because we keep downloading files while we are extracting a pack,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406662912,"Using parallel download API do download packs in parallel.
Closes #298","The major reason we see gain in performance is because we keep downloading files while we are extracting a pack

Right, I meant asynchronously to pack downloads, not each other.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/aaronovz1,8,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-406677382,"Using parallel download API do download packs in parallel.
Closes #298","The benefit might not outweigh the complexity but it does seem that while you would be downloading multiple files at once, the extraction is still done in series and would benefit from parallel processing. Otherwise you potentially have multiple files downloaded sitting there waiting for extraction. Obviously not something for this PR/ticket but figured it was worth mentioning as a future improvement.",True,{'THUMBS_UP': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-407928322,"Using parallel download API do download packs in parallel.
Closes #298","V2:

not printing warning for pack downloads.
rebased on top of new master and fixing broken tests",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-409619635,"Using parallel download API do download packs in parallel.
Closes #298",With this PR test/functional/update/slow-server took about 5 minutes to complete on my system. What's the reason for that? It wasn't super obvious to me looking at the changes you made to the slow-server code.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,11,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-413253552,"Using parallel download API do download packs in parallel.
Closes #298","I couldn't reproduce this problem in update/slow-server test, but the add-rc test was really taking a really long time because of unnecessary retries.
I improved the commit message explaining some changes I made in slow-server. There's a slow down because of 2 retries that are necessary to check if download resume is working. This slows down the test in 30s, so it shouldn't take 5 minutes to complete. It's taking less than 50s in my machine. All tests are running in around 6~7 minutes.
Can you retry using this new branch?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,12,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-413278720,"Using parallel download API do download packs in parallel.
Closes #298",[offline convo] @otaviobp to skip the long-running test if not in travis environment.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,13,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-413307763,"Using parallel download API do download packs in parallel.
Closes #298",New version. Spiking slow-server test when not in travis,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,14,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-413326712,"Using parallel download API do download packs in parallel.
Closes #298",new version: Fixed proposed change and improved docs.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,15,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-413381665,"Using parallel download API do download packs in parallel.
Closes #298",I'll merge when this gets another +1,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/otaviobp,16,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-414838346,"Using parallel download API do download packs in parallel.
Closes #298",Fixed problems reported (other than the test using old lib) in new version,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,523,2018-07-20T00:25:18Z,2018-08-22T00:04:44Z,2018-08-27T21:22:38Z,MERGED,True,229,77,11,https://github.com/otaviobp,Pack downloads,7,[],https://github.com/clearlinux/swupd-client/pull/523,https://github.com/matthewrsj,17,https://github.com/clearlinux/swupd-client/pull/523#issuecomment-414849365,"Using parallel download API do download packs in parallel.
Closes #298",@evil-brain and @castulo please check that your comments have been addressed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,524,2018-07-22T19:30:59Z,2018-07-23T18:37:07Z,2018-07-23T18:37:16Z,MERGED,True,102,0,1,https://github.com/icarus-sparry,Notes on debugging Travis.,1,[],https://github.com/clearlinux/swupd-client/pull/524,https://github.com/icarus-sparry,1,https://github.com/clearlinux/swupd-client/pull/524,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,Signed-off-by: Icarus Sparry icarus.w.sparry@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/525,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/evil-brain,2,https://github.com/clearlinux/swupd-client/pull/525#issuecomment-407528460,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Also, the return on fail is EBUNDLE_INSTALL - this is ""kind of"" correct, but I couldn't find a better error code to use. Suggestions are welcome!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/525#issuecomment-409620251,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","/me notices you updated this PR.
I may have missed the notification, but just so you know if you force push at all it doesn't notify the watchers of the PR that it was updated. Please comment on your PRs when they need a fresh review.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/evil-brain,4,https://github.com/clearlinux/swupd-client/pull/525#issuecomment-410043666,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Updated the PR, changed the commit message and simplified the flow - pretty concise now and ready for more reviews!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/525#issuecomment-410806123,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","You could factor out that code block into its own function and do some real improvements to code readability. Just hacking at it real quick (no testing!) I came up with this refactor
static void thing(arguments) {
	char *original;
	static bool no_freespace_flag = false;
	string_or_die(&original, ""%s/staged/%s"", state_dir, file->hash);
	fs_free = get_available_space(path_prefix);
	if (fs_free < 0 || stat(original, &st) != 0) {
		fprintf(stderr, ""\tWarning: Unable to determine file size for staged file %s"", original);
		goto out
	}
	if (fs_free < st.st_size * 1.1) {
		fprintf(stderr, ""\tWarning: File to install (%s) too large by %ldK.\n"",
			file->filename, (st.st_size - fs_free) / 1000);
		/* set flag to skip checking space on the second failure, assume we're still out of space */
		no_freespace_flag = true;
	}

out:
	fprintf(stderr, ""\tContinuing with install...\n"");
	free_string(&original);
}
I'm sure this could be optimized even more.
EDIT: looks like I missed one conditional to compare original against fs_free, added it in.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/evil-brain,6,https://github.com/clearlinux/swupd-client/pull/525#issuecomment-411470416,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","V3 is up, with the suggested refactor above. Tested and ready for more review.
Thanks to all for reviewing! This is a great way to learn.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,525,2018-07-24T19:42:28Z,2018-08-15T16:53:08Z,2018-10-25T17:06:54Z,MERGED,True,99,17,5,https://github.com/evil-brain,"verify: When --install is specified, warn on disk full",3,[],https://github.com/clearlinux/swupd-client/pull/525,https://github.com/evil-brain,7,https://github.com/clearlinux/swupd-client/pull/525#issuecomment-412225722,"This change adds some simple space checking on the new 'bundles' to
install when using verify.
This assumes that if you pass --install to verify you intend
to install all bundles to a 'new' folder (no other bundles installed).
This could warn erroneously if there are previously installed bundles or partially
installed bundles, because 'contentsize' could be more than the size
that's actually required to install those files.
Fixes #328
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",V5 is up! Added comments that hopefully make it more obvious what the new code does.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,526,2018-07-24T20:20:28Z,2018-07-25T17:53:07Z,2018-07-25T17:53:28Z,MERGED,True,4,0,1,https://github.com/matthewrsj,manifest: ignore I flag in manifest,1,[],https://github.com/clearlinux/swupd-client/pull/526,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/526,"The 'I' flag will be used to represent iterative manifests once the
feature becomes available. For now we need to ignore this flag so the
feature can be implemented in mixer before implementation here. Before
this patch manifest parsing would fail if it encountered an 'I' flag.
The iterative manifests will be published and included in the
Manifest.MoM before actually being used by client, which is why it is
important to ignore and not fail here.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","The 'I' flag will be used to represent iterative manifests once the
feature becomes available. For now we need to ignore this flag so the
feature can be implemented in mixer before implementation here. Before
this patch manifest parsing would fail if it encountered an 'I' flag.
The iterative manifests will be published and included in the
Manifest.MoM before actually being used by client, which is why it is
important to ignore and not fail here.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,528,2018-07-24T23:44:10Z,2018-07-25T17:59:38Z,2018-07-25T17:59:42Z,MERGED,True,3,3,1,https://github.com/matthewrsj,manifest: use configuration variables not hardcoded strings,1,[],https://github.com/clearlinux/swupd-client/pull/528,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/528,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,Signed-off-by: Matthew Johnson matthew.johnson@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,532,2018-07-25T23:12:47Z,2018-07-26T15:39:26Z,2018-09-10T15:59:50Z,MERGED,True,2,2,1,https://github.com/otaviobp,testlib: Print the output differences using diff -u,1,[],https://github.com/clearlinux/swupd-client/pull/532,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/532,Diff -u is used in previous test library and it has an easier to read output.,Diff -u is used in previous test library and it has an easier to read output.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/533,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.","This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/533#issuecomment-408141197,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.",@evil-brain can you take a look at this please?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/533#issuecomment-411120291,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.",Please comment here when you've fixed that since github doesn't notify for force pushes.,True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/533#issuecomment-411143551,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.","I didn't know that @matthewrsj, I fixed the typo pointed out by @phmccarty",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/533#issuecomment-411160094,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.",Still looks misspelled to me. (you have an extra 'h' after the 'P'),True,{'CONFUSED': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/533#issuecomment-411169693,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.","Damn, I think I got it right this time.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,533,2018-07-25T23:16:29Z,2018-08-07T19:47:52Z,2018-08-07T19:47:52Z,MERGED,True,754,114,42,https://github.com/castulo,Adding new assertions to the test library,2,[],https://github.com/clearlinux/swupd-client/pull/533,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/533#issuecomment-411176468,"This pull request include two parts.

It adds 6 new assertions to the test library:


assert_is_output
assert_is_not_output
assert_regex_is_output
assert_regex_is_not_output
assert_regex_in_output
assert_regex_not_in_output


It migrates the tests from the following categories to use the
new library:


completion
hashdump
mirror
search

Finally this commit changes a few test cases so they use
""assert_is_output"" instead of ""assert_in_output"", that way
we can have a tighter control of the output we want since
assert_is_output requires the whole output to match to a
specific text instead of doing a partial match.",@phmccarty how's it look to you? (requiring 2 official approvals now),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,537,2018-08-15T16:30:54Z,2018-08-15T16:57:39Z,2018-08-27T21:22:39Z,MERGED,True,2,2,1,https://github.com/otaviobp,docs: Fix typo (s/privilged/privileged/),1,[],https://github.com/clearlinux/swupd-client/pull/537,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/537,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,538,2018-08-15T17:59:14Z,2018-08-15T18:49:34Z,2018-08-15T18:49:36Z,MERGED,True,1,306,6,https://github.com/matthewrsj,swupd-add-pkg: remove deprecated script,1,[],https://github.com/clearlinux/swupd-client/pull/538,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/538,"Replaced by mixin in the mixer-tools project.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Replaced by mixin in the mixer-tools project.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,540,2018-08-15T18:31:55Z,2018-08-15T18:49:01Z,2018-08-15T18:49:04Z,MERGED,True,5,1,1,https://github.com/matthewrsj,migrate: read format from file system,1,[],https://github.com/clearlinux/swupd-client/pull/540,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/540,"Fixes #539
To find the latest version in the MIX_STATE_DIR swupd must look under
the correct directory versioned after the format number of the current
system. This is a change to mixer that auto-populates the format to the
system on which it is running if the mixer.state file does not exist.
Since mixer.state is not managed by the user when interacting with mixin
we need to use the format number on the system to find the latest
version. Old mixer behaviour was to default to 1 for the format.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixes #539
To find the latest version in the MIX_STATE_DIR swupd must look under
the correct directory versioned after the format number of the current
system. This is a change to mixer that auto-populates the format to the
system on which it is running if the mixer.state file does not exist.
Since mixer.state is not managed by the user when interacting with mixin
we need to use the format number on the system to find the latest
version. Old mixer behaviour was to default to 1 for the format.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,541,2018-08-15T18:38:53Z,2018-08-15T18:49:17Z,2018-08-15T18:49:21Z,MERGED,True,0,5,1,https://github.com/matthewrsj,version: remove duplicated current_version check,1,[],https://github.com/clearlinux/swupd-client/pull/541,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/541,"This check already occurred a couple lines up.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","This check already occurred a couple lines up.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,542,2018-08-15T19:06:26Z,2018-08-16T00:22:52Z,2018-08-16T00:22:55Z,MERGED,True,0,30,2,https://github.com/matthewrsj,test: remove manpage test,1,[],https://github.com/clearlinux/swupd-client/pull/542,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/542,"This test is unreliable and fails seemingly randomly in our CI.
Restarting our tests always makes the test pass.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Unless someone has an idea why this randomly fails I'd like to just remove it.","This test is unreliable and fails seemingly randomly in our CI.
Restarting our tests always makes the test pass.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Unless someone has an idea why this randomly fails I'd like to just remove it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,542,2018-08-15T19:06:26Z,2018-08-16T00:22:52Z,2018-08-16T00:22:55Z,MERGED,True,0,30,2,https://github.com/matthewrsj,test: remove manpage test,1,[],https://github.com/clearlinux/swupd-client/pull/542,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/542#issuecomment-413322149,"This test is unreliable and fails seemingly randomly in our CI.
Restarting our tests always makes the test pass.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Unless someone has an idea why this randomly fails I'd like to just remove it.",@castulo any idea about this one?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,542,2018-08-15T19:06:26Z,2018-08-16T00:22:52Z,2018-08-16T00:22:55Z,MERGED,True,0,30,2,https://github.com/matthewrsj,test: remove manpage test,1,[],https://github.com/clearlinux/swupd-client/pull/542,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/542#issuecomment-413376974,"This test is unreliable and fails seemingly randomly in our CI.
Restarting our tests always makes the test pass.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com
Unless someone has an idea why this randomly fails I'd like to just remove it.",didn't mean to close...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,543,2018-08-15T20:35:04Z,2018-08-16T00:24:29Z,2018-08-16T00:24:29Z,MERGED,True,267,21,2,https://github.com/castulo,Testlib usability improvements,6,[],https://github.com/clearlinux/swupd-client/pull/543,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/543,"This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).","This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,543,2018-08-15T20:35:04Z,2018-08-16T00:24:29Z,2018-08-16T00:24:29Z,MERGED,True,267,21,2,https://github.com/castulo,Testlib usability improvements,6,[],https://github.com/clearlinux/swupd-client/pull/543,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/543#issuecomment-413348415,"This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).","@otaviobp, thanks for reviewing.  I found the bug I entered with this PR, it is fixed now. Let's see if Travis is happy now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,543,2018-08-15T20:35:04Z,2018-08-16T00:24:29Z,2018-08-16T00:24:29Z,MERGED,True,267,21,2,https://github.com/castulo,Testlib usability improvements,6,[],https://github.com/clearlinux/swupd-client/pull/543,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/543#issuecomment-413348987,"This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).",@castulo what was the issue?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,543,2018-08-15T20:35:04Z,2018-08-16T00:24:29Z,2018-08-16T00:24:29Z,MERGED,True,267,21,2,https://github.com/castulo,Testlib usability improvements,6,[],https://github.com/clearlinux/swupd-client/pull/543,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/543#issuecomment-413351510,"This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).","@matthewrsj , when I was creating the PR I changed this line of code within the write_to_protected_file function:
printf ""$@"" | sudo tee $arg ""$file"" >/dev/null
to look like this:
printf ""%s"" ""$@"" | sudo tee $arg ""$file"" >/dev/null
I did that to follow recommendation SC2059, but turned out in this case it is an exception of the rule because I actually want to interpret data as a format string.
And unfortunately I missed trying to run tests locally before submitting the PR, so I didn't notice this was messing up with the manifest creation.",True,{'THUMBS_UP': ['https://github.com/matthewrsj']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,543,2018-08-15T20:35:04Z,2018-08-16T00:24:29Z,2018-08-16T00:24:29Z,MERGED,True,267,21,2,https://github.com/castulo,Testlib usability improvements,6,[],https://github.com/clearlinux/swupd-client/pull/543,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/543#issuecomment-413363260,"This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).",@matthewrsj I added info about the DEBUG_TEST env variable in the README.md as requested.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,543,2018-08-15T20:35:04Z,2018-08-16T00:24:29Z,2018-08-16T00:24:29Z,MERGED,True,267,21,2,https://github.com/castulo,Testlib usability improvements,6,[],https://github.com/clearlinux/swupd-client/pull/543,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/543#issuecomment-413375937,"This pull request add some usability improvements to the test library.

Print the function stack when the script fails due to missing or bad parameters.
Print information about function usage when executing the function without any parameter in the command line.
Allow users to skip the deletion of a test environment temporarily so they can debug what is wrong with its test, and or to verify the environment is correct as they built it.
Adds two more assertions for validating file equality in tests.

Besides the usability improvements the PR includes a fix for some variables that were being used incorrectly (without the $ character).","@matthewrsj I updated the ""Debugging tests"" section of the README based on your suggestion.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,544,2018-08-16T20:17:30Z,2018-08-20T22:11:20Z,2019-09-16T18:23:19Z,MERGED,True,182,64,15,https://github.com/castulo,Bug fixes and improvements for the test library,16,[],https://github.com/clearlinux/swupd-client/pull/544,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/544,"This pull request includes several bug fixes in the test library and also makes a few improvements in it.
Improvements:

Export some more variables that are useful for some tests.
Improves on how content size is read from a manifest.
Allows adding dependencies to newer versions not only version 10 (default one).
Decrease the file count and content size when removing something from a manifest.
Updates the test template generated by the test generator with a more common output.
Adds usage info in a couple of functions that were missing it.
Adds the capability of creating empty test environment (with no os-core bundle).
Removes an unnecessary directory in the creation of ""default"" bundles.
Adds the capability of using existing files in the test bundles.","This pull request includes several bug fixes in the test library and also makes a few improvements in it.
Improvements:

Export some more variables that are useful for some tests.
Improves on how content size is read from a manifest.
Allows adding dependencies to newer versions not only version 10 (default one).
Decrease the file count and content size when removing something from a manifest.
Updates the test template generated by the test generator with a more common output.
Adds usage info in a couple of functions that were missing it.
Adds the capability of creating empty test environment (with no os-core bundle).
Removes an unnecessary directory in the creation of ""default"" bundles.
Adds the capability of using existing files in the test bundles.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,544,2018-08-16T20:17:30Z,2018-08-20T22:11:20Z,2019-09-16T18:23:19Z,MERGED,True,182,64,15,https://github.com/castulo,Bug fixes and improvements for the test library,16,[],https://github.com/clearlinux/swupd-client/pull/544,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/544#issuecomment-414429222,"This pull request includes several bug fixes in the test library and also makes a few improvements in it.
Improvements:

Export some more variables that are useful for some tests.
Improves on how content size is read from a manifest.
Allows adding dependencies to newer versions not only version 10 (default one).
Decrease the file count and content size when removing something from a manifest.
Updates the test template generated by the test generator with a more common output.
Adds usage info in a couple of functions that were missing it.
Adds the capability of creating empty test environment (with no os-core bundle).
Removes an unnecessary directory in the creation of ""default"" bundles.
Adds the capability of using existing files in the test bundles.",I made the requested changes @matthewrsj,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,544,2018-08-16T20:17:30Z,2018-08-20T22:11:20Z,2019-09-16T18:23:19Z,MERGED,True,182,64,15,https://github.com/castulo,Bug fixes and improvements for the test library,16,[],https://github.com/clearlinux/swupd-client/pull/544,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/544#issuecomment-414456628,"This pull request includes several bug fixes in the test library and also makes a few improvements in it.
Improvements:

Export some more variables that are useful for some tests.
Improves on how content size is read from a manifest.
Allows adding dependencies to newer versions not only version 10 (default one).
Decrease the file count and content size when removing something from a manifest.
Updates the test template generated by the test generator with a more common output.
Adds usage info in a couple of functions that were missing it.
Adds the capability of creating empty test environment (with no os-core bundle).
Removes an unnecessary directory in the creation of ""default"" bundles.
Adds the capability of using existing files in the test bundles.",@evil-brain which one of the its is incorrect in that phrase? both?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,545,2018-08-17T19:32:22Z,2018-08-17T21:18:36Z,2018-08-17T22:01:52Z,MERGED,True,30,0,2,https://github.com/phmccarty,Re-enable manpage tests,2,[],https://github.com/clearlinux/swupd-client/pull/545,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/545,"The manpage tests were recently removed due to occasional test failures that were raised. I spent some time debugging the issue and root caused the issue.
So, I've reverted the commit that the removed the tests and fixed the problem in the second commit.","The manpage tests were recently removed due to occasional test failures that were raised. I spent some time debugging the issue and root caused the issue.
So, I've reverted the commit that the removed the tests and fixed the problem in the second commit.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,545,2018-08-17T19:32:22Z,2018-08-17T21:18:36Z,2018-08-17T22:01:52Z,MERGED,True,30,0,2,https://github.com/phmccarty,Re-enable manpage tests,2,[],https://github.com/clearlinux/swupd-client/pull/545,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/545#issuecomment-413999049,"The manpage tests were recently removed due to occasional test failures that were raised. I spent some time debugging the issue and root caused the issue.
So, I've reverted the commit that the removed the tests and fixed the problem in the second commit.","Great catch!!! It looks like git diff-index doesn't check for mtime in newer versions, but it is checking for that in the version we are using in travis. That's why it was harder to reproduce it in my computer.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/546,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.","Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/546#issuecomment-413991350,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.",You may need to pip install some things in .travis.yml to get the travis tests fixed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/546#issuecomment-413992593,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.",I think it's using Python2 instead of Python3. I'll be more explicit.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/jwakre,4,https://github.com/clearlinux/swupd-client/pull/546#issuecomment-416277936,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.","Since the initial pull request I have made the following changes:

Addressed review feedback
Fixed bug with web server port allocation (now this is done in Python instead of bash)
Added test skipping functionality for new tests when testing locally
Moved certificates, alternative trust store, and port/pid files to /tmp
Fixed bug in curl.c where SSL_CLIENT_CERT was not replaced by client_cert_path
Fixed bash syntax issues that caused failures on Travis",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/546#issuecomment-416358662,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.","One thing I like doing when writing bash scripts is to paste my code in https://www.shellcheck.net

Wow, TIL. Very cool.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/jwakre,6,https://github.com/clearlinux/swupd-client/pull/546#issuecomment-416379386,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.",@castulo All of your feedback should be addressed now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,546,2018-08-17T20:33:10Z,2018-09-05T23:15:04Z,2018-09-20T17:19:15Z,MERGED,True,1111,64,16,https://github.com/jwakre,Use SSL Client Cert when provided,3,[],https://github.com/clearlinux/swupd-client/pull/546,https://github.com/jwakre,7,https://github.com/clearlinux/swupd-client/pull/546#issuecomment-417397081,"Re-opening the client certificate pull request based on @gtkramer's implementation.
In addition to enabling client certificate authentication, this pull request includes client certificate tests and new test objects to help write them.",@otaviobp autogen.sh has been updated to remove --with-fallback-capaths,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,547,2018-08-20T22:31:32Z,2018-08-21T20:21:03Z,2018-08-21T20:21:04Z,MERGED,True,150,20,3,https://github.com/castulo,Adding two more functions to testlib,3,[],https://github.com/clearlinux/swupd-client/pull/547,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/547,"This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.","This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,547,2018-08-20T22:31:32Z,2018-08-21T20:21:03Z,2018-08-21T20:21:04Z,MERGED,True,150,20,3,https://github.com/castulo,Adding two more functions to testlib,3,[],https://github.com/clearlinux/swupd-client/pull/547,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/547#issuecomment-414754594,"This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.",Readme updated @matthewrsj,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,547,2018-08-20T22:31:32Z,2018-08-21T20:21:03Z,2018-08-21T20:21:04Z,MERGED,True,150,20,3,https://github.com/castulo,Adding two more functions to testlib,3,[],https://github.com/clearlinux/swupd-client/pull/547,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/547#issuecomment-414755040,"This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.","oh wait, let me add something else quickly, I remember @evil-brain mentioned this:

castulo, Found another thing that should be in README.am - when using a custom file to create a bundle, the user has to also call create_tar() or their bundle isn't correct...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,547,2018-08-20T22:31:32Z,2018-08-21T20:21:03Z,2018-08-21T20:21:04Z,MERGED,True,150,20,3,https://github.com/castulo,Adding two more functions to testlib,3,[],https://github.com/clearlinux/swupd-client/pull/547,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/547#issuecomment-414756172,"This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.","ok, now is ready",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,547,2018-08-20T22:31:32Z,2018-08-21T20:21:03Z,2018-08-21T20:21:04Z,MERGED,True,150,20,3,https://github.com/castulo,Adding two more functions to testlib,3,[],https://github.com/clearlinux/swupd-client/pull/547,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/547#issuecomment-414804338,"This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.",I'm gonna fix one typo,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,547,2018-08-20T22:31:32Z,2018-08-21T20:21:03Z,2018-08-21T20:21:04Z,MERGED,True,150,20,3,https://github.com/castulo,Adding two more functions to testlib,3,[],https://github.com/clearlinux/swupd-client/pull/547,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/547#issuecomment-414804743,"This commit add the following two functions to testlib which will be used in upcoming PRs:

add_to_pack
update_manifest

Both functions aim to make those actions which are very common in tests in a consistent manner and less error prone.","ok, the typo was fixed",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,548,2018-08-21T20:26:22Z,2018-08-21T21:13:14Z,2018-08-21T21:13:14Z,MERGED,True,130,23,2,https://github.com/castulo,Add function to create new test versions,1,[],https://github.com/clearlinux/swupd-client/pull/548,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/548,"Some tests need to have not only one but two or more versions of
the server side content (web-dir).
This commit adds a function that can be used to create these new
versions.","Some tests need to have not only one but two or more versions of
the server side content (web-dir).
This commit adds a function that can be used to create these new
versions.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,549,2018-08-21T22:12:43Z,2018-08-22T16:49:45Z,2018-08-22T16:49:45Z,MERGED,True,42,5,3,https://github.com/castulo,Ability to create environment with complex bundle,1,[],https://github.com/clearlinux/swupd-client/pull/549,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/549,"Normal test environments come with a minimal version of os-core
bundle by default (only one file and the tracking file). Users
also have the option of not having os-core at all with the -e
""empty"" option.
This commit adds another option ""-r"" for creating a test environment
that includes a more complete version of the os-core bundle,
with a couple of useful files: os-release and format. This type
of bundle can be useful when working with some type of tests like
updates.","Normal test environments come with a minimal version of os-core
bundle by default (only one file and the tracking file). Users
also have the option of not having os-core at all with the -e
""empty"" option.
This commit adds another option ""-r"" for creating a test environment
that includes a more complete version of the os-core bundle,
with a couple of useful files: os-release and format. This type
of bundle can be useful when working with some type of tests like
updates.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,550,2018-08-22T23:47:33Z,2018-08-23T16:45:54Z,2018-08-23T16:45:54Z,MERGED,True,98,54,1,https://github.com/castulo,Testlib partial updates for manifests,2,[],https://github.com/clearlinux/swupd-client/pull/550,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/550,"Some functions from the test library can be used by end users to modify some object from their test environment, for example using the add_dependency_to_manifest they can add one or many dependencies to a bundle's manifest.
After modifying a bundle's manifest, a few subsequent actions need to occur in order for the objects to still be valid, the manifest's tar needs to be re-created, since the manifest's hash has changed, the MoM needs to be updated with this new hash, etc.
To minimize the actions an end user needs to do, most of these activities are automatically performed by most library functions. However if the function is being called by another function which expects to perform many updates to the same object, it may not be the best option to be re-creating those tars and updating the MoM many times for the same object since it could affect the performance.
This PR adds a -p flag to some functions that allow them to run a partial update in a manifest, meaning that you plan on making more changes to the manifest so all those unnecessary changes are not performed.","Some functions from the test library can be used by end users to modify some object from their test environment, for example using the add_dependency_to_manifest they can add one or many dependencies to a bundle's manifest.
After modifying a bundle's manifest, a few subsequent actions need to occur in order for the objects to still be valid, the manifest's tar needs to be re-created, since the manifest's hash has changed, the MoM needs to be updated with this new hash, etc.
To minimize the actions an end user needs to do, most of these activities are automatically performed by most library functions. However if the function is being called by another function which expects to perform many updates to the same object, it may not be the best option to be re-creating those tars and updating the MoM many times for the same object since it could affect the performance.
This PR adds a -p flag to some functions that allow them to run a partial update in a manifest, meaning that you plan on making more changes to the manifest so all those unnecessary changes are not performed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,552,2018-08-23T20:28:52Z,2018-09-06T22:00:11Z,2018-09-06T22:00:11Z,MERGED,True,482,11,2,https://github.com/castulo,Adding functions to update bundles and bump format,5,[],https://github.com/clearlinux/swupd-client/pull/552,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/552,"This PR adds a couple of function which are very useful when working with tests that require multiple update versions of a bundle.

update_bundle: allow users to create different kind of updates for a bundle between two versions in the server side content.
bump_format: automatically creates an increase in the format version used in manifests, this requires two versions to be created with an update is os-core, os-core will update the os-release and format files.","This PR adds a couple of function which are very useful when working with tests that require multiple update versions of a bundle.

update_bundle: allow users to create different kind of updates for a bundle between two versions in the server side content.
bump_format: automatically creates an increase in the format version used in manifests, this requires two versions to be created with an update is os-core, os-core will update the os-release and format files.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,552,2018-08-23T20:28:52Z,2018-09-06T22:00:11Z,2018-09-06T22:00:11Z,MERGED,True,482,11,2,https://github.com/castulo,Adding functions to update bundles and bump format,5,[],https://github.com/clearlinux/swupd-client/pull/552,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/552#issuecomment-415854788,"This PR adds a couple of function which are very useful when working with tests that require multiple update versions of a bundle.

update_bundle: allow users to create different kind of updates for a bundle between two versions in the server side content.
bump_format: automatically creates an increase in the format version used in manifests, this requires two versions to be created with an update is os-core, os-core will update the os-release and format files.","I'm thinking it may be a good idea to add some info about these two functions into the readme, I'll push another commit to this PR with that update",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,552,2018-08-23T20:28:52Z,2018-09-06T22:00:11Z,2018-09-06T22:00:11Z,MERGED,True,482,11,2,https://github.com/castulo,Adding functions to update bundles and bump format,5,[],https://github.com/clearlinux/swupd-client/pull/552,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/552#issuecomment-419242535,"This PR adds a couple of function which are very useful when working with tests that require multiple update versions of a bundle.

update_bundle: allow users to create different kind of updates for a bundle between two versions in the server side content.
bump_format: automatically creates an increase in the format version used in manifests, this requires two versions to be created with an update is os-core, os-core will update the os-release and format files.","@phmccarty I think I addressed all your requests with the latest patch, please let me know if I missed something or if you have further requests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,553,2018-08-23T22:35:10Z,2018-08-24T22:53:18Z,2018-08-27T21:22:36Z,MERGED,True,81,47,11,https://github.com/otaviobp,Improvements in swupd_init,5,[],https://github.com/clearlinux/swupd-client/pull/553,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/553,"some clean up in swupd_init and swupd_deinit
Don't use curl on swupd-clean command (fixes #551)","some clean up in swupd_init and swupd_deinit
Don't use curl on swupd-clean command (fixes #551)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,553,2018-08-23T22:35:10Z,2018-08-24T22:53:18Z,2018-08-27T21:22:36Z,MERGED,True,81,47,11,https://github.com/otaviobp,Improvements in swupd_init,5,[],https://github.com/clearlinux/swupd-client/pull/553,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/553#issuecomment-415823165,"some clean up in swupd_init and swupd_deinit
Don't use curl on swupd-clean command (fixes #551)",problems fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,553,2018-08-23T22:35:10Z,2018-08-24T22:53:18Z,2018-08-27T21:22:36Z,MERGED,True,81,47,11,https://github.com/otaviobp,Improvements in swupd_init,5,[],https://github.com/clearlinux/swupd-client/pull/553,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/553#issuecomment-415885343,"some clean up in swupd_init and swupd_deinit
Don't use curl on swupd-clean command (fixes #551)",I sent a fix for the indent that @castulo commented (github hid the message),True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,554,2018-08-23T22:44:34Z,2018-08-24T18:15:42Z,2018-08-27T21:22:38Z,MERGED,True,12,12,12,https://github.com/otaviobp,Fixing typos and orthography errors on docs and codebase,1,[],https://github.com/clearlinux/swupd-client/pull/554,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/554,Errors reported by codespell (https://github.com/codespell-project/codespell),Errors reported by codespell (https://github.com/codespell-project/codespell),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,555,2018-08-24T18:12:10Z,2018-08-24T18:25:31Z,2018-08-27T21:22:37Z,MERGED,True,5,3,1,https://github.com/otaviobp,Travis improvements,3,[],https://github.com/clearlinux/swupd-client/pull/555,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/555,"Add make compliant to travis-ci
Add address sanitizer to travis-ci","Add make compliant to travis-ci
Add address sanitizer to travis-ci",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,559,2018-08-29T19:40:45Z,2018-09-04T19:43:16Z,2018-09-04T19:43:16Z,MERGED,True,11,3,1,https://github.com/vcgomes,search: Allocate the filename for each result dinamically,1,[],https://github.com/clearlinux/swupd-client/pull/559,https://github.com/vcgomes,1,https://github.com/clearlinux/swupd-client/pull/559,"Instead of reserving PATH_MAX bytes for the filename (of each result),
allocate it dinamically. This should use less memory overall, at the
cost of making more small allocations.","Instead of reserving PATH_MAX bytes for the filename (of each result),
allocate it dinamically. This should use less memory overall, at the
cost of making more small allocations.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,560,2018-08-30T22:23:11Z,2018-09-07T22:51:21Z,2018-09-10T15:59:37Z,MERGED,True,48,103,18,https://github.com/otaviobp,Memory,2,[],https://github.com/clearlinux/swupd-client/pull/560,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/560,"@vcgomes has reported on #559 that swupd wasn't consistent on handling return value from callocs, mallocs and reallocs.
One possible solution was to create functions calloc_or_die, malloc_or_die and realloc_or_die, but I preferred to create a macro to check for NULL and abort. Any opinions about that?","@vcgomes has reported on #559 that swupd wasn't consistent on handling return value from callocs, mallocs and reallocs.
One possible solution was to create functions calloc_or_die, malloc_or_die and realloc_or_die, but I preferred to create a macro to check for NULL and abort. Any opinions about that?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,560,2018-08-30T22:23:11Z,2018-09-07T22:51:21Z,2018-09-10T15:59:37Z,MERGED,True,48,103,18,https://github.com/otaviobp,Memory,2,[],https://github.com/clearlinux/swupd-client/pull/560,https://github.com/tmarcu,2,https://github.com/clearlinux/swupd-client/pull/560#issuecomment-418549985,"@vcgomes has reported on #559 that swupd wasn't consistent on handling return value from callocs, mallocs and reallocs.
One possible solution was to create functions calloc_or_die, malloc_or_die and realloc_or_die, but I preferred to create a macro to check for NULL and abort. Any opinions about that?","Looks fine to me using a macro once this is rebased. There are cases you may not catch because all of those functions can still return valid pointers on weird allocations, i.e 0 sized allocs, etc, but likely won't even be the case for swupd.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,560,2018-08-30T22:23:11Z,2018-09-07T22:51:21Z,2018-09-10T15:59:37Z,MERGED,True,48,103,18,https://github.com/otaviobp,Memory,2,[],https://github.com/clearlinux/swupd-client/pull/560,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/560#issuecomment-419269704,"@vcgomes has reported on #559 that swupd wasn't consistent on handling return value from callocs, mallocs and reallocs.
One possible solution was to create functions calloc_or_die, malloc_or_die and realloc_or_die, but I preferred to create a macro to check for NULL and abort. Any opinions about that?",needs a rebase,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,560,2018-08-30T22:23:11Z,2018-09-07T22:51:21Z,2018-09-10T15:59:37Z,MERGED,True,48,103,18,https://github.com/otaviobp,Memory,2,[],https://github.com/clearlinux/swupd-client/pull/560,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/560#issuecomment-419506792,"@vcgomes has reported on #559 that swupd wasn't consistent on handling return value from callocs, mallocs and reallocs.
One possible solution was to create functions calloc_or_die, malloc_or_die and realloc_or_die, but I preferred to create a macro to check for NULL and abort. Any opinions about that?",rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,563,2018-09-07T21:32:59Z,2018-09-11T22:08:22Z,2018-09-11T22:08:22Z,MERGED,True,80,23,1,https://github.com/castulo,Add iterative manifest to bundle update in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/563,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/563,"This commit adds the iterative manifests (to-manifest and from-manifest)
when creating a bundle update. This manifests should contain only those
files that changed in the latest version.
Closes issue #557","This commit adds the iterative manifests (to-manifest and from-manifest)
when creating a bundle update. This manifests should contain only those
files that changed in the latest version.
Closes issue #557",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,563,2018-09-07T21:32:59Z,2018-09-11T22:08:22Z,2018-09-11T22:08:22Z,MERGED,True,80,23,1,https://github.com/castulo,Add iterative manifest to bundle update in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/563,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/563#issuecomment-420099347,"This commit adds the iterative manifests (to-manifest and from-manifest)
when creating a bundle update. This manifests should contain only those
files that changed in the latest version.
Closes issue #557","@phmccarty , @jwakre , I believe I addressed your comments. Please let me know if I'm missing something, or if you have further comments.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,563,2018-09-07T21:32:59Z,2018-09-11T22:08:22Z,2018-09-11T22:08:22Z,MERGED,True,80,23,1,https://github.com/castulo,Add iterative manifest to bundle update in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/563,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/563#issuecomment-420421783,"This commit adds the iterative manifests (to-manifest and from-manifest)
when creating a bundle update. This manifests should contain only those
files that changed in the latest version.
Closes issue #557",@jwakre I added the delta manifest inside a <to_version> directory within the delta pack as you pointed out. Let me know if there is something else needed. Thanks for the review.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,564,2018-09-10T22:22:15Z,2018-09-11T21:27:12Z,2018-11-01T18:01:21Z,MERGED,True,69,20,11,https://github.com/otaviobp,Parallel,4,[],https://github.com/clearlinux/swupd-client/pull/564,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/564,"Fixes in parallel download and workaround to avoid bug #562.
@gtkramer: This PR fixes the bug you reported. Can you check if this version is working for you?","Fixes in parallel download and workaround to avoid bug #562.
@gtkramer: This PR fixes the bug you reported. Can you check if this version is working for you?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,564,2018-09-10T22:22:15Z,2018-09-11T21:27:12Z,2018-11-01T18:01:21Z,MERGED,True,69,20,11,https://github.com/otaviobp,Parallel,4,[],https://github.com/clearlinux/swupd-client/pull/564,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/564#issuecomment-420101065,"Fixes in parallel download and workaround to avoid bug #562.
@gtkramer: This PR fixes the bug you reported. Can you check if this version is working for you?","v2:

Removed whitespaces after '='
Added comment on MAX_XFER change",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/565,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-421134202,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Tests still need to be added to this PR, but everything else should be now finished, so feel free to review the code. I'll add the missing tests soon.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-421170820,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","I just added a couple things that were needed for being able to test updates with iterative manifests:

A --keepcache option for swupd update so the state directory is persisted after an update, which will be useful for tests to verify what manifests were actually downloaded during the update.
Enabled some testlib assertions (like assert_file_exists) to read root owned files since the state directory is not readable for non root users.

Now we just need the tests... those will be submitted shortly.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-421192604,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Well, looks like it is ready. I'd appreciate reviews.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-421194956,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Looks like I spoke too soon, the new tests are failing, apparently there is a memory leak.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-421404202,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",Make sure you are passing the same configuration options at build time as travis does when you test locally.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-422174918,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",I added a couple of options to travis (travis.yml) temporarily only for debugging purposes. I'll remove those once I have fixed the memory leak problem.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-422194576,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",@matthewrsj @otaviobp now that all tests are passing looks like the PR is finally ready to be reviewed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,9,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-422196116,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",I had to push again to add the Signed-off-by to the commits.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/otaviobp,10,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-423264277,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","I performed some tests with this branch to check if it's working with real mixer data.
I installed os-clr-on-clr and desktop in a clearlinux installation and:

Updated from 25070 to 25090 using the current content to make sure full Manifests will be used.


No problem


Updated from 10 (25070) to 20 (25080) using a content generated using mixer with both IManifest and DManifest support:


I found a bug in IManifest implementation on mixer. We aren't creating Manifest tarballs. I'll fix that. I created the manifests with a script to continue the test.
swupd is downloading full manifests in 
  
    
      swupd-client/src/update.c
    
    
         Line 406
      in
      4ed1ce7
    
  
  
    

        
          
           ret = add_included_manifests(server_manifest, current_version, &latest_subs); 
        
    
  


With a workaround on that line, the update was successful using your branch and only IManifests were downloaded. If IManifests are missing, full Manifests are downloaded.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,11,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-423282280,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","I performed some tests with this branch to check if it's working with real mixer data.
I installed os-clr-on-clr and desktop in a clearlinux installation and:

Updated from 25070 to 25090 using the current content to make sure full Manifests will be used.


No problem


Updated from 10 (25070) to 20 (25080) using a content generated using mixer with both IManifest and DManifest support:



I found a bug in IManifest implementation on mixer. We aren't creating Manifest tarballs. I'll fix that. I created the manifests with a script to continue the test.


swupd is downloading full manifests in
  [swupd-client/src/update.c](https://github.com/clearlinux/swupd-client/blob/4ed1ce7009066d556b4e2ae1c9734f966e54fe05/src/update.c#L406)


     Line 406
  in
  [4ed1ce7](/clearlinux/swupd-client/commit/4ed1ce7009066d556b4e2ae1c9734f966e54fe05)





    
      
       ret = add_included_manifests(server_manifest, current_version, &latest_subs);



With a workaround on that line, the update was successful using your branch and only IManifests were downloaded. If IManifests are missing, full Manifests are downloaded.



Hmm, are you sure it is downloading the full manifest of bundles that had a valid iterative manifest?
server_manifest.manifests at that point only contains the iterative manifests (for those bundles that had a valid one), plus full manifests for bundles that didn't, so when looking for the bundle in the Mom it will find the iterative manifest. I don't see why it would get the full manifest (unless the iterative was not there or was invalid, for example from a ""from version"" that didn't match).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/otaviobp,12,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-423312334,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","My bad. The server side was incorrect when I tested that.
I re tested all cases and this branch is working fine for all of them.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,13,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-423350523,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Since the PR that removes all the old tests is already in review #580, and that PR deletes the old update/ directory and renames update_v2/ to update/, I made a change in this PR so the tests for the iterative manifest go straight to the update directory instead of the update_v2 directory so we don't have to submit another patch to move them later.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/matthewrsj,14,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-424118257,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Just a couple questions, otherwise this looks very good.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/matthewrsj,15,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-424440876,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Ok, there's something I think this PR is missing:
If a bundle is added as an include to an already-tracked bundle in the OS version the client is updating to the client needs to download the full to manifest for the new bundle instead of the iterative manifest, regardless of update versions. This is because on the client will need to add several files that were changed in versions older than the client OS version since it is a new bundle.
So you need to do some extra work to ensure that if a bundle is new to the system it will download a full manifest and will not attempt to download the iterative manifest.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/matthewrsj,16,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-424449426,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",@castulo  also will need a test for that scenario ^,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,17,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-424492859,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","@matthewrsj you are right in your comment above, the PR was in fact missing that. But the updated version it now covers it, and already includes a test case for that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,18,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-425581474,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","@otaviobp @matthewrsj @jwakre , the PR is again ready to be reviewed. I think I have addressed all your comments.
To make it easier to review, these are the steps followed by the update:

Loads the current MoM, it loads only the full manifests contained in the MoM.
Loads the server MoM, it loads all manifests (iterative and full) contained in the MoM.
Consolidate the list of manifests in the server MoM to remove duplicated manifests, so there is only one manifest per bundle. If there is an iterative manifest for a bundle, and the bundle is already installed, and the iterative manifest is from the correct ""from"" version, it keeps that iterative manifest in the consolidated list and drops the full manifest. If no valid iterative manifest is found, it saves the full manifest in the list instead.
Link all the iterative manifests with its related full manifest using its full_manifest member.
Create a new subscription list (update_subs) that contains only the subscribed bundles that need to be updated.
Add all the included bundles to that list of subscriptions, so the list now have all the subscribed bundles that need to be updated plus all the unsubscribed bundles that need to be installed (if any).
Filter the list of manifests in the current MoM using the update_subs list so we only keep the from manifests that will be used for the update.
Filter the list of manifests in the server MoM using the update_subs list so we only keep the to manifests that will be used for the update.
Download the from and to manifests based on the new lists that only contain the bundles to be updated and/or added. If an iterative manifest fails to be downloaded, the full manifest is downloaded instead.
The rest of the update process remains unchanged...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/otaviobp,19,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426459715,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","Github hid my comment, so I'm pasting it here
> + * - full_manifests: this list will contain all the full manifests that were in the manifests list
+ * - iterative_manifests: this list will contain all the valid iterative manifests from the manifests
+ *   list, plus the full manifest of those bundles that didn't have a valid iterative manifest
+ *   A valid iterative manifest is one that can be used during an update, meaning that the iterative
+ *   manifest must match the ""from version"" provided, and that it belongs to an already installed bundle*/
+void filter_iterative_manifests(struct list *manifests, int version, struct list **full_manifests, struct list **iterative_manifests)
+{
+	/* Split the manifests into ""iterative manifests"" and ""full manifests"" */
+	struct list *list;
+	struct file *file;
+
+	for (list = manifests; list; list = list->next) {
+		file = list->data;
+		/* Keep only iterative manifests that are from the specified version and that are
+		 * already installed */
+		if (file->is_iterative == 1 && file->from_version == version  && is_tracked_bundle(file->bundlename)) {

I have the feeling we can use file->from_version <= version
If we are updating from 20 to 30 and we have Manifest.bundle.I.10 it means there was no change in bundle between 10 and 30. So we can use it. @matthewrsj is there any corner case where this isn't valid?
But if we are updating from 10 to 30 and there is a Manifest.bundle.I.20 we can't use it, because we will miss files updated from 10 to 20.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,20,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426463300,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","I have the feeling we can use file->from_version <= version
If we are updating from 20 to 30 and we have Manifest.bundle.I.10 it means there was no change in bundle between 10 and 30. So we can use it. @matthewrsj is there any corner case where this isn't valid?
But if we are updating from 10 to 30 and there is a Manifest.bundle.I.20 we can't use it, because we will miss files updated from 10 to 20.

@otaviobp, but if we are updating from 20 to 30 we don't really need Manifest.bundle.I.10 because that was updated in a previous version. That should have been already updated when going from v10 to v20.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/otaviobp,21,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426471841,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","This makes sense. ahhahahaha.
But in this case if this bundle is included by another bundle won't the full Manifest be downloaded because of the add_included_manifests()?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,22,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426473518,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","This makes sense. ahhahahaha.
But in this case if this bundle is included by another bundle won't the full Manifest be downloaded because of the add_included_manifests()?

If bundleA is included by bundleB, and bundleA is installed, and bundleA has a valid iterative manifest, the iterative manifest will be used to update bundleA.
If bundleA is  included by bundleB, and bundleA is not currently installed then the full manifest will be used regardless of what iterative manifests are available for that bundle.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/otaviobp,23,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426771936,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","@otaviobp, but if we are updating from 20 to 30 we don't really need Manifest.bundle.I.10 because that was updated in a previous version. That should have been already updated when going from v10 to v20.

but in this case we are downloading the full manifest. We don't need any information about this manifest? consolidate_manifests() is adding that to the consolidated_manifests",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/jwakre,24,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426807316,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","@otaviobp, but if we are updating from 20 to 30 we don't really need Manifest.bundle.I.10 because that was updated in a previous version. That should have been already updated when going from v10 to v20.

but in this case we are downloading the full manifest. We don't need any information about this manifest? consolidate_manifests() is adding that to the consolidated_manifests

If I understand things correctly, not every manifest in the consolidated_manifests list is downloaded. The 'filter_update_manifests' function creates 'server_manifest_updates' which is a subset of consolidated_manifests that contains manifests that will be downloaded.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,25,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426809269,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","If I understand things correctly, not every manifest in the consolidated_manifests list is downloaded. The 'filter_update_manifests' function creates 'server_manifest_updates' which is a subset of consolidated_manifests that contains manifests that will be downloaded.

Correct",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,26,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426810791,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558","@otaviobp I tried the following scenario:

Create bundleA in version 10 and install it.
Create a version 20 (with no updates)
Create a version 30 (with no updates)
Create a version 40 with an update for bundleA
set the current version of the target system to 20
run an update

Result: the full manifest for bundleA was used
Expected result: the iterative manifest should be used
I think you are probably right that this is caused because of this if within the consolidate_manifests function:
if (file->is_iterative == 1 && file->from_version == version && is_tracked_bundle(file->bundlename)) {
	*consolidated_manifests = list_prepend_data(*consolidated_manifests, file);
} else if (file->is_iterative != 1) {
	full_manifests = list_prepend_data(full_manifests, file);
}",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,565,2018-09-11T00:54:56Z,2018-10-03T22:52:26Z,2018-10-03T23:01:50Z,MERGED,True,816,60,19,https://github.com/castulo,Iterative manifest,8,[],https://github.com/clearlinux/swupd-client/pull/565,https://github.com/castulo,27,https://github.com/clearlinux/swupd-client/pull/565#issuecomment-426823039,"This PR enables the use of an iterative to manifest in swupd client, which only contains the things that need to be updated, therefore reducing the download time, the amount of memory needed to load that manifest and the processing time for parsing it.
Closes #558",I fixed the issue you mentioned @otaviobp and added one more test to make sure we don't regress.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,566,2018-09-12T23:20:58Z,2018-09-13T17:48:32Z,2018-09-13T17:48:32Z,MERGED,True,8,7,3,https://github.com/castulo,Return error if adding subscriptions fails,1,[],https://github.com/clearlinux/swupd-client/pull/566,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/566,"When adding included manifests during an update the add_subscriptions
function is used, this function returns a value of either add_sub_ERR=1,
or add_sub_BADNAME=4 when it fails to add a subscription, and the code
is currently considering any value > 0 to be a successful value.
This commit fixes the issue by making sure the add_subscriptions
function doesn't return a code of 1 or 4 which would mean it failed
adding a subscription.","When adding included manifests during an update the add_subscriptions
function is used, this function returns a value of either add_sub_ERR=1,
or add_sub_BADNAME=4 when it fails to add a subscription, and the code
is currently considering any value > 0 to be a successful value.
This commit fixes the issue by making sure the add_subscriptions
function doesn't return a code of 1 or 4 which would mean it failed
adding a subscription.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,566,2018-09-12T23:20:58Z,2018-09-13T17:48:32Z,2018-09-13T17:48:32Z,MERGED,True,8,7,3,https://github.com/castulo,Return error if adding subscriptions fails,1,[],https://github.com/clearlinux/swupd-client/pull/566,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/566#issuecomment-421047770,"When adding included manifests during an update the add_subscriptions
function is used, this function returns a value of either add_sub_ERR=1,
or add_sub_BADNAME=4 when it fails to add a subscription, and the code
is currently considering any value > 0 to be a successful value.
This commit fixes the issue by making sure the add_subscriptions
function doesn't return a code of 1 or 4 which would mean it failed
adding a subscription.",In the commit message s/successfull/successful/ (drop the second 'l'),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,566,2018-09-12T23:20:58Z,2018-09-13T17:48:32Z,2018-09-13T17:48:32Z,MERGED,True,8,7,3,https://github.com/castulo,Return error if adding subscriptions fails,1,[],https://github.com/clearlinux/swupd-client/pull/566,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/566#issuecomment-421075551,"When adding included manifests during an update the add_subscriptions
function is used, this function returns a value of either add_sub_ERR=1,
or add_sub_BADNAME=4 when it fails to add a subscription, and the code
is currently considering any value > 0 to be a successful value.
This commit fixes the issue by making sure the add_subscriptions
function doesn't return a code of 1 or 4 which would mean it failed
adding a subscription.",I just updated the commit message.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,567,2018-09-13T17:51:18Z,2018-09-27T16:34:10Z,2018-11-01T18:01:20Z,CLOSED,False,200,208,24,https://github.com/otaviobp,Group generic libraries in the same dir and add propose some changes to list implementation,4,[],https://github.com/clearlinux/swupd-client/pull/567,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/567,"As we are working on a Thread Pool for swupd, we thought about having all generic libraries (list, hashmap and ThreadPool) isolated in a single directory to distinguish them from swupd code.
When I was moving this code I decided to take some time to suggest some improvements in the current List API.","As we are working on a Thread Pool for swupd, we thought about having all generic libraries (list, hashmap and ThreadPool) isolated in a single directory to distinguish them from swupd code.
When I was moving this code I decided to take some time to suggest some improvements in the current List API.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,567,2018-09-13T17:51:18Z,2018-09-27T16:34:10Z,2018-11-01T18:01:20Z,CLOSED,False,200,208,24,https://github.com/otaviobp,Group generic libraries in the same dir and add propose some changes to list implementation,4,[],https://github.com/clearlinux/swupd-client/pull/567,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/567#issuecomment-421158282,"As we are working on a Thread Pool for swupd, we thought about having all generic libraries (list, hashmap and ThreadPool) isolated in a single directory to distinguish them from swupd code.
When I was moving this code I decided to take some time to suggest some improvements in the current List API.",Should we just move to use glibc lists instead of updating our custom implementation? http://man7.org/linux/man-pages/man3/queue.3.html,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,567,2018-09-13T17:51:18Z,2018-09-27T16:34:10Z,2018-11-01T18:01:20Z,CLOSED,False,200,208,24,https://github.com/otaviobp,Group generic libraries in the same dir and add propose some changes to list implementation,4,[],https://github.com/clearlinux/swupd-client/pull/567,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/567#issuecomment-421162024,"As we are working on a Thread Pool for swupd, we thought about having all generic libraries (list, hashmap and ThreadPool) isolated in a single directory to distinguish them from swupd code.
When I was moving this code I decided to take some time to suggest some improvements in the current List API.",It looks like a better idea. I'll take a look at  them,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,567,2018-09-13T17:51:18Z,2018-09-27T16:34:10Z,2018-11-01T18:01:20Z,CLOSED,False,200,208,24,https://github.com/otaviobp,Group generic libraries in the same dir and add propose some changes to list implementation,4,[],https://github.com/clearlinux/swupd-client/pull/567,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/567#issuecomment-421403835,"As we are working on a Thread Pool for swupd, we thought about having all generic libraries (list, hashmap and ThreadPool) isolated in a single directory to distinguish them from swupd code.
When I was moving this code I decided to take some time to suggest some improvements in the current List API.",+1 for the first commit though.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,567,2018-09-13T17:51:18Z,2018-09-27T16:34:10Z,2018-11-01T18:01:20Z,CLOSED,False,200,208,24,https://github.com/otaviobp,Group generic libraries in the same dir and add propose some changes to list implementation,4,[],https://github.com/clearlinux/swupd-client/pull/567,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/567#issuecomment-425159331,"As we are working on a Thread Pool for swupd, we thought about having all generic libraries (list, hashmap and ThreadPool) isolated in a single directory to distinguish them from swupd code.
When I was moving this code I decided to take some time to suggest some improvements in the current List API.",The first commit of this message will be included in the thread pool pull request and I'll move the discussion of the glibc list to some time in the future. So I'm closing this pull request,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,569,2018-09-13T20:32:33Z,2018-09-13T21:11:04Z,2018-11-01T18:01:19Z,MERGED,True,4,1,1,https://github.com/otaviobp,swupd.bash: Add autocomeplete for mirror command,1,[],https://github.com/clearlinux/swupd-client/pull/569,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/569,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/574,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-423640183,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@otaviobp @phmccarty addressed comments.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,3,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426017180,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Ha, I just noticed we have a bundle called bc which has an associated manifest called Manifest.bc which is identified as a hashed manifest...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426017748,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","we would have the same problem with a Manifest.deadbeef, Manifest.deadcafe, Manifest.feedface etc.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/phmccarty,5,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426020437,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Perhaps you could check for the expected number of hex digits instead?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426020656,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","That's an idea, I was going to count the number of .s but maybe that's better...",True,{'THUMBS_UP': ['https://github.com/phmccarty']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426021861,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",Actually going with my approach because 1) dots are not allowed in bundle names and 2) someone could have a very long bundle name that is all valid hex xD (deadbeefcafeface....),True,"{'THUMBS_UP': ['https://github.com/otaviobp', 'https://github.com/phmccarty']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426073364,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",ok @otaviobp @jwakre @phmccarty the is_hashed_manifest function changed a little bit to account for hex-named bundles.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,9,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426684537,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",@otaviobp added comments.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/otaviobp,10,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-426836640,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","You still don't need to strdup the string as you aren't changing the content of entry->d_name.
And a nice-to-have improvement is to start from ""entry->d_name + sizeof(""Manifest."")"" so you don't need to look for the first '.'. Also, you don't need to count all dots in the string. because if it has at least 2 dots you can call is_all_xdigits() and it will return false for Iterative and Delta Manifests.
By that you would read each byte of the string only once if it's a manifest hash and even less than that if it's a Iterative or Delta manifest.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,11,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-427191477,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Also, you don't need to count all dots in the string. because if it has at least 2 dots you can call is_all_xdigits() and it will return false for Iterative and Delta Manifests.

Actually for iterative and delta manifests is_all_xdigits will return true because the trailing version are all xdigits.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,12,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-427193062,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",^ and I've confirmed that,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/matthewrsj,13,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-427194446,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Still counting the number of '.' characters, but starting at sizeof(""Manifest."") and not duplicating the string.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,574,2018-09-17T19:29:24Z,2018-10-08T17:49:01Z,2018-10-08T17:49:44Z,MERGED,True,52,5,1,https://github.com/matthewrsj,clean: remove manifest hash hints from cache,1,[],https://github.com/clearlinux/swupd-client/pull/574,https://github.com/otaviobp,14,https://github.com/clearlinux/swupd-client/pull/574#issuecomment-427451168,"Fixes #484
The manifest files with their hashes appended to the filename in the
cache are used internally to prevent swupd from re-calculating manifest
hashes every time they are opened. These should only persist for the
duration of the update and should not persist afterwards to prevent
root-priveleged owners from modifying internally-used data. This patch
causes swupd to remove them by default without having to pass --all. The
files will be automatically removed upon update.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Actually for iterative and delta manifests is_all_xdigits will return true because the trailing version are all xdigits.

If you use strchr it won't. ""Manifest.bundle.D.1234"" will call is_all_xdigits(""D.1234"") that will return false.
But I'm ok with your implementation too.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/580,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-423293630,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","Ups, I forgot about the certificate. I'll fix this right away.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-423337762,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","Looks like I removed one of the files by mistake during the commits (the server.py used in update/slow-server.bats). I have fixed the issue now. Everything looks good.
It is ready for review.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-424121474,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","@castulo the test that you don't think is testing anything (https://github.com/clearlinux/swupd-client/tree/master/test/functional/bundleadd/fix-missing-file) is intended to test that a bundle-add works when there is no zero pack to download. In that case it falls back to downloading the full files for the bundle. It seems this test is working.
The test you thought it might be a duplicate of (https://github.com/clearlinux/swupd-client/tree/master/test/functional/bundleadd/verify-fix-path) is validating something else. That test is checking that it will fall back to downloading full files if the zero pack is incomplete and missing one of the files needed in the bundle-add. This test makes sure that file makes it onto the target regardless of pack completeness.
tl;dr
test 1 - test that bundle-add works with no zero pack
test 2 - test that bundle-add works with incomplete zero pack",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-424122325,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","In general looks good to me as well, can you just confirm that you are covering those two cases I mention above?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-424123907,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","Actually, both of these tests are not going to attempt to download the zero packs at all due to
https://github.com/clearlinux/swupd-client/blob/master/src/bundle.c#L825
which only downloads the zero pack if there are greater than 10 files needed to download. So those tests need an update to add at least 11 files so that packs are initially attempted.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-424550099,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","@castulo the test that you don't think is testing anything (https://github.com/clearlinux/swupd-client/tree/master/test/functional/bundleadd/fix-missing-file) is intended to test that a bundle-add works when there is no zero pack to download. In that case it falls back to downloading the full files for the bundle. It seems this test is working.

Well, if the test is attempting to test that, then it is correct. However, I'm still not sure that is the purpose of the test. Consider this:

There are many other tests (in the old tests) that don't have zero packs, so this would be a duplicate.
The description of the test says this: ""bundle-add verify_fix_path support"", which suggests that the test is validating the verify_fix_path function (
  
    
      swupd-client/src/helpers.c
    
    
         Line 702
      in
      9edc02c
    
  
  
    

        
          
           int verify_fix_path(char *targetpath, struct manifest *target_MoM) 
        
    
  

) is being used some how, but I don't even see this function being called in this test. Maybe it is intended for what you say it is but someone copied the test description from other test and forgot to update it.


The test you thought it might be a duplicate of (https://github.com/clearlinux/swupd-client/tree/master/test/functional/bundleadd/verify-fix-path) is validating something else. That test is checking that it will fall back to downloading full files if the zero pack is incomplete and missing one of the files needed in the bundle-add. This test makes sure that file makes it onto the target regardless of pack completeness.

I think you may be mistaken about this test, I believe this test is intended to validate that bundle-add uses the verify_fix_path function here 
  
    
      swupd-client/src/staging.c
    
    
         Line 100
      in
      c8ca0d3
    
  
  
    

        
          
           verify_fix_path(dir, MoM); 
        
    
  

 to create the missing directories so the file in the manifest can be added. This test looks fine.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/matthewrsj,8,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-425156975,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","There are many other tests (in the old tests) that don't have zero packs, so this would be a duplicate.

Duplicated verification in tests is not a bad thing. With a test that is intended to explicitly check fullfile fallback for bundle-add we can be sure we won't lose coverage if we update the other tests and add zero packs for an unrelated reason.

The description of the test says this: ""bundle-add verify_fix_path support"", which suggests that the test is validating the verify_fix_path function

You are right, with the official fallback in-place to use full-files for bundle-add this function is probably not being used any more. Think of this more as a functional test instead of a unit test. We need to make sure that bundle-add properly falls back to downloading full-files if there is a missing zero pack. I don't really care which internal function is called as long as we can validate the fallback is happening.

I think you may be mistaken about this test, I believe this test is intended to validate that bundle-add uses the verify_fix_path function here
...
to create the missing directories so the file in the manifest can be added. This test looks fine.

No, verify_fix_path was the fallback function to add any files missing after downloading packs. If you look at the bottom of that test it is checking both a directory and a file that needed to be there after the bundle-add.
I still believe that the first test is explicit validation that bundle-add works with no zero pack and the second test is explicit validation that bundle-add works with incomplete zero packs. The comments and test names are out of date and should be updated though. We do not need to validate the specific internal function, we just need to validate the functionality.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,9,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-425206602,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","Hey @matthewrsj I just added a few tests to replace the old https://github.com/castulo/swupd-client/tree/master/test/functional/bundleadd/fix-missing-file test, I think the new ones make more sense for what the original test was validating. I had to cherry-pick this commit from PR #565 because I needed that functionality for these tests. So whatever PR merges second it will need a rebase.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/matthewrsj,10,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-425206760,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.",@castulo did you add the case to validate that bundle-add will fallback to full-files when there are more than 10 files to download but the zero pack doesn't exist? Or was that case already covered? I don't see it in your latest commit.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,11,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-425209195,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.","@matthewrsj I added one test that adds a bundle that has more than 10 files, but one of the files is missing in the zero pack, so the full-file for tat one file is used. There is no case where the whole zero pack is missing. I can add one like that if you think it'd be good to have it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/matthewrsj,12,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-425211433,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.",Please add it. May not be a different code path right now but it could be in the future.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,580,2018-09-20T18:36:22Z,2018-09-27T19:48:16Z,2018-09-27T19:57:32Z,MERGED,True,2408,9518,1060,https://github.com/castulo,Testlib update verify,13,[],https://github.com/clearlinux/swupd-client/pull/580,https://github.com/castulo,13,https://github.com/clearlinux/swupd-client/pull/580#issuecomment-425212895,"This PR includes the following items:

Adds a wrapper function to the test library to print to console from within the tests
Replaces all the old update tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
Replaces all the old verify tests that used the swupd.bash library with an equivalent test that now uses the testlib.bash library.
All the old tests from other themes (bundle-add, bundle-remove, etc.) were removed since they already had an equivalent newer test.
Directories for the test themes were renamed from _v2/ to /
Since there are no longer tests that use the old test infrastructure it was removed so all future tests are written using the new test library.",Done,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/581,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-423543651,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","I added a change so that when loading FROM bundles, unchanged bundles will be skipped. Earlier, unchanged bundles would attempt to download a delta manifest and fallback to download a full manifest.
Also, I moved the tests to the update directory to address @castulo 's feedback.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-423694897,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","Based on offline feedback from @matthewrsj to replace functions that take a boolean delta_manifest argument with wrapper functions, I intend to do the following:

Instead of passing the delta_manifest argument to the recurse_manifest and load_manifest functions, I will add a use_delta_manifest variable to the manifest struct which will only be set to true for the FROM manifest.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/jwakre,4,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-423703207,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","Based on offline feedback from @matthewrsj to replace functions that take a boolean delta_manifest argument with wrapper functions, I intend to do the following:

Instead of passing the delta_manifest argument to the recurse_manifest and load_manifest functions, I will add a use_delta_manifest variable to the manifest struct which will only be set to true for the FROM manifest.


The change described above has been pushed. Adding the 'use_delta_manifest' variable removes most of the API changes.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/matthewrsj,5,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-424154178,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","I have a feeling that a great refactor in create_update_list() is needed to avoid downloading the current manifest from server. We could use current version of the system to decide if we need to update a file or not instead of using the version of that file in the current manifest.

Very good point @otaviobp. That block of code was put in to optimize rename detection iirc, but we don't do things the same way any more. Regardless, if we refactor that code it will need careful review.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/matthewrsj,6,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-424445647,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","Going to comment here about a few cases that need to be handled when not checking against the previous manifest and instead using the version of the installed OS.

file in the to manifest is a newer version than the OS, add to update list.
file in the to manifest is an older version than the OS, but the manifest was added as a new include and was not tracked on the system, and the file itself is only provided by the newly included bundle, if the file is missing or invalid on the file system, add to update list.
file in the to manifest is an older version than the OS and the manifest was already tracked on the file system, do not add to update list regardless of if that file is also provided by a newly included bundle.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/matthewrsj,7,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-424503729,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","A note on minversion bumps:
13:59 < mrsj> the only time a file will get an updated version number with no hash or content change or file name change is when you have a minversion update
14:00 < mrsj> which raises an issue...
14:00 < mrsj> our current plan will cause ALL OS files to be downloaded for a minversion update
14:00 < mrsj> because a minversion marks all files with a new version
14:00 < mrsj> :/
14:01 < mrsj> so our plan would put those under Case1, where the file is greater than the current OS version
14:01 < mrsj> so for every tracked file you will be adding those to the manifest
14:01 < mrsj> CURRENTLY...
14:01 < mrsj> in manifest.c,
14:01 < mrsj> we can detect minversion updates because we know the file version changed by the hash and flags stayed the same
14:01 < mrsj> can't do that when we aren't using the old manifests any more
14:02 < mrsj> we need another solution
14:02 < mrsj> one solution:
14:02 < mrsj> add a manifest header field to the MoM
14:02 < mrsj> minversion:\t<minversion>
14:02 < mrsj> and if <minversion> is greater than current OS version we do the fallback to verifying all files with versions greater than our own OS version
14:03 < mrsj> make sense jwakre, otaviobp?
14:03 < mrsj> this is unfortunate
14:03 < mrsj> but we should be able to add a minversion field to the MoM in mixer without requiring a format bump for the client
14:03 < mrsj> because swupd ignores header fields it doesn't know about
14:04 < jwakre> What is a minversion?
14:05 < mrsj> a minversion is when all content is ""updated"" on the server-side
14:05 < mrsj> by mixer
14:05 < otaviobp> mrsj: this sounds correct to me
14:05 < mrsj> so all file versions are updated to that ""minversion"" build regardless of whether they actually physically changed or not
14:06 < jwakre> oh, so a minimum version for all files on the system
14:06 < mrsj> right now in manifest.c (search for ""minversion"") the client falls back to verifying all files in the update against the system
14:06 < otaviobp> gtkramer said they usually do it once a mounth, so it's releavant to be optimized for that
14:06 < mrsj> to prevent having to download the ENTIRE OS
14:06 < otaviobp> I thought that this was a rare thing, but it's not
14:06 < mrsj> no it is often
14:06 < mrsj> because it allows devops to free up space on their builder
14:06 < mrsj> :/
14:06 < mrsj> apparently disk space is not cheap
14:06 < otaviobp> disk isn't that cheap, apparently 
14:07 < mrsj> despite what everyone tells us ;P
14:09 < mrsj> that was a lot of writing... I should have put it in the PR...
14:09  * mrsj copies",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/jwakre,8,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-429042981,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","PR Updates:


Rebased on to master_new_manifests branch which includes iterative manifests and the refactored update list.


@otaviobp's feedback was addressed by the refactored update list PR which has already been committed.


@matthewrsj 's feedback:



Added comments for delta manifest flow
Removed unnecessary version_dir assignment in clean.c
Removed condition statement in is_delta_manifest function in clean.c
""TO"" file list feedback was addressed by refactored update list PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/jwakre,9,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-429109022,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561","Thanks for the feedback @castulo. I made the following changes to address your feedback:

Moved link_submanifests above the recurse_manifest comment
Changed assert_in_output -> assert_is_output for added tests
Replaced the echo file write with write_to_protected_file",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,581,2018-09-20T19:33:53Z,2018-10-17T19:24:08Z,2018-10-17T19:57:16Z,MERGED,True,361,64,16,https://github.com/jwakre,Delta Manifests,3,[],https://github.com/clearlinux/swupd-client/pull/581,https://github.com/otaviobp,10,https://github.com/clearlinux/swupd-client/pull/581#issuecomment-429134511,"This PR enables the consumption of delta manifests in the swupd client. Delta manifests are manifests that may be found inside delta packs and contain a list of files (from the current version) that have been changed in the TO version.
This PR also cherry picks some changes from #565 which are used by the added tests. Once these cherry picked changes are merged into master, they will be removed from this PR.
Closes #561",Just wait for @matthewrsj to check if he has something else to add and then we can merge this.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,583,2018-09-20T22:27:04Z,2018-09-25T18:00:19Z,2018-11-01T18:01:18Z,MERGED,True,52,30,1,https://github.com/otaviobp,download: Process all completed downloads in poll_fewer_than(),1,[],https://github.com/clearlinux/swupd-client/pull/583,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/583,"When downloading from file:// curl can process all reads and writes on the
first call of curl_multi_process() and then curl_multi_wait() will set numfds
to 0 and poll_fewer_than() will return without processing the download (i.e
extracting it).
Also change a bit the poll_fewer_than() to follow the timeout approach from the
official curl_multi_wait() example (https://curl.haxx.se/libcurl/c/multi-single.html).
Fixes #582
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When downloading from file:// curl can process all reads and writes on the
first call of curl_multi_process() and then curl_multi_wait() will set numfds
to 0 and poll_fewer_than() will return without processing the download (i.e
extracting it).
Also change a bit the poll_fewer_than() to follow the timeout approach from the
official curl_multi_wait() example (https://curl.haxx.se/libcurl/c/multi-single.html).
Fixes #582
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,583,2018-09-20T22:27:04Z,2018-09-25T18:00:19Z,2018-11-01T18:01:18Z,MERGED,True,52,30,1,https://github.com/otaviobp,download: Process all completed downloads in poll_fewer_than(),1,[],https://github.com/clearlinux/swupd-client/pull/583,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/583#issuecomment-423364186,"When downloading from file:// curl can process all reads and writes on the
first call of curl_multi_process() and then curl_multi_wait() will set numfds
to 0 and poll_fewer_than() will return without processing the download (i.e
extracting it).
Also change a bit the poll_fewer_than() to follow the timeout approach from the
official curl_multi_wait() example (https://curl.haxx.se/libcurl/c/multi-single.html).
Fixes #582
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Ah nice, good to know this is only impacting local files. Great find!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,583,2018-09-20T22:27:04Z,2018-09-25T18:00:19Z,2018-11-01T18:01:18Z,MERGED,True,52,30,1,https://github.com/otaviobp,download: Process all completed downloads in poll_fewer_than(),1,[],https://github.com/clearlinux/swupd-client/pull/583,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/583#issuecomment-424089690,"When downloading from file:// curl can process all reads and writes on the
first call of curl_multi_process() and then curl_multi_wait() will set numfds
to 0 and poll_fewer_than() will return without processing the download (i.e
extracting it).
Also change a bit the poll_fewer_than() to follow the timeout approach from the
official curl_multi_wait() example (https://curl.haxx.se/libcurl/c/multi-single.html).
Fixes #582
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",fixed proposed changes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,583,2018-09-20T22:27:04Z,2018-09-25T18:00:19Z,2018-11-01T18:01:18Z,MERGED,True,52,30,1,https://github.com/otaviobp,download: Process all completed downloads in poll_fewer_than(),1,[],https://github.com/clearlinux/swupd-client/pull/583,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/583#issuecomment-424392022,"When downloading from file:// curl can process all reads and writes on the
first call of curl_multi_process() and then curl_multi_wait() will set numfds
to 0 and poll_fewer_than() will return without processing the download (i.e
extracting it).
Also change a bit the poll_fewer_than() to follow the timeout approach from the
official curl_multi_wait() example (https://curl.haxx.se/libcurl/c/multi-single.html).
Fixes #582
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We need another review here, @evil-brain",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,585,2018-09-27T03:36:37Z,2018-09-27T22:03:44Z,2018-10-10T16:15:12Z,MERGED,True,127,2,3,https://github.com/jwakre,Add minversion support to testlib,1,[],https://github.com/clearlinux/swupd-client/pull/585,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/585,"Soon, a minversion header field will be included in the MoM. This change
updates the test library to add a minversion header field to MoMs and adds
functions to create a minversion update. Also, the skip-verified-fullfiles
test was replaced by the update-minversion test. The update-minversion test
verifies that unchanged files with a version bump caused by a minversion
update are skipped during an update.
Signed-off-by: John Akre john.w.akre@intel.com","Soon, a minversion header field will be included in the MoM. This change
updates the test library to add a minversion header field to MoMs and adds
functions to create a minversion update. Also, the skip-verified-fullfiles
test was replaced by the update-minversion test. The update-minversion test
verifies that unchanged files with a version bump caused by a minversion
update are skipped during an update.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,585,2018-09-27T03:36:37Z,2018-09-27T22:03:44Z,2018-10-10T16:15:12Z,MERGED,True,127,2,3,https://github.com/jwakre,Add minversion support to testlib,1,[],https://github.com/clearlinux/swupd-client/pull/585,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/585#issuecomment-425195337,"Soon, a minversion header field will be included in the MoM. This change
updates the test library to add a minversion header field to MoMs and adds
functions to create a minversion update. Also, the skip-verified-fullfiles
test was replaced by the update-minversion test. The update-minversion test
verifies that unchanged files with a version bump caused by a minversion
update are skipped during an update.
Signed-off-by: John Akre john.w.akre@intel.com","New changes:

Moved test in Makefile.am to be in alphabetical order
Update sed command to match fix in #586",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,586,2018-09-27T17:34:44Z,2018-09-27T18:48:36Z,2018-11-01T18:01:17Z,MERGED,True,1,1,1,https://github.com/otaviobp,testlib: Add guards to sed to avoid incorrect replaces,1,[],https://github.com/clearlinux/swupd-client/pull/586,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/586,"When updating the manifest version we were replacing any line with the word
version to ""version: new_version"". This is a problem now that we are adding
a minversion field to the manifest. That could be a problem too when there
was a file named version.
This pull request fixes one problem that is going to be introduced by #580 and #585. If you use both commits minversions of all MoMs created used create_version will have minversion == version, unless you explicitly set the minversion","When updating the manifest version we were replacing any line with the word
version to ""version: new_version"". This is a problem now that we are adding
a minversion field to the manifest. That could be a problem too when there
was a file named version.
This pull request fixes one problem that is going to be introduced by #580 and #585. If you use both commits minversions of all MoMs created used create_version will have minversion == version, unless you explicitly set the minversion",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,587,2018-09-28T01:55:18Z,2018-09-29T00:06:21Z,2018-10-10T16:14:53Z,CLOSED,False,4,4,2,https://github.com/jwakre,Use release os-core manifest for update boot tests,1,[],https://github.com/clearlinux/swupd-client/pull/587,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/587,"When creating the test environment, some files and directories, like
/usr/lib, are created without corresponding entries in the os-core
manifest. This is a problem for update tests that add boot files, like
/usr/lib/kernel/file. Without an entry for /usr/lib in the FROM os-core
manifest, an update will consider /usr and /usr/lib new files even when
they already exist on the system. The '-r' argument can be passed to
create_test_environment to create a more complete os-core manifest.
Signed-off-by: John Akre john.w.akre@intel.com","When creating the test environment, some files and directories, like
/usr/lib, are created without corresponding entries in the os-core
manifest. This is a problem for update tests that add boot files, like
/usr/lib/kernel/file. Without an entry for /usr/lib in the FROM os-core
manifest, an update will consider /usr and /usr/lib new files even when
they already exist on the system. The '-r' argument can be passed to
create_test_environment to create a more complete os-core manifest.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,587,2018-09-28T01:55:18Z,2018-09-29T00:06:21Z,2018-10-10T16:14:53Z,CLOSED,False,4,4,2,https://github.com/jwakre,Use release os-core manifest for update boot tests,1,[],https://github.com/clearlinux/swupd-client/pull/587,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/587#issuecomment-425567348,"When creating the test environment, some files and directories, like
/usr/lib, are created without corresponding entries in the os-core
manifest. This is a problem for update tests that add boot files, like
/usr/lib/kernel/file. Without an entry for /usr/lib in the FROM os-core
manifest, an update will consider /usr and /usr/lib new files even when
they already exist on the system. The '-r' argument can be passed to
create_test_environment to create a more complete os-core manifest.
Signed-off-by: John Akre john.w.akre@intel.com","@jwakre I'm curious why you say this is required for these tests?
I originally didn't add that to these tests because update tests are slow, and using the -r option makes them a even slower, and since I considered that not being important for what these tests were validating I left that out. Adding the -r will create a test environment that more closely resembles a real environment, but it comes with the price of a slower test.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,587,2018-09-28T01:55:18Z,2018-09-29T00:06:21Z,2018-10-10T16:14:53Z,CLOSED,False,4,4,2,https://github.com/jwakre,Use release os-core manifest for update boot tests,1,[],https://github.com/clearlinux/swupd-client/pull/587,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/587#issuecomment-425597944,"When creating the test environment, some files and directories, like
/usr/lib, are created without corresponding entries in the os-core
manifest. This is a problem for update tests that add boot files, like
/usr/lib/kernel/file. Without an entry for /usr/lib in the FROM os-core
manifest, an update will consider /usr and /usr/lib new files even when
they already exist on the system. The '-r' argument can be passed to
create_test_environment to create a more complete os-core manifest.
Signed-off-by: John Akre john.w.akre@intel.com","@jwakre I'm curious why you say this is required for these tests?
I originally didn't add that to these tests because update tests are slow, and using the -r option makes them a even slower, and since I considered that not being important for what these tests were validating I left that out. Adding the -r will create a test environment that more closely resembles a real environment, but it comes with the price of a slower test.

I am rebasing my changes that refactor the update list onto the updated test library and correcting failures. This test was failing earlier and I thought it was because of the shortcut it takes in the manifest. I tried to replicate the failure, but it seems to be working fine now without it. I'm fine dropping this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,587,2018-09-28T01:55:18Z,2018-09-29T00:06:21Z,2018-10-10T16:14:53Z,CLOSED,False,4,4,2,https://github.com/jwakre,Use release os-core manifest for update boot tests,1,[],https://github.com/clearlinux/swupd-client/pull/587,https://github.com/jwakre,4,https://github.com/clearlinux/swupd-client/pull/587#issuecomment-425598051,"When creating the test environment, some files and directories, like
/usr/lib, are created without corresponding entries in the os-core
manifest. This is a problem for update tests that add boot files, like
/usr/lib/kernel/file. Without an entry for /usr/lib in the FROM os-core
manifest, an update will consider /usr and /usr/lib new files even when
they already exist on the system. The '-r' argument can be passed to
create_test_environment to create a more complete os-core manifest.
Signed-off-by: John Akre john.w.akre@intel.com","I am rebasing my changes that refactor the update list onto the updated test library and correcting failures. This test was failing earlier and I thought it was because of the shortcut it takes in the manifest. I tried to replicate the failure, but it seems to be working fine now without it. I'm fine dropping this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,593,2018-10-02T20:40:52Z,2018-10-03T22:41:28Z,2018-10-03T22:42:36Z,MERGED,True,2,2,1,https://github.com/castulo,Fixing memory leak in retrieve_manifests,1,[],https://github.com/clearlinux/swupd-client/pull/593,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/593,"This commit fixes a memory leak with the dir variable in the retrieve_manifests function.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit fixes a memory leak with the dir variable in the retrieve_manifests function.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,593,2018-10-02T20:40:52Z,2018-10-03T22:41:28Z,2018-10-03T22:42:36Z,MERGED,True,2,2,1,https://github.com/castulo,Fixing memory leak in retrieve_manifests,1,[],https://github.com/clearlinux/swupd-client/pull/593,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/593#issuecomment-426422742,"This commit fixes a memory leak with the dir variable in the retrieve_manifests function.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","As requested by @otaviobp this commit was part of PR #565, but since it is really not related to that PR it was included in its own PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,594,2018-10-02T20:44:53Z,2018-10-03T22:43:12Z,2018-10-03T22:43:25Z,MERGED,True,25,3,6,https://github.com/castulo,Adding the --keepcache option when doing updates,1,[],https://github.com/clearlinux/swupd-client/pull/594,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/594,"After running an update, the state directory is cleaned up.
Sometimes it is useful to be able to peek at the state directory
after an update, this is specially true when testing updates,
this way tests can verify what manifests were downloaded during
the update.
This commit adds the --keepcache option to swupd update so it can
be used when writing tests for updates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","After running an update, the state directory is cleaned up.
Sometimes it is useful to be able to peek at the state directory
after an update, this is specially true when testing updates,
this way tests can verify what manifests were downloaded during
the update.
This commit adds the --keepcache option to swupd update so it can
be used when writing tests for updates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,594,2018-10-02T20:44:53Z,2018-10-03T22:43:12Z,2018-10-03T22:43:25Z,MERGED,True,25,3,6,https://github.com/castulo,Adding the --keepcache option when doing updates,1,[],https://github.com/clearlinux/swupd-client/pull/594,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/594#issuecomment-426437362,"After running an update, the state directory is cleaned up.
Sometimes it is useful to be able to peek at the state directory
after an update, this is specially true when testing updates,
this way tests can verify what manifests were downloaded during
the update.
This commit adds the --keepcache option to swupd update so it can
be used when writing tests for updates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","so @otaviobp, regarding adding the flag to swupd.1.rst, I thought of this when I initially worked on this commit, the reason why I decided no to add it to the manual is because looking at what is already in the manual regarding updates, there are actually a lot of the flags missing there, from the 20 options that are shown when using swupd update --help, only 5 are shown in the manual. So I figured that the manual only contains the most important ones, and --keepcache is not that important.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,594,2018-10-02T20:44:53Z,2018-10-03T22:43:12Z,2018-10-03T22:43:25Z,MERGED,True,25,3,6,https://github.com/castulo,Adding the --keepcache option when doing updates,1,[],https://github.com/clearlinux/swupd-client/pull/594,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/594#issuecomment-426440207,"After running an update, the state directory is cleaned up.
Sometimes it is useful to be able to peek at the state directory
after an update, this is specially true when testing updates,
this way tests can verify what manifests were downloaded during
the update.
This commit adds the --keepcache option to swupd update so it can
be used when writing tests for updates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I didn't realize there was an OPTIONS section that listed the common flags, I'll add --keepcache to the update list",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,594,2018-10-02T20:44:53Z,2018-10-03T22:43:12Z,2018-10-03T22:43:25Z,MERGED,True,25,3,6,https://github.com/castulo,Adding the --keepcache option when doing updates,1,[],https://github.com/clearlinux/swupd-client/pull/594,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/594#issuecomment-426441391,"After running an update, the state directory is cleaned up.
Sometimes it is useful to be able to peek at the state directory
after an update, this is specially true when testing updates,
this way tests can verify what manifests were downloaded during
the update.
This commit adds the --keepcache option to swupd update so it can
be used when writing tests for updates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I updated  docs/swupd.1.rst with the --keepcache flag.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/595,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-426875674,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","@otaviobp @castulo I rebased my PR on top of master_new_manifests and addressed all of your feedback with one exception. The 'account_changed_bundle' function is used by link_submanifests, so I did not remove it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-427107975,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","@jwakre I was talking about the account_delta_miss() and account_delta_hit(). They are out now, thanks.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-427143604,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","@jwakre I just have one last question. I see you made changes to the bump_format function in testlib so when doing a format bump the +10 version won't show all the files of a bundle as updated, only the os-release and format files show as updated. Why are you making this change? I remember when I first wrote that function that is how Tudor had told me format bump worked (or that is what I understood from my talk with him anyway). Did I get it wrong or something changed in the way format bumps are made?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/jwakre,5,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-427149316,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","@jwakre I just have one last question. I see you made changes to the bump_format function in testlib so when doing a format bump the +10 version won't show all the files of a bundle as updated, only the os-release and format files show as updated. Why are you making this change? I remember when I first wrote that function that is how Tudor had told me format bump worked (or that is what I understood from my talk with him anyway). Did I get it wrong or something changed in the way format bumps are made?

My understanding is that the +10 and +20 should have identical content, but only the +20 should have a minversion update. The previous implementation performed a minversion update on both the +10 and +20. If I am wrong about this, I need to set the +10 minversion header field instead. @matthewrsj Can you confirm the desired format bump results?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-427475553,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","I'm ok with approving this PR as soon as @matthewrsj or @tmarcu confirm the desired result of the format bump.
With the previous version of the testlib this is how the format bumps use to look like (Manifest.os-core):
Version 10
MANIFEST	1
version:	10
previous:	0
filecount:	9
timestamp:	1538767019
contentsize:	27235

F...	a7cd26fe4b1965230c5e71e3cbc917abd4e28912737e7747b0192b1e7d77a86c	10	/core
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/lib
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr
F...	8b77bb0234b3e202a8e27bc1b4d20c9ca48582519717c8379fb58078feaa5f7a	10	/usr/lib/os-release
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share/defaults/swupd
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share/defaults
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share
F...	b377bac65e56ea9dcae5e0c1f4a21faeca9c95f46d38bd8da42f99d041eab9f7	10	/usr/share/defaults/swupd/format
F...	0aa75909352ea09d1f53739b977efe5ac1065b88c9ef84199f1d2eba55dd93b9	10	/usr/share/clear/bundles/os-core

Version 20
MANIFEST	1
version:	20
previous:	10
filecount:	9
timestamp:	1538767021
contentsize:	27235

F...	a7cd26fe4b1965230c5e71e3cbc917abd4e28912737e7747b0192b1e7d77a86c	20	/core
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	20	/usr/lib
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	20	/usr
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	20	/usr/share/defaults/swupd
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	20	/usr/share/defaults
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	20	/usr/share
F...	0aa75909352ea09d1f53739b977efe5ac1065b88c9ef84199f1d2eba55dd93b9	20	/usr/share/clear/bundles/os-core
F...	f4debcae753a8264a99beb66d09d9be3e9d15c8687432ef3d3cbd4e470e15143	20	/usr/lib/os-release
F...	39a56dd2855a7eed2339358a2b22fe01478bbbb287e9cf13aa07bfc6714ece35	20	/usr/share/defaults/swupd/format

Version 30
MANIFEST	2
version:	30
previous:	20
filecount:	9
timestamp:	1538767021
contentsize:	27235

F...	a7cd26fe4b1965230c5e71e3cbc917abd4e28912737e7747b0192b1e7d77a86c	30	/core
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/lib
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/share/defaults/swupd
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/share/defaults
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/share
F...	0aa75909352ea09d1f53739b977efe5ac1065b88c9ef84199f1d2eba55dd93b9	30	/usr/share/clear/bundles/os-core
F...	f4debcae753a8264a99beb66d09d9be3e9d15c8687432ef3d3cbd4e470e15143	30	/usr/lib/os-release
F...	39a56dd2855a7eed2339358a2b22fe01478bbbb287e9cf13aa07bfc6714ece35	30	/usr/share/defaults/swupd/format

This is how it looks now:
Version 10
MANIFEST	1
version:	10
previous:	0
filecount:	9
timestamp:	1538767610
contentsize:	32689

F...	904912e053c3819c9af7c790b06e7725ee984cf6396eda35736985e3c3d0146b	10	/core
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/lib
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr
F...	8b77bb0234b3e202a8e27bc1b4d20c9ca48582519717c8379fb58078feaa5f7a	10	/usr/lib/os-release
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share/defaults/swupd
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share/defaults
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share
F...	b377bac65e56ea9dcae5e0c1f4a21faeca9c95f46d38bd8da42f99d041eab9f7	10	/usr/share/defaults/swupd/format
F...	fa5ec26a137d185526ea4a46740fa34d8c9afb8237db8ceb65f2eb959b28f04e	10	/usr/share/clear/bundles/os-core

Version 20
MANIFEST	1
version:	20
previous:	10
filecount:	9
timestamp:	1538767612
contentsize:	32689

F...	904912e053c3819c9af7c790b06e7725ee984cf6396eda35736985e3c3d0146b	10	/core
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/lib
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share/defaults/swupd
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share/defaults
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	10	/usr/share
F...	fa5ec26a137d185526ea4a46740fa34d8c9afb8237db8ceb65f2eb959b28f04e	10	/usr/share/clear/bundles/os-core
F...	f4debcae753a8264a99beb66d09d9be3e9d15c8687432ef3d3cbd4e470e15143	20	/usr/lib/os-release
F...	39a56dd2855a7eed2339358a2b22fe01478bbbb287e9cf13aa07bfc6714ece35	20	/usr/share/defaults/swupd/format

Version 30
MANIFEST	2
version:	30
previous:	20
filecount:	9
timestamp:	1538767612
contentsize:	32689

F...	904912e053c3819c9af7c790b06e7725ee984cf6396eda35736985e3c3d0146b	30	/core
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/lib
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/share/defaults/swupd
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/share/defaults
D...	6c27df6efcd6fc401ff1bc67c970b83eef115f6473db4fb9d57e5de317eba96e	30	/usr/share
F...	fa5ec26a137d185526ea4a46740fa34d8c9afb8237db8ceb65f2eb959b28f04e	30	/usr/share/clear/bundles/os-core
F...	f4debcae753a8264a99beb66d09d9be3e9d15c8687432ef3d3cbd4e470e15143	30	/usr/lib/os-release
F...	39a56dd2855a7eed2339358a2b22fe01478bbbb287e9cf13aa07bfc6714ece35	30	/usr/share/defaults/swupd/format

@matthewrsj @tmarcu can any of you please confirm how it should behave?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/tmarcu,7,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-428287087,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","@castulo The output looks correct, I believe the first one was using mixer when it was incorrectly doing a minversion for both builds instead of just the +20 (version 30).",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,595,2018-10-02T22:10:05Z,2018-10-09T20:21:30Z,2018-10-10T16:15:27Z,MERGED,True,280,191,41,https://github.com/jwakre,Refactor update list,5,[],https://github.com/clearlinux/swupd-client/pull/595,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/595#issuecomment-428333356,"This PR refactors the create_update_list function so that it no longer depends on the FROM file list. The old create_update_list implementation is kept as a fallback to be used when the TO MoM header does not include a minversion header field.
Important note about testing:
This PR also changes the testlib to create MoMs with non-zero minversion header fields. As a result, most tests will use the refactored create_update_list function.","@castulo The output looks correct, I believe the first one was using mixer when it was incorrectly doing a minversion for both builds instead of just the +20 (version 30).

In that case this looks good to me",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,596,2018-10-02T22:33:31Z,2018-12-11T20:45:09Z,2018-12-11T20:45:10Z,CLOSED,False,259,34,13,https://github.com/evil-brain,Run extraction in a thread,3,[],https://github.com/clearlinux/swupd-client/pull/596,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/596,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,596,2018-10-02T22:33:31Z,2018-12-11T20:45:09Z,2018-12-11T20:45:10Z,CLOSED,False,259,34,13,https://github.com/evil-brain,Run extraction in a thread,3,[],https://github.com/clearlinux/swupd-client/pull/596,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/596#issuecomment-446355219,,I'm closing this PR for now. We can open that back after the code rework,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,597,2018-10-02T22:34:15Z,2018-10-03T22:44:45Z,2019-07-16T20:26:11Z,MERGED,True,3,0,1,https://github.com/otaviobp,manifest: Memory leak when signature verification fails,1,[],https://github.com/clearlinux/swupd-client/pull/597,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/597,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,599,2018-10-03T16:27:14Z,2018-10-08T17:48:08Z,2018-10-08T17:50:09Z,MERGED,True,80,26,5,https://github.com/matthewrsj,Add more compile options to info and --version,2,[],https://github.com/clearlinux/swupd-client/pull/599,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/599,"When invoking swupd info or swupd --version print more information about
compile-time configuration. This feature was requested after a bug was
introduced to an unreleased Clear Linux build when swupd was built with
the wrong format ID. This allows QA to determine exactly which
compile-time options were set during runtime without inspecting the
binary.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","When invoking swupd info or swupd --version print more information about
compile-time configuration. This feature was requested after a bug was
introduced to an unreleased Clear Linux build when swupd was built with
the wrong format ID. This allows QA to determine exactly which
compile-time options were set during runtime without inspecting the
binary.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,599,2018-10-03T16:27:14Z,2018-10-08T17:48:08Z,2018-10-08T17:50:09Z,MERGED,True,80,26,5,https://github.com/matthewrsj,Add more compile options to info and --version,2,[],https://github.com/clearlinux/swupd-client/pull/599,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/599#issuecomment-426835192,"When invoking swupd info or swupd --version print more information about
compile-time configuration. This feature was requested after a bug was
introduced to an unreleased Clear Linux build when swupd was built with
the wrong format ID. This allows QA to determine exactly which
compile-time options were set during runtime without inspecting the
binary.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","For me, ""swupd -v"" sounds like a command that would print some information about the binary and ""swupd info"" is a command that should print some information about the system. So I wouldn't include the compile flags in that command.

Fine with me, it was requested to be part of the info command which is why I put it there. I agree with you that it makes more sense under --version which is why I added it there as well. Since you agree it makes more sense there I'll just take it out of info.

And btw, ""swupd mirror"" is already displaying all information in ""swupd info"", so can't we get rit of info command? I couldn't find any open issues proposing anything else to be added to that command.

Eh, I like having a swupd info command that gives info. It probably wouldn't make sense to require users not on a mirror to call the swupd mirror command to see their system. The idea is that the information printed from these commands can diverge at some point. swupd mirror might just print the URLs while swupd info might additionally print the format.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,599,2018-10-03T16:27:14Z,2018-10-08T17:48:08Z,2018-10-08T17:50:09Z,MERGED,True,80,26,5,https://github.com/matthewrsj,Add more compile options to info and --version,2,[],https://github.com/clearlinux/swupd-client/pull/599,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/599#issuecomment-426841113,"When invoking swupd info or swupd --version print more information about
compile-time configuration. This feature was requested after a bug was
introduced to an unreleased Clear Linux build when swupd was built with
the wrong format ID. This allows QA to determine exactly which
compile-time options were set during runtime without inspecting the
binary.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Eh, I like having a swupd info command that gives info. It probably wouldn't make sense to require users not on a mirror to call the swupd mirror command to see their system. The idea is that the information printed from these commands can diverge at some point. swupd mirror might just print the URLs while swupd info might additionally print the format.

true",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,599,2018-10-03T16:27:14Z,2018-10-08T17:48:08Z,2018-10-08T17:50:09Z,MERGED,True,80,26,5,https://github.com/matthewrsj,Add more compile options to info and --version,2,[],https://github.com/clearlinux/swupd-client/pull/599,https://github.com/matthewrsj,4,https://github.com/clearlinux/swupd-client/pull/599#issuecomment-427164561,"When invoking swupd info or swupd --version print more information about
compile-time configuration. This feature was requested after a bug was
introduced to an unreleased Clear Linux build when swupd was built with
the wrong format ID. This allows QA to determine exactly which
compile-time options were set during runtime without inspecting the
binary.
Signed-off-by: Matthew Johnson matthew.johnson@intel.com",ok updated,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,602,2018-10-04T00:37:10Z,2018-10-09T20:25:48Z,2018-10-09T20:25:48Z,MERGED,True,90,40,10,https://github.com/castulo,Verify server version is read in check_versions,1,[],https://github.com/clearlinux/swupd-client/pull/602,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/602,"check_versions is a function that performs some validations using
the target system current version, the server version, and the
requested_version (if any), but if there was an error while retrieving
the server version no action would be taken.
This commit adds a verification to make sure the server version was
able to be identified.
Closes #589
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","check_versions is a function that performs some validations using
the target system current version, the server version, and the
requested_version (if any), but if there was an error while retrieving
the server version no action would be taken.
This commit adds a verification to make sure the server version was
able to be identified.
Closes #589
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,602,2018-10-04T00:37:10Z,2018-10-09T20:25:48Z,2018-10-09T20:25:48Z,MERGED,True,90,40,10,https://github.com/castulo,Verify server version is read in check_versions,1,[],https://github.com/clearlinux/swupd-client/pull/602,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/602#issuecomment-427157145,"check_versions is a function that performs some validations using
the target system current version, the server version, and the
requested_version (if any), but if there was an error while retrieving
the server version no action would be taken.
This commit adds a verification to make sure the server version was
able to be identified.
Closes #589
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp the whole purpose of check_versions is to validate the versions gotten from read_versions, if you do those validations in read_versions then the check_versions function would provide no benefit. If you want check_update to also validate the versions, wouldn't it be better just to call check_versions there instead of calling read_versions?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,602,2018-10-04T00:37:10Z,2018-10-09T20:25:48Z,2018-10-09T20:25:48Z,MERGED,True,90,40,10,https://github.com/castulo,Verify server version is read in check_versions,1,[],https://github.com/clearlinux/swupd-client/pull/602,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/602#issuecomment-427161989,"check_versions is a function that performs some validations using
the target system current version, the server version, and the
requested_version (if any), but if there was an error while retrieving
the server version no action would be taken.
This commit adds a verification to make sure the server version was
able to be identified.
Closes #589
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",check_update is validating the versions too. I think it's a good idea if you can merge those 2 functions in 1. I'm trying to avoid code duplication. The only difference is that check_update doesn't have a requested_version.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,602,2018-10-04T00:37:10Z,2018-10-09T20:25:48Z,2018-10-09T20:25:48Z,MERGED,True,90,40,10,https://github.com/castulo,Verify server version is read in check_versions,1,[],https://github.com/clearlinux/swupd-client/pull/602,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/602#issuecomment-427205003,"check_versions is a function that performs some validations using
the target system current version, the server version, and the
requested_version (if any), but if there was an error while retrieving
the server version no action would be taken.
This commit adds a verification to make sure the server version was
able to be identified.
Closes #589
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","check_update is validating the versions too. I think it's a good idea if you can merge those 2 functions in 1. I'm trying to avoid code duplication. The only difference is that check_update doesn't have a requested_version.

I decided not to merge both functions, I think they make more sense separate as they are, but I moved the validations of the server and current versions to the read_versions function, this should take care of the duplicated code.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,603,2018-10-04T22:56:40Z,2018-10-09T20:25:58Z,2018-11-01T18:01:17Z,MERGED,True,5,11,5,https://github.com/otaviobp,Set as static functions that aren't exported,1,[],https://github.com/clearlinux/swupd-client/pull/603,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/603,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,604,2018-10-04T22:58:16Z,2018-10-10T19:50:14Z,2018-10-10T19:50:14Z,CLOSED,False,28,25,7,https://github.com/ahkok,"Make parallel downloads flag global, used for fullfile downloads too.",2,[],https://github.com/clearlinux/swupd-client/pull/604,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/604,"Adjust getopts, since this is relatively new. -D stays the same
and now applies to fullfiles too.","Adjust getopts, since this is relatively new. -D stays the same
and now applies to fullfiles too.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,604,2018-10-04T22:58:16Z,2018-10-10T19:50:14Z,2018-10-10T19:50:14Z,CLOSED,False,28,25,7,https://github.com/ahkok,"Make parallel downloads flag global, used for fullfile downloads too.",2,[],https://github.com/clearlinux/swupd-client/pull/604,https://github.com/evil-brain,2,https://github.com/clearlinux/swupd-client/pull/604#issuecomment-428371709,"Adjust getopts, since this is relatively new. -D stays the same
and now applies to fullfiles too.","Seems to help when using fullfiles, and does what it says it does. Still testing a bit, but tomorrow this will get a +1 after conflicts are fixed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,604,2018-10-04T22:58:16Z,2018-10-10T19:50:14Z,2018-10-10T19:50:14Z,CLOSED,False,28,25,7,https://github.com/ahkok,"Make parallel downloads flag global, used for fullfile downloads too.",2,[],https://github.com/clearlinux/swupd-client/pull/604,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/604#issuecomment-428707200,"Adjust getopts, since this is relatively new. -D stays the same
and now applies to fullfiles too.",merged,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,605,2018-10-05T23:35:40Z,2018-10-08T19:48:06Z,2018-10-08T19:48:06Z,MERGED,True,1,1,1,https://github.com/ericho,Avoid print time stats if the queue is empty.,1,[],https://github.com/clearlinux/swupd-client/pull/605,https://github.com/ericho,1,https://github.com/clearlinux/swupd-client/pull/605,"If the -t parameter is set for a given empty directory, then
the time queue will be empty causing that the TAILQ_FOREACH_REVERSE
macro segfaults.
The proposed solution is to check if the head is NULL at the beginning
of the print_time_stats function.
Fixes #600
Signed-off-by: Erich Cordoba erich.cm@yandex.com","If the -t parameter is set for a given empty directory, then
the time queue will be empty causing that the TAILQ_FOREACH_REVERSE
macro segfaults.
The proposed solution is to check if the head is NULL at the beginning
of the print_time_stats function.
Fixes #600
Signed-off-by: Erich Cordoba erich.cm@yandex.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,605,2018-10-05T23:35:40Z,2018-10-08T19:48:06Z,2018-10-08T19:48:06Z,MERGED,True,1,1,1,https://github.com/ericho,Avoid print time stats if the queue is empty.,1,[],https://github.com/clearlinux/swupd-client/pull/605,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/605#issuecomment-427927757,"If the -t parameter is set for a given empty directory, then
the time queue will be empty causing that the TAILQ_FOREACH_REVERSE
macro segfaults.
The proposed solution is to check if the head is NULL at the beginning
of the print_time_stats function.
Fixes #600
Signed-off-by: Erich Cordoba erich.cm@yandex.com","Nice fix :)
+1 for the commit, but it didn't close #600 yet. In verify_main If sys_version is incorrect the timelist won't be initialized before calling print_stats(), so we may still have invalid memory access.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,606,2018-10-08T19:51:32Z,2018-10-09T20:26:22Z,2018-10-09T20:26:22Z,MERGED,True,1,2,1,https://github.com/otaviobp,time: initialize time list before using it,1,[],https://github.com/clearlinux/swupd-client/pull/606,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/606,"Fixes #600
@ericho Can you take a look at this commit, as it's related to #605","Fixes #600
@ericho Can you take a look at this commit, as it's related to #605",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,606,2018-10-08T19:51:32Z,2018-10-09T20:26:22Z,2018-10-09T20:26:22Z,MERGED,True,1,2,1,https://github.com/otaviobp,time: initialize time list before using it,1,[],https://github.com/clearlinux/swupd-client/pull/606,https://github.com/ericho,2,https://github.com/clearlinux/swupd-client/pull/606#issuecomment-428003808,"Fixes #600
@ericho Can you take a look at this commit, as it's related to #605",LGTM!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,611,2018-10-09T21:46:44Z,2018-10-11T22:59:33Z,2018-11-01T18:01:13Z,MERGED,True,22,35,1,https://github.com/otaviobp,Hashdump - minor fixes,3,[],https://github.com/clearlinux/swupd-client/pull/611,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/611,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,612,2018-10-09T22:10:26Z,2018-10-24T16:46:49Z,2018-11-01T18:01:09Z,MERGED,True,2,2,2,https://github.com/otaviobp,Fix compilation warnings,2,[],https://github.com/clearlinux/swupd-client/pull/612,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/612,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,612,2018-10-09T22:10:26Z,2018-10-24T16:46:49Z,2018-11-01T18:01:09Z,MERGED,True,2,2,2,https://github.com/otaviobp,Fix compilation warnings,2,[],https://github.com/clearlinux/swupd-client/pull/612,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/612#issuecomment-432028336,,"Reopening. I removed the branch by accident.
Rebased on top of origin/master",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,613,2018-10-09T22:44:13Z,2018-10-10T22:58:14Z,2018-11-01T18:01:14Z,MERGED,True,2,3,1,https://github.com/otaviobp,update: Fix memory leak in update_main(),1,[],https://github.com/clearlinux/swupd-client/pull/613,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/613,"current_subs memory wasn't released when we had errors on version checks.
As a test for that was recently introduced we started to have errors on
travis for that.","current_subs memory wasn't released when we had errors on version checks.
As a test for that was recently introduced we started to have errors on
travis for that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,614,2018-10-10T19:50:54Z,2018-10-10T21:22:47Z,2018-11-01T18:01:13Z,MERGED,True,7,7,3,https://github.com/otaviobp,Fix documentation and bash script after parameter rename,1,[],https://github.com/clearlinux/swupd-client/pull/614,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/614,"max-parallel-pack-downloads was renamed to max-parallel-downloads
and documentation needs to be fixed
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","max-parallel-pack-downloads was renamed to max-parallel-downloads
and documentation needs to be fixed
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,617,2018-10-11T17:39:06Z,2018-10-22T20:02:45Z,2018-10-22T20:02:45Z,MERGED,True,118,74,14,https://github.com/castulo,Improve error reporting when there is a failure during an update,3,[],https://github.com/clearlinux/swupd-client/pull/617,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/617,"This PR includes commits to improve the way errors in updates are being handled so the final status of an update is more accurately communicated to the user. The PR includes the following items:

It merges the load_mom and load_mom_err functions into since the only difference between them was that load_mom was a wrapper that didn't return an error code in case the function failed.
Shows an actual message of ""Update filed"" when there is an error during the update process.
If one or more files fail to be downloaded, abort the update.

Closes #323","This PR includes commits to improve the way errors in updates are being handled so the final status of an update is more accurately communicated to the user. The PR includes the following items:

It merges the load_mom and load_mom_err functions into since the only difference between them was that load_mom was a wrapper that didn't return an error code in case the function failed.
Shows an actual message of ""Update filed"" when there is an error during the update process.
If one or more files fail to be downloaded, abort the update.

Closes #323",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,617,2018-10-11T17:39:06Z,2018-10-22T20:02:45Z,2018-10-22T20:02:45Z,MERGED,True,118,74,14,https://github.com/castulo,Improve error reporting when there is a failure during an update,3,[],https://github.com/clearlinux/swupd-client/pull/617,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/617#issuecomment-429142758,"This PR includes commits to improve the way errors in updates are being handled so the final status of an update is more accurately communicated to the user. The PR includes the following items:

It merges the load_mom and load_mom_err functions into since the only difference between them was that load_mom was a wrapper that didn't return an error code in case the function failed.
Shows an actual message of ""Update filed"" when there is an error during the update process.
If one or more files fail to be downloaded, abort the update.

Closes #323",@jwakre I made the requested change,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,617,2018-10-11T17:39:06Z,2018-10-22T20:02:45Z,2018-10-22T20:02:45Z,MERGED,True,118,74,14,https://github.com/castulo,Improve error reporting when there is a failure during an update,3,[],https://github.com/clearlinux/swupd-client/pull/617,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/617#issuecomment-430764518,"This PR includes commits to improve the way errors in updates are being handled so the final status of an update is more accurately communicated to the user. The PR includes the following items:

It merges the load_mom and load_mom_err functions into since the only difference between them was that load_mom was a wrapper that didn't return an error code in case the function failed.
Shows an actual message of ""Update filed"" when there is an error during the update process.
If one or more files fail to be downloaded, abort the update.

Closes #323",@otaviobp I made the change you requested,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,617,2018-10-11T17:39:06Z,2018-10-22T20:02:45Z,2018-10-22T20:02:45Z,MERGED,True,118,74,14,https://github.com/castulo,Improve error reporting when there is a failure during an update,3,[],https://github.com/clearlinux/swupd-client/pull/617,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/617#issuecomment-430772459,"This PR includes commits to improve the way errors in updates are being handled so the final status of an update is more accurately communicated to the user. The PR includes the following items:

It merges the load_mom and load_mom_err functions into since the only difference between them was that load_mom was a wrapper that didn't return an error code in case the function failed.
Shows an actual message of ""Update filed"" when there is an error during the update process.
If one or more files fail to be downloaded, abort the update.

Closes #323","I forgot to change the comment of EFILEDOWNLOAD in the test library, I updated that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,619,2018-10-11T22:36:26Z,2018-10-17T17:57:30Z,2018-10-17T17:57:30Z,MERGED,True,112,58,1,https://github.com/castulo,Adding a menu of functions for testlib,1,[],https://github.com/clearlinux/swupd-client/pull/619,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/619,"This commit adds a menu of the functions that are available for
users when writing tests or just using the library to create
resources to test their code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a menu of the functions that are available for
users when writing tests or just using the library to create
resources to test their code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,619,2018-10-11T22:36:26Z,2018-10-17T17:57:30Z,2018-10-17T17:57:30Z,MERGED,True,112,58,1,https://github.com/castulo,Adding a menu of functions for testlib,1,[],https://github.com/clearlinux/swupd-client/pull/619,https://github.com/icarus-sparry,2,https://github.com/clearlinux/swupd-client/pull/619#issuecomment-429333382,"This commit adds a menu of the functions that are available for
users when writing tests or just using the library to create
resources to test their code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I don't think the implementation is a good idea. POSIX only allows the 'foo()' format for declaring a function. 'function foo' is an extension which means different things in ksh, bash, dash etc. In dash it is invalid, in bash it is the same and in ksh it introduces different scoping rules for local variables.
I think a better implementation would use a ""magic comment"" to mark things that should be ignored.
I wonder if the sorts are a good idea. The fact that you are splitting function names which contain ""assert"" apart suggests that a pure sorted list is not exactly what is needed.
Perhaps you could instead look for lines matching say '^## [0-9]+ ', sort them, and then remove the first two 'words' would allow a more general arrangement of the output. It would also allow you to remove the special case code for the headings, you could have '## 0 heading for section 1' and '## 2 heading for section 3' lines.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,619,2018-10-11T22:36:26Z,2018-10-17T17:57:30Z,2018-10-17T17:57:30Z,MERGED,True,112,58,1,https://github.com/castulo,Adding a menu of functions for testlib,1,[],https://github.com/clearlinux/swupd-client/pull/619,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/619#issuecomment-429402770,"This commit adds a menu of the functions that are available for
users when writing tests or just using the library to create
resources to test their code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I don't think the implementation is a good idea. POSIX only allows the 'foo()' format for declaring a function. 'function foo' is an extension which means different things in ksh, bash, dash etc. In dash it is invalid, in bash it is the same and in ksh it introduces different scoping rules for local variables.

We are using bats for testing and only bash is supported, so I don't see a reason on being concerned about that.

I think a better implementation would use a ""magic comment"" to mark things that should be ignored.

Anyway, I think it's a better idea to use a magic comment. But instead of a comment for ignore I would add a comment for listing it. You could have
 foo() { #swupd_function

and
assert_bla() { #swupd_assert

and grep for that comment.

I wonder if the sorts are a good idea. The fact that you are splitting function names which contain ""assert"" apart suggests that a pure sorted list is not exactly what is needed.

I'm ok on just a regular sort for now as we don't have a really big number of functions. But I agree that it's nice to have that organized by sections",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,619,2018-10-11T22:36:26Z,2018-10-17T17:57:30Z,2018-10-17T17:57:30Z,MERGED,True,112,58,1,https://github.com/castulo,Adding a menu of functions for testlib,1,[],https://github.com/clearlinux/swupd-client/pull/619,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/619#issuecomment-429488744,"This commit adds a menu of the functions that are available for
users when writing tests or just using the library to create
resources to test their code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Thanks @icarus-sparry and @otaviobp that is really good feedback,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,619,2018-10-11T22:36:26Z,2018-10-17T17:57:30Z,2018-10-17T17:57:30Z,MERGED,True,112,58,1,https://github.com/castulo,Adding a menu of functions for testlib,1,[],https://github.com/clearlinux/swupd-client/pull/619,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/619#issuecomment-430428287,"This commit adds a menu of the functions that are available for
users when writing tests or just using the library to create
resources to test their code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp, @jwakre, I have addressed your issues in this new PR update.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,620,2018-10-12T18:04:21Z,2018-10-15T20:39:28Z,2018-10-17T19:57:36Z,MERGED,True,24,113,6,https://github.com/jwakre,Remove manifest delta support,1,[],https://github.com/clearlinux/swupd-client/pull/620,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/620,"Delta manifests are no longer used, so removing support for them. This
change removes the try_delta_manifest_download function which was used
to download manifest deltas. After removing this function, the 'current'
and 'file' parameters were no longer used by the retrieve_manifests
function. This had a ripple effect that removed unused parameters from
a variety of other functions.
Signed-off-by: John Akre john.w.akre@intel.com","Delta manifests are no longer used, so removing support for them. This
change removes the try_delta_manifest_download function which was used
to download manifest deltas. After removing this function, the 'current'
and 'file' parameters were no longer used by the retrieve_manifests
function. This had a ripple effect that removed unused parameters from
a variety of other functions.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,623,2018-10-16T00:10:40Z,2018-10-17T23:14:30Z,2018-11-01T18:01:11Z,MERGED,True,30,2,3,https://github.com/otaviobp,test: Test if make install is installing all necessary files,1,[],https://github.com/clearlinux/swupd-client/pull/623,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/623,"Check if all files expected to be installed in a full installation are
really installed","Check if all files expected to be installed in a full installation are
really installed",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,625,2018-10-17T18:13:43Z,2018-10-18T17:19:30Z,2018-11-01T18:01:10Z,MERGED,True,6,4,5,https://github.com/otaviobp,Remove 404 from the list of possible swupd return codes,1,[],https://github.com/clearlinux/swupd-client/pull/625,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/625,"Linux programs return code should be a number between 0 and 255, so 404 is an
invalid return code. Removing it from docs and from swupd-error.h file.
As it wasn't being used, this won't be a problem.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Linux programs return code should be a number between 0 and 255, so 404 is an
invalid return code. Removing it from docs and from swupd-error.h file.
As it wasn't being used, this won't be a problem.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,625,2018-10-17T18:13:43Z,2018-10-18T17:19:30Z,2018-11-01T18:01:10Z,MERGED,True,6,4,5,https://github.com/otaviobp,Remove 404 from the list of possible swupd return codes,1,[],https://github.com/clearlinux/swupd-client/pull/625,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/625#issuecomment-430732888,"Linux programs return code should be a number between 0 and 255, so 404 is an
invalid return code. Removing it from docs and from swupd-error.h file.
As it wasn't being used, this won't be a problem.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Related to commend I did on #617,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,626,2018-10-17T22:47:49Z,2018-10-22T23:22:50Z,2018-10-22T23:22:50Z,MERGED,True,5,2,1,https://github.com/castulo,Adding the author and testID info to test template,1,[],https://github.com/clearlinux/swupd-client/pull/626,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/626,"This commit adds a few improvements to the test template that aim to
make easier to track tests.
As we are trying to organize the swupd tests better, it is useful to
have an easy way to identify who the original author of the test was
in case there are questions regarding the purpose of the test.
It is also useful sometimes to add a long description to a complex
test, so people reading the test understand what the test is attempting
to verify, and why is useful or different.
Lastly, it is a good practice to add a unique ID to every test case,
this makes it easier to track it, and to refer to it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a few improvements to the test template that aim to
make easier to track tests.
As we are trying to organize the swupd tests better, it is useful to
have an easy way to identify who the original author of the test was
in case there are questions regarding the purpose of the test.
It is also useful sometimes to add a long description to a complex
test, so people reading the test understand what the test is attempting
to verify, and why is useful or different.
Lastly, it is a good practice to add a unique ID to every test case,
this makes it easier to track it, and to refer to it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,627,2018-10-18T00:12:12Z,2018-10-22T20:06:43Z,2018-10-22T20:06:43Z,MERGED,True,15,7,5,https://github.com/castulo,Fix a bug in some verify tests,1,[],https://github.com/clearlinux/swupd-client/pull/627,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/627,"Some time ago the ""-u"" option of the create_test_environment and
create_version functions was renamed to ""-r"". Four of the verify
tests were not updated, so they were crashing during the setup,
while trying to create the test environment, so the test would not
be run since the setup failed but the teardown would still run and
the teardown would attempt to delete a non existant test environment
which would cause the destroy_test_environment to exit the script
causing an inconclusive test result.
This commit fixes the issue by doing the following actions:

Fixes the tests by using the correct option ""-r"".
Modifies the destroy_test_environment function so it does not exit
if a test environment doesn't exist, but instead it just returns a non
zero code and warns the user so the teardown works as expected.

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some time ago the ""-u"" option of the create_test_environment and
create_version functions was renamed to ""-r"". Four of the verify
tests were not updated, so they were crashing during the setup,
while trying to create the test environment, so the test would not
be run since the setup failed but the teardown would still run and
the teardown would attempt to delete a non existant test environment
which would cause the destroy_test_environment to exit the script
causing an inconclusive test result.
This commit fixes the issue by doing the following actions:

Fixes the tests by using the correct option ""-r"".
Modifies the destroy_test_environment function so it does not exit
if a test environment doesn't exist, but instead it just returns a non
zero code and warns the user so the teardown works as expected.

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,627,2018-10-18T00:12:12Z,2018-10-22T20:06:43Z,2018-10-22T20:06:43Z,MERGED,True,15,7,5,https://github.com/castulo,Fix a bug in some verify tests,1,[],https://github.com/clearlinux/swupd-client/pull/627,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/627#issuecomment-430836222,"Some time ago the ""-u"" option of the create_test_environment and
create_version functions was renamed to ""-r"". Four of the verify
tests were not updated, so they were crashing during the setup,
while trying to create the test environment, so the test would not
be run since the setup failed but the teardown would still run and
the teardown would attempt to delete a non existant test environment
which would cause the destroy_test_environment to exit the script
causing an inconclusive test result.
This commit fixes the issue by doing the following actions:

Fixes the tests by using the correct option ""-r"".
Modifies the destroy_test_environment function so it does not exit
if a test environment doesn't exist, but instead it just returns a non
zero code and warns the user so the teardown works as expected.

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Spelling: s/accouonted/accounted
Otherwise +1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,627,2018-10-18T00:12:12Z,2018-10-22T20:06:43Z,2018-10-22T20:06:43Z,MERGED,True,15,7,5,https://github.com/castulo,Fix a bug in some verify tests,1,[],https://github.com/clearlinux/swupd-client/pull/627,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/627#issuecomment-431092371,"Some time ago the ""-u"" option of the create_test_environment and
create_version functions was renamed to ""-r"". Four of the verify
tests were not updated, so they were crashing during the setup,
while trying to create the test environment, so the test would not
be run since the setup failed but the teardown would still run and
the teardown would attempt to delete a non existant test environment
which would cause the destroy_test_environment to exit the script
causing an inconclusive test result.
This commit fixes the issue by doing the following actions:

Fixes the tests by using the correct option ""-r"".
Modifies the destroy_test_environment function so it does not exit
if a test environment doesn't exist, but instead it just returns a non
zero code and warns the user so the teardown works as expected.

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","so they were crashing during the setup, so the failure was not accouonted for

We need a fix for that. If the setup is failing the test should fail. This is a big problem. if it's not an easy fix, open an issue for that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,627,2018-10-18T00:12:12Z,2018-10-22T20:06:43Z,2018-10-22T20:06:43Z,MERGED,True,15,7,5,https://github.com/castulo,Fix a bug in some verify tests,1,[],https://github.com/clearlinux/swupd-client/pull/627,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/627#issuecomment-431092445,"Some time ago the ""-u"" option of the create_test_environment and
create_version functions was renamed to ""-r"". Four of the verify
tests were not updated, so they were crashing during the setup,
while trying to create the test environment, so the test would not
be run since the setup failed but the teardown would still run and
the teardown would attempt to delete a non existant test environment
which would cause the destroy_test_environment to exit the script
causing an inconclusive test result.
This commit fixes the issue by doing the following actions:

Fixes the tests by using the correct option ""-r"".
Modifies the destroy_test_environment function so it does not exit
if a test environment doesn't exist, but instead it just returns a non
zero code and warns the user so the teardown works as expected.

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","btw, s/crete_version/create_version",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,627,2018-10-18T00:12:12Z,2018-10-22T20:06:43Z,2018-10-22T20:06:43Z,MERGED,True,15,7,5,https://github.com/castulo,Fix a bug in some verify tests,1,[],https://github.com/clearlinux/swupd-client/pull/627,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/627#issuecomment-431130287,"Some time ago the ""-u"" option of the create_test_environment and
create_version functions was renamed to ""-r"". Four of the verify
tests were not updated, so they were crashing during the setup,
while trying to create the test environment, so the test would not
be run since the setup failed but the teardown would still run and
the teardown would attempt to delete a non existant test environment
which would cause the destroy_test_environment to exit the script
causing an inconclusive test result.
This commit fixes the issue by doing the following actions:

Fixes the tests by using the correct option ""-r"".
Modifies the destroy_test_environment function so it does not exit
if a test environment doesn't exist, but instead it just returns a non
zero code and warns the user so the teardown works as expected.

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","so they were crashing during the setup, so the failure was not accouonted for

We need a fix for that. If the setup is failing the test should fail. This is a big problem. if it's not an easy fix, open an issue for that.

So after further debugging this, I found out that the problem is actually not because there was an error in the setup method.... but the real problem was with the teardown method.
Looks like this is the current behavior in BATS; if something causes the test execution to exit during setup or during the test body, the test shows as failed correctly, but if exit occurs during teardown then the test shows no result.
For example, this case:
#!/usr/bin/env bats

setup() {
	exit 1
}

teardown() {
	echo ""teardown""
}


@test ""some test"" {
	exit 1
}

Running the test above will yield the correct result:
 some test
1 test, 1 failure
Now, consider this other one:
#!/usr/bin/env bats

setup() {
	exit 1
}

teardown() {
	exit 1
}

@test ""some test"" {
	exit 1
}

The test above will yield to an incorrect inconclusive result:
some test
1 test, 0 failures
It doesn't pass but it doesn't fail either.
The misbehaving verify tests where using a wrong option when creating the test environment, which would cause the create_test_environment function to fail, and issue an exit 1, which should be fine,  but then the tests were running their teardown function which was attempting to destroy the test environment using the destroy_test_environment function using a non existing environment as parameter, this was causing this function to trigger an exit 1 which would cause the inconclusive test result.
I will update this PR to address that and will update the commit message.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/628,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-432860005,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Fixed proposed changes, added --no-scripts to verify and update commands, added a new variable $BUNDLE_LIST to make it possible to run a faster test and added a new test to check if fullfile downloads are working.
To run it in the fast mode just do:
$ BUNDLE_LIST=os-core bats -t test/real_content/test_swupd.bats",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-433189399,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Actually one thing I used to do in the last project I worked on, is that we had shellcheck running in our CI server on every bash script and it would reject the patch if it the scripts didn't comply with shellcheck. It would save reviewers time if we do something like that.

I forgot about that again. Can you set that up for travis? Unless it takes a really long time it would be nice to have this run on every script we change.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-433193314,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","I forgot about that again. Can you set that up for travis? Unless it takes a really long time it would be nice to have this run on every script we change.

I think it may take some time, but it is something we can start thinking about implementing soon. I'll keep that in my radar and will start researching about doing that soon.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-434507006,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",@castulo I fixed all shellcheck reported problems and renamed the file,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-434521196,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","@otaviobp there is still one comment you have not addressed though:

in line 22 you defined a local variable called VERSIONS:
local VERSIONS # Array of last available versions. First item is the oldest
but here you are using VERSION and I don't see VERSIONS anywhere else. did you mean to use VERSIONS here?

So didn't you mean to call the variable at line 23 as VERSION instead of VERSIONS?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-434762503,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","So didn't you mean to call the variable at line 23 as VERSION instead of VERSIONS?

yes. fixed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-434774070,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",@otaviobp did you say you ran shellcheck in your script and fixed all the issues reported by it? I just did and I see 24 issues reported by shellcheck. Starting with the variables you are declaring as local at the beginning of the script. local only make sense inside a function.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-434822240,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Ouch. I renamed the file to a name that was in .gitignore. So I sent the outdated version. Thank you for noticing.
I have just pushed a new version with a change to .gitignore.
I'm also always using shellchecker binary with the seds in Makefile because shellcheck can't recognize load and @test.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,628,2018-10-18T18:19:47Z,2018-11-01T17:01:00Z,2018-11-01T18:00:59Z,MERGED,True,235,1,2,https://github.com/otaviobp,test: Check if swupd is able to perform updates in last releases,2,[],https://github.com/clearlinux/swupd-client/pull/628,https://github.com/otaviobp,10,https://github.com/clearlinux/swupd-client/pull/628#issuecomment-434847487,"Tests added:

Check if bundle-list --all is working (because this affect the next tests)
Check if we can install an old version of clear and update interactively
until last release
Check if we can install and old version and update to the most recent one

As this test takes a really long time to run, I'm not adding it to the
tests list to be executed to make check, but this can be used to validate
swupd before a release.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","well, I think we're fine now",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,631,2018-10-18T21:28:13Z,2018-10-25T20:42:14Z,2018-11-20T21:27:52Z,MERGED,True,104,22,8,https://github.com/jwakre,Safely convert strings to numbers,1,[],https://github.com/clearlinux/swupd-client/pull/631,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/631,"Various functions, like strtol, were used to convert strings to numbers.
Frequently, the results of these conversion functions were stored in
variables with types that did not match the function return value. As a
result, there was a potential risk that an overflow would occur when
type casting the string conversion function result to store it in a
mismatched type.
The most common case is to convert a string to an int, so this commit
creates the strtoi_err function which converts a string to an int and
provides error handling. Also, the error checking for other string to
number conversions was improved by adding error handling with errno.
Fixes #601
Signed-off-by: John Akre john.w.akre@intel.com","Various functions, like strtol, were used to convert strings to numbers.
Frequently, the results of these conversion functions were stored in
variables with types that did not match the function return value. As a
result, there was a potential risk that an overflow would occur when
type casting the string conversion function result to store it in a
mismatched type.
The most common case is to convert a string to an int, so this commit
creates the strtoi_err function which converts a string to an int and
provides error handling. Also, the error checking for other string to
number conversions was improved by adding error handling with errno.
Fixes #601
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,631,2018-10-18T21:28:13Z,2018-10-25T20:42:14Z,2018-11-20T21:27:52Z,MERGED,True,104,22,8,https://github.com/jwakre,Safely convert strings to numbers,1,[],https://github.com/clearlinux/swupd-client/pull/631,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/631#issuecomment-431188835,"Various functions, like strtol, were used to convert strings to numbers.
Frequently, the results of these conversion functions were stored in
variables with types that did not match the function return value. As a
result, there was a potential risk that an overflow would occur when
type casting the string conversion function result to store it in a
mismatched type.
The most common case is to convert a string to an int, so this commit
creates the strtoi_err function which converts a string to an int and
provides error handling. Also, the error checking for other string to
number conversions was improved by adding error handling with errno.
Fixes #601
Signed-off-by: John Akre john.w.akre@intel.com","I am unsure on the best way to create tests for this change because different systems will have different type ranges. On my system I verified that type overflows was a problem (updating to version 2^32 + 100 identical to updating to version 100). With this change, type overflows were caught on my system.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,631,2018-10-18T21:28:13Z,2018-10-25T20:42:14Z,2018-11-20T21:27:52Z,MERGED,True,104,22,8,https://github.com/jwakre,Safely convert strings to numbers,1,[],https://github.com/clearlinux/swupd-client/pull/631,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/631#issuecomment-432405855,"Various functions, like strtol, were used to convert strings to numbers.
Frequently, the results of these conversion functions were stored in
variables with types that did not match the function return value. As a
result, there was a potential risk that an overflow would occur when
type casting the string conversion function result to store it in a
mismatched type.
The most common case is to convert a string to an int, so this commit
creates the strtoi_err function which converts a string to an int and
provides error handling. Also, the error checking for other string to
number conversions was improved by adding error handling with errno.
Fixes #601
Signed-off-by: John Akre john.w.akre@intel.com","New changes to address @otaviobp 's feedback:

strtoi_err returns errno status code and passes converted int by reference.
Remove base argument from strtoi_err
Use negative errno codes
Return -EOVERFLOW when type casting long to int overflows",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,631,2018-10-18T21:28:13Z,2018-10-25T20:42:14Z,2018-11-20T21:27:52Z,MERGED,True,104,22,8,https://github.com/jwakre,Safely convert strings to numbers,1,[],https://github.com/clearlinux/swupd-client/pull/631,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/631#issuecomment-432420376,"Various functions, like strtol, were used to convert strings to numbers.
Frequently, the results of these conversion functions were stored in
variables with types that did not match the function return value. As a
result, there was a potential risk that an overflow would occur when
type casting the string conversion function result to store it in a
mismatched type.
The most common case is to convert a string to an int, so this commit
creates the strtoi_err function which converts a string to an int and
provides error handling. Also, the error checking for other string to
number conversions was improved by adding error handling with errno.
Fixes #601
Signed-off-by: John Akre john.w.akre@intel.com",nice changes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,637,2018-10-19T22:54:59Z,2018-11-12T22:28:29Z,2018-11-12T22:28:29Z,CLOSED,False,144,0,6,https://github.com/matthewrsj,tests: add verify --install tests,1,['testing'],https://github.com/clearlinux/swupd-client/pull/637,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/637,"This adds several tests for os installation functionality.

install - regular installation of just os-core
install-multiple - install os-core and a test-bundle
install-bad - attempt to install an invalid bundle name
install-no-zero-packs - install os-core and test-bundle with no
zero-packs available. Fullfiles still available as a fallback.
install-no-fullfile-fallback - attempt to install with no zero packs
and no fullfiles available for fallback.

Signed-off-by: Matthew Johnson matthew.johnson@intel.com","This adds several tests for os installation functionality.

install - regular installation of just os-core
install-multiple - install os-core and a test-bundle
install-bad - attempt to install an invalid bundle name
install-no-zero-packs - install os-core and test-bundle with no
zero-packs available. Fullfiles still available as a fallback.
install-no-fullfile-fallback - attempt to install with no zero packs
and no fullfiles available for fallback.

Signed-off-by: Matthew Johnson matthew.johnson@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,637,2018-10-19T22:54:59Z,2018-11-12T22:28:29Z,2018-11-12T22:28:29Z,CLOSED,False,144,0,6,https://github.com/matthewrsj,tests: add verify --install tests,1,['testing'],https://github.com/clearlinux/swupd-client/pull/637,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/637#issuecomment-438050600,"This adds several tests for os installation functionality.

install - regular installation of just os-core
install-multiple - install os-core and a test-bundle
install-bad - attempt to install an invalid bundle name
install-no-zero-packs - install os-core and test-bundle with no
zero-packs available. Fullfiles still available as a fallback.
install-no-fullfile-fallback - attempt to install with no zero packs
and no fullfiles available for fallback.

Signed-off-by: Matthew Johnson matthew.johnson@intel.com","Merged adding changes proposed by @castulo, but I didn't remove the touch lines because they were necessary",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,639,2018-10-19T23:48:54Z,2018-10-22T22:09:19Z,2018-10-22T22:09:19Z,MERGED,True,48,0,2,https://github.com/castulo,Adding tests for bundle-add --nosigcheck,1,[],https://github.com/clearlinux/swupd-client/pull/639,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/639,"Adding missing tests for the --nosigcheck option in the
bundle-add command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding missing tests for the --nosigcheck option in the
bundle-add command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,641,2018-10-19T23:58:51Z,2018-11-16T18:09:40Z,2018-11-16T18:09:40Z,MERGED,True,52,0,2,https://github.com/reaganlo,Adding missing tests for the -t option in the bundle-add command.,1,[],https://github.com/clearlinux/swupd-client/pull/641,https://github.com/reaganlo,1,https://github.com/clearlinux/swupd-client/pull/641,Adding missing tests for the -t option in the bundle-add command.,Adding missing tests for the -t option in the bundle-add command.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,641,2018-10-19T23:58:51Z,2018-11-16T18:09:40Z,2018-11-16T18:09:40Z,MERGED,True,52,0,2,https://github.com/reaganlo,Adding missing tests for the -t option in the bundle-add command.,1,[],https://github.com/clearlinux/swupd-client/pull/641,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/641#issuecomment-431907167,Adding missing tests for the -t option in the bundle-add command.,"One more thing @reaganlo , in order for that test to run in travis, you need to add that test (in alphabetic order) to https://github.com/clearlinux/swupd-client/blob/master/Makefile.am#L114",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,642,2018-10-20T00:41:13Z,2018-10-22T21:07:16Z,2018-10-22T21:07:16Z,MERGED,True,8,0,1,https://github.com/phmccarty,test: add localhost for no_proxy if not present,1,[],https://github.com/clearlinux/swupd-client/pull/642,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/642,"I see the checkupdate/chk-update-slow-server test fail when the http_proxy env variable is set, but no_proxy is not set.
Resolve the issue by adding ""localhost"" to no_proxy if needed, since the test web servers run on localhost.","I see the checkupdate/chk-update-slow-server test fail when the http_proxy env variable is set, but no_proxy is not set.
Resolve the issue by adding ""localhost"" to no_proxy if needed, since the test web servers run on localhost.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,643,2018-10-22T18:32:41Z,2018-10-22T21:11:44Z,2018-10-22T21:11:44Z,MERGED,True,14,0,2,https://github.com/matthewrsj,man-pages: add os-format reference,1,['documentation'],https://github.com/clearlinux/swupd-client/pull/643,https://github.com/matthewrsj,1,https://github.com/clearlinux/swupd-client/pull/643,Waiting on clearlinux/clr-man-pages#4,Waiting on clearlinux/clr-man-pages#4,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,644,2018-10-22T18:51:31Z,2018-10-24T20:04:16Z,2018-10-24T20:04:16Z,MERGED,True,5,7,3,https://github.com/castulo,bundle-add to return 0 if bundle already installed,1,[],https://github.com/clearlinux/swupd-client/pull/644,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/644,"Previously, the only way to get a return code of 0 (success) during
a bundle-add operation was if everything that was attempted to be
added had been successful. That means that bundle-add command was
returning EBUNDLE_INSTALL whenever it would try to add a bundle that
was already installed.
This commit changes the return code of such operation since it was
determined that it is a more appropriate behavior to consider an
attempt to add a bundle that is already added as successful, even when
no bundle was added during the operation.
Closes #510
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Previously, the only way to get a return code of 0 (success) during
a bundle-add operation was if everything that was attempted to be
added had been successful. That means that bundle-add command was
returning EBUNDLE_INSTALL whenever it would try to add a bundle that
was already installed.
This commit changes the return code of such operation since it was
determined that it is a more appropriate behavior to consider an
attempt to add a bundle that is already added as successful, even when
no bundle was added during the operation.
Closes #510
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,644,2018-10-22T18:51:31Z,2018-10-24T20:04:16Z,2018-10-24T20:04:16Z,MERGED,True,5,7,3,https://github.com/castulo,bundle-add to return 0 if bundle already installed,1,[],https://github.com/clearlinux/swupd-client/pull/644,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/644#issuecomment-432771049,"Previously, the only way to get a return code of 0 (success) during
a bundle-add operation was if everything that was attempted to be
added had been successful. That means that bundle-add command was
returning EBUNDLE_INSTALL whenever it would try to add a bundle that
was already installed.
This commit changes the return code of such operation since it was
determined that it is a more appropriate behavior to consider an
attempt to add a bundle that is already added as successful, even when
no bundle was added during the operation.
Closes #510
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I had missed updating one test, Travis should be happy now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,646,2018-10-22T22:01:03Z,2018-10-22T23:34:49Z,2018-11-01T18:01:10Z,MERGED,True,7,7,7,https://github.com/otaviobp,test: Fix flag name on certificate tests,1,[],https://github.com/clearlinux/swupd-client/pull/646,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/646,"sed s/fallback-ca-paths/with-fallback-capaths/g
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","sed s/fallback-ca-paths/with-fallback-capaths/g
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,648,2018-10-22T23:51:34Z,2018-10-24T16:55:00Z,2018-11-01T18:01:03Z,MERGED,True,18,10,2,https://github.com/otaviobp,Add systemd unitdir to swupd --version output,1,[],https://github.com/clearlinux/swupd-client/pull/648,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/648,"Print the compile-time configuration systemdsystemunitdir.
Option was incorrectly removed on 74b2d52 so it didn't get into commit
that added extra information to --version (204e2a4)
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Print the compile-time configuration systemdsystemunitdir.
Option was incorrectly removed on 74b2d52 so it didn't get into commit
that added extra information to --version (204e2a4)
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,649,2018-10-23T19:13:33Z,2018-10-24T16:56:04Z,2018-11-20T21:26:42Z,MERGED,True,75,104,5,https://github.com/jwakre,test: consolidate test web server implementations,1,[],https://github.com/clearlinux/swupd-client/pull/649,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/649,"There were two web server implementations in the functional tests and the
test library's slow server implementation was not functional. These issues
were addressed by the following changes:

Consolidate test web server implementations into test library
Add partial download support to start_web_server test library function
Fix test library slow server functionality.

Signed-off-by: John Akre john.w.akre@intel.com","There were two web server implementations in the functional tests and the
test library's slow server implementation was not functional. These issues
were addressed by the following changes:

Consolidate test web server implementations into test library
Add partial download support to start_web_server test library function
Fix test library slow server functionality.

Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,649,2018-10-23T19:13:33Z,2018-10-24T16:56:04Z,2018-11-20T21:26:42Z,MERGED,True,75,104,5,https://github.com/jwakre,test: consolidate test web server implementations,1,[],https://github.com/clearlinux/swupd-client/pull/649,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/649#issuecomment-432436533,"There were two web server implementations in the functional tests and the
test library's slow server implementation was not functional. These issues
were addressed by the following changes:

Consolidate test web server implementations into test library
Add partial download support to start_web_server test library function
Fix test library slow server functionality.

Signed-off-by: John Akre john.w.akre@intel.com","New version has the following changes to address feedback:

Server reads 1 byte at a time.
Changed latest version in check version test to 99990.

Additionally, the previous implementation had a problem with the logic to match the file name from self.path with partial_download_file. The old implementation used the 'endswith' function which would match incorrectly. Now, the 'split' function is used to correctly match the last path item from self.path with partial_download_file.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,653,2018-10-24T00:39:08Z,2018-10-30T16:49:43Z,2018-10-30T17:06:49Z,MERGED,True,262,75,9,https://github.com/castulo,Use verify --fix --picky with older versions,2,[],https://github.com/clearlinux/swupd-client/pull/653,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/653,"When you do a ""verify --fix --picky -m older_version"", and one
or more of the currently installed bundles didn't exist back then,
a non useful error message was being used, and the verify operation
would fail.
This commit makes the following changes.


With this commit, if the mentioned situation happens, the verify
operation will still be stopped, but a useful message will now be
displayed to inform the user of the situation, and he/she will be
presented with an alternative to proceed using the --force option.


If the user uses the --force option, the user will still be warned
but the verify operation will continue and the offending bundles will
be removed from the system.


Fixes a bug when using verify --picky. Only files that were orphaned
were being counted as files being removed from the system, files removed
because of the picky options were not being counted. This commit fixes
that.


Closes #608
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When you do a ""verify --fix --picky -m older_version"", and one
or more of the currently installed bundles didn't exist back then,
a non useful error message was being used, and the verify operation
would fail.
This commit makes the following changes.


With this commit, if the mentioned situation happens, the verify
operation will still be stopped, but a useful message will now be
displayed to inform the user of the situation, and he/she will be
presented with an alternative to proceed using the --force option.


If the user uses the --force option, the user will still be warned
but the verify operation will continue and the offending bundles will
be removed from the system.


Fixes a bug when using verify --picky. Only files that were orphaned
were being counted as files being removed from the system, files removed
because of the picky options were not being counted. This commit fixes
that.


Closes #608
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,653,2018-10-24T00:39:08Z,2018-10-30T16:49:43Z,2018-10-30T17:06:49Z,MERGED,True,262,75,9,https://github.com/castulo,Use verify --fix --picky with older versions,2,[],https://github.com/clearlinux/swupd-client/pull/653,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/653#issuecomment-432859622,"When you do a ""verify --fix --picky -m older_version"", and one
or more of the currently installed bundles didn't exist back then,
a non useful error message was being used, and the verify operation
would fail.
This commit makes the following changes.


With this commit, if the mentioned situation happens, the verify
operation will still be stopped, but a useful message will now be
displayed to inform the user of the situation, and he/she will be
presented with an alternative to proceed using the --force option.


If the user uses the --force option, the user will still be warned
but the verify operation will continue and the offending bundles will
be removed from the system.


Fixes a bug when using verify --picky. Only files that were orphaned
were being counted as files being removed from the system, files removed
because of the picky options were not being counted. This commit fixes
that.


Closes #608
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I made the changes you requested and I also took the opportunity to regroup the changes into more appropriate commits according to what they were doing so they are more organized.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,653,2018-10-24T00:39:08Z,2018-10-30T16:49:43Z,2018-10-30T17:06:49Z,MERGED,True,262,75,9,https://github.com/castulo,Use verify --fix --picky with older versions,2,[],https://github.com/clearlinux/swupd-client/pull/653,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/653#issuecomment-432859832,"When you do a ""verify --fix --picky -m older_version"", and one
or more of the currently installed bundles didn't exist back then,
a non useful error message was being used, and the verify operation
would fail.
This commit makes the following changes.


With this commit, if the mentioned situation happens, the verify
operation will still be stopped, but a useful message will now be
displayed to inform the user of the situation, and he/she will be
presented with an alternative to proceed using the --force option.


If the user uses the --force option, the user will still be warned
but the verify operation will continue and the offending bundles will
be removed from the system.


Fixes a bug when using verify --picky. Only files that were orphaned
were being counted as files being removed from the system, files removed
because of the picky options were not being counted. This commit fixes
that.


Closes #608
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","oops, commented in the wrong PR",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,654,2018-10-24T19:56:09Z,2018-10-24T21:02:05Z,2018-11-01T18:01:02Z,MERGED,True,23,23,1,https://github.com/otaviobp,makefile: Group variables and targets,1,[],https://github.com/clearlinux/swupd-client/pull/654,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/654,"When mixing variables and targets make was attributing some variables as
targets. Because of that make install was running some tests defined in TEST
variable. Reordering all variable definitions to make sure all are defined
before first target definition.
Fix travis error in #653","When mixing variables and targets make was attributing some variables as
targets. Because of that make install was running some tests defined in TEST
variable. Reordering all variable definitions to make sure all are defined
before first target definition.
Fix travis error in #653",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,656,2018-10-25T17:18:08Z,2018-11-07T21:41:09Z,2018-11-07T21:41:09Z,MERGED,True,9,0,1,https://github.com/evil-brain,archives: Add output for out of space errors,1,[],https://github.com/clearlinux/swupd-client/pull/656,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/656,"Libarchive's archive_error_string() method returns a textual
error message suitable for display.
However, this method returns only ""Write Failed"" if libarchive
runs out of hard disk space.
Check specifically for ENOSPC and print a correct
warning message to the user.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Libarchive's archive_error_string() method returns a textual
error message suitable for display.
However, this method returns only ""Write Failed"" if libarchive
runs out of hard disk space.
Check specifically for ENOSPC and print a correct
warning message to the user.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,656,2018-10-25T17:18:08Z,2018-11-07T21:41:09Z,2018-11-07T21:41:09Z,MERGED,True,9,0,1,https://github.com/evil-brain,archives: Add output for out of space errors,1,[],https://github.com/clearlinux/swupd-client/pull/656,https://github.com/evil-brain,2,https://github.com/clearlinux/swupd-client/pull/656#issuecomment-433134960,"Libarchive's archive_error_string() method returns a textual
error message suitable for display.
However, this method returns only ""Write Failed"" if libarchive
runs out of hard disk space.
Check specifically for ENOSPC and print a correct
warning message to the user.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","I think this may fix #486 - unless we can think of any more side cases... libcurl reports a little weird (Error for $FILE download: Response 200 - Failed writing received data to disk/application), but I think that is a good enough pointer to check disk space...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,656,2018-10-25T17:18:08Z,2018-11-07T21:41:09Z,2018-11-07T21:41:09Z,MERGED,True,9,0,1,https://github.com/evil-brain,archives: Add output for out of space errors,1,[],https://github.com/clearlinux/swupd-client/pull/656,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/656#issuecomment-434394091,"Libarchive's archive_error_string() method returns a textual
error message suitable for display.
However, this method returns only ""Write Failed"" if libarchive
runs out of hard disk space.
Check specifically for ENOSPC and print a correct
warning message to the user.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","I think this may fix #486 - unless we can think of any more side cases... libcurl reports a little weird (Error for $FILE download: Response 200 - Failed writing received data to disk/application), but I think that is a good enough pointer to check disk space...

Let's improve that message in curl before closing this. It's too confusing to me",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,657,2018-10-25T19:52:57Z,2018-10-30T22:00:23Z,2018-10-30T22:00:23Z,MERGED,True,56,13,3,https://github.com/castulo,Improvements for DEBUG_TEST in test library,1,[],https://github.com/clearlinux/swupd-client/pull/657,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/657,"When running tests, there is the possibility of preserving your
test environment for debugging purposes.
We were preserving the environment by skipping the execution of
the destroy_test_environment function when the DEBUG_TEST env
variable was set. This had one limitation, this was being done in
the default teardown function, so if the user would define his own
teardown then the DEBUG_TEST had no effect, the same if the user
used global_teardown instead. Another limitation the current
implementation had was that when an environment had been preserved
if the user would forget to clean it up manually before re-running
the test it would cause unexpected results in the test.
This commit removes both limitations by looking for the DEBUG_TEST
variable directly within the destroy_test_environment function so
the env will be preserved regardless of where the function is called
from and removes the environment at the beginning of the test if it
exists.
Closes #651
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running tests, there is the possibility of preserving your
test environment for debugging purposes.
We were preserving the environment by skipping the execution of
the destroy_test_environment function when the DEBUG_TEST env
variable was set. This had one limitation, this was being done in
the default teardown function, so if the user would define his own
teardown then the DEBUG_TEST had no effect, the same if the user
used global_teardown instead. Another limitation the current
implementation had was that when an environment had been preserved
if the user would forget to clean it up manually before re-running
the test it would cause unexpected results in the test.
This commit removes both limitations by looking for the DEBUG_TEST
variable directly within the destroy_test_environment function so
the env will be preserved regardless of where the function is called
from and removes the environment at the beginning of the test if it
exists.
Closes #651
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,657,2018-10-25T19:52:57Z,2018-10-30T22:00:23Z,2018-10-30T22:00:23Z,MERGED,True,56,13,3,https://github.com/castulo,Improvements for DEBUG_TEST in test library,1,[],https://github.com/clearlinux/swupd-client/pull/657,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/657#issuecomment-433202796,"When running tests, there is the possibility of preserving your
test environment for debugging purposes.
We were preserving the environment by skipping the execution of
the destroy_test_environment function when the DEBUG_TEST env
variable was set. This had one limitation, this was being done in
the default teardown function, so if the user would define his own
teardown then the DEBUG_TEST had no effect, the same if the user
used global_teardown instead. Another limitation the current
implementation had was that when an environment had been preserved
if the user would forget to clean it up manually before re-running
the test it would cause unexpected results in the test.
This commit removes both limitations by looking for the DEBUG_TEST
variable directly within the destroy_test_environment function so
the env will be preserved regardless of where the function is called
from and removes the environment at the beginning of the test if it
exists.
Closes #651
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","some tests, are failing, I'll take a look at this",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,657,2018-10-25T19:52:57Z,2018-10-30T22:00:23Z,2018-10-30T22:00:23Z,MERGED,True,56,13,3,https://github.com/castulo,Improvements for DEBUG_TEST in test library,1,[],https://github.com/clearlinux/swupd-client/pull/657,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/657#issuecomment-433255218,"When running tests, there is the possibility of preserving your
test environment for debugging purposes.
We were preserving the environment by skipping the execution of
the destroy_test_environment function when the DEBUG_TEST env
variable was set. This had one limitation, this was being done in
the default teardown function, so if the user would define his own
teardown then the DEBUG_TEST had no effect, the same if the user
used global_teardown instead. Another limitation the current
implementation had was that when an environment had been preserved
if the user would forget to clean it up manually before re-running
the test it would cause unexpected results in the test.
This commit removes both limitations by looking for the DEBUG_TEST
variable directly within the destroy_test_environment function so
the env will be preserved regardless of where the function is called
from and removes the environment at the beginning of the test if it
exists.
Closes #651
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There was an issue when cleaning up an old environment in the scenario where global_setup was being used, since the rest of the tests share one environment. To be able to fix this I had to implement the use of multiple environment, which is what you were referring to @otaviobp . It should work now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,657,2018-10-25T19:52:57Z,2018-10-30T22:00:23Z,2018-10-30T22:00:23Z,MERGED,True,56,13,3,https://github.com/castulo,Improvements for DEBUG_TEST in test library,1,[],https://github.com/clearlinux/swupd-client/pull/657,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/657#issuecomment-434000782,"When running tests, there is the possibility of preserving your
test environment for debugging purposes.
We were preserving the environment by skipping the execution of
the destroy_test_environment function when the DEBUG_TEST env
variable was set. This had one limitation, this was being done in
the default teardown function, so if the user would define his own
teardown then the DEBUG_TEST had no effect, the same if the user
used global_teardown instead. Another limitation the current
implementation had was that when an environment had been preserved
if the user would forget to clean it up manually before re-running
the test it would cause unexpected results in the test.
This commit removes both limitations by looking for the DEBUG_TEST
variable directly within the destroy_test_environment function so
the env will be preserved regardless of where the function is called
from and removes the environment at the beginning of the test if it
exists.
Closes #651
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","As suggested by @jwakre, when using a global environment, if DEBUG_TEST is set, we will keep a copy of each test's state dir.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,658,2018-10-25T21:13:51Z,2018-10-30T17:48:22Z,2018-10-30T17:48:23Z,MERGED,True,257,175,8,https://github.com/otaviobp,Time: Improvements in time logging and reporting,4,[],https://github.com/clearlinux/swupd-client/pull/658,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/658,"Fixes some bugs and organizes code. Also printing now the total time of a swupd execution.
Fixes #575","Fixes some bugs and organizes code. Also printing now the total time of a swupd execution.
Fixes #575",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,659,2018-10-26T21:01:16Z,2018-10-30T16:57:27Z,2018-10-30T16:57:27Z,MERGED,True,61,6,1,https://github.com/castulo,"Adding info about ""Getting help"" to testlib readme",1,[],https://github.com/clearlinux/swupd-client/pull/659,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/659,"Some functionality was added to the test library to allow printing
function availability plus usage information.
This commit adds that info to the readme of the library to keep it
accurate. It also adds a table of groups for the tests which will
be useful soon when we start using IDs in the tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some functionality was added to the test library to allow printing
function availability plus usage information.
This commit adds that info to the readme of the library to keep it
accurate. It also adds a table of groups for the tests which will
be useful soon when we start using IDs in the tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,660,2018-10-26T21:34:12Z,2018-11-12T22:30:46Z,2018-11-20T21:27:35Z,MERGED,True,72,111,13,https://github.com/jwakre,Test: file cleanup,2,[],https://github.com/clearlinux/swupd-client/pull/660,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/660,"Some tests (tests using web servers) wrote files to /tmp which were hard to clean up. This change moves the files/directories that were written to /tmp to more obvious locations. The trusted certificate store is now written to the top level directory of the repo and the other files are written to their corresponding test environment directories. Also this change adds a trap to clean up tests when they are interrupted.
Fixes #650","Some tests (tests using web servers) wrote files to /tmp which were hard to clean up. This change moves the files/directories that were written to /tmp to more obvious locations. The trusted certificate store is now written to the top level directory of the repo and the other files are written to their corresponding test environment directories. Also this change adds a trap to clean up tests when they are interrupted.
Fixes #650",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,660,2018-10-26T21:34:12Z,2018-11-12T22:30:46Z,2018-11-20T21:27:35Z,MERGED,True,72,111,13,https://github.com/jwakre,Test: file cleanup,2,[],https://github.com/clearlinux/swupd-client/pull/660,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/660#issuecomment-436096385,"Some tests (tests using web servers) wrote files to /tmp which were hard to clean up. This change moves the files/directories that were written to /tmp to more obvious locations. The trusted certificate store is now written to the top level directory of the repo and the other files are written to their corresponding test environment directories. Also this change adds a trap to clean up tests when they are interrupted.
Fixes #650","I need to resolve an issue after rebasing. Attempting to put the certificate keys in $TEST_NAME, but it is changed to $TEST_NAME_<#> and is not updated in the certificate key path.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,660,2018-10-26T21:34:12Z,2018-11-12T22:30:46Z,2018-11-20T21:27:35Z,MERGED,True,72,111,13,https://github.com/jwakre,Test: file cleanup,2,[],https://github.com/clearlinux/swupd-client/pull/660,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/660#issuecomment-436361232,"Some tests (tests using web servers) wrote files to /tmp which were hard to clean up. This change moves the files/directories that were written to /tmp to more obvious locations. The trusted certificate store is now written to the top level directory of the repo and the other files are written to their corresponding test environment directories. Also this change adds a trap to clean up tests when they are interrupted.
Fixes #650","@otaviobp Your feedback should be addressed. Additionally, I updated the certificates paths to store them in directory named ""$TEST_NAME""_1 instead of ""$TEST_NAME""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,661,2018-10-26T23:31:53Z,2018-10-30T16:59:57Z,2018-10-30T16:59:58Z,MERGED,True,46,57,18,https://github.com/castulo,Adding IDs to bundle-add tests,1,[],https://github.com/clearlinux/swupd-client/pull/661,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/661,"As part of the effort of having the functional tests better
organized and have traceability we are adding unique IDs to
every test.
This commit adds the IDs to the bundle-add tests. It also
changes the description of some of them to make them clearer,
and removes duplicates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","As part of the effort of having the functional tests better
organized and have traceability we are adding unique IDs to
every test.
This commit adds the IDs to the bundle-add tests. It also
changes the description of some of them to make them clearer,
and removes duplicates.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,663,2018-10-29T22:45:37Z,2018-10-31T16:51:43Z,2018-11-01T18:01:00Z,MERGED,True,41,28,13,https://github.com/otaviobp,Shellcheck,3,[],https://github.com/clearlinux/swupd-client/pull/663,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/663,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,663,2018-10-29T22:45:37Z,2018-10-31T16:51:43Z,2018-11-01T18:01:00Z,MERGED,True,41,28,13,https://github.com/otaviobp,Shellcheck,3,[],https://github.com/clearlinux/swupd-client/pull/663,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/663#issuecomment-434118079,,"So from what I see here, you are not including testilb.bash yet, right? until we fix all the current errors?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,663,2018-10-29T22:45:37Z,2018-10-31T16:51:43Z,2018-11-01T18:01:00Z,MERGED,True,41,28,13,https://github.com/otaviobp,Shellcheck,3,[],https://github.com/clearlinux/swupd-client/pull/663,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/663#issuecomment-434384469,,"So from what I see here, you are not including testilb.bash yet, right? until we fix all the current errors?

yes. Issue: #662",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,664,2018-10-30T17:52:39Z,2018-10-30T19:12:27Z,2018-11-01T18:01:01Z,MERGED,True,4,0,2,https://github.com/otaviobp,time: record time of scripts execution on verify and bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/664,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/664,"Add a timer counter to print how long run_scripts() take on verify and
bundle-add commands. Note that this is already in place for update.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Add a timer counter to print how long run_scripts() take on verify and
bundle-add commands. Note that this is already in place for update.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,665,2018-10-30T17:53:04Z,2018-11-02T22:25:10Z,2018-11-02T22:25:10Z,MERGED,True,110,8,5,https://github.com/castulo,Adding functions to get test IDs in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/665,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/665,"Adding functions to get test IDs in testlib
Every test should include a unique ID, so it is necessary to have
a way of knowing what is the next available ID for the group of
tests.
This commit helps with that issue by implementing the following
features in the test library:

Adds the function get_test_list which can be used to print a list of tests in a specific group directory.
Adds the function get_next_available_id which return the next test ID that can be used in a new test.
When using the generate_test function to generate an empty test the next available ID will be used for the template.

This commit also adds the ID to a bundle-add test that was missing it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding functions to get test IDs in testlib
Every test should include a unique ID, so it is necessary to have
a way of knowing what is the next available ID for the group of
tests.
This commit helps with that issue by implementing the following
features in the test library:

Adds the function get_test_list which can be used to print a list of tests in a specific group directory.
Adds the function get_next_available_id which return the next test ID that can be used in a new test.
When using the generate_test function to generate an empty test the next available ID will be used for the template.

This commit also adds the ID to a bundle-add test that was missing it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,665,2018-10-30T17:53:04Z,2018-11-02T22:25:10Z,2018-11-02T22:25:10Z,MERGED,True,110,8,5,https://github.com/castulo,Adding functions to get test IDs in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/665,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/665#issuecomment-434431339,"Adding functions to get test IDs in testlib
Every test should include a unique ID, so it is necessary to have
a way of knowing what is the next available ID for the group of
tests.
This commit helps with that issue by implementing the following
features in the test library:

Adds the function get_test_list which can be used to print a list of tests in a specific group directory.
Adds the function get_next_available_id which return the next test ID that can be used in a new test.
When using the generate_test function to generate an empty test the next available ID will be used for the template.

This commit also adds the ID to a bundle-add test that was missing it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Nice :)
But I prefer to add a function to testlib that print that as output instead of committing the test file. And you could print just one output instead of one per file, like:
==========
Bundle-add
==========
ADD001: Adding one bundle
ADD002: Adding multiple bundles
ADD003: Try adding one bundle that is already added

=============
Bundle-remove
=============
....",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,665,2018-10-30T17:53:04Z,2018-11-02T22:25:10Z,2018-11-02T22:25:10Z,MERGED,True,110,8,5,https://github.com/castulo,Adding functions to get test IDs in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/665,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/665#issuecomment-434482786,"Adding functions to get test IDs in testlib
Every test should include a unique ID, so it is necessary to have
a way of knowing what is the next available ID for the group of
tests.
This commit helps with that issue by implementing the following
features in the test library:

Adds the function get_test_list which can be used to print a list of tests in a specific group directory.
Adds the function get_next_available_id which return the next test ID that can be used in a new test.
When using the generate_test function to generate an empty test the next available ID will be used for the template.

This commit also adds the ID to a bundle-add test that was missing it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I made some changes based on your feedback. I updated the PR description to reflect this too.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,665,2018-10-30T17:53:04Z,2018-11-02T22:25:10Z,2018-11-02T22:25:10Z,MERGED,True,110,8,5,https://github.com/castulo,Adding functions to get test IDs in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/665,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/665#issuecomment-434482999,"Adding functions to get test IDs in testlib
Every test should include a unique ID, so it is necessary to have
a way of knowing what is the next available ID for the group of
tests.
This commit helps with that issue by implementing the following
features in the test library:

Adds the function get_test_list which can be used to print a list of tests in a specific group directory.
Adds the function get_next_available_id which return the next test ID that can be used in a new test.
When using the generate_test function to generate an empty test the next available ID will be used for the template.

This commit also adds the ID to a bundle-add test that was missing it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@jwakre this PR adds the functionality that you had suggested in a previous PR.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,667,2018-10-31T20:43:57Z,2018-11-13T21:56:03Z,2018-11-13T21:56:03Z,MERGED,True,316,93,23,https://github.com/castulo,Add consistency between verify and verify --fix,2,[],https://github.com/clearlinux/swupd-client/pull/667,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/667,"Running ""swupd verify"" should be a dry-run of running
""swupd verify --fix"", meaning that ""swupd verify"" should find
the same issues to be resolved than ""swupd verify --fix"" but it
should just inform about them while --fix should inform + fix them.
In occasions this does not happen, for example when there are
tracked files that need to be removed from the system.
Closes #607
Closes #536
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Running ""swupd verify"" should be a dry-run of running
""swupd verify --fix"", meaning that ""swupd verify"" should find
the same issues to be resolved than ""swupd verify --fix"" but it
should just inform about them while --fix should inform + fix them.
In occasions this does not happen, for example when there are
tracked files that need to be removed from the system.
Closes #607
Closes #536
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,667,2018-10-31T20:43:57Z,2018-11-13T21:56:03Z,2018-11-13T21:56:03Z,MERGED,True,316,93,23,https://github.com/castulo,Add consistency between verify and verify --fix,2,[],https://github.com/clearlinux/swupd-client/pull/667,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/667#issuecomment-435447452,"Running ""swupd verify"" should be a dry-run of running
""swupd verify --fix"", meaning that ""swupd verify"" should find
the same issues to be resolved than ""swupd verify --fix"" but it
should just inform about them while --fix should inform + fix them.
In occasions this does not happen, for example when there are
tracked files that need to be removed from the system.
Closes #607
Closes #536
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",tests look good to me,True,"{'THUMBS_UP': ['https://github.com/jwakre', 'https://github.com/phmccarty']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,668,2018-11-01T21:17:43Z,2018-11-02T17:07:41Z,2018-12-07T21:17:31Z,MERGED,True,1,1,1,https://github.com/otaviobp,configure: Remove trailing ],1,[],https://github.com/clearlinux/swupd-client/pull/668,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/668,"Configure was printing the error:
14:13:44 ./configure: line 14047: ]: command not found
It was harmless though.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Configure was printing the error:
14:13:44 ./configure: line 14047: ]: command not found
It was harmless though.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,670,2018-11-02T21:39:18Z,2018-11-05T17:12:01Z,2018-11-05T17:12:01Z,MERGED,True,5,5,3,https://github.com/castulo,Fixing a bug in the test list in Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/670,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/670,"The list is missing a """" at the end of one test which is causing
a group of tests to be ignored by the makefile, therefore they are
not being run.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The list is missing a """" at the end of one test which is causing
a group of tests to be ignored by the makefile, therefore they are
not being run.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,670,2018-11-02T21:39:18Z,2018-11-05T17:12:01Z,2018-11-05T17:12:01Z,MERGED,True,5,5,3,https://github.com/castulo,Fixing a bug in the test list in Makefile,1,[],https://github.com/clearlinux/swupd-client/pull/670,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/670#issuecomment-435522994,"The list is missing a """" at the end of one test which is causing
a group of tests to be ignored by the makefile, therefore they are
not being run.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Looks like one of the tests book by this commit
0f16013#diff-a7e08b5cc0d732f4df545b0edc5ae058
I submitted a fixed patch",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,672,2018-11-02T23:59:21Z,2018-11-05T18:16:01Z,2018-11-05T18:16:01Z,MERGED,True,10,10,6,https://github.com/castulo,Adding a missing line break in the verify command,1,[],https://github.com/clearlinux/swupd-client/pull/672,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/672,"There is a missing line break that shows up When running
the ""swupd verify"" command and there is a hash mismatch.
The output looks like this:
$ sudo swupd verify
Verifying version 25590
Verifying files
   ...1%Hash mismatch for file: /usr/bin/tmux
   ...100%
Inspected 292278 files
  1 files did not match
Verify successful

This commit fixes the issue by adding a line break at the
beginning of the output.
This PR depends on PR #670  as soon as that one merges I will rebase this one.","There is a missing line break that shows up When running
the ""swupd verify"" command and there is a hash mismatch.
The output looks like this:
$ sudo swupd verify
Verifying version 25590
Verifying files
   ...1%Hash mismatch for file: /usr/bin/tmux
   ...100%
Inspected 292278 files
  1 files did not match
Verify successful

This commit fixes the issue by adding a line break at the
beginning of the output.
This PR depends on PR #670  as soon as that one merges I will rebase this one.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,672,2018-11-02T23:59:21Z,2018-11-05T18:16:01Z,2018-11-05T18:16:01Z,MERGED,True,10,10,6,https://github.com/castulo,Adding a missing line break in the verify command,1,[],https://github.com/clearlinux/swupd-client/pull/672,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/672#issuecomment-435964111,"There is a missing line break that shows up When running
the ""swupd verify"" command and there is a hash mismatch.
The output looks like this:
$ sudo swupd verify
Verifying version 25590
Verifying files
   ...1%Hash mismatch for file: /usr/bin/tmux
   ...100%
Inspected 292278 files
  1 files did not match
Verify successful

This commit fixes the issue by adding a line break at the
beginning of the output.
This PR depends on PR #670  as soon as that one merges I will rebase this one.",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,673,2018-11-06T00:34:15Z,2018-11-13T23:42:46Z,2018-11-13T23:54:33Z,MERGED,True,277,155,29,https://github.com/castulo,Adding ID for verify tests and add missing tests for verify --picky,1,[],https://github.com/clearlinux/swupd-client/pull/673,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/673,"Adding tests for verify --picky
This commit adds some missing tests for ""verify --picky"", the rest
of the tests were added recently as part of other commits.
This commit also add the test ID to every verify test, and remove
duplicates.
This PR is built on top of #667, once that PR merges I will rebase this one.
Closes #315","Adding tests for verify --picky
This commit adds some missing tests for ""verify --picky"", the rest
of the tests were added recently as part of other commits.
This commit also add the test ID to every verify test, and remove
duplicates.
This PR is built on top of #667, once that PR merges I will rebase this one.
Closes #315",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,677,2018-11-07T23:21:59Z,2018-11-12T22:54:24Z,2018-11-12T22:54:25Z,MERGED,True,64,2,3,https://github.com/castulo,Continue with update when a bundle was removed upstream,2,[],https://github.com/clearlinux/swupd-client/pull/677,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/677,"If a bundle happens to be removed from the content server (or mix) it
means the bundle won't be in the MoM anymore, so the bundle in the
system will look like an invalid bundle. When this happens the update
is currently stopping.
This PR fixes this so If this happens, the user is informed, and
the update continues.
Closes #624
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","If a bundle happens to be removed from the content server (or mix) it
means the bundle won't be in the MoM anymore, so the bundle in the
system will look like an invalid bundle. When this happens the update
is currently stopping.
This PR fixes this so If this happens, the user is informed, and
the update continues.
Closes #624
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,680,2018-11-08T21:55:57Z,2018-11-13T21:20:48Z,2018-11-13T21:20:49Z,CLOSED,False,5,0,2,https://github.com/evil-brain,Output hints to check free space on download failures,1,[],https://github.com/clearlinux/swupd-client/pull/680,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/680,"Currently some of the output from swupd can be cryptic when
files fail to download. Add a hint to the user to check
their free space if Curl returns write errors.
Closes #486
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Currently some of the output from swupd can be cryptic when
files fail to download. Add a hint to the user to check
their free space if Curl returns write errors.
Closes #486
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,680,2018-11-08T21:55:57Z,2018-11-13T21:20:48Z,2018-11-13T21:20:49Z,CLOSED,False,5,0,2,https://github.com/evil-brain,Output hints to check free space on download failures,1,[],https://github.com/clearlinux/swupd-client/pull/680,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/680#issuecomment-438441331,"Currently some of the output from swupd can be cryptic when
files fail to download. Add a hint to the user to check
their free space if Curl returns write errors.
Closes #486
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,681,2018-11-08T23:42:27Z,2018-11-09T20:52:49Z,2019-07-16T20:26:12Z,CLOSED,False,4,1,1,https://github.com/ahkok,configure.ac: detect openssl version (1.0 vs. 1.1),1,[],https://github.com/clearlinux/swupd-client/pull/681,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/681,"This defines HAVE_OPENSSL11 if openssl is >= 1.1.x. This can be used
later in the code to implement support for 1.0 and 1.1 OpenSSL APIs
at the same time.","This defines HAVE_OPENSSL11 if openssl is >= 1.1.x. This can be used
later in the code to implement support for 1.0 and 1.1 OpenSSL APIs
at the same time.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,681,2018-11-08T23:42:27Z,2018-11-09T20:52:49Z,2019-07-16T20:26:12Z,CLOSED,False,4,1,1,https://github.com/ahkok,configure.ac: detect openssl version (1.0 vs. 1.1),1,[],https://github.com/clearlinux/swupd-client/pull/681,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/681#issuecomment-437491682,"This defines HAVE_OPENSSL11 if openssl is >= 1.1.x. This can be used
later in the code to implement support for 1.0 and 1.1 OpenSSL APIs
at the same time.",I'm closing this in favor of #682,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/tmarcu,1,https://github.com/clearlinux/swupd-client/pull/682,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/ahkok,2,https://github.com/clearlinux/swupd-client/pull/682#issuecomment-437213095,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",Neat! did you also verify this against OpenSSL-1.0?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/682#issuecomment-437213930,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","awesome, will this close issue #283?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/682#issuecomment-437241127,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Really nice!!!
I tested that with libcryto 1.0 and it works fine, so we don't need to concern about compatibility, bumps, etc. But I had some problems with libcrypto 1.1 in last clear (26170).
I got the following warning
/usr/bin/ld: warning: libcrypto.so.1.0.0, needed by /usr/lib64/gcc/x86_64-generic-linux/8.2.1/../../../../lib64/libcurl.so, may conflict with libcrypto.so.1.1

and a segmentation fault when running swupd. Last curl available is linked agains libcrypto 1.0 and not 1.1, so we need to wait for curl with 1.1 to fix that. Probably we are going to have that soon. Same problem with libarchive. So I would wait for them to merge.",True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/ahkok,5,https://github.com/clearlinux/swupd-client/pull/682#issuecomment-437251496,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","Last curl available is linked agains libcrypto 1.0 and not 1.1, so we
 need to wait for curl with 1.1 to fix that.
I pushed a rebuild of curl against 1.1 earlier this afternoon to koji,
so this will be very soon.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/ahkok,6,https://github.com/clearlinux/swupd-client/pull/682#issuecomment-437261351,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com",libarchive also getting updated now.,True,{'THUMBS_UP': ['https://github.com/tmarcu']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,682,2018-11-09T00:41:54Z,2018-11-09T20:52:32Z,2018-11-09T20:52:32Z,MERGED,True,8,4,1,https://github.com/tmarcu,[RFC] - Update signature verification for OpenSSL 1.1,2,[],https://github.com/clearlinux/swupd-client/pull/682,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/682#issuecomment-437444031,"The ERR_remove_thread_state() function is deprecated as the thread
handling and many memory management operatoins have been re-written to
be internally handled by the API. The error code should be retrieved
by the proper function now from X509 store contexts.
Signed-off-by: Tudor Marcu tudor.marcu@intel.com","I'm having this problem when running swupd verify with this patch:
139928164279488:error:21075075:PKCS7 routines:PKCS7_verify:certificate verify error:crypto/pkcs7/pk7_smime.c:285:Verify error:unsupported certificate purpose
Certificate verification error: unsupported certificate purpose",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,684,2018-11-09T21:12:04Z,2018-11-09T23:03:23Z,2018-12-07T21:17:31Z,MERGED,True,3,1,1,https://github.com/otaviobp,curl: Don't warn about curl fd leaks,1,[],https://github.com/clearlinux/swupd-client/pull/684,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/684,"Curl isn't closing urandom and random when using openssl 1.1. As it's something
out of our control and this won't create any resource leak problems, we're not
reporting that anymore.
This fd leak report is triggered when any https download is performed by swupd
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Curl isn't closing urandom and random when using openssl 1.1. As it's something
out of our control and this won't create any resource leak problems, we're not
reporting that anymore.
This fd leak report is triggered when any https download is performed by swupd
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,685,2018-11-09T22:32:16Z,2018-11-14T22:00:49Z,2018-11-14T22:00:49Z,MERGED,True,12,12,1,https://github.com/castulo,Fix a bug in bundle-add --time,1,[],https://github.com/clearlinux/swupd-client/pull/685,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/685,"This PR fixes a bug in bundle-add --time that was causing the command to show wrong values (and duplicated)
Closes #675","This PR fixes a bug in bundle-add --time that was causing the command to show wrong values (and duplicated)
Closes #675",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,685,2018-11-09T22:32:16Z,2018-11-14T22:00:49Z,2018-11-14T22:00:49Z,MERGED,True,12,12,1,https://github.com/castulo,Fix a bug in bundle-add --time,1,[],https://github.com/clearlinux/swupd-client/pull/685,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/685#issuecomment-437516233,"This PR fixes a bug in bundle-add --time that was causing the command to show wrong values (and duplicated)
Closes #675","I didn't add a test for this code since @reaganlo already submitted a PR #641 for this, he will have to update the test with this output once merged.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,685,2018-11-09T22:32:16Z,2018-11-14T22:00:49Z,2018-11-14T22:00:49Z,MERGED,True,12,12,1,https://github.com/castulo,Fix a bug in bundle-add --time,1,[],https://github.com/clearlinux/swupd-client/pull/685,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/685#issuecomment-438490488,"This PR fixes a bug in bundle-add --time that was causing the command to show wrong values (and duplicated)
Closes #675",I removed the commit that showed the time output as a tree like view,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,686,2018-11-09T23:52:07Z,2018-12-07T21:11:48Z,2018-12-07T21:17:14Z,MERGED,True,245,208,5,https://github.com/otaviobp,Real content,7,[],https://github.com/clearlinux/swupd-client/pull/686,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/686,I've been running those tests for currently release and they are quite stable right now. Sending for review,I've been running those tests for currently release and they are quite stable right now. Sending for review,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,686,2018-11-09T23:52:07Z,2018-12-07T21:11:48Z,2018-12-07T21:17:14Z,MERGED,True,245,208,5,https://github.com/otaviobp,Real content,7,[],https://github.com/clearlinux/swupd-client/pull/686,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/686#issuecomment-439201746,I've been running those tests for currently release and they are quite stable right now. Sending for review,Fixed proposed changes and squashed last commit with the one spliting files because it makes more sense to have them together,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,686,2018-11-09T23:52:07Z,2018-12-07T21:11:48Z,2018-12-07T21:17:14Z,MERGED,True,245,208,5,https://github.com/otaviobp,Real content,7,[],https://github.com/clearlinux/swupd-client/pull/686,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/686#issuecomment-441837835,I've been running those tests for currently release and they are quite stable right now. Sending for review,"I have reorganized the commits and fixed the addressed issues. I removed the test ""list bundles"" and added a check where this is used to make sure it's working fine.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,687,2018-11-13T19:03:47Z,2018-11-13T21:22:10Z,2018-12-07T21:17:28Z,MERGED,True,6,7,1,https://github.com/otaviobp,verifytime: Fix TOCTOU problem,1,[],https://github.com/clearlinux/swupd-client/pull/687,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/687,"We can't assume that the file wasn't deleted between the execution of a
stat and a fopen. Printing error only when fopen fails.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We can't assume that the file wasn't deleted between the execution of a
stat and a fopen. Printing error only when fopen fails.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,688,2018-11-13T20:55:32Z,2018-11-13T21:22:01Z,2018-12-07T21:17:26Z,MERGED,True,1,1,1,https://github.com/otaviobp,archive: Ignore return code of function,1,[],https://github.com/clearlinux/swupd-client/pull/688,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/688,"Ignore function return code as we don't need to check if operation is
fatal or not at this point.","Ignore function return code as we don't need to check if operation is
fatal or not at this point.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,689,2018-11-13T21:24:07Z,2018-11-16T16:25:44Z,2018-12-07T21:17:24Z,MERGED,True,25,23,1,https://github.com/otaviobp,xattrs: Create dummy implementations for xattr API when disabled,1,[],https://github.com/clearlinux/swupd-client/pull/689,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/689,"When xattr is disabled in a build, use a dummy implementation of the API
instead of counting on dummy implementation of the functions used by xattr.
By doing that we are clearer on the output of the functions, less code
executions and we get rid of a dead code.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When xattr is disabled in a build, use a dummy implementation of the API
instead of counting on dummy implementation of the functions used by xattr.
By doing that we are clearer on the output of the functions, less code
executions and we get rid of a dead code.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,691,2018-11-13T23:22:54Z,2018-11-14T21:09:43Z,2018-11-14T21:09:43Z,MERGED,True,269,217,12,https://github.com/castulo,Adding IDs to bundle-remove tests,1,[],https://github.com/clearlinux/swupd-client/pull/691,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/691,"This commit adds the test ID to every bundle-remove test, removes
duplicates and make readability improvements.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds the test ID to every bundle-remove test, removes
duplicates and make readability improvements.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,692,2018-11-14T01:42:39Z,2018-11-14T17:00:05Z,2018-12-07T21:17:22Z,CLOSED,False,68,38,4,https://github.com/otaviobp,Time: Add a fancy decoration to timelist output,2,[],https://github.com/clearlinux/swupd-client/pull/692,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/692,As suggested by @castulo on #685,As suggested by @castulo on #685,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,692,2018-11-14T01:42:39Z,2018-11-14T17:00:05Z,2018-12-07T21:17:22Z,CLOSED,False,68,38,4,https://github.com/otaviobp,Time: Add a fancy decoration to timelist output,2,[],https://github.com/clearlinux/swupd-client/pull/692,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/692#issuecomment-438737272,As suggested by @castulo on #685,I'm closing this one because @castulo has a better solution,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,692,2018-11-14T01:42:39Z,2018-11-14T17:00:05Z,2018-12-07T21:17:22Z,CLOSED,False,68,38,4,https://github.com/otaviobp,Time: Add a fancy decoration to timelist output,2,[],https://github.com/clearlinux/swupd-client/pull/692,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/692#issuecomment-438805935,As suggested by @castulo on #685,#694,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,693,2018-11-14T16:13:23Z,2018-11-14T21:10:02Z,2018-11-14T21:10:02Z,MERGED,True,3,3,1,https://github.com/gvancuts,verifytime: modify set_time() to take single argument,1,[],https://github.com/clearlinux/swupd-client/pull/693,https://github.com/gvancuts,1,https://github.com/clearlinux/swupd-client/pull/693,"Modify the set_time() function used in verifytime.c to take a single
argument instead of two. The second argument that was previously used
can easily be derived from the first and it avoids situations where
these two are not coherent (which happens to the case in the current
version of verifytime.c)
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com","Modify the set_time() function used in verifytime.c to take a single
argument instead of two. The second argument that was previously used
can easily be derived from the first and it avoids situations where
these two are not coherent (which happens to the case in the current
version of verifytime.c)
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,693,2018-11-14T16:13:23Z,2018-11-14T21:10:02Z,2018-11-14T21:10:02Z,MERGED,True,3,3,1,https://github.com/gvancuts,verifytime: modify set_time() to take single argument,1,[],https://github.com/clearlinux/swupd-client/pull/693,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/693#issuecomment-438739287,"Modify the set_time() function used in verifytime.c to take a single
argument instead of two. The second argument that was previously used
can easily be derived from the first and it avoids situations where
these two are not coherent (which happens to the case in the current
version of verifytime.c)
Signed-off-by: Geoffroy Van Cutsem geoffroy.vancutsem@intel.com",nice. this is really a bug. thanks,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,694,2018-11-14T20:23:02Z,2018-11-16T23:50:27Z,2018-11-16T23:50:27Z,MERGED,True,47,21,2,https://github.com/castulo,Prettifying the --time output,2,['UX'],https://github.com/clearlinux/swupd-client/pull/694,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/694,"Changing the way time is displayed when using the --time option so it
shows as a tree view so it is easier to see what items are sub-tasks
of other tasks.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Changing the way time is displayed when using the --time option so it
shows as a tree view so it is easier to see what items are sub-tasks
of other tasks.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,694,2018-11-14T20:23:02Z,2018-11-16T23:50:27Z,2018-11-16T23:50:27Z,MERGED,True,47,21,2,https://github.com/castulo,Prettifying the --time output,2,['UX'],https://github.com/clearlinux/swupd-client/pull/694,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/694#issuecomment-438805728,"Changing the way time is displayed when using the --time option so it
shows as a tree view so it is easier to see what items are sub-tasks
of other tasks.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",This PR was first suggested in #685,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,694,2018-11-14T20:23:02Z,2018-11-16T23:50:27Z,2018-11-16T23:50:27Z,MERGED,True,47,21,2,https://github.com/castulo,Prettifying the --time output,2,['UX'],https://github.com/clearlinux/swupd-client/pull/694,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/694#issuecomment-438830631,"Changing the way time is displayed when using the --time option so it
shows as a tree view so it is easier to see what items are sub-tasks
of other tasks.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp I made the changes you requested, thanks for reviewing 
I would like to hold on to merging this PR until this other PR is merged though #641, I don't like submitting code without adding a test for the new code. I am not adding a test to this PR because it would duplicate the one in #641. Once #641 merges I will update that test with the changes in this PR and then we can merge it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,694,2018-11-14T20:23:02Z,2018-11-16T23:50:27Z,2018-11-16T23:50:27Z,MERGED,True,47,21,2,https://github.com/castulo,Prettifying the --time output,2,['UX'],https://github.com/clearlinux/swupd-client/pull/694,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/694#issuecomment-439485266,"Changing the way time is displayed when using the --time option so it
shows as a tree view so it is easier to see what items are sub-tasks
of other tasks.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I rebased and updated the bundle-add --time test to include this format.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,694,2018-11-14T20:23:02Z,2018-11-16T23:50:27Z,2018-11-16T23:50:27Z,MERGED,True,47,21,2,https://github.com/castulo,Prettifying the --time output,2,['UX'],https://github.com/clearlinux/swupd-client/pull/694,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/694#issuecomment-439529467,"Changing the way time is displayed when using the --time option so it
shows as a tree view so it is easier to see what items are sub-tasks
of other tasks.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Just removing a couple of shellcheck warnings,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,695,2018-11-14T22:55:03Z,2018-11-16T18:44:29Z,2018-12-07T21:17:18Z,MERGED,True,10,4,2,https://github.com/otaviobp,"helpers: Don't enforce umask on mkdir_p, just force that when needed",1,[],https://github.com/clearlinux/swupd-client/pull/695,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/695,"Swupd state dir should be masked as 700, but we can't mask all subfolders
as 700. This is particularly a problem because /var and /var/lib/ shoudn't
be 700, but /var/lib/swupd should. So creating all folders with current
umask and using chmod syscall to set only the swupd statedir diretory to
root only
Also, stop using mkdir_p where are no longer needed
Fixes #655
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Swupd state dir should be masked as 700, but we can't mask all subfolders
as 700. This is particularly a problem because /var and /var/lib/ shoudn't
be 700, but /var/lib/swupd should. So creating all folders with current
umask and using chmod syscall to set only the swupd statedir diretory to
root only
Also, stop using mkdir_p where are no longer needed
Fixes #655
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,695,2018-11-14T22:55:03Z,2018-11-16T18:44:29Z,2018-12-07T21:17:18Z,MERGED,True,10,4,2,https://github.com/otaviobp,"helpers: Don't enforce umask on mkdir_p, just force that when needed",1,[],https://github.com/clearlinux/swupd-client/pull/695,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/695#issuecomment-439454376,"Swupd state dir should be masked as 700, but we can't mask all subfolders
as 700. This is particularly a problem because /var and /var/lib/ shoudn't
be 700, but /var/lib/swupd should. So creating all folders with current
umask and using chmod syscall to set only the swupd statedir diretory to
root only
Also, stop using mkdir_p where are no longer needed
Fixes #655
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Fixed the commit message. Thanks. Same mistake again. I don't know why I'm always confusing parent directories with sub directories.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,696,2018-11-15T00:31:31Z,2018-11-16T22:31:12Z,2018-11-16T22:31:12Z,MERGED,True,31,9,7,https://github.com/castulo,Continue check-update when time is not correct,1,[],https://github.com/clearlinux/swupd-client/pull/696,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/696,"When the system time is way off, the certificate validation will
fail. For this reason, many swupd commands attempt to fix the
system time if wrong. check-update was not doing this so the
command would fail in this situation.
This commit adds a verification for this so check-update attempts
to fix the system time and continue instead of failing.
Closes #678
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When the system time is way off, the certificate validation will
fail. For this reason, many swupd commands attempt to fix the
system time if wrong. check-update was not doing this so the
command would fail in this situation.
This commit adds a verification for this so check-update attempts
to fix the system time and continue instead of failing.
Closes #678
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,696,2018-11-15T00:31:31Z,2018-11-16T22:31:12Z,2018-11-16T22:31:12Z,MERGED,True,31,9,7,https://github.com/castulo,Continue check-update when time is not correct,1,[],https://github.com/clearlinux/swupd-client/pull/696,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/696#issuecomment-439225847,"When the system time is way off, the certificate validation will
fail. For this reason, many swupd commands attempt to fix the
system time if wrong. check-update was not doing this so the
command would fail in this situation.
This commit adds a verification for this so check-update attempts
to fix the system time and continue instead of failing.
Closes #678
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp  I added the -I and -C options to check-update,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,696,2018-11-15T00:31:31Z,2018-11-16T22:31:12Z,2018-11-16T22:31:12Z,MERGED,True,31,9,7,https://github.com/castulo,Continue check-update when time is not correct,1,[],https://github.com/clearlinux/swupd-client/pull/696,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/696#issuecomment-439537350,"When the system time is way off, the certificate validation will
fail. For this reason, many swupd commands attempt to fix the
system time if wrong. check-update was not doing this so the
command would fail in this situation.
This commit adds a verification for this so check-update attempts
to fix the system time and continue instead of failing.
Closes #678
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I just modified the PR to use the verify_time() function as requested.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,697,2018-11-15T00:37:21Z,2018-11-15T18:51:21Z,2018-11-15T18:51:21Z,MERGED,True,2,1,1,https://github.com/castulo,Correct test group code for checkupdate,1,[],https://github.com/clearlinux/swupd-client/pull/697,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/697,"The check-update tests should use a group code of CHK, but the
test library was using AUT incorrectly which belongs to the autoupdate
tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The check-update tests should use a group code of CHK, but the
test library was using AUT incorrectly which belongs to the autoupdate
tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,698,2018-11-15T01:32:14Z,2018-11-15T18:54:30Z,2018-11-15T18:54:30Z,MERGED,True,21,9,5,https://github.com/castulo,Adding ID to install tests,1,[],https://github.com/clearlinux/swupd-client/pull/698,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/698,"Some verify --install tests were submitted some time ago before we
started using IDs for tests, so these tests are missing the ID.
This commit add those missing IDs and make a couple of improvements
in the tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some verify --install tests were submitted some time ago before we
started using IDs for tests, so these tests are missing the ID.
This commit add those missing IDs and make a couple of improvements
in the tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,700,2018-11-15T23:03:16Z,2018-12-11T20:34:19Z,2018-12-11T20:34:19Z,CLOSED,False,21,1,1,https://github.com/evil-brain,Modify and add compile-time flags,1,[],https://github.com/clearlinux/swupd-client/pull/700,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/700,"Added the following non-warning CFLAGS:
-fstack-protector-strong: Improvement on -fstack-protector
-fpie: Position Independent Code/ASLR
-fstack-clash-protection: Increased reliability of stack overflow detection
-fcf-protection: Control flow integrity protection
Added -pie to LDFLAGS.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Added the following non-warning CFLAGS:
-fstack-protector-strong: Improvement on -fstack-protector
-fpie: Position Independent Code/ASLR
-fstack-clash-protection: Increased reliability of stack overflow detection
-fcf-protection: Control flow integrity protection
Added -pie to LDFLAGS.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,700,2018-11-15T23:03:16Z,2018-12-11T20:34:19Z,2018-12-11T20:34:19Z,CLOSED,False,21,1,1,https://github.com/evil-brain,Modify and add compile-time flags,1,[],https://github.com/clearlinux/swupd-client/pull/700,https://github.com/evil-brain,2,https://github.com/clearlinux/swupd-client/pull/700#issuecomment-439228447,"Added the following non-warning CFLAGS:
-fstack-protector-strong: Improvement on -fstack-protector
-fpie: Position Independent Code/ASLR
-fstack-clash-protection: Increased reliability of stack overflow detection
-fcf-protection: Control flow integrity protection
Added -pie to LDFLAGS.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Oh, Travis, your older GCC demands removal of
-fstack-clash-protection and -fcf-protection
If I had more time, I'd use autotools to check compiler compatibility during autogen/configure... maybe I will anyways.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,700,2018-11-15T23:03:16Z,2018-12-11T20:34:19Z,2018-12-11T20:34:19Z,CLOSED,False,21,1,1,https://github.com/evil-brain,Modify and add compile-time flags,1,[],https://github.com/clearlinux/swupd-client/pull/700,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/700#issuecomment-446351925,"Added the following non-warning CFLAGS:
-fstack-protector-strong: Improvement on -fstack-protector
-fpie: Position Independent Code/ASLR
-fstack-clash-protection: Increased reliability of stack overflow detection
-fcf-protection: Control flow integrity protection
Added -pie to LDFLAGS.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",Nice work. I'll take notes of the flags so we can evaluate what we can use and then we can work on a new pull request for that. I'm closing that for now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,701,2018-11-15T23:28:22Z,2018-11-16T16:21:20Z,2018-11-16T16:21:20Z,MERGED,True,0,4,1,https://github.com/castulo,Clean up unused variables from test,1,[],https://github.com/clearlinux/swupd-client/pull/701,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/701,"There are some variables left over from commit
897f5d4
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There are some variables left over from commit
897f5d4
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,702,2018-11-15T23:47:33Z,2018-11-16T16:22:16Z,2018-11-16T16:22:16Z,MERGED,True,54,7,5,https://github.com/otaviobp,Link swupd with verifytime,1,[],https://github.com/clearlinux/swupd-client/pull/702,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/702,"Instead on counting with the verify time in the system, link swupd
with verifytime lib.
This reduces one point of failure of swupd on recovering a corrupt system.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Instead on counting with the verify time in the system, link swupd
with verifytime lib.
This reduces one point of failure of swupd on recovering a corrupt system.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,703,2018-11-16T00:10:50Z,2018-11-16T18:05:15Z,2018-11-16T18:05:15Z,MERGED,True,53,12,12,https://github.com/castulo,Adding ID to bundle-list tests,1,[],https://github.com/clearlinux/swupd-client/pull/703,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/703,"Adding an ID to all bundle-list tests and rewording some of the
test descriptions to make it more readable.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding an ID to all bundle-list tests and rewording some of the
test descriptions to make it more readable.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,704,2018-11-16T00:39:47Z,2018-11-16T18:05:46Z,2018-11-16T18:05:46Z,MERGED,True,13,9,7,https://github.com/castulo,Adding ID to check-update tests,1,[],https://github.com/clearlinux/swupd-client/pull/704,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/704,"Adding ID to check-update tests and changing their description to
make it more readable.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding ID to check-update tests and changing their description to
make it more readable.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,705,2018-11-16T18:44:44Z,2018-11-16T21:16:35Z,2018-12-07T21:17:17Z,MERGED,True,8,4,2,https://github.com/otaviobp,verifytime: Fix return value of verify_time function,1,[],https://github.com/clearlinux/swupd-client/pull/705,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/705,"There was some confusion about shell return code and bools.
Shell returns 0 for true and bools are 0 for false.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","There was some confusion about shell return code and bools.
Shell returns 0 for true and bools are 0 for false.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,705,2018-11-16T18:44:44Z,2018-11-16T21:16:35Z,2018-12-07T21:17:17Z,MERGED,True,8,4,2,https://github.com/otaviobp,verifytime: Fix return value of verify_time function,1,[],https://github.com/clearlinux/swupd-client/pull/705,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/705#issuecomment-439488717,"There was some confusion about shell return code and bools.
Shell returns 0 for true and bools are 0 for false.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",@castulo Can you test if this is really fixing the problem?,True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,705,2018-11-16T18:44:44Z,2018-11-16T21:16:35Z,2018-12-07T21:17:17Z,MERGED,True,8,4,2,https://github.com/otaviobp,verifytime: Fix return value of verify_time function,1,[],https://github.com/clearlinux/swupd-client/pull/705,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/705#issuecomment-439515922,"There was some confusion about shell return code and bools.
Shell returns 0 for true and bools are 0 for false.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","@castulo Can you test if this is really fixing the problem?

Looks like it does! ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,707,2018-11-16T22:17:39Z,2018-11-26T22:13:47Z,2019-05-04T16:55:41Z,MERGED,True,7,0,1,https://github.com/otaviobp,locale: Set locale to system locale,1,[],https://github.com/clearlinux/swupd-client/pull/707,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/707,"Standard locale on C applications is C and we use in clearlinux UTF-8
for file names. Libarchive checks the program locale to convert
filenames so we need to set this.
According to setlocale documentation, setlocale(LC_ALL, """") sets the locale
to system default (in the case of ClearLinux, UTF-8).
More information on the libarchive problem:
https://github.com/libarchive/libarchive/wiki/Filenames and
libarchive/libarchive#587
Fixes #445
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Standard locale on C applications is C and we use in clearlinux UTF-8
for file names. Libarchive checks the program locale to convert
filenames so we need to set this.
According to setlocale documentation, setlocale(LC_ALL, """") sets the locale
to system default (in the case of ClearLinux, UTF-8).
More information on the libarchive problem:
https://github.com/libarchive/libarchive/wiki/Filenames and
libarchive/libarchive#587
Fixes #445
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,708,2018-11-16T23:23:38Z,2018-11-20T18:03:50Z,2018-11-20T18:03:50Z,MERGED,True,135,34,3,https://github.com/castulo,Adding ID to search tests,1,[],https://github.com/clearlinux/swupd-client/pull/708,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/708,"Adding ID to search tests and changing the description of some of
them to make them clearer.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding ID to search tests and changing the description of some of
them to make them clearer.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,709,2018-11-16T23:44:39Z,2018-11-16T23:51:33Z,2018-11-16T23:51:33Z,MERGED,True,28,20,2,https://github.com/castulo,Adding IDs to mirror tests,1,[],https://github.com/clearlinux/swupd-client/pull/709,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/709,"Adding IDs to mirror tests and some small changes.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding IDs to mirror tests and some small changes.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,710,2018-11-17T00:26:57Z,2018-11-19T20:47:24Z,2018-11-19T20:47:24Z,MERGED,True,23,5,1,https://github.com/castulo,Adding IDs to hashdump tests,1,[],https://github.com/clearlinux/swupd-client/pull/710,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/710,"Adding IDs and minor changes in hashdump tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding IDs and minor changes in hashdump tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,711,2018-11-17T00:35:26Z,2018-11-19T20:46:47Z,2018-11-19T21:06:16Z,MERGED,True,4,4,1,https://github.com/castulo,Adding IDs to usability tests,1,[],https://github.com/clearlinux/swupd-client/pull/711,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/711,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,713,2018-11-20T18:12:12Z,2018-11-20T20:31:15Z,2018-11-20T20:31:15Z,MERGED,True,4,24,4,https://github.com/castulo,Removing option --force where is not needed,1,[],https://github.com/clearlinux/swupd-client/pull/713,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/713,"The --force option is included in bundle-add, bundle-remove,
check-update, update and verify, but it is really only used in
verify.
This commit removes the option from the commands that are not using
it so it is not misleading to users. If at some point we need to
implement somthing with --force it can be added back at that point.
Closes #636
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The --force option is included in bundle-add, bundle-remove,
check-update, update and verify, but it is really only used in
verify.
This commit removes the option from the commands that are not using
it so it is not misleading to users. If at some point we need to
implement somthing with --force it can be added back at that point.
Closes #636
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,713,2018-11-20T18:12:12Z,2018-11-20T20:31:15Z,2018-11-20T20:31:15Z,MERGED,True,4,24,4,https://github.com/castulo,Removing option --force where is not needed,1,[],https://github.com/clearlinux/swupd-client/pull/713,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/713#issuecomment-440378860,"The --force option is included in bundle-add, bundle-remove,
check-update, update and verify, but it is really only used in
verify.
This commit removes the option from the commands that are not using
it so it is not misleading to users. If at some point we need to
implement somthing with --force it can be added back at that point.
Closes #636
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","+1 for the idea here, I'd like to see --force never come back though and instead be --force=thing1,thing2 just as a request.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,714,2018-11-20T22:51:27Z,2018-12-06T22:50:02Z,2018-12-07T21:17:00Z,MERGED,True,712,1059,13,https://github.com/otaviobp,Global,3,[],https://github.com/clearlinux/swupd-client/pull/714,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/714,"There is a list of parameters in swupd that are really configuration changes that applies to almost every command (and they should apply to any command that uses any feature that this setting is configuring).
But those parameters were being set specifically for each swupd command, making it a hard task to keep documentation updated and make sure that all parameters are really added to all commands that may benefit from using them.
When I was reviewing parameters sanitization I decided to take some time to close #571 to make our lives easier.
So this pull request consolidate parameters in global.c and fixes some sanitization problems I found.
Note that we have a problem related to weird path names (#640) but this isn't a sanitization problem because that path is valid.
Fixes: #571","There is a list of parameters in swupd that are really configuration changes that applies to almost every command (and they should apply to any command that uses any feature that this setting is configuring).
But those parameters were being set specifically for each swupd command, making it a hard task to keep documentation updated and make sure that all parameters are really added to all commands that may benefit from using them.
When I was reviewing parameters sanitization I decided to take some time to close #571 to make our lives easier.
So this pull request consolidate parameters in global.c and fixes some sanitization problems I found.
Note that we have a problem related to weird path names (#640) but this isn't a sanitization problem because that path is valid.
Fixes: #571",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,714,2018-11-20T22:51:27Z,2018-12-06T22:50:02Z,2018-12-07T21:17:00Z,MERGED,True,712,1059,13,https://github.com/otaviobp,Global,3,[],https://github.com/clearlinux/swupd-client/pull/714,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/714#issuecomment-441847095,"There is a list of parameters in swupd that are really configuration changes that applies to almost every command (and they should apply to any command that uses any feature that this setting is configuring).
But those parameters were being set specifically for each swupd command, making it a hard task to keep documentation updated and make sure that all parameters are really added to all commands that may benefit from using them.
When I was reviewing parameters sanitization I decided to take some time to close #571 to make our lives easier.
So this pull request consolidate parameters in global.c and fixes some sanitization problems I found.
Note that we have a problem related to weird path names (#640) but this isn't a sanitization problem because that path is valid.
Fixes: #571","Pushed new version addressing reported problems.
I removed the commit that really sanitize the parameters because I'll stop using scanf and I'll send that in a new pull request.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,714,2018-11-20T22:51:27Z,2018-12-06T22:50:02Z,2018-12-07T21:17:00Z,MERGED,True,712,1059,13,https://github.com/otaviobp,Global,3,[],https://github.com/clearlinux/swupd-client/pull/714,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/714#issuecomment-441854425,"There is a list of parameters in swupd that are really configuration changes that applies to almost every command (and they should apply to any command that uses any feature that this setting is configuring).
But those parameters were being set specifically for each swupd command, making it a hard task to keep documentation updated and make sure that all parameters are really added to all commands that may benefit from using them.
When I was reviewing parameters sanitization I decided to take some time to close #571 to make our lives easier.
So this pull request consolidate parameters in global.c and fixes some sanitization problems I found.
Note that we have a problem related to weird path names (#640) but this isn't a sanitization problem because that path is valid.
Fixes: #571",I pushed the sanitize commit back because I realized I could do it in this PR. It will get better after #722.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,715,2018-11-20T23:49:09Z,2018-11-26T22:16:01Z,2018-11-26T22:16:01Z,MERGED,True,13,8,4,https://github.com/castulo,Move the MoM from bundles dir to /var/tmp/swupd,1,[],https://github.com/clearlinux/swupd-client/pull/715,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/715,"swupd copies the latest MoM to /usr/share/clear/bundles/.MoM so we
can use it for bash completion. The problem is that this directory
is tracked by clearlinux and because of that ""swupd verify --picky""
will list this file as an extra file. And ""swupd verify --fix --picky""
will remove that file.
This commit fixes the issue by changing the location where the .MoM
is copied to being this an untracked location, so the file won't be
removed.
Closes #632
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","swupd copies the latest MoM to /usr/share/clear/bundles/.MoM so we
can use it for bash completion. The problem is that this directory
is tracked by clearlinux and because of that ""swupd verify --picky""
will list this file as an extra file. And ""swupd verify --fix --picky""
will remove that file.
This commit fixes the issue by changing the location where the .MoM
is copied to being this an untracked location, so the file won't be
removed.
Closes #632
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,716,2018-11-21T00:03:12Z,2018-11-26T22:18:22Z,2018-11-26T22:18:22Z,CLOSED,False,0,9,1,https://github.com/castulo,Remove old test files from gitignore,1,[],https://github.com/clearlinux/swupd-client/pull/716,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/716,"Removing some files that are no longer applicable from the gitignore
file.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Removing some files that are no longer applicable from the gitignore
file.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,717,2018-11-21T00:17:12Z,2018-12-06T22:50:20Z,2018-12-07T21:16:58Z,MERGED,True,235,94,10,https://github.com/otaviobp,sys: Add run_command() function to replace some usages of system(),7,[],https://github.com/clearlinux/swupd-client/pull/717,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/717,"System API is a very convenient way on executing external commands, but it has
some problems for some usages. System always launches a shell to execute the
desired command, so we can be affected by environment variables (like PATH) and
shell globbing.
We can avoid most of the environment variables affecting the swupd result by
using the full path of the program being executed, but making sure the shell
won't expand all wildcards is tricky and specially dangerous for some commands
that we need to run, like cp, mkdir, etc.
So to make sure no globbing will be performed we can use fork+execve to run
commands instead of system.","System API is a very convenient way on executing external commands, but it has
some problems for some usages. System always launches a shell to execute the
desired command, so we can be affected by environment variables (like PATH) and
shell globbing.
We can avoid most of the environment variables affecting the swupd result by
using the full path of the program being executed, but making sure the shell
won't expand all wildcards is tricky and specially dangerous for some commands
that we need to run, like cp, mkdir, etc.
So to make sure no globbing will be performed we can use fork+execve to run
commands instead of system.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,717,2018-11-21T00:17:12Z,2018-12-06T22:50:20Z,2018-12-07T21:16:58Z,MERGED,True,235,94,10,https://github.com/otaviobp,sys: Add run_command() function to replace some usages of system(),7,[],https://github.com/clearlinux/swupd-client/pull/717,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/717#issuecomment-440494863,"System API is a very convenient way on executing external commands, but it has
some problems for some usages. System always launches a shell to execute the
desired command, so we can be affected by environment variables (like PATH) and
shell globbing.
We can avoid most of the environment variables affecting the swupd result by
using the full path of the program being executed, but making sure the shell
won't expand all wildcards is tricky and specially dangerous for some commands
that we need to run, like cp, mkdir, etc.
So to make sure no globbing will be performed we can use fork+execve to run
commands instead of system.",Very nice,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,717,2018-11-21T00:17:12Z,2018-12-06T22:50:20Z,2018-12-07T21:16:58Z,MERGED,True,235,94,10,https://github.com/otaviobp,sys: Add run_command() function to replace some usages of system(),7,[],https://github.com/clearlinux/swupd-client/pull/717,https://github.com/evil-brain,3,https://github.com/clearlinux/swupd-client/pull/717#issuecomment-442637969,"System API is a very convenient way on executing external commands, but it has
some problems for some usages. System always launches a shell to execute the
desired command, so we can be affected by environment variables (like PATH) and
shell globbing.
We can avoid most of the environment variables affecting the swupd result by
using the full path of the program being executed, but making sure the shell
won't expand all wildcards is tricky and specially dangerous for some commands
that we need to run, like cp, mkdir, etc.
So to make sure no globbing will be performed we can use fork+execve to run
commands instead of system.","HUGE readability improvement, very nice! Couple minor nits with comments, but this is great.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,717,2018-11-21T00:17:12Z,2018-12-06T22:50:20Z,2018-12-07T21:16:58Z,MERGED,True,235,94,10,https://github.com/otaviobp,sys: Add run_command() function to replace some usages of system(),7,[],https://github.com/clearlinux/swupd-client/pull/717,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/717#issuecomment-442660430,"System API is a very convenient way on executing external commands, but it has
some problems for some usages. System always launches a shell to execute the
desired command, so we can be affected by environment variables (like PATH) and
shell globbing.
We can avoid most of the environment variables affecting the swupd result by
using the full path of the program being executed, but making sure the shell
won't expand all wildcards is tricky and specially dangerous for some commands
that we need to run, like cp, mkdir, etc.
So to make sure no globbing will be performed we can use fork+execve to run
commands instead of system.",rebased and fixed the reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,718,2018-11-21T20:15:39Z,2018-11-27T00:04:44Z,2018-11-27T00:04:44Z,MERGED,True,128,141,35,https://github.com/castulo,Adding IDs to update tests,2,[],https://github.com/clearlinux/swupd-client/pull/718,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/718,"Adding the IDs to the update tests and some minor improvements.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding the IDs to the update tests and some minor improvements.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,718,2018-11-21T20:15:39Z,2018-11-27T00:04:44Z,2018-11-27T00:04:44Z,MERGED,True,128,141,35,https://github.com/castulo,Adding IDs to update tests,2,[],https://github.com/clearlinux/swupd-client/pull/718,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/718#issuecomment-441829008,"Adding the IDs to the update tests and some minor improvements.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I updated the commit message to reflect the test that was removed as requested,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,718,2018-11-21T20:15:39Z,2018-11-27T00:04:44Z,2018-11-27T00:04:44Z,MERGED,True,128,141,35,https://github.com/castulo,Adding IDs to update tests,2,[],https://github.com/clearlinux/swupd-client/pull/718,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/718#issuecomment-441834164,"Adding the IDs to the update tests and some minor improvements.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I split the commit in two commits as suggested by @matthewrsj,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,719,2018-11-26T18:13:48Z,2018-11-26T22:24:26Z,2018-11-27T00:59:47Z,MERGED,True,5,7,2,https://github.com/otaviobp,Safe functions,2,[],https://github.com/clearlinux/swupd-client/pull/719,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/719,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,720,2018-11-26T22:36:38Z,2018-12-06T22:50:33Z,2018-12-06T22:50:33Z,MERGED,True,21,18,3,https://github.com/castulo,Reporting of deleted files in bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/720,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/720,"When running bundle-remove to remove a bundle the number in ""Total
deleted files"" is often wrong. This is happening because when deleting
the files from a bundle sometimes we start by deleting a directory
(with all the files within it), so all the files that got deleted are not
accounted for, only one file will be counted as deleted (the directory),
this will yield to an incorrect count of deleted files.
This commit fixes this issue by printing the total number of
files that should be deleted, minus those that failed to be deleted,
instead of counting those that succeeded.
Closes #690
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running bundle-remove to remove a bundle the number in ""Total
deleted files"" is often wrong. This is happening because when deleting
the files from a bundle sometimes we start by deleting a directory
(with all the files within it), so all the files that got deleted are not
accounted for, only one file will be counted as deleted (the directory),
this will yield to an incorrect count of deleted files.
This commit fixes this issue by printing the total number of
files that should be deleted, minus those that failed to be deleted,
instead of counting those that succeeded.
Closes #690
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,722,2018-11-27T00:30:53Z,2018-11-28T21:44:32Z,2018-12-07T21:17:04Z,MERGED,True,52,19,7,https://github.com/otaviobp,helpers: Check for trailing characters in strtoi_err,1,[],https://github.com/clearlinux/swupd-client/pull/722,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/722,"Besides checking for overflow, also checks if the number in the string
doesn't have any trailing character. For example ""123abc"" will return
an error and ""123 abc"" won't.
Also:

Don't return EOVERFLOW anymore, because from the user of strtoi_err
perspective it doesn't matter if the overflow is in the int size or in
the long size. I would expect the same return code.

Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Besides checking for overflow, also checks if the number in the string
doesn't have any trailing character. For example ""123abc"" will return
an error and ""123 abc"" won't.
Also:

Don't return EOVERFLOW anymore, because from the user of strtoi_err
perspective it doesn't matter if the overflow is in the int size or in
the long size. I would expect the same return code.

Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,723,2018-11-27T00:56:34Z,2018-11-27T01:42:58Z,2018-12-07T21:17:13Z,MERGED,True,3,3,2,https://github.com/otaviobp,Don't save the latests Manifest as a hidden file,1,[],https://github.com/clearlinux/swupd-client/pull/723,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/723,"As we aren't saving the MoM in a directory we were reading to look for
bundles, we don't need to save it as a hidden file.
Suggestion of @phmccarty","As we aren't saving the MoM in a directory we were reading to look for
bundles, we don't need to save it as a hidden file.
Suggestion of @phmccarty",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,724,2018-11-28T02:12:30Z,2018-12-06T22:53:20Z,2018-12-06T22:53:20Z,MERGED,True,288,27,13,https://github.com/castulo,Fixes a bug in update when using mirrors,3,[],https://github.com/clearlinux/swupd-client/pull/724,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/724,"There are a couple of problems when the user has a mirror set up,
and tries to update. The first one is that in the case where the
user is using the -p option and a mirror, the version of the mirror
was failing to be retrieved since the path_prefix was being added
to the path twice. The second problem was that when the mirror being
used by the user was stale, the mirror was being unset but some values
had already being cached, causing the update function to fail.
This PR fixes the issues and add a few tests to validate the correct behavior.","There are a couple of problems when the user has a mirror set up,
and tries to update. The first one is that in the case where the
user is using the -p option and a mirror, the version of the mirror
was failing to be retrieved since the path_prefix was being added
to the path twice. The second problem was that when the mirror being
used by the user was stale, the mirror was being unset but some values
had already being cached, causing the update function to fail.
This PR fixes the issues and add a few tests to validate the correct behavior.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,724,2018-11-28T02:12:30Z,2018-12-06T22:53:20Z,2018-12-06T22:53:20Z,MERGED,True,288,27,13,https://github.com/castulo,Fixes a bug in update when using mirrors,3,[],https://github.com/clearlinux/swupd-client/pull/724,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/724#issuecomment-442292421,"There are a couple of problems when the user has a mirror set up,
and tries to update. The first one is that in the case where the
user is using the -p option and a mirror, the version of the mirror
was failing to be retrieved since the path_prefix was being added
to the path twice. The second problem was that when the mirror being
used by the user was stale, the mirror was being unset but some values
had already being cached, causing the update function to fail.
This PR fixes the issues and add a few tests to validate the correct behavior.",These bugs where found while trying to reproduce bug #669,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,724,2018-11-28T02:12:30Z,2018-12-06T22:53:20Z,2018-12-06T22:53:20Z,MERGED,True,288,27,13,https://github.com/castulo,Fixes a bug in update when using mirrors,3,[],https://github.com/clearlinux/swupd-client/pull/724,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/724#issuecomment-442634168,"There are a couple of problems when the user has a mirror set up,
and tries to update. The first one is that in the case where the
user is using the -p option and a mirror, the version of the mirror
was failing to be retrieved since the path_prefix was being added
to the path twice. The second problem was that when the mirror being
used by the user was stale, the mirror was being unset but some values
had already being cached, causing the update function to fail.
This PR fixes the issues and add a few tests to validate the correct behavior.","yes @otaviobp we don't have tests for those flags, it'll be nice to add those, and I prefer to have explicit tests for them than ""testing"" them as a side effect of using them anyway",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,724,2018-11-28T02:12:30Z,2018-12-06T22:53:20Z,2018-12-06T22:53:20Z,MERGED,True,288,27,13,https://github.com/castulo,Fixes a bug in update when using mirrors,3,[],https://github.com/clearlinux/swupd-client/pull/724,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/724#issuecomment-442646721,"There are a couple of problems when the user has a mirror set up,
and tries to update. The first one is that in the case where the
user is using the -p option and a mirror, the version of the mirror
was failing to be retrieved since the path_prefix was being added
to the path twice. The second problem was that when the mirror being
used by the user was stale, the mirror was being unset but some values
had already being cached, causing the update function to fail.
This PR fixes the issues and add a few tests to validate the correct behavior.",@otaviobp I moved the changes on the affected tests to the first commit as requested,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,725,2018-11-28T20:38:25Z,2018-11-28T21:45:50Z,2018-11-28T21:45:50Z,MERGED,True,9,10,1,https://github.com/castulo,Fix the path used by the test generator,1,[],https://github.com/clearlinux/swupd-client/pull/725,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/725,"There was a bug defining the path for a test in the test generator
that was causing the script to fail if the command was executed from
the wrong path.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There was a bug defining the path for a test in the test generator
that was causing the script to fail if the command was executed from
the wrong path.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,726,2018-11-28T23:58:59Z,2018-11-29T00:37:50Z,2018-12-07T21:17:03Z,MERGED,True,1,1,1,https://github.com/otaviobp,test: Add an ID to installation tests,1,[],https://github.com/clearlinux/swupd-client/pull/726,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/726,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/727,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/727#issuecomment-443288355,,"Another thing that came to my mind now about aliases. I don't know the future plans for alias, but we are not tracking the aliases that were installed, just the bundles. So, it would be nice to warn the user the list of bundles that he is installing from each alias. Something like:
$ swupd bundle-add alias1
  Installing ""vim emacs ..."" bundles as 'required' by alias alias1",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/727#issuecomment-443324666,,"Hrm, I agree having that output would be nice. I'll see about putting that in now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/727#issuecomment-443333897,,Hrm so I'm having second thoughts on printing out an installing specific for aliases. The issue I have is mostly increasing how ugly the code building the bundles_list_str is but I'm also a little unsure if I should be adding printing at that location given the output about installing bundles later on in the bundle_install code.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/727#issuecomment-445025090,,@otaviobp Is there anything more you'd like for me to do on the PR? I think I've addressed everything outside of the potential open on printing out what bundles are being installed via an alias.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/bryteise,6,https://github.com/clearlinux/swupd-client/pull/727#issuecomment-445114251,,@otaviobp I don't see any way to improve creating bundle_list_str aside from abstracting it behind a list function like reduce unfortunately. I added printing out the bundles added through alias and addressed the rest of the issues so the PR hopefully should be about ready now for merging.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,727,2018-11-29T19:24:27Z,2018-12-07T19:04:10Z,2019-01-25T21:13:46Z,MERGED,True,809,33,14,https://github.com/bryteise,Aliasing,3,[],https://github.com/clearlinux/swupd-client/pull/727,https://github.com/bryteise,7,https://github.com/clearlinux/swupd-client/pull/727#issuecomment-445321274,,Assuming travis says I numbered everything correctly this should be ready to merge now.,True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,728,2018-11-29T19:30:49Z,2018-11-29T20:58:02Z,2018-11-29T23:47:00Z,MERGED,True,1,1,1,https://github.com/vaclave,Update verify to include purpose for cert check,1,[],https://github.com/clearlinux/swupd-client/pull/728,https://github.com/vaclave,1,https://github.com/clearlinux/swupd-client/pull/728,"Newer versions of openssl require a valid purpose so
pass this in for the cert check.
Signed-off-by: David Klimesh david.j.klimesh@intel.com","Newer versions of openssl require a valid purpose so
pass this in for the cert check.
Signed-off-by: David Klimesh david.j.klimesh@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,728,2018-11-29T19:30:49Z,2018-11-29T20:58:02Z,2018-11-29T23:47:00Z,MERGED,True,1,1,1,https://github.com/vaclave,Update verify to include purpose for cert check,1,[],https://github.com/clearlinux/swupd-client/pull/728,https://github.com/matthewrsj,2,https://github.com/clearlinux/swupd-client/pull/728#issuecomment-443036630,"Newer versions of openssl require a valid purpose so
pass this in for the cert check.
Signed-off-by: David Klimesh david.j.klimesh@intel.com","@vaclave @otaviobp just so you know this shows up on master branch as a commit authored by @clrbuilder because @vaclave's email address must be associated with that account. Fortunately the commit author and signoff are correct, looks like just a github UI oddity.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,729,2018-11-29T22:05:02Z,2018-12-03T21:07:04Z,2018-12-03T21:07:04Z,MERGED,True,88,30,5,https://github.com/castulo,"Add ability to parse ""experimental"" bundles in MoM",2,[],https://github.com/clearlinux/swupd-client/pull/729,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/729,"Mixer will soon start using a new modifier for bundles in a MoM that are marked
as experimental. These bundles will include a ""e"" in the 4th position of the
modifiers of a manifest, like shown here:
M..e 4b91c3122e7e32f1e3edb0a705a6168ca8e66f597c6f89ff32cfffd977afb5e5 10 test-bundle
This PR adds the mechanism to parse that element from the MoM and store it in
memory. In the future this will allow swupd to treat this experimental bundles
differently if required.","Mixer will soon start using a new modifier for bundles in a MoM that are marked
as experimental. These bundles will include a ""e"" in the 4th position of the
modifiers of a manifest, like shown here:
M..e 4b91c3122e7e32f1e3edb0a705a6168ca8e66f597c6f89ff32cfffd977afb5e5 10 test-bundle
This PR adds the mechanism to parse that element from the MoM and store it in
memory. In the future this will allow swupd to treat this experimental bundles
differently if required.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,729,2018-11-29T22:05:02Z,2018-12-03T21:07:04Z,2018-12-03T21:07:04Z,MERGED,True,88,30,5,https://github.com/castulo,"Add ability to parse ""experimental"" bundles in MoM",2,[],https://github.com/clearlinux/swupd-client/pull/729,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/729#issuecomment-443012065,"Mixer will soon start using a new modifier for bundles in a MoM that are marked
as experimental. These bundles will include a ""e"" in the 4th position of the
modifiers of a manifest, like shown here:
M..e 4b91c3122e7e32f1e3edb0a705a6168ca8e66f597c6f89ff32cfffd977afb5e5 10 test-bundle
This PR adds the mechanism to parse that element from the MoM and store it in
memory. In the future this will allow swupd to treat this experimental bundles
differently if required.",This PR is part of the implementation of #676,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,729,2018-11-29T22:05:02Z,2018-12-03T21:07:04Z,2018-12-03T21:07:04Z,MERGED,True,88,30,5,https://github.com/castulo,"Add ability to parse ""experimental"" bundles in MoM",2,[],https://github.com/clearlinux/swupd-client/pull/729,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/729#issuecomment-443030361,"Mixer will soon start using a new modifier for bundles in a MoM that are marked
as experimental. These bundles will include a ""e"" in the 4th position of the
modifiers of a manifest, like shown here:
M..e 4b91c3122e7e32f1e3edb0a705a6168ca8e66f597c6f89ff32cfffd977afb5e5 10 test-bundle
This PR adds the mechanism to parse that element from the MoM and store it in
memory. In the future this will allow swupd to treat this experimental bundles
differently if required.","ups, actually I forgot to add the test to the Makefile  ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,729,2018-11-29T22:05:02Z,2018-12-03T21:07:04Z,2018-12-03T21:07:04Z,MERGED,True,88,30,5,https://github.com/castulo,"Add ability to parse ""experimental"" bundles in MoM",2,[],https://github.com/clearlinux/swupd-client/pull/729,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/729#issuecomment-443030796,"Mixer will soon start using a new modifier for bundles in a MoM that are marked
as experimental. These bundles will include a ""e"" in the 4th position of the
modifiers of a manifest, like shown here:
M..e 4b91c3122e7e32f1e3edb0a705a6168ca8e66f597c6f89ff32cfffd977afb5e5 10 test-bundle
This PR adds the mechanism to parse that element from the MoM and store it in
memory. In the future this will allow swupd to treat this experimental bundles
differently if required.",There it is,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/730,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list","This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-443034521,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list","This PR is built on top of PR #729 , once that one merges this will have to be rebased.
This is part of the work required for #676",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-443047506,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list",@matthewrsj I did the requested change.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-443056538,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list","I added one more piece, the ability to view experimental bundles when listing installed bundles.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-443060883,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list",I just realized there is a bit more work that needs to be done for this PR. Please hold on on reviewing it until further notice.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-443346306,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list","ok, now is ready to be reviewed",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-443891621,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list",Just rebased the code now that #729 was merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,730,2018-11-29T23:36:02Z,2018-12-10T22:44:34Z,2018-12-10T22:44:34Z,MERGED,True,106,20,5,https://github.com/castulo,Distinguish experimental bundles in a bundle list,2,[],https://github.com/clearlinux/swupd-client/pull/730,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/730#issuecomment-445959513,"This PR adds the ability to show an identifier in bundles that are
marked as experimental when listing available bundles or installed
bundles:
swupd bundle-list --all
swupd bundle-list",@otaviobp all your feedback should have been addressed now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,733,2018-11-30T22:02:55Z,2018-12-07T00:13:15Z,2018-12-07T00:13:15Z,MERGED,True,44,0,3,https://github.com/castulo,Warn user when adding an experimental bundle,1,[],https://github.com/clearlinux/swupd-client/pull/733,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/733,"This commit adds the ability of warning the user if he/she tries
to install an experimental bundle.","This commit adds the ability of warning the user if he/she tries
to install an experimental bundle.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,733,2018-11-30T22:02:55Z,2018-12-07T00:13:15Z,2018-12-07T00:13:15Z,MERGED,True,44,0,3,https://github.com/castulo,Warn user when adding an experimental bundle,1,[],https://github.com/clearlinux/swupd-client/pull/733,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/733#issuecomment-443354667,"This commit adds the ability of warning the user if he/she tries
to install an experimental bundle.","This PR is built on top of PR #729 , once that one merges this will have to be rebased.
This is part of the work required for #676",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,733,2018-11-30T22:02:55Z,2018-12-07T00:13:15Z,2018-12-07T00:13:15Z,MERGED,True,44,0,3,https://github.com/castulo,Warn user when adding an experimental bundle,1,[],https://github.com/clearlinux/swupd-client/pull/733,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/733#issuecomment-443892320,"This commit adds the ability of warning the user if he/she tries
to install an experimental bundle.",Just rebased the code now that #729 was merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,734,2018-11-30T23:57:51Z,2018-12-11T20:47:00Z,2018-12-11T20:47:00Z,MERGED,True,152,12,6,https://github.com/castulo,Show when a bundle is experimental in swupd search,1,[],https://github.com/clearlinux/swupd-client/pull/734,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/734,"This commit adds ability to show when a bundle is experimental in the
results of a swupd search.
Closes #676","This commit adds ability to show when a bundle is experimental in the
results of a swupd search.
Closes #676",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,734,2018-11-30T23:57:51Z,2018-12-11T20:47:00Z,2018-12-11T20:47:00Z,MERGED,True,152,12,6,https://github.com/castulo,Show when a bundle is experimental in swupd search,1,[],https://github.com/clearlinux/swupd-client/pull/734,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/734#issuecomment-443375581,"This commit adds ability to show when a bundle is experimental in the
results of a swupd search.
Closes #676","This PR is built on top of PR #729 , once that one merges this will have to be rebased.
This is part of the work required for #676",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,734,2018-11-30T23:57:51Z,2018-12-11T20:47:00Z,2018-12-11T20:47:00Z,MERGED,True,152,12,6,https://github.com/castulo,Show when a bundle is experimental in swupd search,1,[],https://github.com/clearlinux/swupd-client/pull/734,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/734#issuecomment-443892043,"This commit adds ability to show when a bundle is experimental in the
results of a swupd search.
Closes #676",Just rebased the code now that #729 was merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,734,2018-11-30T23:57:51Z,2018-12-11T20:47:00Z,2018-12-11T20:47:00Z,MERGED,True,152,12,6,https://github.com/castulo,Show when a bundle is experimental in swupd search,1,[],https://github.com/clearlinux/swupd-client/pull/734,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/734#issuecomment-446032432,"This commit adds ability to show when a bundle is experimental in the
results of a swupd search.
Closes #676",@otaviobp your comment was addressed. Let me know if you need anything else.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,734,2018-11-30T23:57:51Z,2018-12-11T20:47:00Z,2018-12-11T20:47:00Z,MERGED,True,152,12,6,https://github.com/castulo,Show when a bundle is experimental in swupd search,1,[],https://github.com/clearlinux/swupd-client/pull/734,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/734#issuecomment-446032649,"This commit adds ability to show when a bundle is experimental in the
results of a swupd search.
Closes #676","Since this is the last PR about this topic to be merged.
Closes #676",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,735,2018-12-03T23:02:45Z,2018-12-13T20:18:04Z,2019-03-14T17:09:03Z,MERGED,True,0,186,2,https://github.com/otaviobp,Scripts,2,[],https://github.com/clearlinux/swupd-client/pull/735,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/735,Removing 2 unused scripts,Removing 2 unused scripts,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,736,2018-12-07T00:29:53Z,2018-12-07T01:08:45Z,2018-12-07T01:08:45Z,MERGED,True,4,2,2,https://github.com/castulo,Making set_version_url and set_content_url public,1,[],https://github.com/clearlinux/swupd-client/pull/736,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/736,"Functions set_version_url and set_content_url were recently made static
since they were not being used outside of the globals file. Another
commit was merged that was using those functions from another file.
This commit makes those functions back to public.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Functions set_version_url and set_content_url were recently made static
since they were not being used outside of the globals file. Another
commit was merged that was using those functions from another file.
This commit makes those functions back to public.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,737,2018-12-07T18:57:01Z,2018-12-07T19:38:08Z,2018-12-07T19:38:08Z,MERGED,True,16,11,1,https://github.com/castulo,Changes to comply with PEP8,1,[],https://github.com/clearlinux/swupd-client/pull/737,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/737,"PEP8 dictates the style conventions for Python, complying with these
standards is a good practice.
This commit makes a few small changes to comply with PEP8 standards.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","PEP8 dictates the style conventions for Python, complying with these
standards is a good practice.
This commit makes a few small changes to comply with PEP8 standards.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,738,2018-12-07T19:34:28Z,2018-12-17T21:25:24Z,2019-03-14T17:08:56Z,MERGED,True,211,134,19,https://github.com/otaviobp,Reorg,3,[],https://github.com/clearlinux/swupd-client/pull/738,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/738,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,738,2018-12-07T19:34:28Z,2018-12-17T21:25:24Z,2019-03-14T17:08:56Z,MERGED,True,211,134,19,https://github.com/otaviobp,Reorg,3,[],https://github.com/clearlinux/swupd-client/pull/738,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/738#issuecomment-447946320,,What about helpers.c? shouldn't that be moved to src/lib/ too?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,738,2018-12-07T19:34:28Z,2018-12-17T21:25:24Z,2019-03-14T17:08:56Z,MERGED,True,211,134,19,https://github.com/otaviobp,Reorg,3,[],https://github.com/clearlinux/swupd-client/pull/738,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/738#issuecomment-447973526,,"What about helpers.c? shouldn't that be moved to src/lib/ too?

Eventually yes. But there are several functions in helpers that are aren't generic and are tightly coupled with other swupd code (like verify_fix_path, is_compatible_format, is_current_version...). And even some functions that looks generic, like untar_full_download, are not.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,739,2018-12-10T21:22:34Z,2018-12-13T20:18:49Z,2018-12-13T20:18:49Z,MERGED,True,137,23,3,https://github.com/castulo,Provide the ability to set the upstream server in a test environment.,3,[],https://github.com/clearlinux/swupd-client/pull/739,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/739,"Every test environment gets created with a default value for versionurl
and contenturl that points to the appropriate place using the ""file://""
protocol. In some occassions the user may want to change this value to
something different, for example if he/she is planning on using an http
server to host the version/content.
This PR provides a way of setting up the upstream server in the test environment.","Every test environment gets created with a default value for versionurl
and contenturl that points to the appropriate place using the ""file://""
protocol. In some occassions the user may want to change this value to
something different, for example if he/she is planning on using an http
server to host the version/content.
This PR provides a way of setting up the upstream server in the test environment.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,740,2018-12-10T21:49:17Z,2018-12-17T14:19:15Z,2018-12-17T14:19:16Z,MERGED,True,61,33,8,https://github.com/castulo,Setting upstream server in client cert tests,1,[],https://github.com/clearlinux/swupd-client/pull/740,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/740,"The tests that attempt to verify the client certificate were using the
swupd -u option to set the url of the ""upstream server"". Recently a
function was added to the test library to set the default upstream
server.
This commit modifies these tests so they used the new function to set
the upstream server instead of using the -u option. This will provide
the benefit of the test environment being more similar to a prod
environment, also makes the test setup less convoluted and the tests
easier to read.
This PR is built on top of PR #739, once that PR merges this will have to be rebased.","The tests that attempt to verify the client certificate were using the
swupd -u option to set the url of the ""upstream server"". Recently a
function was added to the test library to set the default upstream
server.
This commit modifies these tests so they used the new function to set
the upstream server instead of using the -u option. This will provide
the benefit of the test environment being more similar to a prod
environment, also makes the test setup less convoluted and the tests
easier to read.
This PR is built on top of PR #739, once that PR merges this will have to be rebased.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,740,2018-12-10T21:49:17Z,2018-12-17T14:19:15Z,2018-12-17T14:19:16Z,MERGED,True,61,33,8,https://github.com/castulo,Setting upstream server in client cert tests,1,[],https://github.com/clearlinux/swupd-client/pull/740,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/740#issuecomment-447099080,"The tests that attempt to verify the client certificate were using the
swupd -u option to set the url of the ""upstream server"". Recently a
function was added to the test library to set the default upstream
server.
This commit modifies these tests so they used the new function to set
the upstream server instead of using the -u option. This will provide
the benefit of the test environment being more similar to a prod
environment, also makes the test setup less convoluted and the tests
easier to read.
This PR is built on top of PR #739, once that PR merges this will have to be rebased.",I don't think there is still a reason for the check-update tests to be different than the other client certificates tests. Does it make sense for the check-update tests to follow this new test format?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,740,2018-12-10T21:49:17Z,2018-12-17T14:19:15Z,2018-12-17T14:19:16Z,MERGED,True,61,33,8,https://github.com/castulo,Setting upstream server in client cert tests,1,[],https://github.com/clearlinux/swupd-client/pull/740,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/740#issuecomment-447116776,"The tests that attempt to verify the client certificate were using the
swupd -u option to set the url of the ""upstream server"". Recently a
function was added to the test library to set the default upstream
server.
This commit modifies these tests so they used the new function to set
the upstream server instead of using the -u option. This will provide
the benefit of the test environment being more similar to a prod
environment, also makes the test setup less convoluted and the tests
easier to read.
This PR is built on top of PR #739, once that PR merges this will have to be rebased.","I don't think there is still a reason for the check-update tests to be different than the other client certificates tests. Does it make sense for the check-update tests to follow this new test format?

You are absolutely right. Very good catch. I guess I missed them because I most have searched for the SWUPD_OPTS_HTTP variable and those ones aren't using it. I'll update that test in a new commit. Thanks for noticing that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,741,2018-12-11T01:06:41Z,2018-12-13T22:11:56Z,2018-12-13T22:11:56Z,MERGED,True,202,59,3,https://github.com/castulo,Adding options to further control server.py,1,[],https://github.com/clearlinux/swupd-client/pull/741,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/741,"The server.py script is used in some functional tests to simulate
a slow content server. This commit provides a few extra options
that extend the use of this script for testing purposes.
Improvements included:

Ability to specify what port to use for the web server (useful when running the script manually)
Ability to make the web server reachable by other machines in the network (useful when running the script manually/debugging)
Ability to specify the directory to serve instead of just serving the directory where the server.py file is
Ability to hang the server on command
Ability to fine-tune how slow the server responds by being able to specify the delay time and the number of bytes read per cycle.
Ability to either hang the server / or make it slow after a specific number of normal requests. This way you can simulate a server that is working normally and suddenly it starts working odd.
Includes also a few improvements to make the code more robust

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The server.py script is used in some functional tests to simulate
a slow content server. This commit provides a few extra options
that extend the use of this script for testing purposes.
Improvements included:

Ability to specify what port to use for the web server (useful when running the script manually)
Ability to make the web server reachable by other machines in the network (useful when running the script manually/debugging)
Ability to specify the directory to serve instead of just serving the directory where the server.py file is
Ability to hang the server on command
Ability to fine-tune how slow the server responds by being able to specify the delay time and the number of bytes read per cycle.
Ability to either hang the server / or make it slow after a specific number of normal requests. This way you can simulate a server that is working normally and suddenly it starts working odd.
Includes also a few improvements to make the code more robust

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,741,2018-12-11T01:06:41Z,2018-12-13T22:11:56Z,2018-12-13T22:11:56Z,MERGED,True,202,59,3,https://github.com/castulo,Adding options to further control server.py,1,[],https://github.com/clearlinux/swupd-client/pull/741,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/741#issuecomment-446422194,"The server.py script is used in some functional tests to simulate
a slow content server. This commit provides a few extra options
that extend the use of this script for testing purposes.
Improvements included:

Ability to specify what port to use for the web server (useful when running the script manually)
Ability to make the web server reachable by other machines in the network (useful when running the script manually/debugging)
Ability to specify the directory to serve instead of just serving the directory where the server.py file is
Ability to hang the server on command
Ability to fine-tune how slow the server responds by being able to specify the delay time and the number of bytes read per cycle.
Ability to either hang the server / or make it slow after a specific number of normal requests. This way you can simulate a server that is working normally and suddenly it starts working odd.
Includes also a few improvements to make the code more robust

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I realized I needed to move the block that changes the working directory to the bottom of the main so it doesn't affect other paths (like the path of the pid_file and port_file),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,741,2018-12-11T01:06:41Z,2018-12-13T22:11:56Z,2018-12-13T22:11:56Z,MERGED,True,202,59,3,https://github.com/castulo,Adding options to further control server.py,1,[],https://github.com/clearlinux/swupd-client/pull/741,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/741#issuecomment-446435291,"The server.py script is used in some functional tests to simulate
a slow content server. This commit provides a few extra options
that extend the use of this script for testing purposes.
Improvements included:

Ability to specify what port to use for the web server (useful when running the script manually)
Ability to make the web server reachable by other machines in the network (useful when running the script manually/debugging)
Ability to specify the directory to serve instead of just serving the directory where the server.py file is
Ability to hang the server on command
Ability to fine-tune how slow the server responds by being able to specify the delay time and the number of bytes read per cycle.
Ability to either hang the server / or make it slow after a specific number of normal requests. This way you can simulate a server that is working normally and suddenly it starts working odd.
Includes also a few improvements to make the code more robust

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Oops I had to do one more change.
When starting the server.py from the testilb.bash (start_web_server) we wait for the server to be ready by performing some curl requests and waiting for the server to respond. If the option -H (hang the server) is used, then one of this curl requests is going to cause the server to hang ahead of time, causing the testlib to get stuck waiting for the server. I had to add one test url (/test-connection) that can be used safely to wait for the server to be ready without hanging it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,741,2018-12-11T01:06:41Z,2018-12-13T22:11:56Z,2018-12-13T22:11:56Z,MERGED,True,202,59,3,https://github.com/castulo,Adding options to further control server.py,1,[],https://github.com/clearlinux/swupd-client/pull/741,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/741#issuecomment-447111049,"The server.py script is used in some functional tests to simulate
a slow content server. This commit provides a few extra options
that extend the use of this script for testing purposes.
Improvements included:

Ability to specify what port to use for the web server (useful when running the script manually)
Ability to make the web server reachable by other machines in the network (useful when running the script manually/debugging)
Ability to specify the directory to serve instead of just serving the directory where the server.py file is
Ability to hang the server on command
Ability to fine-tune how slow the server responds by being able to specify the delay time and the number of bytes read per cycle.
Ability to either hang the server / or make it slow after a specific number of normal requests. This way you can simulate a server that is working normally and suddenly it starts working odd.
Includes also a few improvements to make the code more robust

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@jwakre I made the change you requested. ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,743,2018-12-11T18:27:21Z,2018-12-11T22:30:06Z,2018-12-11T22:30:06Z,MERGED,True,3,3,2,https://github.com/castulo,Moving experimental flag from 4th to 2nd position,1,[],https://github.com/clearlinux/swupd-client/pull/743,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/743,"There was a change of plans in the mixer side and looks like the flag
that will be used to mark a bundle as an experimental will be the 2nd
one instead of the 4th one.
This commit moves the flag to the 2nd position in the swupd client.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There was a change of plans in the mixer side and looks like the flag
that will be used to mark a bundle as an experimental will be the 2nd
one instead of the 4th one.
This commit moves the flag to the 2nd position in the swupd client.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,744,2018-12-11T22:18:04Z,2019-01-08T23:00:22Z,2019-01-08T23:00:22Z,CLOSED,False,44,12,11,https://github.com/evil-brain,Add compile-time warning flags,3,[],https://github.com/clearlinux/swupd-client/pull/744,https://github.com/evil-brain,1,https://github.com/clearlinux/swupd-client/pull/744,"Note: Wpedantic adds a bunch of warnings right now.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","Note: Wpedantic adds a bunch of warnings right now.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,744,2018-12-11T22:18:04Z,2019-01-08T23:00:22Z,2019-01-08T23:00:22Z,CLOSED,False,44,12,11,https://github.com/evil-brain,Add compile-time warning flags,3,[],https://github.com/clearlinux/swupd-client/pull/744,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/744#issuecomment-446395934,"Note: Wpedantic adds a bunch of warnings right now.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com","@evil-brain According to the commit message, warnings are made fatal, but I do not see an option here that does that. Is the commit message outdated?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,744,2018-12-11T22:18:04Z,2019-01-08T23:00:22Z,2019-01-08T23:00:22Z,CLOSED,False,44,12,11,https://github.com/evil-brain,Add compile-time warning flags,3,[],https://github.com/clearlinux/swupd-client/pull/744,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/744#issuecomment-452483009,"Note: Wpedantic adds a bunch of warnings right now.
All warning-related flags are on their own lines, because they look very
messy if they're all shoved together. Enabled many more warnings and
made warnings fatal.
Signed-off-by: Brian J Lovin brian.j.lovin@intel.com",merged with a subset of proposed warning flags.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,745,2018-12-12T00:15:33Z,2018-12-12T17:26:26Z,2019-03-14T17:08:58Z,MERGED,True,57,1,2,https://github.com/otaviobp,docs: Add swupd-alias.7.rst to repository,1,[],https://github.com/clearlinux/swupd-client/pull/745,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/745,"We have defined that we are committing to the repository the rst files,
so I'm adding the alias rst file
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We have defined that we are committing to the repository the rst files,
so I'm adding the alias rst file
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,745,2018-12-12T00:15:33Z,2018-12-12T17:26:26Z,2019-03-14T17:08:58Z,MERGED,True,57,1,2,https://github.com/otaviobp,docs: Add swupd-alias.7.rst to repository,1,[],https://github.com/clearlinux/swupd-client/pull/745,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/745#issuecomment-446425396,"We have defined that we are committing to the repository the rst files,
so I'm adding the alias rst file
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Normally I don't see autoconf generated content checked into the repo but I guess that isn't a particularly bad for configure and the like from make dist so +1.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,747,2018-12-12T21:21:16Z,2018-12-20T16:49:47Z,2019-03-14T17:08:57Z,MERGED,True,17,16,8,https://github.com/otaviobp,curl: Don't warn users on non critical SSL errors,1,[],https://github.com/clearlinux/swupd-client/pull/747,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/747,"If we have an ssl error we try to use a fallback capath directory. Don't warn
users for errors unless we have failed on connecting using all available
fallback paths.
Fixes: #746
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If we have an ssl error we try to use a fallback capath directory. Don't warn
users for errors unless we have failed on connecting using all available
fallback paths.
Fixes: #746
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,747,2018-12-12T21:21:16Z,2018-12-20T16:49:47Z,2019-03-14T17:08:57Z,MERGED,True,17,16,8,https://github.com/otaviobp,curl: Don't warn users on non critical SSL errors,1,[],https://github.com/clearlinux/swupd-client/pull/747,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/747#issuecomment-447862870,"If we have an ssl error we try to use a fallback capath directory. Don't warn
users for errors unless we have failed on connecting using all available
fallback paths.
Fixes: #746
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",tests were updated and we're passing everything now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,748,2018-12-13T00:57:23Z,2018-12-13T18:53:23Z,2018-12-13T18:53:23Z,MERGED,True,12,2,1,https://github.com/castulo,Add git user and email by default in new tests,1,[],https://github.com/clearlinux/swupd-client/pull/748,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/748,"When using the test generator from the testlib to create a new empty
test, it will pre-fill the user name and email from the git config in the
test if possible.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When using the test generator from the testlib to create a new empty
test, it will pre-fill the user name and email from the git config in the
test if possible.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,749,2018-12-13T22:27:52Z,2018-12-27T17:34:02Z,2018-12-27T17:34:02Z,MERGED,True,267,77,5,https://github.com/castulo,Timeout for testing connection in swupd init,2,[],https://github.com/clearlinux/swupd-client/pull/749,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/749,"As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,749,2018-12-13T22:27:52Z,2018-12-27T17:34:02Z,2018-12-27T17:34:02Z,MERGED,True,267,77,5,https://github.com/castulo,Timeout for testing connection in swupd init,2,[],https://github.com/clearlinux/swupd-client/pull/749,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/749#issuecomment-449208740,"As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The slow-server test is failing to initialize curl (getting error ECURL_INIT, cannot initialize curl agent)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,749,2018-12-13T22:27:52Z,2018-12-27T17:34:02Z,2018-12-27T17:34:02Z,MERGED,True,267,77,5,https://github.com/castulo,Timeout for testing connection in swupd init,2,[],https://github.com/clearlinux/swupd-client/pull/749,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/749#issuecomment-449490031,"As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I realized the update-slow-server test is failing because is the only test using the TestServer class from server.py (https://github.com/clearlinux/swupd-client/blob/master/test/functional/server.py#L66). When curl checks the connection at curl initialization it does a HEAD request to that server, and that TestServer does not support that method so it returns a code 501. Since we have set CURLOPT_FAILONERROR with the swupd_curl_set_basic_options which does this ""CURLOPT_FAILONERROR - request failure on HTTP response >= 400"" then curl initialization fails.
To fix this test I'll need to either add support to HEAD requests to the TestServer class, or move the functionality from the TestServer class to the SimpleServer class which supports the HEAD method and get rid of TestServer. This is more work than the first option but I think is the best option so we use only one class for the server.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,749,2018-12-13T22:27:52Z,2018-12-27T17:34:02Z,2018-12-27T17:34:02Z,MERGED,True,267,77,5,https://github.com/castulo,Timeout for testing connection in swupd init,2,[],https://github.com/clearlinux/swupd-client/pull/749,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/749#issuecomment-449494260,"As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Merging is always nice, but not sure if it's an easy task.
It looks like a copy and paste from do_HEAD method from SimpleTest to support that in TestServer. if this is the case, I would go with the 2nd alternative",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,749,2018-12-13T22:27:52Z,2018-12-27T17:34:02Z,2018-12-27T17:34:02Z,MERGED,True,267,77,5,https://github.com/castulo,Timeout for testing connection in swupd init,2,[],https://github.com/clearlinux/swupd-client/pull/749,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/749#issuecomment-449494730,"As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","oops, I didn't realize SImpleTest depended on hang_server. It looks easier to go with the 1st alternative then",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,749,2018-12-13T22:27:52Z,2018-12-27T17:34:02Z,2018-12-27T17:34:02Z,MERGED,True,267,77,5,https://github.com/castulo,Timeout for testing connection in swupd init,2,[],https://github.com/clearlinux/swupd-client/pull/749,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/749#issuecomment-449495946,"As part of the swupd initialization, curl is initialized, which means it
is configured and the connection is tested. When configuring curl for
this test, no timeout was being configured, which was causing curl to
hang waiting for a response from the server if the server was unresponsive.
This commit configures the curl timeouts the same way they are being
configured when downloading files, so in case we get an unresponsive
server (or mirror) it doesn't get stuck forever.
Closes #669
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","oops, I didn't realize SImpleTest depended on hang_server. It looks easier to go with the 1st alternative then

what do you mean SimpleTest depended on hang_server?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,750,2018-12-13T23:48:11Z,2019-02-28T18:56:34Z,2019-02-28T18:56:34Z,CLOSED,False,1434,236,54,https://github.com/jwakre,BLOCKED (Needs FB): Enable iterative/delta manifests,18,[],https://github.com/clearlinux/swupd-client/pull/750,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/750,The master_new_manifests branch has been rebased onto master. This PR applies the updated patches to the master branch which enables iterative/delta manifests.,The master_new_manifests branch has been rebased onto master. This PR applies the updated patches to the master branch which enables iterative/delta manifests.,True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,750,2018-12-13T23:48:11Z,2019-02-28T18:56:34Z,2019-02-28T18:56:34Z,CLOSED,False,1434,236,54,https://github.com/jwakre,BLOCKED (Needs FB): Enable iterative/delta manifests,18,[],https://github.com/clearlinux/swupd-client/pull/750,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/750#issuecomment-447432844,The master_new_manifests branch has been rebased onto master. This PR applies the updated patches to the master branch which enables iterative/delta manifests.,The last 3 commits were not part of the original iterative/delta manifest PR. I added them to resolve issues in the rebase while also making it easier to review.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,750,2018-12-13T23:48:11Z,2019-02-28T18:56:34Z,2019-02-28T18:56:34Z,CLOSED,False,1434,236,54,https://github.com/jwakre,BLOCKED (Needs FB): Enable iterative/delta manifests,18,[],https://github.com/clearlinux/swupd-client/pull/750,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/750#issuecomment-468393446,The master_new_manifests branch has been rebased onto master. This PR applies the updated patches to the master branch which enables iterative/delta manifests.,"Since manifest deltas are re-enabled, this feature may no longer be desired. Closing PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,754,2018-12-14T22:42:53Z,2018-12-17T17:51:31Z,2018-12-17T17:51:31Z,MERGED,True,1,3,1,https://github.com/jwakre,Add space to separate 'mixin build' command,1,[],https://github.com/clearlinux/swupd-client/pull/754,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/754,"The run_command calls /usr/bin/mixinbuild, but it should call
/usr/bin/mixin build.
Signed-off-by: John Akre john.w.akre@intel.com","The run_command calls /usr/bin/mixinbuild, but it should call
/usr/bin/mixin build.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,755,2018-12-15T00:11:34Z,2018-12-31T22:02:54Z,2018-12-31T22:02:54Z,CLOSED,False,10,0,1,https://github.com/jwakre,Sync mixin version with upstream during update,1,[],https://github.com/clearlinux/swupd-client/pull/755,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/755,"When updating to a new upstream version, the mixin version should be
reset so that it is based on the new upstream version. Removing the
'.valid-mix' file before calling the 'mixin build' command will reset
the mixin version to the new upstream version.
Signed-off-by: John Akre john.w.akre@intel.com","When updating to a new upstream version, the mixin version should be
reset so that it is based on the new upstream version. Removing the
'.valid-mix' file before calling the 'mixin build' command will reset
the mixin version to the new upstream version.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,755,2018-12-15T00:11:34Z,2018-12-31T22:02:54Z,2018-12-31T22:02:54Z,CLOSED,False,10,0,1,https://github.com/jwakre,Sync mixin version with upstream during update,1,[],https://github.com/clearlinux/swupd-client/pull/755,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/755#issuecomment-447515983,"When updating to a new upstream version, the mixin version should be
reset so that it is based on the new upstream version. Removing the
'.valid-mix' file before calling the 'mixin build' command will reset
the mixin version to the new upstream version.
Signed-off-by: John Akre john.w.akre@intel.com","This PR addresses the following issue from mixer:
clearlinux/mixer-tools#367
It is much easier to implement the solution on swupd",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,756,2018-12-15T01:05:57Z,2018-12-17T20:43:06Z,2018-12-17T20:43:06Z,MERGED,True,19,6,1,https://github.com/castulo,Testlib improvements,3,[],https://github.com/clearlinux/swupd-client/pull/756,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/756,"This PR includes the following improvements for testlib:

Ability to create files with specific size, useful for creating bundles
with files of a known size, or really big files.
Silencing output when starting a test web server.
Use std out if there is no file descriptor 3 when using print.","This PR includes the following improvements for testlib:

Ability to create files with specific size, useful for creating bundles
with files of a known size, or really big files.
Silencing output when starting a test web server.
Use std out if there is no file descriptor 3 when using print.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,757,2018-12-17T17:21:32Z,2019-01-08T23:08:14Z,2019-01-08T23:08:17Z,MERGED,True,70,5,3,https://github.com/otaviobp,Add swupd development guide,1,[],https://github.com/clearlinux/swupd-client/pull/757,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/757,"Add a simple development guide for swupd. We can maintain that as long as we
add new development rules to swupd project.","Add a simple development guide for swupd. We can maintain that as long as we
add new development rules to swupd project.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,757,2018-12-17T17:21:32Z,2019-01-08T23:08:14Z,2019-01-08T23:08:17Z,MERGED,True,70,5,3,https://github.com/otaviobp,Add swupd development guide,1,[],https://github.com/clearlinux/swupd-client/pull/757,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/757#issuecomment-447941353,"Add a simple development guide for swupd. We can maintain that as long as we
add new development rules to swupd project.","Also, maybe you can add something about printing messages to the screen. For example if they should use capital letters for warning: some message or Error: Some message and perhaps also when to use printf vs fprintf...",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,757,2018-12-17T17:21:32Z,2019-01-08T23:08:14Z,2019-01-08T23:08:17Z,MERGED,True,70,5,3,https://github.com/otaviobp,Add swupd development guide,1,[],https://github.com/clearlinux/swupd-client/pull/757,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/757#issuecomment-447966459,"Add a simple development guide for swupd. We can maintain that as long as we
add new development rules to swupd project.","Also, maybe you can add something about printing messages to the screen. For example if they should use capital letters for warning: some message or Error: Some message and perhaps also when to use printf vs fprintf...

We have one ticket to define that (#294). We can add this as soon as we have a better definition on what will we do.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,757,2018-12-17T17:21:32Z,2019-01-08T23:08:14Z,2019-01-08T23:08:17Z,MERGED,True,70,5,3,https://github.com/otaviobp,Add swupd development guide,1,[],https://github.com/clearlinux/swupd-client/pull/757,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/757#issuecomment-452484946,"Add a simple development guide for swupd. We can maintain that as long as we
add new development rules to swupd project.",Merged with proposed fixes.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,758,2018-12-17T22:05:15Z,2018-12-27T17:34:38Z,2019-03-14T17:08:53Z,MERGED,True,131,4,8,https://github.com/otaviobp,Log - curl downloads,3,[],https://github.com/clearlinux/swupd-client/pull/758,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/758,"I have a local code with prints I use to debug some download bugs. I didn't commit that before because it's too verbose to print it always.
This series introduce a new log API and 2 new flags (--debug and --quiet) and a commit using that to print download debug information. As those flags are experimental and are not completely finished (--quiet is far from quiet in current master) I didn't added that to the documentation or help messages.","I have a local code with prints I use to debug some download bugs. I didn't commit that before because it's too verbose to print it always.
This series introduce a new log API and 2 new flags (--debug and --quiet) and a commit using that to print download debug information. As those flags are experimental and are not completely finished (--quiet is far from quiet in current master) I didn't added that to the documentation or help messages.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,758,2018-12-17T22:05:15Z,2018-12-27T17:34:38Z,2019-03-14T17:08:53Z,MERGED,True,131,4,8,https://github.com/otaviobp,Log - curl downloads,3,[],https://github.com/clearlinux/swupd-client/pull/758,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/758#issuecomment-449449976,"I have a local code with prints I use to debug some download bugs. I didn't commit that before because it's too verbose to print it always.
This series introduce a new log API and 2 new flags (--debug and --quiet) and a commit using that to print download debug information. As those flags are experimental and are not completely finished (--quiet is far from quiet in current master) I didn't added that to the documentation or help messages.","Sent a new version adding the current timestamp. Also printing now the timestamp, file and line on every log when --debug is used.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,759,2018-12-18T00:09:48Z,2018-12-20T23:20:25Z,2019-03-14T17:08:55Z,MERGED,True,40,2,2,https://github.com/otaviobp,Hashmap bugs,3,[],https://github.com/clearlinux/swupd-client/pull/759,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/759,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,760,2018-12-18T16:39:17Z,2018-12-21T17:45:14Z,2019-03-14T17:08:56Z,MERGED,True,9,0,2,https://github.com/otaviobp,Makefile: Only run shellcheck on scripts that have changed in current,1,[],https://github.com/clearlinux/swupd-client/pull/760,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/760," branch
Use origin/master branch to check which bash and bats scripts have changed and
run shellcheck only on them. This intends to make travis check faster."," branch
Use origin/master branch to check which bash and bats scripts have changed and
run shellcheck only on them. This intends to make travis check faster.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,761,2018-12-18T20:56:10Z,2019-01-11T21:59:05Z,2019-03-14T17:08:46Z,CLOSED,False,243,8,5,https://github.com/otaviobp,Bringing back http downloads with threads after some fixes,2,[],https://github.com/clearlinux/swupd-client/pull/761,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/761,depends on #759 to work properly.,depends on #759 to work properly.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,761,2018-12-18T20:56:10Z,2019-01-11T21:59:05Z,2019-03-14T17:08:46Z,CLOSED,False,243,8,5,https://github.com/otaviobp,Bringing back http downloads with threads after some fixes,2,[],https://github.com/clearlinux/swupd-client/pull/761,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/761#issuecomment-453280930,depends on #759 to work properly.,"Updated the PR, but waiting a comment on my comment about comments.",True,{'LAUGH': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,761,2018-12-18T20:56:10Z,2019-01-11T21:59:05Z,2019-03-14T17:08:46Z,CLOSED,False,243,8,5,https://github.com/otaviobp,Bringing back http downloads with threads after some fixes,2,[],https://github.com/clearlinux/swupd-client/pull/761,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/761#issuecomment-453670259,depends on #759 to work properly.,"it keeps failing due to code style issues, did you rebase the PR @otaviobp ?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,762,2018-12-19T00:15:28Z,2019-01-10T22:05:03Z,2019-01-10T22:05:03Z,MERGED,True,945,134,30,https://github.com/castulo,Do not retry files download if there is no more space on disk,10,[],https://github.com/clearlinux/swupd-client/pull/762,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/762,"When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,762,2018-12-19T00:15:28Z,2019-01-10T22:05:03Z,2019-01-10T22:05:03Z,MERGED,True,945,134,30,https://github.com/castulo,Do not retry files download if there is no more space on disk,10,[],https://github.com/clearlinux/swupd-client/pull/762,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/762#issuecomment-448648975,"When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","nice commit. with this feature we can also add tests for bundle-add with large bundles.
I will just wait for a test using it to get this merged, to make sure it's really working fine.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,762,2018-12-19T00:15:28Z,2019-01-10T22:05:03Z,2019-01-10T22:05:03Z,MERGED,True,945,134,30,https://github.com/castulo,Do not retry files download if there is no more space on disk,10,[],https://github.com/clearlinux/swupd-client/pull/762,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/762#issuecomment-448755736,"When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I'm working on having this working for bundle-add too...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,762,2018-12-19T00:15:28Z,2019-01-10T22:05:03Z,2019-01-10T22:05:03Z,MERGED,True,945,134,30,https://github.com/castulo,Do not retry files download if there is no more space on disk,10,[],https://github.com/clearlinux/swupd-client/pull/762,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/762#issuecomment-450936708,"When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There are some strange failures on the tests included in test/functional/search/search-no-disk-space.bats. I'll look into it, in the mean time please hold on reviewing this PR.
WIP",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,762,2018-12-19T00:15:28Z,2019-01-10T22:05:03Z,2019-01-10T22:05:03Z,MERGED,True,945,134,30,https://github.com/castulo,Do not retry files download if there is no more space on disk,10,[],https://github.com/clearlinux/swupd-client/pull/762,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/762#issuecomment-451590480,"When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",The PR is now ready for review,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,762,2018-12-19T00:15:28Z,2019-01-10T22:05:03Z,2019-01-10T22:05:03Z,MERGED,True,945,134,30,https://github.com/castulo,Do not retry files download if there is no more space on disk,10,[],https://github.com/clearlinux/swupd-client/pull/762,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/762#issuecomment-451607154,"When a disk gets full on a file download during an update, we are currently scheduling up to five retries for that download, which are going to fail for sure since there is no more space on disk.
This PR changes this behavior so it only tries to download the file once if we receive an error about the disk being full so we don't waste time.
The PR includes these commits:

A commit with the necessary updates in the test library so we can create test environments that are limited in space.
A commit that includes tests to validate the different scenarios where the disk can get filled up during an update.
The changes to the swupd code to abort download retries when the disk is full.

Closes #752
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Rebased and added one more improvement to the search test scripts now that #770 has been merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,763,2018-12-19T16:53:55Z,2018-12-20T23:20:37Z,2019-03-14T17:08:54Z,MERGED,True,8,2,2,https://github.com/otaviobp,time: Use strftotime instead of asctime,1,[],https://github.com/clearlinux/swupd-client/pull/763,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/763,"Strtotime is safer than asctime, so prefer that. It's known that there are
implementations of asctime that doesn't handle errors very well.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Strtotime is safer than asctime, so prefer that. It's known that there are
implementations of asctime that doesn't handle errors very well.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,764,2018-12-19T16:55:13Z,2018-12-19T17:32:53Z,2018-12-19T17:32:54Z,CLOSED,False,78,102,5,https://github.com/otaviobp,CURL: Fix http error code handling,2,[],https://github.com/clearlinux/swupd-client/pull/764,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/764,"Fix http error code handling for async downloads.
WIP: Still missing tests for this PR. I'm working on that, but I sent that to speed up review.","Fix http error code handling for async downloads.
WIP: Still missing tests for this PR. I'm working on that, but I sent that to speed up review.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,764,2018-12-19T16:55:13Z,2018-12-19T17:32:53Z,2018-12-19T17:32:54Z,CLOSED,False,78,102,5,https://github.com/otaviobp,CURL: Fix http error code handling,2,[],https://github.com/clearlinux/swupd-client/pull/764,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/764#issuecomment-448679893,"Fix http error code handling for async downloads.
WIP: Still missing tests for this PR. I'm working on that, but I sent that to speed up review.","I'm closing this pull request. I realized there's a bug on download resume, so it's better to have ppl reviewing this later, when the problem is fixed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,767,2018-12-21T16:42:36Z,2019-01-16T16:42:05Z,2019-03-14T17:08:46Z,MERGED,True,256,219,17,https://github.com/otaviobp,Http bug fixes,6,[],https://github.com/clearlinux/swupd-client/pull/767,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/767,"fixes some problems in http downloads:

There were some http codes that aren't processed the way they should
Fix problem in download resume
Inform users when a download is resuming (request on #598)
Reduce the number of downloads in parallel when there are connection errors (like timeout) in downloads. Retry using 27, 9, 3, 1, 1, 1 downloads in parallel (requested on #598)

Fixes #598 #562","fixes some problems in http downloads:

There were some http codes that aren't processed the way they should
Fix problem in download resume
Inform users when a download is resuming (request on #598)
Reduce the number of downloads in parallel when there are connection errors (like timeout) in downloads. Retry using 27, 9, 3, 1, 1, 1 downloads in parallel (requested on #598)

Fixes #598 #562",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,769,2018-12-27T18:06:39Z,2019-01-10T21:56:09Z,2019-03-14T17:08:51Z,MERGED,True,1,1,1,https://github.com/otaviobp,Makeifile: Check all files under src/ for code style,1,[],https://github.com/clearlinux/swupd-client/pull/769,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/769,"Glob ** will only recurse directories if globstar is set. To avoid skipping
important files run clang-format on src/ and src/lib
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Glob ** will only recurse directories if globstar is set. To avoid skipping
important files run clang-format on src/ and src/lib
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,769,2018-12-27T18:06:39Z,2019-01-10T21:56:09Z,2019-03-14T17:08:51Z,MERGED,True,1,1,1,https://github.com/otaviobp,Makeifile: Check all files under src/ for code style,1,[],https://github.com/clearlinux/swupd-client/pull/769,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/769#issuecomment-450216151,"Glob ** will only recurse directories if globstar is set. To avoid skipping
important files run clang-format on src/ and src/lib
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Nit: s/Makeifile/Makefile,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,770,2019-01-04T22:51:05Z,2019-01-04T23:41:42Z,2019-03-14T17:08:48Z,MERGED,True,11,15,4,https://github.com/otaviobp,curl: swupd_curl_query_content_size is leaking file content,1,[],https://github.com/clearlinux/swupd-client/pull/770,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/770,"When CURLOPT_NOBODY is set to true, curl shouldn't get the body of a file,
we should get only headers. This works fine for all tested scenarios using
http and https. It's also working in most scenarios that uses file://, but
it fails on travis environment. So, add a dummy function to ignore body data
if present.
There was a hack in search tests to ignore leaked file content. Removing that
hack.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When CURLOPT_NOBODY is set to true, curl shouldn't get the body of a file,
we should get only headers. This works fine for all tested scenarios using
http and https. It's also working in most scenarios that uses file://, but
it fails on travis environment. So, add a dummy function to ignore body data
if present.
There was a hack in search tests to ignore leaked file content. Removing that
hack.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,770,2019-01-04T22:51:05Z,2019-01-04T23:41:42Z,2019-03-14T17:08:48Z,MERGED,True,11,15,4,https://github.com/otaviobp,curl: swupd_curl_query_content_size is leaking file content,1,[],https://github.com/clearlinux/swupd-client/pull/770,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/770#issuecomment-451594871,"When CURLOPT_NOBODY is set to true, curl shouldn't get the body of a file,
we should get only headers. This works fine for all tested scenarios using
http and https. It's also working in most scenarios that uses file://, but
it fails on travis environment. So, add a dummy function to ignore body data
if present.
There was a hack in search tests to ignore leaked file content. Removing that
hack.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",fixed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,773,2019-01-08T23:44:59Z,2019-01-10T22:02:57Z,2019-01-10T22:02:57Z,CLOSED,False,28,9,1,https://github.com/castulo,Testlib: Fixing symlinks of test bundles,1,[],https://github.com/clearlinux/swupd-client/pull/773,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/773,"When creating a test bundle that contains a symlink like this:
create_bundle -L -n my_bundle -f /my_file -l /my_link my_test_environment
A test bundle called my_bundle is created in my_test_environment,
this bundle has one link called my_link and this link points to a
file that is also added to the bundle's manifest. The problem is
that during the creation of the bundle the symbolic link is created
to point to an existing file but later in the process the file is
renamed, causing the symlink to become dangling. This dangling link
is then added to the bundle's manifest.  If we run ""swupd verify
--fix"" the installed bundle will always show a hash mismatch and the
good symlink will be replaced with the dangling symlink.
This commit changes the way symlinks are being created when creating a
bundle so they point to the correct file.
Closes #772
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When creating a test bundle that contains a symlink like this:
create_bundle -L -n my_bundle -f /my_file -l /my_link my_test_environment
A test bundle called my_bundle is created in my_test_environment,
this bundle has one link called my_link and this link points to a
file that is also added to the bundle's manifest. The problem is
that during the creation of the bundle the symbolic link is created
to point to an existing file but later in the process the file is
renamed, causing the symlink to become dangling. This dangling link
is then added to the bundle's manifest.  If we run ""swupd verify
--fix"" the installed bundle will always show a hash mismatch and the
good symlink will be replaced with the dangling symlink.
This commit changes the way symlinks are being created when creating a
bundle so they point to the correct file.
Closes #772
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,773,2019-01-08T23:44:59Z,2019-01-10T22:02:57Z,2019-01-10T22:02:57Z,CLOSED,False,28,9,1,https://github.com/castulo,Testlib: Fixing symlinks of test bundles,1,[],https://github.com/clearlinux/swupd-client/pull/773,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/773#issuecomment-453271462,"When creating a test bundle that contains a symlink like this:
create_bundle -L -n my_bundle -f /my_file -l /my_link my_test_environment
A test bundle called my_bundle is created in my_test_environment,
this bundle has one link called my_link and this link points to a
file that is also added to the bundle's manifest. The problem is
that during the creation of the bundle the symbolic link is created
to point to an existing file but later in the process the file is
renamed, causing the symlink to become dangling. This dangling link
is then added to the bundle's manifest.  If we run ""swupd verify
--fix"" the installed bundle will always show a hash mismatch and the
good symlink will be replaced with the dangling symlink.
This commit changes the way symlinks are being created when creating a
bundle so they point to the correct file.
Closes #772
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",merged by other PR,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,774,2019-01-09T23:24:19Z,2019-01-10T22:00:52Z,2019-01-10T22:00:52Z,MERGED,True,142,37,5,https://github.com/castulo,Verify --fix skip files that are unsafe to delete without warning the user,3,[],https://github.com/clearlinux/swupd-client/pull/774,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/774,"When running verify --fix, if there are files in the system that are
marked as deleted in the manifest, then they are removed from the
system. However, if a component of the path of the file is a
symbolic link, the file is determined to be unsafe to be removed and
it is left in the system, the user is warned, and the not-deleted
file count is incremented.
This commit modifies this behavior so verify just skips the file, the
user is not warned with the ""Not safe to delete: "" error message,
and so the not-deleted file count is not incremented since it is really
not useful for the end user.
Closes #765","When running verify --fix, if there are files in the system that are
marked as deleted in the manifest, then they are removed from the
system. However, if a component of the path of the file is a
symbolic link, the file is determined to be unsafe to be removed and
it is left in the system, the user is warned, and the not-deleted
file count is incremented.
This commit modifies this behavior so verify just skips the file, the
user is not warned with the ""Not safe to delete: "" error message,
and so the not-deleted file count is not incremented since it is really
not useful for the end user.
Closes #765",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,774,2019-01-09T23:24:19Z,2019-01-10T22:00:52Z,2019-01-10T22:00:52Z,MERGED,True,142,37,5,https://github.com/castulo,Verify --fix skip files that are unsafe to delete without warning the user,3,[],https://github.com/clearlinux/swupd-client/pull/774,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/774#issuecomment-453231455,"When running verify --fix, if there are files in the system that are
marked as deleted in the manifest, then they are removed from the
system. However, if a component of the path of the file is a
symbolic link, the file is determined to be unsafe to be removed and
it is left in the system, the user is warned, and the not-deleted
file count is incremented.
This commit modifies this behavior so verify just skips the file, the
user is not warned with the ""Not safe to delete: "" error message,
and so the not-deleted file count is not incremented since it is really
not useful for the end user.
Closes #765",this PR was built on top of PR #773 so that one needs to merge first.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,775,2019-01-10T22:09:44Z,2019-01-17T03:22:55Z,2019-01-25T21:13:40Z,CLOSED,False,172,3,5,https://github.com/bryteise,verify: Enable verifying a single bundle,1,[],https://github.com/clearlinux/swupd-client/pull/775,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/775,"Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.","Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,775,2019-01-10T22:09:44Z,2019-01-17T03:22:55Z,2019-01-25T21:13:40Z,CLOSED,False,172,3,5,https://github.com/bryteise,verify: Enable verifying a single bundle,1,[],https://github.com/clearlinux/swupd-client/pull/775,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/775#issuecomment-454575300,"Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.","@otaviobp I'd want to put that in now before it is merged as making a change to command line flags is not very friendly and having a bundle and bundles flag is pretty unpleasant too. That said the implementation could get unpleasant unless we force --bundles a,b,c rather than --bundles a b c. Any thoughts about this?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,775,2019-01-10T22:09:44Z,2019-01-17T03:22:55Z,2019-01-25T21:13:40Z,CLOSED,False,172,3,5,https://github.com/bryteise,verify: Enable verifying a single bundle,1,[],https://github.com/clearlinux/swupd-client/pull/775,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/775#issuecomment-454593062,"Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.","That said the implementation could get unpleasant unless we force --bundles a,b,c rather than --bundles a b c. Any thoughts about this?

I prefer
 --bundles a b c

Because we it looks like
swupd bundle-add a b c",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,775,2019-01-10T22:09:44Z,2019-01-17T03:22:55Z,2019-01-25T21:13:40Z,CLOSED,False,172,3,5,https://github.com/bryteise,verify: Enable verifying a single bundle,1,[],https://github.com/clearlinux/swupd-client/pull/775,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/775#issuecomment-454595710,"Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.","I'd want to put that in now before it is merged as making a change to command line flags is not very friendly and having a bundle and bundles flag is pretty unpleasant too.

By later I mean 'later, but before a swupd release'. We also need to add that to the manpage document.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,775,2019-01-10T22:09:44Z,2019-01-17T03:22:55Z,2019-01-25T21:13:40Z,CLOSED,False,172,3,5,https://github.com/bryteise,verify: Enable verifying a single bundle,1,[],https://github.com/clearlinux/swupd-client/pull/775,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/775#issuecomment-454901535,"Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.","Updated based on feedback, though had to stick with the --bundles flag taking a comma separated list of bundles. Man page for verify updated and a new test for multiple bundles added.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,775,2019-01-10T22:09:44Z,2019-01-17T03:22:55Z,2019-01-25T21:13:40Z,CLOSED,False,172,3,5,https://github.com/bryteise,verify: Enable verifying a single bundle,1,[],https://github.com/clearlinux/swupd-client/pull/775,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/775#issuecomment-455028438,"Allow users to verify just a single bundle rather than the entire
system. This also enables an alternative ""installation"" with a verify
--fix --bundle $foo where foo doesn't include os-core which is useful
for installing 3rd party content that lives outside of /usr.",Merged with a fix in the docs. There was an whitespace removed before the Example keyword that was creating a weird alignment in final doc.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,776,2019-01-11T16:33:15Z,2019-01-11T17:24:19Z,2019-01-11T17:24:19Z,MERGED,True,2,2,2,https://github.com/castulo,Fixing code style issues,1,[],https://github.com/clearlinux/swupd-client/pull/776,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/776,"This commit fixes a couple of style issues found in the code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit fixes a couple of style issues found in the code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,777,2019-01-11T18:52:53Z,2019-01-11T20:40:33Z,2019-01-11T20:40:33Z,MERGED,True,5,5,1,https://github.com/castulo,Fixing IDs of update tests,1,[],https://github.com/clearlinux/swupd-client/pull/777,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/777,"Two PRs that included tests for swupd update were submitted and merged
at the same time, which caused the test IDs to be inconsistent.
This commit fixes the IDs of the update tests with duplicated ID.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Two PRs that included tests for swupd update were submitted and merged
at the same time, which caused the test IDs to be inconsistent.
This commit fixes the IDs of the update tests with duplicated ID.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,778,2019-01-11T19:52:01Z,2019-01-11T20:38:13Z,2019-01-11T20:38:14Z,MERGED,True,1,1,1,https://github.com/castulo,Fixing a race condition in testlib,1,[],https://github.com/clearlinux/swupd-client/pull/778,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/778,"When in a test we create a new version and a bundle update in that new
version, we copy the latest tar for each fullfile from the previous
versions into the new version. The code currently was searching for
those tars starting with the current directory, this was working fine
when running the tests locally because tests are run serially, but this
was causing an unexpected result when running in Travis since tests are
run in parallel, so this was causing the search to sometimes find the
tar in a different test environment (from another test), which was
causing unexpected results and a race condition.
This commit fixes the issue by narrowing the search of the tars to the
web-dir of the specific test environment.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When in a test we create a new version and a bundle update in that new
version, we copy the latest tar for each fullfile from the previous
versions into the new version. The code currently was searching for
those tars starting with the current directory, this was working fine
when running the tests locally because tests are run serially, but this
was causing an unexpected result when running in Travis since tests are
run in parallel, so this was causing the search to sometimes find the
tar in a different test environment (from another test), which was
causing unexpected results and a race condition.
This commit fixes the issue by narrowing the search of the tars to the
web-dir of the specific test environment.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,779,2019-01-11T23:36:32Z,2019-01-16T16:49:44Z,2019-01-16T16:49:44Z,MERGED,True,104,94,2,https://github.com/castulo,Making testlib shellcheck compliant,1,[],https://github.com/clearlinux/swupd-client/pull/779,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/779,"Shellcheck provides many useful recommendations for writing shell code.
This commit makes testlib.bash shellcheck compliant.
Signed-off-by: Castulo J. Martinez castulo.martinez@intel.com
Closes #662","Shellcheck provides many useful recommendations for writing shell code.
This commit makes testlib.bash shellcheck compliant.
Signed-off-by: Castulo J. Martinez castulo.martinez@intel.com
Closes #662",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,779,2019-01-11T23:36:32Z,2019-01-16T16:49:44Z,2019-01-16T16:49:44Z,MERGED,True,104,94,2,https://github.com/castulo,Making testlib shellcheck compliant,1,[],https://github.com/clearlinux/swupd-client/pull/779,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/779#issuecomment-454583768,"Shellcheck provides many useful recommendations for writing shell code.
This commit makes testlib.bash shellcheck compliant.
Signed-off-by: Castulo J. Martinez castulo.martinez@intel.com
Closes #662","lgtm. I prefer to merge this even if it's not fixing all the problems. Than you can have another PR fixing the remaining problems.

I'm almost done fixing all the issues",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,779,2019-01-11T23:36:32Z,2019-01-16T16:49:44Z,2019-01-16T16:49:44Z,MERGED,True,104,94,2,https://github.com/castulo,Making testlib shellcheck compliant,1,[],https://github.com/clearlinux/swupd-client/pull/779,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/779#issuecomment-454607437,"Shellcheck provides many useful recommendations for writing shell code.
This commit makes testlib.bash shellcheck compliant.
Signed-off-by: Castulo J. Martinez castulo.martinez@intel.com
Closes #662",All issues have been fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,782,2019-01-16T20:44:25Z,2019-01-17T03:23:32Z,2019-03-14T17:08:45Z,MERGED,True,3,3,3,https://github.com/otaviobp,verify: Add /usr/src to the list of protected directories on verify p,1,[],https://github.com/clearlinux/swupd-client/pull/782,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/782,"icky
Fixes #780
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","icky
Fixes #780
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,783,2019-01-16T21:10:44Z,2019-01-17T03:23:16Z,2019-03-14T17:08:37Z,MERGED,True,5,37,5,https://github.com/otaviobp,Removing check for optarg for parameters with required arguments,1,[],https://github.com/clearlinux/swupd-client/pull/783,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/783,"According to getopt_long documentation optarg is always set when argument is
required. It can be empty when argument is optional, but we don't have that
case in swupd.
So we can remove the extra check for empty optarg on opt parse functions.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","According to getopt_long documentation optarg is always set when argument is
required. It can be empty when argument is optional, but we don't have that
case in swupd.
So we can remove the extra check for empty optarg on opt parse functions.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,783,2019-01-16T21:10:44Z,2019-01-17T03:23:16Z,2019-03-14T17:08:37Z,MERGED,True,5,37,5,https://github.com/otaviobp,Removing check for optarg for parameters with required arguments,1,[],https://github.com/clearlinux/swupd-client/pull/783,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/783#issuecomment-454944625,"According to getopt_long documentation optarg is always set when argument is
required. It can be empty when argument is optional, but we don't have that
case in swupd.
So we can remove the extra check for empty optarg on opt parse functions.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Good cleanup, LGTM!",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,785,2019-01-16T23:34:41Z,2019-01-17T00:15:25Z,2019-03-14T17:08:37Z,MERGED,True,4,2,1,https://github.com/otaviobp,sys: Fix memory leak,1,[],https://github.com/clearlinux/swupd-client/pull/785,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/785,"The code was assuming that dup2 was replacing the fd, but this is not the case.
It is duplicating it, so new_fd was leaking.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","The code was assuming that dup2 was replacing the fd, but this is not the case.
It is duplicating it, so new_fd was leaking.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,786,2019-01-17T17:10:10Z,2019-01-17T18:37:59Z,2019-03-14T17:08:38Z,MERGED,True,31,25,18,https://github.com/otaviobp,some styles fixes,3,[],https://github.com/clearlinux/swupd-client/pull/786,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/786,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,787,2019-01-17T20:33:12Z,2019-01-24T21:29:33Z,2019-01-24T21:29:33Z,MERGED,True,250,199,20,https://github.com/otaviobp,Curl - Cosmetic changes,4,[],https://github.com/clearlinux/swupd-client/pull/787,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/787,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,787,2019-01-17T20:33:12Z,2019-01-24T21:29:33Z,2019-01-24T21:29:33Z,MERGED,True,250,199,20,https://github.com/otaviobp,Curl - Cosmetic changes,4,[],https://github.com/clearlinux/swupd-client/pull/787,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/787#issuecomment-456519701,,I updated all error messages according to what we have discussed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,790,2019-01-18T01:07:57Z,2019-01-24T23:23:16Z,2019-01-24T23:23:16Z,MERGED,True,592,422,68,https://github.com/castulo,Making swupd consistent in return codes,18,[],https://github.com/clearlinux/swupd-client/pull/790,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/790,"This PR includes the following things:

 Rename the file from swupd-error.h to swupd_exit_codes.h so we can include successful codes if needed.
 Rename existing error codes following these rules:

All codes should start with SWUPD_ so we never get confused what code comes from swupd
Always separate codes that contain multiple words using an underscore SWUPD_MULTI_WORD_ERROR instead of using SWUPDMULTIWORDERROR
Code 0 is reserved for SWUPD_SUCCESS (or SWUPD_OK)
Code 1 is reserved to be used by commands that return a boolean state (e.g. swupd autoupdate)


 When a function returns a boolean state, explicitly return true or false instead of returning 0 or 1
 Some functions currently mask error codes in a catch all error code, for example bundle-add which only uses EBUNDLE_INSTALL or bundle-remove which only uses EBUNDLE_REMOVE. Remove the catch all return codes from these functions so we can have a more meaningful error.
 Regardless of what codes are used internally, swupd should always exit with a code defined in swupd-codes.h

 autoupdate
 bundle-add
 bundle-remove
 bundle-list
 hashdump
 update
 verify
 check-update
 search
 info
 clean
 mirror


 Update the documentation about swupd codes on swupd.1 and swupd.1.rst
 Add the guidelines mentioned in this ToDo list and these ones below to the developer's guide so contributors follow these project standards in the future (no need to rework these ones at the moment with the existing code base since it would be a lot of work).

Internally, swupd can use errors that comply with these rules:
it can use errors defined in any included file as long as these dont get propagated to the end user. For example errors from:

/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/errno.h
/usr/include/curl/curl.h


The errors used internally should preferably be negative values. For example prefer using -ENOENT instead of ENOENT.



Closes #610","This PR includes the following things:

 Rename the file from swupd-error.h to swupd_exit_codes.h so we can include successful codes if needed.
 Rename existing error codes following these rules:

All codes should start with SWUPD_ so we never get confused what code comes from swupd
Always separate codes that contain multiple words using an underscore SWUPD_MULTI_WORD_ERROR instead of using SWUPDMULTIWORDERROR
Code 0 is reserved for SWUPD_SUCCESS (or SWUPD_OK)
Code 1 is reserved to be used by commands that return a boolean state (e.g. swupd autoupdate)


 When a function returns a boolean state, explicitly return true or false instead of returning 0 or 1
 Some functions currently mask error codes in a catch all error code, for example bundle-add which only uses EBUNDLE_INSTALL or bundle-remove which only uses EBUNDLE_REMOVE. Remove the catch all return codes from these functions so we can have a more meaningful error.
 Regardless of what codes are used internally, swupd should always exit with a code defined in swupd-codes.h

 autoupdate
 bundle-add
 bundle-remove
 bundle-list
 hashdump
 update
 verify
 check-update
 search
 info
 clean
 mirror


 Update the documentation about swupd codes on swupd.1 and swupd.1.rst
 Add the guidelines mentioned in this ToDo list and these ones below to the developer's guide so contributors follow these project standards in the future (no need to rework these ones at the moment with the existing code base since it would be a lot of work).

Internally, swupd can use errors that comply with these rules:
it can use errors defined in any included file as long as these dont get propagated to the end user. For example errors from:

/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/errno.h
/usr/include/curl/curl.h


The errors used internally should preferably be negative values. For example prefer using -ENOENT instead of ENOENT.



Closes #610",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,790,2019-01-18T01:07:57Z,2019-01-24T23:23:16Z,2019-01-24T23:23:16Z,MERGED,True,592,422,68,https://github.com/castulo,Making swupd consistent in return codes,18,[],https://github.com/clearlinux/swupd-client/pull/790,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/790#issuecomment-457373595,"This PR includes the following things:

 Rename the file from swupd-error.h to swupd_exit_codes.h so we can include successful codes if needed.
 Rename existing error codes following these rules:

All codes should start with SWUPD_ so we never get confused what code comes from swupd
Always separate codes that contain multiple words using an underscore SWUPD_MULTI_WORD_ERROR instead of using SWUPDMULTIWORDERROR
Code 0 is reserved for SWUPD_SUCCESS (or SWUPD_OK)
Code 1 is reserved to be used by commands that return a boolean state (e.g. swupd autoupdate)


 When a function returns a boolean state, explicitly return true or false instead of returning 0 or 1
 Some functions currently mask error codes in a catch all error code, for example bundle-add which only uses EBUNDLE_INSTALL or bundle-remove which only uses EBUNDLE_REMOVE. Remove the catch all return codes from these functions so we can have a more meaningful error.
 Regardless of what codes are used internally, swupd should always exit with a code defined in swupd-codes.h

 autoupdate
 bundle-add
 bundle-remove
 bundle-list
 hashdump
 update
 verify
 check-update
 search
 info
 clean
 mirror


 Update the documentation about swupd codes on swupd.1 and swupd.1.rst
 Add the guidelines mentioned in this ToDo list and these ones below to the developer's guide so contributors follow these project standards in the future (no need to rework these ones at the moment with the existing code base since it would be a lot of work).

Internally, swupd can use errors that comply with these rules:
it can use errors defined in any included file as long as these dont get propagated to the end user. For example errors from:

/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/errno.h
/usr/include/curl/curl.h


The errors used internally should preferably be negative values. For example prefer using -ENOENT instead of ENOENT.



Closes #610",It is finally finished. It can now be fully reviewed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,793,2019-01-23T23:29:23Z,2019-01-23T23:49:04Z,2019-01-23T23:49:04Z,MERGED,True,1,13,1,https://github.com/castulo,Removing useless code from get_all_files function,1,[],https://github.com/clearlinux/swupd-client/pull/793,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/793,"Removing useless code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Removing useless code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,794,2019-01-24T00:15:27Z,2019-01-24T00:41:29Z,2019-03-14T17:08:39Z,MERGED,True,6,5,3,https://github.com/otaviobp,curl: Consider the download failed even if user handles the error,1,[],https://github.com/clearlinux/swupd-client/pull/794,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/794,"If the user handles the error we won't reschedule the download, but we
should at least to consider that download a failure and return a negative
code on swupd_curl_parallel_download_end().
Tests that are suppose to get that were incorrect. Fixing that too
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If the user handles the error we won't reschedule the download, but we
should at least to consider that download a failure and return a negative
code on swupd_curl_parallel_download_end().
Tests that are suppose to get that were incorrect. Fixing that too
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,796,2019-01-25T21:14:30Z,2019-01-25T21:57:50Z,2019-01-25T21:57:56Z,CLOSED,False,1,1,1,https://github.com/bryteise,globals: Use path_prefix for cert_path,1,[],https://github.com/clearlinux/swupd-client/pull/796,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/796,"The certificate path should be looked up based on the path_prefix as
the configuration of the content under the path_prefix may be
different than the base system's.","The certificate path should be looked up based on the path_prefix as
the configuration of the content under the path_prefix may be
different than the base system's.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,796,2019-01-25T21:14:30Z,2019-01-25T21:57:50Z,2019-01-25T21:57:56Z,CLOSED,False,1,1,1,https://github.com/bryteise,globals: Use path_prefix for cert_path,1,[],https://github.com/clearlinux/swupd-client/pull/796,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/796#issuecomment-457744679,"The certificate path should be looked up based on the path_prefix as
the configuration of the content under the path_prefix may be
different than the base system's.",Closing as this solution carries problems and needs a rethink. Will use work arounds of always passing the certificate file for now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,797,2019-01-28T21:31:02Z,2019-01-29T01:27:26Z,2019-01-29T01:27:26Z,MERGED,True,15,1161,12,https://github.com/otaviobp,docs: Remove generated manpages from repository,1,[],https://github.com/clearlinux/swupd-client/pull/797,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/797,"Those files are generate that in build time, so there's no reason to keep
them here.
We went out of sync before and it's easier to make sure the last man page is
used if we generate that on build time.
Also removes man page tests because they don't make sense anymore. And add
option --disable-manpage, so we can build swupd without manpages if rst2man.py
isn't available.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Those files are generate that in build time, so there's no reason to keep
them here.
We went out of sync before and it's easier to make sure the last man page is
used if we generate that on build time.
Also removes man page tests because they don't make sense anymore. And add
option --disable-manpage, so we can build swupd without manpages if rst2man.py
isn't available.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{'THUMBS_UP': ['https://github.com/aaronovz1']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,798,2019-01-28T22:51:19Z,2019-01-31T18:55:18Z,2019-03-14T17:08:41Z,MERGED,True,361,71,8,https://github.com/otaviobp,Unit tests,2,[],https://github.com/clearlinux/swupd-client/pull/798,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/798,Introducing Unit tests in swupd.,Introducing Unit tests in swupd.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,798,2019-01-28T22:51:19Z,2019-01-31T18:55:18Z,2019-03-14T17:08:41Z,MERGED,True,361,71,8,https://github.com/otaviobp,Unit tests,2,[],https://github.com/clearlinux/swupd-client/pull/798,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/798#issuecomment-459443375,Introducing Unit tests in swupd.,fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,799,2019-01-29T00:08:07Z,2019-02-08T22:05:14Z,2019-03-14T17:08:39Z,CLOSED,False,286,74,10,https://github.com/otaviobp,WIP: New progress bar,4,[],https://github.com/clearlinux/swupd-client/pull/799,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/799,"One thing that people complain a lot about swupd is the progress indicator and the fact that we print millions of dots when outputting to a file. Introducing in this commit a suggestion of a new progress bar. It's not printing the total download size, speed or any other download information, but that's something easier to extend now.
So far the only thing that was replaced to use the new progress bar was the pack downloads, because I am waiting on feedback before porting all print_progress we have in swupd.
Example of output on swupd update:
Update started.
Preparing to update from 27460 to 27490
Packs to download:
        vim
        unbundle
        sysadmin-basic
        storage-utils-dev
        storage-utils
        qt-basic
        python3-basic
        python2-basic
        os-core-update-index
        os-core-update
        os-core
        network-basic
        mkosi
        mixer
        machine-learning-basic
        linux-tools
        libxml2
        kernel-native
        icdiff
        gpgme
        git
        firefox
        docutils
        diffoscope
        devpkg-qtbase
        devpkg-glib
        dev-utils-dev
        desktop-kde-libs
        desktop-assets
        desktop-apps
        desktop
        computer-vision-basic
        cloud-api
        c-basic
        kde-frameworks5

(24/47) Downloading and extracting packs       [=============             ] 51%

If we are redirecting stderr to a file one progress bar will be printed each time we complete 10% of the progress, so only 11 lines will be printed. The output is human readable and easy to parse. (we can add an option to print on every step if that output is going to be used by the installer to give users feedback)
(0/47) Downloading and extracting packs        [                          ]  0%
(5/47) Downloading and extracting packs        [==                        ] 10%
(10/47) Downloading and extracting packs       [=====                     ] 21%
(15/47) Downloading and extracting packs       [========                  ] 31%
(19/47) Downloading and extracting packs       [==========                ] 40%
(24/47) Downloading and extracting packs       [=============             ] 51%
(29/47) Downloading and extracting packs       [===============           ] 61%
(33/47) Downloading and extracting packs       [==================        ] 70%
(47/47) Downloading and extracting packs       [==========================] 100%","One thing that people complain a lot about swupd is the progress indicator and the fact that we print millions of dots when outputting to a file. Introducing in this commit a suggestion of a new progress bar. It's not printing the total download size, speed or any other download information, but that's something easier to extend now.
So far the only thing that was replaced to use the new progress bar was the pack downloads, because I am waiting on feedback before porting all print_progress we have in swupd.
Example of output on swupd update:
Update started.
Preparing to update from 27460 to 27490
Packs to download:
        vim
        unbundle
        sysadmin-basic
        storage-utils-dev
        storage-utils
        qt-basic
        python3-basic
        python2-basic
        os-core-update-index
        os-core-update
        os-core
        network-basic
        mkosi
        mixer
        machine-learning-basic
        linux-tools
        libxml2
        kernel-native
        icdiff
        gpgme
        git
        firefox
        docutils
        diffoscope
        devpkg-qtbase
        devpkg-glib
        dev-utils-dev
        desktop-kde-libs
        desktop-assets
        desktop-apps
        desktop
        computer-vision-basic
        cloud-api
        c-basic
        kde-frameworks5

(24/47) Downloading and extracting packs       [=============             ] 51%

If we are redirecting stderr to a file one progress bar will be printed each time we complete 10% of the progress, so only 11 lines will be printed. The output is human readable and easy to parse. (we can add an option to print on every step if that output is going to be used by the installer to give users feedback)
(0/47) Downloading and extracting packs        [                          ]  0%
(5/47) Downloading and extracting packs        [==                        ] 10%
(10/47) Downloading and extracting packs       [=====                     ] 21%
(15/47) Downloading and extracting packs       [========                  ] 31%
(19/47) Downloading and extracting packs       [==========                ] 40%
(24/47) Downloading and extracting packs       [=============             ] 51%
(29/47) Downloading and extracting packs       [===============           ] 61%
(33/47) Downloading and extracting packs       [==================        ] 70%
(47/47) Downloading and extracting packs       [==========================] 100%",True,{'THUMBS_UP': ['https://github.com/aaronovz1']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,799,2019-01-29T00:08:07Z,2019-02-08T22:05:14Z,2019-03-14T17:08:39Z,CLOSED,False,286,74,10,https://github.com/otaviobp,WIP: New progress bar,4,[],https://github.com/clearlinux/swupd-client/pull/799,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/799#issuecomment-461988671,"One thing that people complain a lot about swupd is the progress indicator and the fact that we print millions of dots when outputting to a file. Introducing in this commit a suggestion of a new progress bar. It's not printing the total download size, speed or any other download information, but that's something easier to extend now.
So far the only thing that was replaced to use the new progress bar was the pack downloads, because I am waiting on feedback before porting all print_progress we have in swupd.
Example of output on swupd update:
Update started.
Preparing to update from 27460 to 27490
Packs to download:
        vim
        unbundle
        sysadmin-basic
        storage-utils-dev
        storage-utils
        qt-basic
        python3-basic
        python2-basic
        os-core-update-index
        os-core-update
        os-core
        network-basic
        mkosi
        mixer
        machine-learning-basic
        linux-tools
        libxml2
        kernel-native
        icdiff
        gpgme
        git
        firefox
        docutils
        diffoscope
        devpkg-qtbase
        devpkg-glib
        dev-utils-dev
        desktop-kde-libs
        desktop-assets
        desktop-apps
        desktop
        computer-vision-basic
        cloud-api
        c-basic
        kde-frameworks5

(24/47) Downloading and extracting packs       [=============             ] 51%

If we are redirecting stderr to a file one progress bar will be printed each time we complete 10% of the progress, so only 11 lines will be printed. The output is human readable and easy to parse. (we can add an option to print on every step if that output is going to be used by the installer to give users feedback)
(0/47) Downloading and extracting packs        [                          ]  0%
(5/47) Downloading and extracting packs        [==                        ] 10%
(10/47) Downloading and extracting packs       [=====                     ] 21%
(15/47) Downloading and extracting packs       [========                  ] 31%
(19/47) Downloading and extracting packs       [==========                ] 40%
(24/47) Downloading and extracting packs       [=============             ] 51%
(29/47) Downloading and extracting packs       [===============           ] 61%
(33/47) Downloading and extracting packs       [==================        ] 70%
(47/47) Downloading and extracting packs       [==========================] 100%",@otaviobp why was this PR closed?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,800,2019-01-30T20:04:11Z,2019-02-01T20:30:47Z,2019-02-01T20:30:47Z,MERGED,True,258,129,16,https://github.com/castulo,Configurable download retries,6,[],https://github.com/clearlinux/swupd-client/pull/800,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/800,"This PR tackles two main issues in download retries:


Sync download retries were handled all over the place in the base code. This PR removes the retries from all those places and adds a single place for retrying a download, making the code more consistent and a lot easier to follow and maintain.


Download retries where hardcoded to 3 in the case of sync downloads and to 5 in the case of async downloads. This PR add options to allow users to configure how many download retries they want swupd to do, and how long to wait between retries. This will be helpful for users in networks with unreliable connections, and will also help developers testing the code that were facing long wait times when simulating network problems.


Closes #211
Closes #322","This PR tackles two main issues in download retries:


Sync download retries were handled all over the place in the base code. This PR removes the retries from all those places and adds a single place for retrying a download, making the code more consistent and a lot easier to follow and maintain.


Download retries where hardcoded to 3 in the case of sync downloads and to 5 in the case of async downloads. This PR add options to allow users to configure how many download retries they want swupd to do, and how long to wait between retries. This will be helpful for users in networks with unreliable connections, and will also help developers testing the code that were facing long wait times when simulating network problems.


Closes #211
Closes #322",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,800,2019-01-30T20:04:11Z,2019-02-01T20:30:47Z,2019-02-01T20:30:47Z,MERGED,True,258,129,16,https://github.com/castulo,Configurable download retries,6,[],https://github.com/clearlinux/swupd-client/pull/800,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/800#issuecomment-459824889,"This PR tackles two main issues in download retries:


Sync download retries were handled all over the place in the base code. This PR removes the retries from all those places and adds a single place for retrying a download, making the code more consistent and a lot easier to follow and maintain.


Download retries where hardcoded to 3 in the case of sync downloads and to 5 in the case of async downloads. This PR add options to allow users to configure how many download retries they want swupd to do, and how long to wait between retries. This will be helpful for users in networks with unreliable connections, and will also help developers testing the code that were facing long wait times when simulating network problems.


Closes #211
Closes #322",@otaviobp all your comments have been addressed. ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,802,2019-01-31T01:40:41Z,2019-01-31T18:03:42Z,2019-01-31T18:03:42Z,MERGED,True,45,4,7,https://github.com/castulo,Checking if the boot script exist before running,1,[],https://github.com/clearlinux/swupd-client/pull/802,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/802,"When swupd needs to run a boot script it does so without checking if the
file exists in the system or not. This will cause an error to be raised
by the shell if the script does not exist.
This commit adds a check for the existance of the script before
attempting to run it.
Closes #795
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When swupd needs to run a boot script it does so without checking if the
file exists in the system or not. This will cause an error to be raised
by the shell if the script does not exist.
This commit adds a check for the existance of the script before
attempting to run it.
Closes #795
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,803,2019-02-01T18:40:08Z,2019-02-05T21:03:26Z,2019-02-05T21:03:26Z,MERGED,True,35,11,3,https://github.com/castulo,Return non-0 code if search does not find entries,1,[],https://github.com/clearlinux/swupd-client/pull/803,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/803,"swupd search returns 0 both when something is found and when nothing
is found.
This commit makes a change so it returns 0 (SWUPD_OK) if search found
somthing and 1 (SWUPD_NO) if it didn't.
Closes #731
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","swupd search returns 0 both when something is found and when nothing
is found.
This commit makes a change so it returns 0 (SWUPD_OK) if search found
somthing and 1 (SWUPD_NO) if it didn't.
Closes #731
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,808,2019-02-08T20:09:24Z,2019-02-11T20:32:41Z,2019-02-11T20:32:41Z,MERGED,True,43,19,9,https://github.com/ahkok,Telemetry: include `bytes transferred` wherever applicable.,3,[],https://github.com/clearlinux/swupd-client/pull/808,https://github.com/ahkok,1,https://github.com/clearlinux/swupd-client/pull/808,"Display the bytes transferred after each update in the message
that shows ""took N seconds"" by appending the info.
This includes total transfer bytes for verify, update, check,
bundle-add and bundle-remove.
The curl error handling function is the perfect location to
capture the bytes for each transfer, and add them to a global
counter. The global counter is then included in each telemetry
event.","Display the bytes transferred after each update in the message
that shows ""took N seconds"" by appending the info.
This includes total transfer bytes for verify, update, check,
bundle-add and bundle-remove.
The curl error handling function is the perfect location to
capture the bytes for each transfer, and add them to a global
counter. The global counter is then included in each telemetry
event.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,808,2019-02-08T20:09:24Z,2019-02-11T20:32:41Z,2019-02-11T20:32:41Z,MERGED,True,43,19,9,https://github.com/ahkok,Telemetry: include `bytes transferred` wherever applicable.,3,[],https://github.com/clearlinux/swupd-client/pull/808,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/808#issuecomment-461965020,"Display the bytes transferred after each update in the message
that shows ""took N seconds"" by appending the info.
This includes total transfer bytes for verify, update, check,
bundle-add and bundle-remove.
The curl error handling function is the perfect location to
capture the bytes for each transfer, and add them to a global
counter. The global counter is then included in each telemetry
event.","I made a wrong assumption about the broken travis build. It's a build time problem. Maybe we can fix that by building a newer curl, but not sure.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,809,2019-02-08T23:55:07Z,2019-02-11T22:28:49Z,2019-02-11T22:28:49Z,MERGED,True,15,2,3,https://github.com/castulo,Providing option to disable compiler optimizations,1,[],https://github.com/clearlinux/swupd-client/pull/809,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/809,"This commit adds an option to disable compiler optimizations which is
very useful when debugging a problem in swupd.
Note: the user would still need to make sure the optimization option is
not enabled in his/her CFLAGS variable.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds an option to disable compiler optimizations which is
very useful when debugging a problem in swupd.
Note: the user would still need to make sure the optimization option is
not enabled in his/her CFLAGS variable.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,810,2019-02-09T00:30:51Z,2019-02-12T00:54:31Z,2019-02-12T00:54:31Z,CLOSED,False,115,34,8,https://github.com/otaviobp,WIP: Use manifest-deltas in swupd on update,1,[],https://github.com/clearlinux/swupd-client/pull/810,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/810,"Tested with a minimal mix generated using PR: clearlinux/mixer-tools#543
TODO:

Test update with a mix with more than 1 bundle
Test verify going forward
Create function tests for this feature

Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Tested with a minimal mix generated using PR: clearlinux/mixer-tools#543
TODO:

Test update with a mix with more than 1 bundle
Test verify going forward
Create function tests for this feature

Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,811,2019-02-11T18:31:44Z,2019-02-11T22:24:32Z,2019-03-14T17:08:40Z,MERGED,True,6,14,4,https://github.com/otaviobp,docs: Fix documentation on --force option,1,[],https://github.com/clearlinux/swupd-client/pull/811,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/811,"--force/-x is specific for verify command, but documentation was stating
that it was global. Removing all references from a global --force and
adding that information to the help page of verify command.
Also moves the force variable from global to verify.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","--force/-x is specific for verify command, but documentation was stating
that it was global. Removing all references from a global --force and
adding that information to the help page of verify command.
Also moves the force variable from global to verify.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,811,2019-02-11T18:31:44Z,2019-02-11T22:24:32Z,2019-03-14T17:08:40Z,MERGED,True,6,14,4,https://github.com/otaviobp,docs: Fix documentation on --force option,1,[],https://github.com/clearlinux/swupd-client/pull/811,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/811#issuecomment-462519450,"--force/-x is specific for verify command, but documentation was stating
that it was global. Removing all references from a global --force and
adding that information to the help page of verify command.
Also moves the force variable from global to verify.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","IIRC, the original intent of this option was to enable it for the other subcommands as appropriate. But because that plan never took shape, I'm fine with this change.

Yes, we can move it back if we use force for something else, but I don't see this happening in a close future.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,813,2019-02-11T20:35:13Z,2019-02-12T23:07:26Z,2019-02-12T23:07:26Z,MERGED,True,4,3,1,https://github.com/otaviobp,curl: Check for errors before using value from curl_easy_getinfo call,1,[],https://github.com/clearlinux/swupd-client/pull/813,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/813,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,814,2019-02-11T21:00:28Z,2019-02-12T22:38:59Z,2019-02-12T22:38:59Z,MERGED,True,94,28,4,https://github.com/otaviobp,update: Be consistent in exit codes when trying to update to the same version,2,[],https://github.com/clearlinux/swupd-client/pull/814,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/814,"Use similar output and same exit code used when you are already in the
last version in the case where you are updating to the same version you
already are.

i.e. if you are in version 100, both commands are going to have the same
exit code:

 - swupd update
 - swupd update -m 100","Use similar output and same exit code used when you are already in the
last version in the case where you are updating to the same version you
already are.

i.e. if you are in version 100, both commands are going to have the same
exit code:

 - swupd update
 - swupd update -m 100",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,814,2019-02-11T21:00:28Z,2019-02-12T22:38:59Z,2019-02-12T22:38:59Z,MERGED,True,94,28,4,https://github.com/otaviobp,update: Be consistent in exit codes when trying to update to the same version,2,[],https://github.com/clearlinux/swupd-client/pull/814,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/814#issuecomment-462966557,"Use similar output and same exit code used when you are already in the
last version in the case where you are updating to the same version you
already are.

i.e. if you are in version 100, both commands are going to have the same
exit code:

 - swupd update
 - swupd update -m 100",Fixes #821,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,815,2019-02-12T00:56:58Z,2019-02-12T23:11:02Z,2019-03-14T17:08:32Z,MERGED,True,201,4,5,https://github.com/otaviobp,update: Use manifest-deltas in swupd on update,2,[],https://github.com/clearlinux/swupd-client/pull/815,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/815,now with tests and fixes,now with tests and fixes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,815,2019-02-12T00:56:58Z,2019-02-12T23:11:02Z,2019-03-14T17:08:32Z,MERGED,True,201,4,5,https://github.com/otaviobp,update: Use manifest-deltas in swupd on update,2,[],https://github.com/clearlinux/swupd-client/pull/815,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/815#issuecomment-462939385,now with tests and fixes,Fixes #806,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,816,2019-02-12T01:41:26Z,2019-02-12T23:32:36Z,2019-03-14T17:08:33Z,MERGED,True,2,2,1,https://github.com/otaviobp,update: Print total bytes downloaded in MB,1,[],https://github.com/clearlinux/swupd-client/pull/816,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/816,"Fixes #271
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Fixes #271
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{'THUMBS_UP': ['https://github.com/aaronovz1']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,817,2019-02-12T19:03:24Z,2019-02-13T20:23:29Z,2019-07-16T20:26:14Z,MERGED,True,78,20,7,https://github.com/bryteise,Fix manually installed bundle tracking and add tests,2,[],https://github.com/clearlinux/swupd-client/pull/817,https://github.com/bryteise,1,https://github.com/clearlinux/swupd-client/pull/817,"Update bundle tracking to correctly initialize tracked bundle state
and add testing to validate tracking works as expected.","Update bundle tracking to correctly initialize tracked bundle state
and add testing to validate tracking works as expected.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,819,2019-02-12T20:44:16Z,2019-02-13T00:01:04Z,2019-03-14T17:08:31Z,MERGED,True,79,65,11,https://github.com/otaviobp,Curl ssl,3,[],https://github.com/clearlinux/swupd-client/pull/819,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/819,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,819,2019-02-12T20:44:16Z,2019-02-13T00:01:04Z,2019-03-14T17:08:31Z,MERGED,True,79,65,11,https://github.com/otaviobp,Curl ssl,3,[],https://github.com/clearlinux/swupd-client/pull/819,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/819#issuecomment-462980909,,Fixed issues and added another commit changing some other messages.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,820,2019-02-12T21:58:27Z,2019-02-13T00:02:07Z,2019-03-14T17:08:33Z,MERGED,True,5,5,2,https://github.com/otaviobp,Curl async - parallel downloads,2,[],https://github.com/clearlinux/swupd-client/pull/820,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/820,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,822,2019-02-12T22:34:13Z,2019-02-13T20:21:21Z,2019-02-13T20:21:21Z,MERGED,True,32,17,5,https://github.com/castulo,Adding path_prefix for versionstamp,1,[],https://github.com/clearlinux/swupd-client/pull/822,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/822,"When a user is using the -p/--path option with swupd he can point to a
chroot installation of clear or a custom mount. However when swupd
checks the system time to see if it is sane it compares it with a
versionstamp hardcoded in  /usr/share/clear/versionstamp, which causes
swupd to fail in systems using -p.
This commit prepends the path_prefix to the versionstamp path so it
points to the correct file if using the --path option.
Closes #812
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When a user is using the -p/--path option with swupd he can point to a
chroot installation of clear or a custom mount. However when swupd
checks the system time to see if it is sane it compares it with a
versionstamp hardcoded in  /usr/share/clear/versionstamp, which causes
swupd to fail in systems using -p.
This commit prepends the path_prefix to the versionstamp path so it
points to the correct file if using the --path option.
Closes #812
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,823,2019-02-13T20:53:25Z,2019-02-13T20:58:25Z,2019-02-13T20:58:25Z,MERGED,True,5,2,1,https://github.com/otaviobp,curl: Getting even better on message if swupd fails to connect to server,1,[],https://github.com/clearlinux/swupd-client/pull/823,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/823,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,825,2019-02-14T00:13:48Z,2019-02-14T07:01:12Z,2019-03-14T17:08:30Z,MERGED,True,11,9,3,https://github.com/otaviobp,Curl: Don't set curl fail on error when checking the connection,1,[],https://github.com/clearlinux/swupd-client/pull/825,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/825,"When we are checking if the SSL is working and the server is up we don't care
about the server return code. We just care if the server is responding. So
we shouldn't set the curl option CURLOPT_FAILONERROR.
The major problem of this change is that some servers don't respond to GET
in '/'. So checking the connection using the version url will fail in that
cases if CURLOPT_FAILONERROR is set.
As we don't really need the other options, reverting that change back to
how it was before.
Fixes #792
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When we are checking if the SSL is working and the server is up we don't care
about the server return code. We just care if the server is responding. So
we shouldn't set the curl option CURLOPT_FAILONERROR.
The major problem of this change is that some servers don't respond to GET
in '/'. So checking the connection using the version url will fail in that
cases if CURLOPT_FAILONERROR is set.
As we don't really need the other options, reverting that change back to
how it was before.
Fixes #792
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,828,2019-02-16T01:07:15Z,2019-02-19T17:16:38Z,2019-02-19T17:16:38Z,MERGED,True,20,9,1,https://github.com/castulo,Checking if update scripts exist before running,1,[],https://github.com/clearlinux/swupd-client/pull/828,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/828,"When swupd needs to run a post update script it does so without checking
if the file exists in the system or not. This will cause an error to be
raised by the shell if the script does not exist.
This commit adds a check for the existance of the script before
attempting to run it.
Closes #824
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When swupd needs to run a post update script it does so without checking
if the file exists in the system or not. This will cause an error to be
raised by the shell if the script does not exist.
This commit adds a check for the existance of the script before
attempting to run it.
Closes #824
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,830,2019-02-21T00:56:47Z,2019-02-22T17:36:40Z,2019-02-22T17:36:40Z,MERGED,True,192,5,10,https://github.com/castulo,Add swupd-inspector command into swupd,1,[],https://github.com/clearlinux/swupd-client/pull/830,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/830,"Use a binary launcher to load swupd-inspector and execute that
when swupd inspector is run.
Closes #826
Signed-off-by: Otavio Pontes otavio.pontes@intel.com
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Use a binary launcher to load swupd-inspector and execute that
when swupd inspector is run.
Closes #826
Signed-off-by: Otavio Pontes otavio.pontes@intel.com
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,831,2019-02-25T01:36:53Z,2019-02-25T22:02:50Z,2019-02-25T22:02:50Z,MERGED,True,1,1,1,https://github.com/litcoder,Fix missed dereferencing operator in string hash function,1,[],https://github.com/clearlinux/swupd-client/pull/831,https://github.com/litcoder,1,https://github.com/clearlinux/swupd-client/pull/831,Signed-off-by: Brandon Hong brandon.hong@intel.com,Signed-off-by: Brandon Hong brandon.hong@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,832,2019-02-25T21:53:57Z,2019-03-01T17:58:08Z,2019-03-01T17:58:08Z,MERGED,True,100,117,4,https://github.com/castulo,Consolidating minversion implementations in testlib,2,[],https://github.com/clearlinux/swupd-client/pull/832,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/832,"The update_minversion and bump_format testlib functions both perform a minversion update, but with separate implementations. These implementations should be consolidated.
Closes #618","The update_minversion and bump_format testlib functions both perform a minversion update, but with separate implementations. These implementations should be consolidated.
Closes #618",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,832,2019-02-25T21:53:57Z,2019-03-01T17:58:08Z,2019-03-01T17:58:08Z,MERGED,True,100,117,4,https://github.com/castulo,Consolidating minversion implementations in testlib,2,[],https://github.com/clearlinux/swupd-client/pull/832,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/832#issuecomment-467214601,"The update_minversion and bump_format testlib functions both perform a minversion update, but with separate implementations. These implementations should be consolidated.
Closes #618","lgtm, but I'll wait on @jwakre",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,833,2019-02-28T00:49:11Z,2019-03-05T22:47:31Z,2019-03-05T22:47:32Z,MERGED,True,258,65,3,https://github.com/castulo,Generating delta packs for all previous versions,5,[],https://github.com/clearlinux/swupd-client/pull/833,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/833,"Currently, testlib.bash generates delta packs for a given bundle from its most recently changed version to the latest version. This is not sufficient because the current version may be older than a bundle's most recently changed version. For instance, if an update was performed from version 10 to version 30 and a bundle has been updated in versions 20 and 30, a delta pack will be generated for that bundle from version 20 to version 30. It is expected that a delta pack for that bundle should be generated for an update from version 10 to version 30.
This PR generates delta packs for all previous version of a bundle when an update is created.
Closes #615","Currently, testlib.bash generates delta packs for a given bundle from its most recently changed version to the latest version. This is not sufficient because the current version may be older than a bundle's most recently changed version. For instance, if an update was performed from version 10 to version 30 and a bundle has been updated in versions 20 and 30, a delta pack will be generated for that bundle from version 20 to version 30. It is expected that a delta pack for that bundle should be generated for an update from version 10 to version 30.
This PR generates delta packs for all previous version of a bundle when an update is created.
Closes #615",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,833,2019-02-28T00:49:11Z,2019-03-05T22:47:31Z,2019-03-05T22:47:32Z,MERGED,True,258,65,3,https://github.com/castulo,Generating delta packs for all previous versions,5,[],https://github.com/clearlinux/swupd-client/pull/833,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/833#issuecomment-469866029,"Currently, testlib.bash generates delta packs for a given bundle from its most recently changed version to the latest version. This is not sufficient because the current version may be older than a bundle's most recently changed version. For instance, if an update was performed from version 10 to version 30 and a bundle has been updated in versions 20 and 30, a delta pack will be generated for that bundle from version 20 to version 30. It is expected that a delta pack for that bundle should be generated for an update from version 10 to version 30.
This PR generates delta packs for all previous version of a bundle when an update is created.
Closes #615",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,835,2019-03-01T01:11:03Z,2019-03-01T23:01:20Z,2019-03-01T23:01:20Z,MERGED,True,24,23,6,https://github.com/castulo,Running local search when searching,1,[],https://github.com/clearlinux/swupd-client/pull/835,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/835,"swupd-search is a script that searches locally for the best bundle that
matches a search-term.
This commit runs the swupd-search script when users use the ""swupd search""
command instead of calling the previous search code.
The previous search functionality will still be available for now using
the ""search-legacy"" command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","swupd-search is a script that searches locally for the best bundle that
matches a search-term.
This commit runs the swupd-search script when users use the ""swupd search""
command instead of calling the previous search code.
The previous search functionality will still be available for now using
the ""search-legacy"" command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,835,2019-03-01T01:11:03Z,2019-03-01T23:01:20Z,2019-03-01T23:01:20Z,MERGED,True,24,23,6,https://github.com/castulo,Running local search when searching,1,[],https://github.com/clearlinux/swupd-client/pull/835,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/835#issuecomment-468803576,"swupd-search is a script that searches locally for the best bundle that
matches a search-term.
This commit runs the swupd-search script when users use the ""swupd search""
command instead of calling the previous search code.
The previous search functionality will still be available for now using
the ""search-legacy"" command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",There is a bug in swupd-search that causes the script to crash if no argument is provided when running the script. It should be fixed before merging this PR. I have already provided a fix for that issue.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,835,2019-03-01T01:11:03Z,2019-03-01T23:01:20Z,2019-03-01T23:01:20Z,MERGED,True,24,23,6,https://github.com/castulo,Running local search when searching,1,[],https://github.com/clearlinux/swupd-client/pull/835,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/835#issuecomment-468804810,"swupd-search is a script that searches locally for the best bundle that
matches a search-term.
This commit runs the swupd-search script when users use the ""swupd search""
command instead of calling the previous search code.
The previous search functionality will still be available for now using
the ""search-legacy"" command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",This PR should at least fix the problem of falling back to the old search being confusing in this issue #834,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,836,2019-03-02T00:05:19Z,2019-03-05T21:32:26Z,2019-03-05T21:32:27Z,MERGED,True,96,39,3,https://github.com/castulo,Fixing the time shown using update -t,1,[],https://github.com/clearlinux/swupd-client/pull/836,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/836,"When running an update using the flag --time/-t the user is presented
with a verbose time output of the update operations. The time collected
for those operations was wrong.
This commit fixes the issue and presents a verbose output that is
consistent with other commands like bundle-add --time.
Closes #584
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running an update using the flag --time/-t the user is presented
with a verbose time output of the update operations. The time collected
for those operations was wrong.
This commit fixes the issue and presents a verbose output that is
consistent with other commands like bundle-add --time.
Closes #584
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,837,2019-03-04T18:57:18Z,2019-03-06T00:44:13Z,2019-03-06T00:44:13Z,MERGED,True,5,2,1,https://github.com/castulo,Add search-legacy to autocompletion script,1,[],https://github.com/clearlinux/swupd-client/pull/837,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/837,"Since search became search-legacy and there is a new search, the
autocompletion script needs to be updated.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Since search became search-legacy and there is a new search, the
autocompletion script needs to be updated.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,839,2019-03-05T21:32:02Z,2019-03-06T00:55:50Z,2019-03-06T00:55:50Z,MERGED,True,39,40,7,https://github.com/otaviobp,modules: Take swupd-inspector out of swupd,2,[],https://github.com/clearlinux/swupd-client/pull/839,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/839,"We needed on sample for external binaries, but as now we have swupd-search we
can take swupd inspector out.
Also move local search to list of external modules and fix all related tests
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We needed on sample for external binaries, but as now we have swupd-search we
can take swupd inspector out.
Also move local search to list of external modules and fix all related tests
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,840,2019-03-05T21:35:13Z,2019-03-07T21:22:48Z,2019-03-14T17:08:23Z,MERGED,True,64,8,3,https://github.com/otaviobp,thread_pool: Run tasks in same thread if threads are not supported,1,[],https://github.com/clearlinux/swupd-client/pull/840,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/840,"If we have any errors on pipe2 syscall or in pthread creation run tasks
in main thread. Also set the max downloads in parallel to 1 to avoid timeouts
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If we have any errors on pipe2 syscall or in pthread creation run tasks
in main thread. Also set the max downloads in parallel to 1 to avoid timeouts
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,841,2019-03-06T00:50:44Z,2019-03-06T17:46:10Z,2019-03-06T17:46:11Z,MERGED,True,210,122,3,https://github.com/castulo,Removing search heuristics,2,[],https://github.com/clearlinux/swupd-client/pull/841,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/841,"The search command uses a score system to weight the results it finds,
the purpose of this is to try and show the most relevant results to the
user on top, however since the focus of the search command is changing,
we don't need to guess what the user is looking for and just show all we
find.
This commit removes the score ordering from the search command.","The search command uses a score system to weight the results it finds,
the purpose of this is to try and show the most relevant results to the
user on top, however since the focus of the search command is changing,
we don't need to guess what the user is looking for and just show all we
find.
This commit removes the score ordering from the search command.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,842,2019-03-06T16:42:41Z,2019-03-06T17:44:21Z,2019-03-14T17:08:18Z,MERGED,True,3,3,1,https://github.com/otaviobp,test: Swupd-search test was incorrect,1,[],https://github.com/clearlinux/swupd-client/pull/842,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/842,"And it fails when using current version of swupd-search.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","And it fails when using current version of swupd-search.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,843,2019-03-07T00:33:14Z,2019-03-07T21:10:00Z,2019-03-14T17:08:44Z,MERGED,True,9,8,4,https://github.com/otaviobp,Set signature verification enabled as default,1,[],https://github.com/clearlinux/swupd-client/pull/843,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/843,"Signature verification was disabled as a default parameters to make it easier
for people to build the project on other distros. But this can be dangerous
as users may start using a built swupd without signature checking to
install a CL distro.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Signature verification was disabled as a default parameters to make it easier
for people to build the project on other distros. But this can be dangerous
as users may start using a built swupd without signature checking to
install a CL distro.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,843,2019-03-07T00:33:14Z,2019-03-07T21:10:00Z,2019-03-14T17:08:44Z,MERGED,True,9,8,4,https://github.com/otaviobp,Set signature verification enabled as default,1,[],https://github.com/clearlinux/swupd-client/pull/843,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/843#issuecomment-470409450,"Signature verification was disabled as a default parameters to make it easier
for people to build the project on other distros. But this can be dangerous
as users may start using a built swupd without signature checking to
install a CL distro.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","@otaviobp Can you provide a little more context to justify enabling this by default? I don't quite follow your reasoning. Who is building swupd to install Clear Linux? The installer images ship with the swupd-client that is part of the distro, correct?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,843,2019-03-07T00:33:14Z,2019-03-07T21:10:00Z,2019-03-14T17:08:44Z,MERGED,True,9,8,4,https://github.com/otaviobp,Set signature verification enabled as default,1,[],https://github.com/clearlinux/swupd-client/pull/843,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/843#issuecomment-470644813,"Signature verification was disabled as a default parameters to make it easier
for people to build the project on other distros. But this can be dangerous
as users may start using a built swupd without signature checking to
install a CL distro.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",No one is necessary building Swupd to install clear. Build a person could do that. And if he/she uses the default settings we won't check for signatures. I prefer to have a --disable in the case the person doesn't have the required libraries so the person knows that signatures won't be checked.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,843,2019-03-07T00:33:14Z,2019-03-07T21:10:00Z,2019-03-14T17:08:44Z,MERGED,True,9,8,4,https://github.com/otaviobp,Set signature verification enabled as default,1,[],https://github.com/clearlinux/swupd-client/pull/843,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/843#issuecomment-470678635,"Signature verification was disabled as a default parameters to make it easier
for people to build the project on other distros. But this can be dangerous
as users may start using a built swupd without signature checking to
install a CL distro.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","thanks for the review. It took me some time to get things right and I forgot to fix the docstrings and check for leftovers.
Fixed now",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,844,2019-03-07T21:40:31Z,2019-03-12T22:08:12Z,2019-03-14T17:08:17Z,MERGED,True,0,4,2,https://github.com/otaviobp,Remove unecessary srand() calls,1,[],https://github.com/clearlinux/swupd-client/pull/844,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/844,"We don't use rand() in swupd so don't need to initialize the random generator.
This was a leftover from previous code that used rand() for tests purposes.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We don't use rand() in swupd so don't need to initialize the random generator.
This was a leftover from previous code that used rand() for tests purposes.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,845,2019-03-08T17:15:03Z,2019-03-08T22:08:15Z,2019-03-14T17:08:15Z,MERGED,True,1,2,3,https://github.com/otaviobp,update: move variable to correct file,1,[],https://github.com/clearlinux/swupd-client/pull/845,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/845,"Left overs from global refactor
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Left overs from global refactor
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,846,2019-03-08T23:12:43Z,2019-03-25T23:07:42Z,2019-03-25T23:07:42Z,MERGED,True,1262,791,90,https://github.com/castulo,Create machine readable output for bundle-add,12,[],https://github.com/clearlinux/swupd-client/pull/846,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/846,"This PR adds the --json-output option for the bundle-add command in swupd which formats the output generated by swupd to comply with the JSON format. This way the output can be read and parsed easily by other applications that have an interest in real time status of a swupd operation.
These tasks are part of the PR:

 add the --json-output flag to the bundle-add command
 implement a formatter which will grab a normal string literal and will wrap it with a valid JSON format
 replace current messages in bundle-add with the formatted messages
 add a function to report an exit status of the swupd operation in JSON format to the formatter
 report the status of the add operation using the json_status function.
 add a json_progress function to report progress in JSON format to the formatter
 report progress using the json_progress function throughout the bundle add process, specially during the three steps:

Download packs
Installing bundle(s) files onto filesystem
Download missing files


 create tests for the new functionality

Closes #433
Closes #294
Closes #489
Closes #864","This PR adds the --json-output option for the bundle-add command in swupd which formats the output generated by swupd to comply with the JSON format. This way the output can be read and parsed easily by other applications that have an interest in real time status of a swupd operation.
These tasks are part of the PR:

 add the --json-output flag to the bundle-add command
 implement a formatter which will grab a normal string literal and will wrap it with a valid JSON format
 replace current messages in bundle-add with the formatted messages
 add a function to report an exit status of the swupd operation in JSON format to the formatter
 report the status of the add operation using the json_status function.
 add a json_progress function to report progress in JSON format to the formatter
 report progress using the json_progress function throughout the bundle add process, specially during the three steps:

Download packs
Installing bundle(s) files onto filesystem
Download missing files


 create tests for the new functionality

Closes #433
Closes #294
Closes #489
Closes #864",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,846,2019-03-08T23:12:43Z,2019-03-25T23:07:42Z,2019-03-25T23:07:42Z,MERGED,True,1262,791,90,https://github.com/castulo,Create machine readable output for bundle-add,12,[],https://github.com/clearlinux/swupd-client/pull/846,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/846#issuecomment-472207357,"This PR adds the --json-output option for the bundle-add command in swupd which formats the output generated by swupd to comply with the JSON format. This way the output can be read and parsed easily by other applications that have an interest in real time status of a swupd operation.
These tasks are part of the PR:

 add the --json-output flag to the bundle-add command
 implement a formatter which will grab a normal string literal and will wrap it with a valid JSON format
 replace current messages in bundle-add with the formatted messages
 add a function to report an exit status of the swupd operation in JSON format to the formatter
 report the status of the add operation using the json_status function.
 add a json_progress function to report progress in JSON format to the formatter
 report progress using the json_progress function throughout the bundle add process, specially during the three steps:

Download packs
Installing bundle(s) files onto filesystem
Download missing files


 create tests for the new functionality

Closes #433
Closes #294
Closes #489
Closes #864",I also pushed a commit to your branch adding a suggestion to keep json functions in a different file. By doing this it is easier to extend swupd to support more formatters if we need to.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,846,2019-03-08T23:12:43Z,2019-03-25T23:07:42Z,2019-03-25T23:07:42Z,MERGED,True,1262,791,90,https://github.com/castulo,Create machine readable output for bundle-add,12,[],https://github.com/clearlinux/swupd-client/pull/846,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/846#issuecomment-475054693,"This PR adds the --json-output option for the bundle-add command in swupd which formats the output generated by swupd to comply with the JSON format. This way the output can be read and parsed easily by other applications that have an interest in real time status of a swupd operation.
These tasks are part of the PR:

 add the --json-output flag to the bundle-add command
 implement a formatter which will grab a normal string literal and will wrap it with a valid JSON format
 replace current messages in bundle-add with the formatted messages
 add a function to report an exit status of the swupd operation in JSON format to the formatter
 report the status of the add operation using the json_status function.
 add a json_progress function to report progress in JSON format to the formatter
 report progress using the json_progress function throughout the bundle add process, specially during the three steps:

Download packs
Installing bundle(s) files onto filesystem
Download missing files


 create tests for the new functionality

Closes #433
Closes #294
Closes #489
Closes #864",I also tested with the golang sample I posted on the bug report and it's working file. Entries are consumed as they are printed and not just at the end. Cool,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,846,2019-03-08T23:12:43Z,2019-03-25T23:07:42Z,2019-03-25T23:07:42Z,MERGED,True,1262,791,90,https://github.com/castulo,Create machine readable output for bundle-add,12,[],https://github.com/clearlinux/swupd-client/pull/846,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/846#issuecomment-475054880,"This PR adds the --json-output option for the bundle-add command in swupd which formats the output generated by swupd to comply with the JSON format. This way the output can be read and parsed easily by other applications that have an interest in real time status of a swupd operation.
These tasks are part of the PR:

 add the --json-output flag to the bundle-add command
 implement a formatter which will grab a normal string literal and will wrap it with a valid JSON format
 replace current messages in bundle-add with the formatted messages
 add a function to report an exit status of the swupd operation in JSON format to the formatter
 report the status of the add operation using the json_status function.
 add a json_progress function to report progress in JSON format to the formatter
 report progress using the json_progress function throughout the bundle add process, specially during the three steps:

Download packs
Installing bundle(s) files onto filesystem
Download missing files


 create tests for the new functionality

Closes #433
Closes #294
Closes #489
Closes #864","Note: We need to review all usages of fprintf in the code. If any fprintf(stderr, ...) is used during the execution, parser will break.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,846,2019-03-08T23:12:43Z,2019-03-25T23:07:42Z,2019-03-25T23:07:42Z,MERGED,True,1262,791,90,https://github.com/castulo,Create machine readable output for bundle-add,12,[],https://github.com/clearlinux/swupd-client/pull/846,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/846#issuecomment-475317982,"This PR adds the --json-output option for the bundle-add command in swupd which formats the output generated by swupd to comply with the JSON format. This way the output can be read and parsed easily by other applications that have an interest in real time status of a swupd operation.
These tasks are part of the PR:

 add the --json-output flag to the bundle-add command
 implement a formatter which will grab a normal string literal and will wrap it with a valid JSON format
 replace current messages in bundle-add with the formatted messages
 add a function to report an exit status of the swupd operation in JSON format to the formatter
 report the status of the add operation using the json_status function.
 add a json_progress function to report progress in JSON format to the formatter
 report progress using the json_progress function throughout the bundle add process, specially during the three steps:

Download packs
Installing bundle(s) files onto filesystem
Download missing files


 create tests for the new functionality

Closes #433
Closes #294
Closes #489
Closes #864","I have addressed all comments @otaviobp , let me know if there is something else that needs to be done with this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,849,2019-03-15T20:37:32Z,2019-03-15T23:32:34Z,2019-03-15T23:32:34Z,MERGED,True,1,0,1,https://github.com/castulo,Adding missing test for deltas to Makefile.am,1,[],https://github.com/clearlinux/swupd-client/pull/849,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/849,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,850,2019-03-15T22:32:37Z,2019-03-28T23:35:03Z,2019-03-28T23:35:03Z,MERGED,True,542,659,13,https://github.com/otaviobp,Search-file rework,8,[],https://github.com/clearlinux/swupd-client/pull/850,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/850,"Rewriting some functions on swupd search so we don't need to store everything in memory to be printed later. Print things as we find them. This makes search-file a lot faster and with a smaller memory footprint
Fixex #388","Rewriting some functions on swupd search so we don't need to store everything in memory to be printed later. Print things as we find them. This makes search-file a lot faster and with a smaller memory footprint
Fixex #388",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,850,2019-03-15T22:32:37Z,2019-03-28T23:35:03Z,2019-03-28T23:35:03Z,MERGED,True,542,659,13,https://github.com/otaviobp,Search-file rework,8,[],https://github.com/clearlinux/swupd-client/pull/850,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/850#issuecomment-476410534,"Rewriting some functions on swupd search so we don't need to store everything in memory to be printed later. Print things as we find them. This makes search-file a lot faster and with a smaller memory footprint
Fixex #388",fixed the reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,853,2019-03-15T23:04:46Z,2019-03-21T19:25:12Z,2019-03-21T19:25:12Z,MERGED,True,38,0,2,https://github.com/otaviobp,info: Use parameters defined as global parameters,2,[],https://github.com/clearlinux/swupd-client/pull/853,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/853,"Mostly because we need to use --path to display information about a chroot
Fixes #851
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Mostly because we need to use --path to display information about a chroot
Fixes #851
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,853,2019-03-15T23:04:46Z,2019-03-21T19:25:12Z,2019-03-21T19:25:12Z,MERGED,True,38,0,2,https://github.com/otaviobp,info: Use parameters defined as global parameters,2,[],https://github.com/clearlinux/swupd-client/pull/853,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/853#issuecomment-475008839,"Mostly because we need to use --path to display information about a chroot
Fixes #851
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Fixed the reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,856,2019-03-18T21:54:36Z,2019-03-18T22:43:24Z,2019-03-18T22:43:24Z,MERGED,True,28,7,2,https://github.com/castulo,Travis improvements to speed up the build,3,[],https://github.com/clearlinux/swupd-client/pull/856,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/856,"This is the proposed solution:

 Run make compliant and shellcheck before running make and running the functional tests  so if there is code style issues with the code the build fails right away instead of failing after all tests have finished. This will allow use to fail faster if the build is going to fail anyway.
	Use the correct number of parallel jobs in make. From the documentation: ""SeeVirtualization environmentsto determine how many CPUs an environment normally has and set themakejob parameter to a similar number (or slightly higher if your build frequently waits on disk I/O)"". Ubuntu environments have only 2 cores.
 Running functional tests is the most time consuming task in the build process, so if we split them in different jobs instead of running them in a single job we can avoid reaching the timeout.

Closes #852","This is the proposed solution:

 Run make compliant and shellcheck before running make and running the functional tests  so if there is code style issues with the code the build fails right away instead of failing after all tests have finished. This will allow use to fail faster if the build is going to fail anyway.
	Use the correct number of parallel jobs in make. From the documentation: ""SeeVirtualization environmentsto determine how many CPUs an environment normally has and set themakejob parameter to a similar number (or slightly higher if your build frequently waits on disk I/O)"". Ubuntu environments have only 2 cores.
 Running functional tests is the most time consuming task in the build process, so if we split them in different jobs instead of running them in a single job we can avoid reaching the timeout.

Closes #852",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,859,2019-03-19T22:30:27Z,2019-03-19T23:09:07Z,2019-03-19T23:09:07Z,MERGED,True,26,21,1,https://github.com/castulo,Run static analysis in a different test stage in the build process,1,[],https://github.com/clearlinux/swupd-client/pull/859,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/859,"This commit includes two improvements for the build process:


It separates the static analysis and unit test execution into its
own job in a different previous stage in the build process from the
functional testing. This will allow the build not only to run the static
analysis before the functional tests but will also only run the functional
tests if the static analysis and unit test passed. This is important
because this stage only uses one job while the functional tests use many
jobs. There is no need to waste many jobs if the build didn't pass the
static analysis.


It groups tests in different jobs for execution in a way that most
jobs take similar time to finish. This will allow fine tuning how long
the build takes to finish by configuring number of groups and number of
tests in each group.


Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit includes two improvements for the build process:


It separates the static analysis and unit test execution into its
own job in a different previous stage in the build process from the
functional testing. This will allow the build not only to run the static
analysis before the functional tests but will also only run the functional
tests if the static analysis and unit test passed. This is important
because this stage only uses one job while the functional tests use many
jobs. There is no need to waste many jobs if the build didn't pass the
static analysis.


It groups tests in different jobs for execution in a way that most
jobs take similar time to finish. This will allow fine tuning how long
the build takes to finish by configuring number of groups and number of
tests in each group.


Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,861,2019-03-20T19:51:57Z,2019-03-21T19:25:35Z,2019-03-21T19:25:35Z,MERGED,True,3,1,1,https://github.com/otaviobp,verify: break line in error message to make it more readable,1,[],https://github.com/clearlinux/swupd-client/pull/861,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/861,"Fix #860
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Fix #860
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,865,2019-03-20T23:17:01Z,2019-03-20T23:42:54Z,2019-03-20T23:42:54Z,MERGED,True,19,8,1,https://github.com/castulo,Balance tests in jobs in Travis,1,[],https://github.com/clearlinux/swupd-client/pull/865,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/865,"This commit includes two more improvements for the swupd build process:


It balances the tests run in each one of the four test jobs so they
take approximately the same time. Before tests were being balanced per
test directory, with this commit tests are now balanced at a test file
level, which provides an even better tuning. In this case we are
splitting the update tests into 2 jobs since they are the most time
consuming.


Instead of using bats directly for running tests, this commit uses
""make check"" to run the tests but it provides a specific list for make
to override the default list so it doesn't run all tests. The advantage
of this is to still enjoy the benefits of the nice output provided by
make check which only shows a list of the tests executed and their status
and it only shows the the test output from the tests that failed. This
also provides one more benefit, the ability to use the parallelization
provided by make, so in this way we can have multiple parallelization by
having parallel threads within parallel jobs.


Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit includes two more improvements for the swupd build process:


It balances the tests run in each one of the four test jobs so they
take approximately the same time. Before tests were being balanced per
test directory, with this commit tests are now balanced at a test file
level, which provides an even better tuning. In this case we are
splitting the update tests into 2 jobs since they are the most time
consuming.


Instead of using bats directly for running tests, this commit uses
""make check"" to run the tests but it provides a specific list for make
to override the default list so it doesn't run all tests. The advantage
of this is to still enjoy the benefits of the nice output provided by
make check which only shows a list of the tests executed and their status
and it only shows the the test output from the tests that failed. This
also provides one more benefit, the ability to use the parallelization
provided by make, so in this way we can have multiple parallelization by
having parallel threads within parallel jobs.


Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,867,2019-03-21T20:00:54Z,2019-03-26T22:39:10Z,2019-03-26T22:39:10Z,MERGED,True,375,317,7,https://github.com/otaviobp,Manifest,7,[],https://github.com/clearlinux/swupd-client/pull/867,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/867,"Reorganizing manifest parser, adding some improvements and making it easier to extend Manifests without breaking swupd.
Fixes #858","Reorganizing manifest parser, adding some improvements and making it easier to extend Manifests without breaking swupd.
Fixes #858",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,867,2019-03-21T20:00:54Z,2019-03-26T22:39:10Z,2019-03-26T22:39:10Z,MERGED,True,375,317,7,https://github.com/otaviobp,Manifest,7,[],https://github.com/clearlinux/swupd-client/pull/867,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/867#issuecomment-476403617,"Reorganizing manifest parser, adding some improvements and making it easier to extend Manifests without breaking swupd.
Fixes #858",Fixed the proposed changes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,868,2019-03-21T23:06:22Z,2019-03-25T22:25:04Z,2019-03-25T22:25:04Z,MERGED,True,35,25,2,https://github.com/castulo,Adding the --quiet flag to hashdump,1,[],https://github.com/clearlinux/swupd-client/pull/868,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/868,"Currently when calculating the hash from a file two lines are printed:
Calculating hash with xattrs for: my_file
5114e8e3cc667fa80eb5407e5825c618e6668503aba53c8cca7f8daf84cec03f
The first line goes to STDERR while the second one goes to STDOUT. The
test library uses the hash that goes to STDOUT to perform many tasks, so
it is important the output can be filtered to just print the hash.
In the near future, all messages printed with printf or fprintf will be
replaced by logger functions in all the source code which will cause both
lines to be printed to the output which will break the test library.
This commit adds the --quiet flag to the hashdump command so that only
the calculated hashdump is printed on screen.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Currently when calculating the hash from a file two lines are printed:
Calculating hash with xattrs for: my_file
5114e8e3cc667fa80eb5407e5825c618e6668503aba53c8cca7f8daf84cec03f
The first line goes to STDERR while the second one goes to STDOUT. The
test library uses the hash that goes to STDOUT to perform many tasks, so
it is important the output can be filtered to just print the hash.
In the near future, all messages printed with printf or fprintf will be
replaced by logger functions in all the source code which will cause both
lines to be printed to the output which will break the test library.
This commit adds the --quiet flag to the hashdump command so that only
the calculated hashdump is printed on screen.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,868,2019-03-21T23:06:22Z,2019-03-25T22:25:04Z,2019-03-25T22:25:04Z,MERGED,True,35,25,2,https://github.com/castulo,Adding the --quiet flag to hashdump,1,[],https://github.com/clearlinux/swupd-client/pull/868,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/868#issuecomment-475437627,"Currently when calculating the hash from a file two lines are printed:
Calculating hash with xattrs for: my_file
5114e8e3cc667fa80eb5407e5825c618e6668503aba53c8cca7f8daf84cec03f
The first line goes to STDERR while the second one goes to STDOUT. The
test library uses the hash that goes to STDOUT to perform many tasks, so
it is important the output can be filtered to just print the hash.
In the near future, all messages printed with printf or fprintf will be
replaced by logger functions in all the source code which will cause both
lines to be printed to the output which will break the test library.
This commit adds the --quiet flag to the hashdump command so that only
the calculated hashdump is printed on screen.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",This PR is related to #864,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,870,2019-03-25T23:32:46Z,2019-03-26T16:44:30Z,2019-07-23T16:58:31Z,MERGED,True,3,3,1,https://github.com/otaviobp,info: Using functions from log.h instead of fprintf,1,[],https://github.com/clearlinux/swupd-client/pull/870,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/870,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,871,2019-03-26T21:40:20Z,2019-03-27T23:47:56Z,2019-03-27T23:47:56Z,MERGED,True,4,6,2,https://github.com/otaviobp,global: Make --quiet and --debug official,1,[],https://github.com/clearlinux/swupd-client/pull/871,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/871,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,871,2019-03-26T21:40:20Z,2019-03-27T23:47:56Z,2019-03-27T23:47:56Z,MERGED,True,4,6,2,https://github.com/otaviobp,global: Make --quiet and --debug official,1,[],https://github.com/clearlinux/swupd-client/pull/871,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/871#issuecomment-477366666,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,fixed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,872,2019-03-26T21:40:54Z,2019-03-27T23:47:37Z,2019-07-23T16:58:30Z,MERGED,True,49,30,11,https://github.com/otaviobp,Verify: Fix tests on test/real_content/,3,[],https://github.com/clearlinux/swupd-client/pull/872,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/872,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,873,2019-03-27T00:01:01Z,2019-03-28T16:39:03Z,2019-07-23T16:58:30Z,MERGED,True,158,2,8,https://github.com/otaviobp,manifest: Add manifest parser unit tests,1,[],https://github.com/clearlinux/swupd-client/pull/873,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/873,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,873,2019-03-27T00:01:01Z,2019-03-28T16:39:03Z,2019-07-23T16:58:30Z,MERGED,True,158,2,8,https://github.com/otaviobp,manifest: Add manifest parser unit tests,1,[],https://github.com/clearlinux/swupd-client/pull/873,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/873#issuecomment-477368436,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,878,2019-03-27T23:38:04Z,2019-04-01T19:03:24Z,2019-04-01T19:03:24Z,MERGED,True,764,98,24,https://github.com/castulo,Enabling the --json-output flag as a global option,1,[],https://github.com/clearlinux/swupd-client/pull/878,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/878,"The --json-output flag can be enabled for every swupd command.
This commit converts it to be a global flag, and enables it in every
swupd command.
Closes #869
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The --json-output flag can be enabled for every swupd command.
This commit converts it to be a global flag, and enables it in every
swupd command.
Closes #869
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,878,2019-03-27T23:38:04Z,2019-04-01T19:03:24Z,2019-04-01T19:03:24Z,MERGED,True,764,98,24,https://github.com/castulo,Enabling the --json-output flag as a global option,1,[],https://github.com/clearlinux/swupd-client/pull/878,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/878#issuecomment-478049454,"The --json-output flag can be enabled for every swupd command.
This commit converts it to be a global flag, and enables it in every
swupd command.
Closes #869
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@castulo Can you rebase that?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,878,2019-03-27T23:38:04Z,2019-04-01T19:03:24Z,2019-04-01T19:03:24Z,MERGED,True,764,98,24,https://github.com/castulo,Enabling the --json-output flag as a global option,1,[],https://github.com/clearlinux/swupd-client/pull/878,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/878#issuecomment-478078973,"The --json-output flag can be enabled for every swupd command.
This commit converts it to be a global flag, and enables it in every
swupd command.
Closes #869
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo Can you rebase that?

yeah, I'm on it",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,879,2019-03-28T00:25:56Z,2019-03-28T20:05:37Z,2019-03-28T20:05:37Z,MERGED,True,12,12,2,https://github.com/castulo,Autocompletion for --debug and --quiet,1,[],https://github.com/clearlinux/swupd-client/pull/879,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/879,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,880,2019-03-29T20:42:09Z,2019-04-15T20:28:45Z,2019-07-23T16:58:28Z,MERGED,True,64,5,10,https://github.com/otaviobp,Remove test ID duplication,4,[],https://github.com/clearlinux/swupd-client/pull/880,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/880,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,881,2019-04-04T21:09:14Z,2019-04-09T19:27:04Z,2019-04-09T19:27:04Z,MERGED,True,1,9,1,https://github.com/otaviobp,sys: First parameter in argv isn't the basename of the binary,1,[],https://github.com/clearlinux/swupd-client/pull/881,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/881,"The default is to use the full path of the binary that is being executed and
not the basename.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","The default is to use the full path of the binary that is being executed and
not the basename.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,882,2019-04-04T21:41:13Z,2019-04-09T19:26:51Z,2019-07-23T16:58:29Z,MERGED,True,17,44,4,https://github.com/otaviobp,update: use execv() instead of system() to re-execute update,1,[],https://github.com/clearlinux/swupd-client/pull/882,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/882,"Note that we don't need to use run_command() (fork + exec) because
we don't need to handle any output on swupd. We can just replace current
process with the new swupd execution.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Note that we don't need to use run_command() (fork + exec) because
we don't need to handle any output on swupd. We can just replace current
process with the new swupd execution.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/883,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/883#issuecomment-483849891,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","I just found a problem with this PR, @otaviobp please hold on reviewing until further notice ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/883#issuecomment-483882160,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","I fixed the issue, it is now ready for review @otaviobp",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/883#issuecomment-484144402,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","I did some tests and I found a bug on download fullfile. I tried this:
swupd verify --quick --fix -B os-core,vim --path /custom -F 27 --force -m 28100 -u https://cdn.download.clearlinux.org/update/

And the verify command failed. It works fine with master.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/883#issuecomment-484265458,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","I did some tests and I found a bug on download fullfile. I tried this:
swupd verify --quick --fix -B os-core,vim --path /custom -F 27 --force -m 28100 -u https://cdn.download.clearlinux.org/update/

And the verify command failed. It works fine with master.

Looks like for some reason it was failing when extracting some tars, there were some changes recently on tar extraction. I rebased the PR and it is working now. I cannot recreate the issue anymore.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/883#issuecomment-484599634,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","Overall it looks great. I added some minor comments and I have another suggestion.
When we finish the download we print a 100% progress, but we still need to extract the last tarball. So the progress get stuck in 100% for some time. And that's a problem hard to fix, but there's an easy workaround. Can we move progress until 99% and only print 100% at the end of the process?

Well the percentage we are showing is strictly related to download progress, so it doesn't really reflect any progress in tarball extraction, so moving the percentage based on that it would be misleading and that was the problem we wanted to fix in the first place. To avoid being misleading maybe we can just show a message like ""Finishing package extraction..."" after the 100% has been reached, so the user knows download is complete but tars are still being unpacked. The unpacking only take a few extra seconds anyway (at least in all the tests I ran) so users shouldn't really need detailed progress update on that task.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,883,2019-04-05T17:42:51Z,2019-04-18T17:29:51Z,2019-05-14T22:54:20Z,MERGED,True,661,435,78,https://github.com/castulo,Report progress based on downloaded content,4,[],https://github.com/clearlinux/swupd-client/pull/883,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/883#issuecomment-484603104,"When swupd reports progress of content it needs, it does so by counting
how many items it needs to download (fullfiles or packs) and how many it
has already downloaded. This gives a rough estimate of what is the
progress of the overall download, but it can also be very misleading
since some files may be very different in size compared to others. This
is specially true when talking about packs, one pack could be a couple
of Mb big while another one could be a few houndred Mbs.
This PR changes the reporting of progress for packs nd fullfiles so swupd reports
progress based on how much of the total Mbs we have downloaded instead
of how many files, this will give a more accurate feeling of where the overall
process is.
Closes #877","Yes, you're right. let we keep the way it is for now",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,884,2019-04-06T00:50:54Z,2019-04-06T01:08:21Z,2019-04-06T01:08:21Z,CLOSED,False,65,5,5,https://github.com/castulo,Id duplication,4,[],https://github.com/clearlinux/swupd-client/pull/884,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/884,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,885,2019-04-08T21:37:09Z,2019-04-25T16:40:52Z,2019-05-14T22:54:08Z,CLOSED,False,41,1,3,https://github.com/castulo,bundle-add overwrites old content,1,[],https://github.com/clearlinux/swupd-client/pull/885,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/885,"When swupd is installing a bundle, it goes through the list of files to
install and removes those files that already exist in the target system
from the list without checking if the file needs to be updated or not.
This commit changes this process so the file is removed from the
list of files to install only if the file already exist in the target
system and the hash matches the hash in the manifest.
Closes #863
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When swupd is installing a bundle, it goes through the list of files to
install and removes those files that already exist in the target system
from the list without checking if the file needs to be updated or not.
This commit changes this process so the file is removed from the
list of files to install only if the file already exist in the target
system and the hash matches the hash in the manifest.
Closes #863
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,885,2019-04-08T21:37:09Z,2019-04-25T16:40:52Z,2019-05-14T22:54:08Z,CLOSED,False,41,1,3,https://github.com/castulo,bundle-add overwrites old content,1,[],https://github.com/clearlinux/swupd-client/pull/885,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/885#issuecomment-486748689,"When swupd is installing a bundle, it goes through the list of files to
install and removes those files that already exist in the target system
from the list without checking if the file needs to be updated or not.
This commit changes this process so the file is removed from the
list of files to install only if the file already exist in the target
system and the hash matches the hash in the manifest.
Closes #863
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This PR is being superseded by #903, I'm closing this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,886,2019-04-09T16:51:05Z,2019-07-03T21:59:48Z,2019-07-03T21:59:48Z,MERGED,True,155,2,11,https://github.com/castulo,"Support ""optional"" bundles in manifests",3,[],https://github.com/clearlinux/swupd-client/pull/886,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/886,"This PR adds support in swupd for optional bundles in manifests. An optional bundle is similar to the required bundles (included bundles) but have a couple of differences.

Optional bundles are installed by default when the main bundle that includes them is installed.
Users have the option to skip the installation of Optional bundles by using the flag --skip-optional or -o with bundle-add.
Optional bundles can be removed from the system even if the main bundle that installed them is still in the system.

Closes #875","This PR adds support in swupd for optional bundles in manifests. An optional bundle is similar to the required bundles (included bundles) but have a couple of differences.

Optional bundles are installed by default when the main bundle that includes them is installed.
Users have the option to skip the installation of Optional bundles by using the flag --skip-optional or -o with bundle-add.
Optional bundles can be removed from the system even if the main bundle that installed them is still in the system.

Closes #875",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,886,2019-04-09T16:51:05Z,2019-07-03T21:59:48Z,2019-07-03T21:59:48Z,MERGED,True,155,2,11,https://github.com/castulo,"Support ""optional"" bundles in manifests",3,[],https://github.com/clearlinux/swupd-client/pull/886,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/886#issuecomment-481420725,"This PR adds support in swupd for optional bundles in manifests. An optional bundle is similar to the required bundles (included bundles) but have a couple of differences.

Optional bundles are installed by default when the main bundle that includes them is installed.
Users have the option to skip the installation of Optional bundles by using the flag --skip-optional or -o with bundle-add.
Optional bundles can be removed from the system even if the main bundle that installed them is still in the system.

Closes #875","Overall this looks good, but let's wait on a server implementation to merge this.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,886,2019-04-09T16:51:05Z,2019-07-03T21:59:48Z,2019-07-03T21:59:48Z,MERGED,True,155,2,11,https://github.com/castulo,"Support ""optional"" bundles in manifests",3,[],https://github.com/clearlinux/swupd-client/pull/886,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/886#issuecomment-495799084,"This PR adds support in swupd for optional bundles in manifests. An optional bundle is similar to the required bundles (included bundles) but have a couple of differences.

Optional bundles are installed by default when the main bundle that includes them is installed.
Users have the option to skip the installation of Optional bundles by using the flag --skip-optional or -o with bundle-add.
Optional bundles can be removed from the system even if the main bundle that installed them is still in the system.

Closes #875",This PR is the mixer side implementation -> clearlinux/mixer-tools#580,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,887,2019-04-09T23:13:33Z,2019-04-10T23:13:55Z,2019-04-10T23:13:55Z,MERGED,True,282,162,21,https://github.com/otaviobp,System: Use fork() + exec() instead of system(),6,[],https://github.com/clearlinux/swupd-client/pull/887,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/887,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,888,2019-04-10T20:45:29Z,2019-04-10T22:27:32Z,2019-07-23T16:58:27Z,MERGED,True,5,0,5,https://github.com/otaviobp,test: Disabling json tests for now,1,[],https://github.com/clearlinux/swupd-client/pull/888,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/888,"Disabling json tests that checks for progress because tests are unstable.
If we have any minor changes in the code that could affect how curl is called
we could have different progress reports and because of that we would have false
negatives.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Disabling json tests that checks for progress because tests are unstable.
If we have any minor changes in the code that could affect how curl is called
we could have different progress reports and because of that we would have false
negatives.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,889,2019-04-10T21:42:55Z,2019-04-10T23:52:20Z,2019-07-23T16:58:26Z,MERGED,True,116,83,8,https://github.com/otaviobp,System2: Use libarchive instead of tar to check for tarball contents,3,[],https://github.com/clearlinux/swupd-client/pull/889,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/889,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,892,2019-04-12T17:19:31Z,2019-04-12T17:41:24Z,2019-07-23T16:58:25Z,MERGED,True,5,5,1,https://github.com/otaviobp,configure: Cert Path was incorrect when default was used for signatur,1,[],https://github.com/clearlinux/swupd-client/pull/892,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/892,"e check
When we enabled signature check by default we introduced one bug in configure that
was not setting the correct cert path when the flag --enable-signature-verification
was omitted. That wasn't triggered by our tests because we use an alternative signature.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","e check
When we enabled signature check by default we introduced one bug in configure that
was not setting the correct cert path when the flag --enable-signature-verification
was omitted. That wasn't triggered by our tests because we use an alternative signature.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,893,2019-04-12T17:22:40Z,2019-04-15T20:29:01Z,2019-07-23T16:58:25Z,MERGED,True,39,30,3,https://github.com/otaviobp,archives: Don't assume tarball includes '/' for directories,1,[],https://github.com/clearlinux/swupd-client/pull/893,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/893,"At first I assumed that all tarballs would have a trailing '/' for directories
and this isn't true. But we can't assume that we won't have a trailing '/'. So
archives_check_single_file_tarball() is now ignoring trailing '/' when comparing
files. That is the same behavior of the function that
archives_check_single_file_tarball() replaced.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","At first I assumed that all tarballs would have a trailing '/' for directories
and this isn't true. But we can't assume that we won't have a trailing '/'. So
archives_check_single_file_tarball() is now ignoring trailing '/' when comparing
files. That is the same behavior of the function that
archives_check_single_file_tarball() replaced.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,896,2019-04-17T00:11:22Z,2019-04-17T15:23:18Z,2019-04-17T15:23:18Z,MERGED,True,1,4,1,https://github.com/castulo,Removing code not used from bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/896,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/896,"Cleaning up some code that does nothing in bundle-add.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Cleaning up some code that does nothing in bundle-add.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,897,2019-04-17T15:52:50Z,2019-04-17T19:05:48Z,2019-04-17T19:05:48Z,MERGED,True,4,3,4,https://github.com/otaviobp,swupd: Don't include libcurl headers,1,[],https://github.com/clearlinux/swupd-client/pull/897,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/897,"We have a layer isolating curl API calls, so don't include libcurl
headers on swupd.h.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We have a layer isolating curl API calls, so don't include libcurl
headers on swupd.h.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,898,2019-04-17T23:19:07Z,2019-04-18T17:20:43Z,2019-04-18T17:23:50Z,MERGED,True,368,177,10,https://github.com/otaviobp,"Signature - Some organization, certificate revocation and tests",9,[],https://github.com/clearlinux/swupd-client/pull/898,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/898,"Reorganize code to take swupd specific code from signature.c
Add unit tests for signature verification
Check if OCSP is set as critical and reject the certificate if so, because OCSP isn't supported on swupd yet.","Reorganize code to take swupd specific code from signature.c
Add unit tests for signature verification
Check if OCSP is set as critical and reject the certificate if so, because OCSP isn't supported on swupd yet.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,898,2019-04-17T23:19:07Z,2019-04-18T17:20:43Z,2019-04-18T17:23:50Z,MERGED,True,368,177,10,https://github.com/otaviobp,"Signature - Some organization, certificate revocation and tests",9,[],https://github.com/clearlinux/swupd-client/pull/898,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/898#issuecomment-484584231,"Reorganize code to take swupd specific code from signature.c
Add unit tests for signature verification
Check if OCSP is set as critical and reject the certificate if so, because OCSP isn't supported on swupd yet.",fixing all comments,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,899,2019-04-18T19:03:19Z,2019-05-14T21:28:28Z,2019-07-23T16:58:22Z,MERGED,True,221,19,12,https://github.com/otaviobp,Signature,4,[],https://github.com/clearlinux/swupd-client/pull/899,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/899,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,900,2019-04-18T19:38:30Z,2019-04-18T20:30:27Z,2019-04-18T20:30:27Z,MERGED,True,23,29,4,https://github.com/otaviobp,curl: Use a struct declaration instead of void pointers,1,[],https://github.com/clearlinux/swupd-client/pull/900,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/900,"We can declare the scruct in a header file and define it in a source file so
we can avoid using void pointers for the handle. It's a better approach because
compilers can trigger errors if we use a different type.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We can declare the scruct in a header file and define it in a source file so
we can avoid using void pointers for the handle. It's a better approach because
compilers can trigger errors if we use a different type.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,901,2019-04-22T22:17:47Z,2019-05-14T22:51:48Z,2019-05-14T22:51:48Z,MERGED,True,133,177,20,https://github.com/otaviobp,Global: More generic swupd_init(),3,[],https://github.com/clearlinux/swupd-client/pull/901,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/901,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,901,2019-04-22T22:17:47Z,2019-05-14T22:51:48Z,2019-05-14T22:51:48Z,MERGED,True,133,177,20,https://github.com/otaviobp,Global: More generic swupd_init(),3,[],https://github.com/clearlinux/swupd-client/pull/901,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/901#issuecomment-491994410,,fixed reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,902,2019-04-22T22:25:50Z,2019-04-23T20:27:12Z,2019-07-23T16:58:24Z,MERGED,True,3056,286,26,https://github.com/otaviobp,Documentation improvement,3,[],https://github.com/clearlinux/swupd-client/pull/902,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/902,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,903,2019-04-23T19:19:51Z,2019-05-13T21:38:21Z,2019-05-14T22:53:55Z,MERGED,True,331,93,64,https://github.com/castulo,Bundleadd improvements,3,[],https://github.com/clearlinux/swupd-client/pull/903,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/903,"When staging a file using do_staging(), if the path of the file is  missing verify_fix_path() is called to try fix the missing path. verify_fix_path() then removes bad directories (if any), downloads the file and again and stages the new directory using do_staging(), doing a circular reference.
On top of this bundle add is calling verify_fix_path() after running do_staging() again.
All this circular reference makes the code very difficult to understand and may cause swupd to do extra work that is not necessary. This commit simplifies the code by not allowing do_staging() to call verify_fix_path() so we can manually call it later if necessary.
This PR also includes a fix for the following bug:
Closes #863
The PR also adds more comments in the bundle-add code to try to make it easier to follow.","When staging a file using do_staging(), if the path of the file is  missing verify_fix_path() is called to try fix the missing path. verify_fix_path() then removes bad directories (if any), downloads the file and again and stages the new directory using do_staging(), doing a circular reference.
On top of this bundle add is calling verify_fix_path() after running do_staging() again.
All this circular reference makes the code very difficult to understand and may cause swupd to do extra work that is not necessary. This commit simplifies the code by not allowing do_staging() to call verify_fix_path() so we can manually call it later if necessary.
This PR also includes a fix for the following bug:
Closes #863
The PR also adds more comments in the bundle-add code to try to make it easier to follow.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,904,2019-04-23T22:26:18Z,2019-04-24T16:33:00Z,2019-07-23T16:58:24Z,MERGED,True,1,1,1,https://github.com/otaviobp,sys: Adding a missing --no-block flag on call that shouldn't block,1,[],https://github.com/clearlinux/swupd-client/pull/904,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/904,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,907,2019-04-26T22:41:45Z,2019-08-13T19:31:00Z,2019-09-17T16:51:28Z,CLOSED,False,318,375,19,https://github.com/otaviobp,Staging,4,[],https://github.com/clearlinux/swupd-client/pull/907,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/907,Improvements in staging process.,Improvements in staging process.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,908,2019-04-29T22:30:33Z,2019-05-13T21:29:29Z,2019-05-14T22:53:43Z,MERGED,True,9,9,1,https://github.com/castulo,Print the json output to stdout instead of stderr,1,[],https://github.com/clearlinux/swupd-client/pull/908,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/908,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,910,2019-05-01T18:03:54Z,2019-05-13T21:48:48Z,2019-05-13T21:48:49Z,MERGED,True,3,0,1,https://github.com/alexjch,Set user-agent header,1,[],https://github.com/clearlinux/swupd-client/pull/910,https://github.com/alexjch,1,https://github.com/clearlinux/swupd-client/pull/910,"This change sets swupd client User-Agent header to PACKAGE/VERSION. This is
a standard HTTP header to identify the client that originates a request.
Signed-off-by: Alex Jaramillo alex.v.jaramillo@intel.com","This change sets swupd client User-Agent header to PACKAGE/VERSION. This is
a standard HTTP header to identify the client that originates a request.
Signed-off-by: Alex Jaramillo alex.v.jaramillo@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,912,2019-05-06T22:54:34Z,2019-05-14T21:26:31Z,2019-05-14T22:53:33Z,MERGED,True,759,349,31,https://github.com/castulo,Making verify --install a top-level command,1,[],https://github.com/clearlinux/swupd-client/pull/912,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/912,"The purpose of swupd verify --install is so it can be used to install
a new Clear OS in a target system. However since currently it is part
of the swupd verify command it makes it confusing as of to what its
purpose is.
This commit moves the swupd verify --install option to be a top level
command (swupd os-install) so its purpose is more straightforward. The
new command still uses the verify code to perform the task underneath.
Closes #250
Closes #911
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The purpose of swupd verify --install is so it can be used to install
a new Clear OS in a target system. However since currently it is part
of the swupd verify command it makes it confusing as of to what its
purpose is.
This commit moves the swupd verify --install option to be a top level
command (swupd os-install) so its purpose is more straightforward. The
new command still uses the verify code to perform the task underneath.
Closes #250
Closes #911
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,912,2019-05-06T22:54:34Z,2019-05-14T21:26:31Z,2019-05-14T22:53:33Z,MERGED,True,759,349,31,https://github.com/castulo,Making verify --install a top-level command,1,[],https://github.com/clearlinux/swupd-client/pull/912,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/912#issuecomment-492396159,"The purpose of swupd verify --install is so it can be used to install
a new Clear OS in a target system. However since currently it is part
of the swupd verify command it makes it confusing as of to what its
purpose is.
This commit moves the swupd verify --install option to be a top level
command (swupd os-install) so its purpose is more straightforward. The
new command still uses the verify code to perform the task underneath.
Closes #250
Closes #911
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I addressed all the points in the feedback.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,913,2019-05-07T19:25:02Z,2019-05-09T22:33:01Z,2019-05-14T22:53:22Z,MERGED,True,1,1,1,https://github.com/castulo,Removes iter manifests from bundle-add completion,1,[],https://github.com/clearlinux/swupd-client/pull/913,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/913,"There is a bug in the code that causes swupd bundle-add 
to list regular bundle names as well as iterative manifest names.
This commit fixes the issue by removing the iterative manifests from
the list of results.
Closes #906
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There is a bug in the code that causes swupd bundle-add 
to list regular bundle names as well as iterative manifest names.
This commit fixes the issue by removing the iterative manifests from
the list of results.
Closes #906
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,915,2019-05-08T18:52:41Z,2019-05-09T21:50:08Z,2019-05-14T22:53:08Z,MERGED,True,1,1,1,https://github.com/castulo,Update the copyright to 2019,1,[],https://github.com/clearlinux/swupd-client/pull/915,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/915,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/916,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914","The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/916#issuecomment-491079595,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914","NOTE: This PR is built on top of PR #912, so PR #912 has to be reviewed and merged before this one. Once that has happened this PR can be rebased and reviewed.
",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/mdhorn,3,https://github.com/clearlinux/swupd-client/pull/916#issuecomment-492463340,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914","@castulo @otaviobp
The installer relies on using swupd verify --install, so that command is going away in a future swupd release? We will have to coordinate this change or it will break the DevOps and anyone installing.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/gvancuts,4,https://github.com/clearlinux/swupd-client/pull/916#issuecomment-492546680,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914","I would also recommend that a more formal and descriptive announcement about this change be sent to the relevant mailing list prior to landing in Clear Linux. This is a command that's fairly widely used by people and referenced in various wikis, it will catch many by surprise so a heads-up would be useful.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/916#issuecomment-492722459,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914",For now we are just introducing the replacements and tuning the parameters. We aren't going to remove verify install in next swupd release and verify will be around for some time. Before removing it completely we will for sure announce it in advance to make sure people won't have scripts broken.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/916#issuecomment-492726328,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914","@castulo @otaviobp
The installer relies on using swupd verify --install, so that command is going away in a future swupd release? We will have to coordinate this change or it will break the DevOps and anyone installing.

@mdhorn yes, actually this PR from installer already includes that change clearlinux/clr-installer#372. In any case the old command/options will continue to work for some time with a proper warning so other users have time to update their scripts.",True,{'THUMBS_UP': ['https://github.com/mdhorn']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,916,2019-05-09T21:41:15Z,2019-05-14T21:34:26Z,2019-05-15T16:33:50Z,CLOSED,False,1821,952,59,https://github.com/castulo,Making verify --fix a top-level command,2,[],https://github.com/clearlinux/swupd-client/pull/916,https://github.com/mdhorn,7,https://github.com/clearlinux/swupd-client/pull/916#issuecomment-492728013,"The purpose of ""swupd verify --fix"" is to repair local issues relative
to a server manifest. However the verify command currently has many
flags, and some flags are mutually exclusive, this makes the command
very confusing to use for users.
This commit makes ""swupd verify --fix"" the top level command
""swupd repair"". This new command still uses the verify code under the
covers.
Closes #914","@castulo @otaviobp Great that backward compatibility will still be there! :)
Some older tools like 'ister.py' which are still in use also use the verify --install; so something to capture when you get to the phase of removing that command.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,917,2019-05-09T22:38:07Z,2019-05-10T19:43:07Z,2019-07-23T16:58:22Z,MERGED,True,4,3,2,https://github.com/otaviobp,"swupd.bash"" Remove extra "" when setting COMPREPL",1,[],https://github.com/clearlinux/swupd-client/pull/917,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/917,"Bash completion was adding line breaks because of that extra "" on COMPREPLY
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Bash completion was adding line breaks because of that extra "" on COMPREPLY
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,919,2019-05-10T17:35:49Z,2019-05-14T22:51:29Z,2019-05-14T22:52:32Z,MERGED,True,157,72,24,https://github.com/castulo,"Renaming ""swupd verify"" to ""swupd diagnose""",1,[],https://github.com/clearlinux/swupd-client/pull/919,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/919,"This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918","This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,919,2019-05-10T17:35:49Z,2019-05-14T22:51:29Z,2019-05-14T22:52:32Z,MERGED,True,157,72,24,https://github.com/castulo,"Renaming ""swupd verify"" to ""swupd diagnose""",1,[],https://github.com/clearlinux/swupd-client/pull/919,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/919#issuecomment-491371424,"This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918","  NOTE: This PR is built on top of PRs #912 and #916, so those PRs have to be reviewed and merged before this one (in that order). Once that has happened this PR can be rebased and reviewed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,919,2019-05-10T17:35:49Z,2019-05-14T22:51:29Z,2019-05-14T22:52:32Z,MERGED,True,157,72,24,https://github.com/castulo,"Renaming ""swupd verify"" to ""swupd diagnose""",1,[],https://github.com/clearlinux/swupd-client/pull/919,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/919#issuecomment-492317337,"This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918","lgtm. just restore old dos with a warning for deprecation. other than that, it's good to go

I will @otaviobp. One more thing I'm thinking I may need to update (not sure) is other testing besides from the functional tests, like the ""real content"" tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,919,2019-05-10T17:35:49Z,2019-05-14T22:51:29Z,2019-05-14T22:52:32Z,MERGED,True,157,72,24,https://github.com/castulo,"Renaming ""swupd verify"" to ""swupd diagnose""",1,[],https://github.com/clearlinux/swupd-client/pull/919,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/919#issuecomment-492418858,"This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918","I will @otaviobp. One more thing I'm thinking I may need to update (not sure) is other testing besides from the functional tests, like the ""real content"" tests.

yes we will need to update them.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,919,2019-05-10T17:35:49Z,2019-05-14T22:51:29Z,2019-05-14T22:52:32Z,MERGED,True,157,72,24,https://github.com/castulo,"Renaming ""swupd verify"" to ""swupd diagnose""",1,[],https://github.com/clearlinux/swupd-client/pull/919,https://github.com/busykai,5,https://github.com/clearlinux/swupd-client/pull/919#issuecomment-492427020,"This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918","+1 on rearranging commands. However, let's not call verify --install os-install. It can be used to install bundles and it seems to me just install will reflect it's purpose well.
EDIT: oops, it's seems i'm a little late to the party. this comment is related to #912 rather.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,919,2019-05-10T17:35:49Z,2019-05-14T22:51:29Z,2019-05-14T22:52:32Z,MERGED,True,157,72,24,https://github.com/castulo,"Renaming ""swupd verify"" to ""swupd diagnose""",1,[],https://github.com/clearlinux/swupd-client/pull/919,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/919#issuecomment-492430913,"This PR renames the ""verify"" command to ""diagnose"" to make it
more straightforward for the user to understand the purpose of the
command.
Closes #918","+1 on rearranging commands. However, let's not call verify --install os-install. It can be used to install bundles and it seems to me just install will reflect it's purpose well.
EDIT: oops, it's seems i'm a little late to the party. this comment is related to #912 rather.

There were some arguments made in the original issue #250 against using swupd install, that is why we went with os-install. We don't want to mislead users to use install to install bundles but bundle-add instead.",True,{'THUMBS_UP': ['https://github.com/busykai']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,927,2019-05-20T20:56:15Z,2019-05-20T22:50:49Z,2019-07-23T16:58:07Z,MERGED,True,3,1,1,https://github.com/otaviobp,mirror: Don't enforce root if mirror command is used in read-only mode,1,[],https://github.com/clearlinux/swupd-client/pull/927,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/927,"Fixes #926
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Fixes #926
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,928,2019-05-21T21:17:11Z,2019-05-24T17:25:57Z,2019-07-23T16:58:08Z,MERGED,True,49,30,1,https://github.com/otaviobp,global: Fallback to system configuration when configuration on path_p,1,[],https://github.com/clearlinux/swupd-client/pull/928,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/928,"refix
If --path is used swupd looks for version and content url inside the informed chroot path.
This is the expected, but in some cases not enough. When installing a CL we usually point to
an empty chroot. So if there's no config file inside the chroot, fallbacks to system configuration.
Fixes #924","refix
If --path is used swupd looks for version and content url inside the informed chroot path.
This is the expected, but in some cases not enough. When installing a CL we usually point to
an empty chroot. So if there's no config file inside the chroot, fallbacks to system configuration.
Fixes #924",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,928,2019-05-21T21:17:11Z,2019-05-24T17:25:57Z,2019-07-23T16:58:08Z,MERGED,True,49,30,1,https://github.com/otaviobp,global: Fallback to system configuration when configuration on path_p,1,[],https://github.com/clearlinux/swupd-client/pull/928,https://github.com/clefrks,2,https://github.com/clearlinux/swupd-client/pull/928#issuecomment-495502929,"refix
If --path is used swupd looks for version and content url inside the informed chroot path.
This is the expected, but in some cases not enough. When installing a CL we usually point to
an empty chroot. So if there's no config file inside the chroot, fallbacks to system configuration.
Fixes #924",@otaviobp when would this be merged?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,930,2019-05-24T17:10:09Z,2019-05-24T20:57:10Z,2019-05-24T21:55:20Z,MERGED,True,23,13,8,https://github.com/castulo,Adding the -V / --version flag to swupd commands,1,[],https://github.com/clearlinux/swupd-client/pull/930,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/930,"swupd uses the -m / --manifest flag for some commands to specify what
version to use for that specfic action. For example using ""swupd verify
--install --manifest=10"" will attempt to install the OS with version 10.
The problem is that this flag doesn't really hint users about what the
flag is used for, specially if the user is not familiar with swupd / mixer
internals.
This commit adds a replacement flag -V / --version that will have the
exact same functionality of -m / --manifest which will be deprecated.
The deprecated flag should be removed in 6 months time.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","swupd uses the -m / --manifest flag for some commands to specify what
version to use for that specfic action. For example using ""swupd verify
--install --manifest=10"" will attempt to install the OS with version 10.
The problem is that this flag doesn't really hint users about what the
flag is used for, specially if the user is not familiar with swupd / mixer
internals.
This commit adds a replacement flag -V / --version that will have the
exact same functionality of -m / --manifest which will be deprecated.
The deprecated flag should be removed in 6 months time.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,931,2019-05-24T17:47:34Z,2019-05-24T19:33:56Z,2019-05-24T19:33:56Z,MERGED,True,11,19,1,https://github.com/otaviobp,global: Use system format number as a fallback if there's no format n,1,[],https://github.com/clearlinux/swupd-client/pull/931,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/931,umber in path_prefix,umber in path_prefix,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,933,2019-05-24T20:46:23Z,2019-05-29T03:09:49Z,2019-05-29T03:09:50Z,MERGED,True,8,4,1,https://github.com/castulo,Fixing false positive in a functional test,1,[],https://github.com/clearlinux/swupd-client/pull/933,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/933,"The update/update-json.bats functional test is giving a false positive
since one hardcoded value (time) was taking longer to run in a local
environment.
This commit fixes the issue by using a regex to accept any time value.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The update/update-json.bats functional test is giving a false positive
since one hardcoded value (time) was taking longer to run in a local
environment.
This commit fixes the issue by using a regex to accept any time value.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,933,2019-05-24T20:46:23Z,2019-05-29T03:09:49Z,2019-05-29T03:09:50Z,MERGED,True,8,4,1,https://github.com/castulo,Fixing false positive in a functional test,1,[],https://github.com/clearlinux/swupd-client/pull/933,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/933#issuecomment-495797529,"The update/update-json.bats functional test is giving a false positive
since one hardcoded value (time) was taking longer to run in a local
environment.
This commit fixes the issue by using a regex to accept any time value.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Cool. This one was breaking in my system sometimes too. I looks fixed now. I'll ping you if it breaks again

I saw there is one more test breaking, but it is a unit test test/unit/test_signature.c",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,934,2019-05-24T21:15:16Z,2019-05-24T22:44:26Z,2019-05-24T22:44:26Z,MERGED,True,20,4,1,https://github.com/otaviobp,global: Remove trailing slashes on content and version URLs,1,[],https://github.com/clearlinux/swupd-client/pull/934,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/934,"We always append an extra '/' at the end of the URL and some webservers doesn't support
multiple slashes connected. So always removing last '/' on URLs.","We always append an extra '/' at the end of the URL and some webservers doesn't support
multiple slashes connected. So always removing last '/' on URLs.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,935,2019-05-24T23:16:26Z,2019-05-29T03:10:30Z,2019-05-29T03:10:30Z,MERGED,True,11,11,1,https://github.com/castulo,Sorting swupd main menu,1,[],https://github.com/clearlinux/swupd-client/pull/935,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/935,"This commit sorts the swupd main menu in a way that makes more sense.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit sorts the swupd main menu in a way that makes more sense.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,936,2019-05-25T00:42:00Z,2019-05-29T03:10:07Z,2019-05-29T03:10:07Z,MERGED,True,1,1,2,https://github.com/castulo,"Fix a line break when running ""swupd repair""",1,[],https://github.com/clearlinux/swupd-client/pull/936,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/936,"There was a bug with the line breaks during swupd verify --fix or swupd repair that was causing the output to look like this.
Verifying version 29620
Verifying files
	...100%
Starting download of remaining update content. This may take a while...
	...66528%Adding any missing files
	...100%
Repairing modified files

This PR fixes that by moving the line break to the appropriate place.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There was a bug with the line breaks during swupd verify --fix or swupd repair that was causing the output to look like this.
Verifying version 29620
Verifying files
	...100%
Starting download of remaining update content. This may take a while...
	...66528%Adding any missing files
	...100%
Repairing modified files

This PR fixes that by moving the line break to the appropriate place.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,938,2019-05-30T18:50:31Z,2019-05-30T20:58:15Z,2019-05-30T20:58:15Z,MERGED,True,92,63,37,https://github.com/castulo,verify command as superseded instead of deprecated,1,[],https://github.com/clearlinux/swupd-client/pull/938,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/938,"The verify command has been superseded by diagnose, the --fix option has
been superseded by the repair command, and the --install option has been
superseded by the os-install command. This commit changes the messages
displayed to the user from showing the commands as ""deprecated"" to the
more accurate ""superseded"" description. It also fixes some other
mismatches in output when using the new commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The verify command has been superseded by diagnose, the --fix option has
been superseded by the repair command, and the --install option has been
superseded by the os-install command. This commit changes the messages
displayed to the user from showing the commands as ""deprecated"" to the
more accurate ""superseded"" description. It also fixes some other
mismatches in output when using the new commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,940,2019-05-31T16:53:49Z,2019-05-31T19:35:34Z,2019-07-23T16:58:09Z,MERGED,True,16,3,4,https://github.com/otaviobp,bundle-list: local bundle list should work without root,1,[],https://github.com/clearlinux/swupd-client/pull/940,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/940,"When we changed the init swupd function we stopped supporting bundle-list as root.
Adding this back on.","When we changed the init swupd function we stopped supporting bundle-list as root.
Adding this back on.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,943,2019-06-03T23:37:36Z,2019-06-05T23:19:11Z,2019-06-05T23:19:11Z,MERGED,True,84,31,7,https://github.com/castulo,Fix download progress for fullfiles,1,[],https://github.com/clearlinux/swupd-client/pull/943,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/943,"When the download progress of fullfiles was being calculated it was
being done considering as if the files were being downloaded serially
not in parallel. This was causing an error in the calculation of the
download progress.
This commit fixes the issue by considering the files are being downloaded
in parallel when calculating the download progress.
Closes #939
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When the download progress of fullfiles was being calculated it was
being done considering as if the files were being downloaded serially
not in parallel. This was causing an error in the calculation of the
download progress.
This commit fixes the issue by considering the files are being downloaded
in parallel when calculating the download progress.
Closes #939
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,943,2019-06-03T23:37:36Z,2019-06-05T23:19:11Z,2019-06-05T23:19:11Z,MERGED,True,84,31,7,https://github.com/castulo,Fix download progress for fullfiles,1,[],https://github.com/clearlinux/swupd-client/pull/943,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/943#issuecomment-499248417,"When the download progress of fullfiles was being calculated it was
being done considering as if the files were being downloaded serially
not in parallel. This was causing an error in the calculation of the
download progress.
This commit fixes the issue by considering the files are being downloaded
in parallel when calculating the download progress.
Closes #939
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,943,2019-06-03T23:37:36Z,2019-06-05T23:19:11Z,2019-06-05T23:19:11Z,MERGED,True,84,31,7,https://github.com/castulo,Fix download progress for fullfiles,1,[],https://github.com/clearlinux/swupd-client/pull/943,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/943#issuecomment-499269411,"When the download progress of fullfiles was being calculated it was
being done considering as if the files were being downloaded serially
not in parallel. This was causing an error in the calculation of the
download progress.
This commit fixes the issue by considering the files are being downloaded
in parallel when calculating the download progress.
Closes #939
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp I addressed your comments, let me know if there is something else missing",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,944,2019-06-05T01:28:44Z,2019-06-06T22:37:22Z,2019-06-06T22:37:27Z,MERGED,True,357,292,41,https://github.com/castulo,Improvements in swupd output,3,[],https://github.com/clearlinux/swupd-client/pull/944,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/944,"This PR includes some improvements in the swupd output:

Adds a line break to the progress percentage when it reaches 100% so it doesn't has to be specified individually every time a progress is reported.
Splits the action of ""diagnosing"" a system in three actions so the progress is reported more accurately.
Fixes the display of progress percentages when the progress display is ""interrupted"" by another message (look at the example below).

Example of a current output running swupd repair:
Verifying version 29750
Verifying files

Missing file: /usr/bin/mixer
	...100%
	...0%
Hash mismatch for file: /usr/bin/mixin

Hash mismatch for file: /usr/bin/swupd-extract

Hash mismatch for file: /usr/bin/swupd-inspector
	...99%
Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%
Inspected 632545 files
  1 file was missing
  4 files did not match
Diagnose successful

Example of improved output:
Diagnosing version 29750

Checking for missing files
 -> Missing file: /usr/bin/mixer
	...100%

Checking for corrupt files
 -> Hash mismatch for file: /usr/bin/mixin
 -> Hash mismatch for file: /usr/bin/swupd-extract
 -> Hash mismatch for file: /usr/bin/swupd-inspector
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%

Checking for extraneous files
	...100%

Inspected 632545 files
  1 file was missing
  4 files did not match
Use ""swupd repair"" to correct the problems in the system

Diagnose successful

Another example of the improved output when doing  swap repair:
Diagnosing version 29750

Checking for corrupt files
	...100%

Starting download of remaining update content. This may take a while...
	...100%

Adding any missing files
 -> Missing file: /usr/bin/mixer -> fixed
	...100%

Repairing corrupt files
 -> Hash mismatch for file: /usr/bin/mixin -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-extract -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-inspector -> fixed
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer -> fixed
	...100%

Removing extraneous files
	...100%

Inspected 632545 files
  1 file was missing
    1 of 1 missing files were replaced
    0 of 1 missing files were not replaced
  4 files did not match
    4 of 4 files were repaired
    0 of 4 files were not repaired
Calling post-update helper scripts.
none

Repair successful","This PR includes some improvements in the swupd output:

Adds a line break to the progress percentage when it reaches 100% so it doesn't has to be specified individually every time a progress is reported.
Splits the action of ""diagnosing"" a system in three actions so the progress is reported more accurately.
Fixes the display of progress percentages when the progress display is ""interrupted"" by another message (look at the example below).

Example of a current output running swupd repair:
Verifying version 29750
Verifying files

Missing file: /usr/bin/mixer
	...100%
	...0%
Hash mismatch for file: /usr/bin/mixin

Hash mismatch for file: /usr/bin/swupd-extract

Hash mismatch for file: /usr/bin/swupd-inspector
	...99%
Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%
Inspected 632545 files
  1 file was missing
  4 files did not match
Diagnose successful

Example of improved output:
Diagnosing version 29750

Checking for missing files
 -> Missing file: /usr/bin/mixer
	...100%

Checking for corrupt files
 -> Hash mismatch for file: /usr/bin/mixin
 -> Hash mismatch for file: /usr/bin/swupd-extract
 -> Hash mismatch for file: /usr/bin/swupd-inspector
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%

Checking for extraneous files
	...100%

Inspected 632545 files
  1 file was missing
  4 files did not match
Use ""swupd repair"" to correct the problems in the system

Diagnose successful

Another example of the improved output when doing  swap repair:
Diagnosing version 29750

Checking for corrupt files
	...100%

Starting download of remaining update content. This may take a while...
	...100%

Adding any missing files
 -> Missing file: /usr/bin/mixer -> fixed
	...100%

Repairing corrupt files
 -> Hash mismatch for file: /usr/bin/mixin -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-extract -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-inspector -> fixed
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer -> fixed
	...100%

Removing extraneous files
	...100%

Inspected 632545 files
  1 file was missing
    1 of 1 missing files were replaced
    0 of 1 missing files were not replaced
  4 files did not match
    4 of 4 files were repaired
    0 of 4 files were not repaired
Calling post-update helper scripts.
none

Repair successful",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,944,2019-06-05T01:28:44Z,2019-06-06T22:37:22Z,2019-06-06T22:37:27Z,MERGED,True,357,292,41,https://github.com/castulo,Improvements in swupd output,3,[],https://github.com/clearlinux/swupd-client/pull/944,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/944#issuecomment-498903783,"This PR includes some improvements in the swupd output:

Adds a line break to the progress percentage when it reaches 100% so it doesn't has to be specified individually every time a progress is reported.
Splits the action of ""diagnosing"" a system in three actions so the progress is reported more accurately.
Fixes the display of progress percentages when the progress display is ""interrupted"" by another message (look at the example below).

Example of a current output running swupd repair:
Verifying version 29750
Verifying files

Missing file: /usr/bin/mixer
	...100%
	...0%
Hash mismatch for file: /usr/bin/mixin

Hash mismatch for file: /usr/bin/swupd-extract

Hash mismatch for file: /usr/bin/swupd-inspector
	...99%
Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%
Inspected 632545 files
  1 file was missing
  4 files did not match
Diagnose successful

Example of improved output:
Diagnosing version 29750

Checking for missing files
 -> Missing file: /usr/bin/mixer
	...100%

Checking for corrupt files
 -> Hash mismatch for file: /usr/bin/mixin
 -> Hash mismatch for file: /usr/bin/swupd-extract
 -> Hash mismatch for file: /usr/bin/swupd-inspector
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%

Checking for extraneous files
	...100%

Inspected 632545 files
  1 file was missing
  4 files did not match
Use ""swupd repair"" to correct the problems in the system

Diagnose successful

Another example of the improved output when doing  swap repair:
Diagnosing version 29750

Checking for corrupt files
	...100%

Starting download of remaining update content. This may take a while...
	...100%

Adding any missing files
 -> Missing file: /usr/bin/mixer -> fixed
	...100%

Repairing corrupt files
 -> Hash mismatch for file: /usr/bin/mixin -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-extract -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-inspector -> fixed
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer -> fixed
	...100%

Removing extraneous files
	...100%

Inspected 632545 files
  1 file was missing
    1 of 1 missing files were replaced
    0 of 1 missing files were not replaced
  4 files did not match
    4 of 4 files were repaired
    0 of 4 files were not repaired
Calling post-update helper scripts.
none

Repair successful","@otaviobp this PR is missing the updates in the functional tests, so lots of them are going to fail. Since this PR requires a significant update in the output from the tests, I wanted to run this by you first, and see what is your opinion before spending time updating the tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,944,2019-06-05T01:28:44Z,2019-06-06T22:37:22Z,2019-06-06T22:37:27Z,MERGED,True,357,292,41,https://github.com/castulo,Improvements in swupd output,3,[],https://github.com/clearlinux/swupd-client/pull/944,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/944#issuecomment-499269987,"This PR includes some improvements in the swupd output:

Adds a line break to the progress percentage when it reaches 100% so it doesn't has to be specified individually every time a progress is reported.
Splits the action of ""diagnosing"" a system in three actions so the progress is reported more accurately.
Fixes the display of progress percentages when the progress display is ""interrupted"" by another message (look at the example below).

Example of a current output running swupd repair:
Verifying version 29750
Verifying files

Missing file: /usr/bin/mixer
	...100%
	...0%
Hash mismatch for file: /usr/bin/mixin

Hash mismatch for file: /usr/bin/swupd-extract

Hash mismatch for file: /usr/bin/swupd-inspector
	...99%
Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%
Inspected 632545 files
  1 file was missing
  4 files did not match
Diagnose successful

Example of improved output:
Diagnosing version 29750

Checking for missing files
 -> Missing file: /usr/bin/mixer
	...100%

Checking for corrupt files
 -> Hash mismatch for file: /usr/bin/mixin
 -> Hash mismatch for file: /usr/bin/swupd-extract
 -> Hash mismatch for file: /usr/bin/swupd-inspector
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer
	...100%

Checking for extraneous files
	...100%

Inspected 632545 files
  1 file was missing
  4 files did not match
Use ""swupd repair"" to correct the problems in the system

Diagnose successful

Another example of the improved output when doing  swap repair:
Diagnosing version 29750

Checking for corrupt files
	...100%

Starting download of remaining update content. This may take a while...
	...100%

Adding any missing files
 -> Missing file: /usr/bin/mixer -> fixed
	...100%

Repairing corrupt files
 -> Hash mismatch for file: /usr/bin/mixin -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-extract -> fixed
 -> Hash mismatch for file: /usr/bin/swupd-inspector -> fixed
 -> Hash mismatch for file: /usr/share/zsh/site-functions/_mixer -> fixed
	...100%

Removing extraneous files
	...100%

Inspected 632545 files
  1 file was missing
    1 of 1 missing files were replaced
    0 of 1 missing files were not replaced
  4 files did not match
    4 of 4 files were repaired
    0 of 4 files were not repaired
Calling post-update helper scripts.
none

Repair successful",lgtm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,945,2019-06-05T23:20:08Z,2019-06-06T01:15:42Z,2019-06-06T01:15:50Z,MERGED,True,12,1,1,https://github.com/castulo,Add full path to swupd binary before re-update,1,[],https://github.com/clearlinux/swupd-client/pull/945,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/945,"When swupd is updating a system and it has to go over a format bump, the
update is run twice. First to get to the lower boundary of the format
bump and then it run again to go from the upper boundary of the format
bump to the desired version.
The second time the update was being run, swupd was being executed without
considering the environment, so the PATH variable was not being read,
this was causing swupd to fail to re execute itself for the second
update unless the user had run swupd specifying the full path in the
first place.
This commit fixes the issue by resolving the full path to swupd before
re executing itself.
Closes #942","When swupd is updating a system and it has to go over a format bump, the
update is run twice. First to get to the lower boundary of the format
bump and then it run again to go from the upper boundary of the format
bump to the desired version.
The second time the update was being run, swupd was being executed without
considering the environment, so the PATH variable was not being read,
this was causing swupd to fail to re execute itself for the second
update unless the user had run swupd specifying the full path in the
first place.
This commit fixes the issue by resolving the full path to swupd before
re executing itself.
Closes #942",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,947,2019-06-06T23:17:13Z,2019-06-25T22:43:06Z,2019-06-25T22:43:06Z,MERGED,True,281,0,1,https://github.com/lebensterben,Add `zsh` completion,3,[],https://github.com/clearlinux/swupd-client/pull/947,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/947,"I wrote a zsh completion function for clearlinux/swupd-client.

It shows both available arguments/options and their description
It provides URL and PATH completions for certain options
It provides BUNDLE completion for swupd diagnose -b|--bundles,
swupd repair -b|--bundles and swupd bundle-remove. The list
of available bundle is dynamic, that is to say if you've already
specified a bundle, it won't appear in the list.
Those labelled as deprecated are not presented in the completion.
(But you may add them.)

I also suggest the following:

swupd.zsh shall be placed under /usr/share/zsh/site-functions and
named as _swupd according to zsh convention, if zsh is installed.
It will be loaded by zsh because this directory is in zsh's $fpath.
swupd.bash currently is located in /usr/share/defaults/etc/profile.d,
but we put all other bash completions in
/usr/share/bash-completion/completions directory. And I suggest to move
swupd.bash here, which would be loaded by bash without needing to","I wrote a zsh completion function for clearlinux/swupd-client.

It shows both available arguments/options and their description
It provides URL and PATH completions for certain options
It provides BUNDLE completion for swupd diagnose -b|--bundles,
swupd repair -b|--bundles and swupd bundle-remove. The list
of available bundle is dynamic, that is to say if you've already
specified a bundle, it won't appear in the list.
Those labelled as deprecated are not presented in the completion.
(But you may add them.)

I also suggest the following:

swupd.zsh shall be placed under /usr/share/zsh/site-functions and
named as _swupd according to zsh convention, if zsh is installed.
It will be loaded by zsh because this directory is in zsh's $fpath.
swupd.bash currently is located in /usr/share/defaults/etc/profile.d,
but we put all other bash completions in
/usr/share/bash-completion/completions directory. And I suggest to move
swupd.bash here, which would be loaded by bash without needing to",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,947,2019-06-06T23:17:13Z,2019-06-25T22:43:06Z,2019-06-25T22:43:06Z,MERGED,True,281,0,1,https://github.com/lebensterben,Add `zsh` completion,3,[],https://github.com/clearlinux/swupd-client/pull/947,https://github.com/miguelinux,2,https://github.com/clearlinux/swupd-client/pull/947#issuecomment-504102425,"I wrote a zsh completion function for clearlinux/swupd-client.

It shows both available arguments/options and their description
It provides URL and PATH completions for certain options
It provides BUNDLE completion for swupd diagnose -b|--bundles,
swupd repair -b|--bundles and swupd bundle-remove. The list
of available bundle is dynamic, that is to say if you've already
specified a bundle, it won't appear in the list.
Those labelled as deprecated are not presented in the completion.
(But you may add them.)

I also suggest the following:

swupd.zsh shall be placed under /usr/share/zsh/site-functions and
named as _swupd according to zsh convention, if zsh is installed.
It will be loaded by zsh because this directory is in zsh's $fpath.
swupd.bash currently is located in /usr/share/defaults/etc/profile.d,
but we put all other bash completions in
/usr/share/bash-completion/completions directory. And I suggest to move
swupd.bash here, which would be loaded by bash without needing to","LGTM
@castulo @otaviobp any feedback?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,948,2019-06-07T22:51:14Z,2019-07-03T23:10:48Z,2019-07-03T23:10:48Z,MERGED,True,134,43,10,https://github.com/castulo,Checking mirror status only if it is set,1,[],https://github.com/clearlinux/swupd-client/pull/948,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/948,"When doing an update, we check to see if a mirror is stale, this only
needs to be done if there is a mirror set.
This commit checks to see if a mirror is set and only then it checks to
see if it is stale. This gives us the advantage of adding more detailed
messages when checking for the mirror status without polluting the output
with those extra messages when a mirror is not set.
Closes #922
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When doing an update, we check to see if a mirror is stale, this only
needs to be done if there is a mirror set.
This commit checks to see if a mirror is set and only then it checks to
see if it is stale. This gives us the advantage of adding more detailed
messages when checking for the mirror status without polluting the output
with those extra messages when a mirror is not set.
Closes #922
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,948,2019-06-07T22:51:14Z,2019-07-03T23:10:48Z,2019-07-03T23:10:48Z,MERGED,True,134,43,10,https://github.com/castulo,Checking mirror status only if it is set,1,[],https://github.com/clearlinux/swupd-client/pull/948,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/948#issuecomment-506420421,"When doing an update, we check to see if a mirror is stale, this only
needs to be done if there is a mirror set.
This commit checks to see if a mirror is set and only then it checks to
see if it is stale. This gives us the advantage of adding more detailed
messages when checking for the mirror status without polluting the output
with those extra messages when a mirror is not set.
Closes #922
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Hey @otaviobp I think I addressed all your concerns with this update in the PR,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,948,2019-06-07T22:51:14Z,2019-07-03T23:10:48Z,2019-07-03T23:10:48Z,MERGED,True,134,43,10,https://github.com/castulo,Checking mirror status only if it is set,1,[],https://github.com/clearlinux/swupd-client/pull/948,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/948#issuecomment-506905256,"When doing an update, we check to see if a mirror is stale, this only
needs to be done if there is a mirror set.
This commit checks to see if a mirror is set and only then it checks to
see if it is stale. This gives us the advantage of adding more detailed
messages when checking for the mirror status without polluting the output
with those extra messages when a mirror is not set.
Closes #922
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp ok, I made some changes, I think it now works as expected",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,948,2019-06-07T22:51:14Z,2019-07-03T23:10:48Z,2019-07-03T23:10:48Z,MERGED,True,134,43,10,https://github.com/castulo,Checking mirror status only if it is set,1,[],https://github.com/clearlinux/swupd-client/pull/948,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/948#issuecomment-508276566,"When doing an update, we check to see if a mirror is stale, this only
needs to be done if there is a mirror set.
This commit checks to see if a mirror is set and only then it checks to
see if it is stale. This gives us the advantage of adding more detailed
messages when checking for the mirror status without polluting the output
with those extra messages when a mirror is not set.
Closes #922
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I addressed your comments in the last update,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,949,2019-06-07T23:14:11Z,2019-06-14T21:50:10Z,2019-06-14T21:50:10Z,MERGED,True,106,105,74,https://github.com/castulo,"Including a few more cosmetic changes for ""verify""",1,[],https://github.com/clearlinux/swupd-client/pull/949,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/949,"This commit adds a few more cosmetic changes to the commands that run
verify in the back for consistency.

Different steps in the update process are separated by a blank line.
Messages from swupd should not finish with a '.'

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a few more cosmetic changes to the commands that run
verify in the back for consistency.

Different steps in the update process are separated by a blank line.
Messages from swupd should not finish with a '.'

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,951,2019-06-10T07:53:49Z,2019-06-25T22:48:31Z,2019-06-25T22:48:31Z,MERGED,True,20,0,1,https://github.com/castulo,Fixes a bug when calculating the download size,1,[],https://github.com/clearlinux/swupd-client/pull/951,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/951,"To calculate the total download size of packs and fullfiles, swupd is
relying in a function that uses curl to request the server for the
download size of each file. However, when a file is not found in the
server, a size of 162 is returned by curl, which was causing the total
download size calculation to be wrong.
This commit fixes the issue by counting the file size returned by curl
only if the file exists.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","To calculate the total download size of packs and fullfiles, swupd is
relying in a function that uses curl to request the server for the
download size of each file. However, when a file is not found in the
server, a size of 162 is returned by curl, which was causing the total
download size calculation to be wrong.
This commit fixes the issue by counting the file size returned by curl
only if the file exists.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,951,2019-06-10T07:53:49Z,2019-06-25T22:48:31Z,2019-06-25T22:48:31Z,MERGED,True,20,0,1,https://github.com/castulo,Fixes a bug when calculating the download size,1,[],https://github.com/clearlinux/swupd-client/pull/951,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/951#issuecomment-505207786,"To calculate the total download size of packs and fullfiles, swupd is
relying in a function that uses curl to request the server for the
download size of each file. However, when a file is not found in the
server, a size of 162 is returned by curl, which was causing the total
download size calculation to be wrong.
This commit fixes the issue by counting the file size returned by curl
only if the file exists.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp I just pushed an update addressing all your comments,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,954,2019-06-11T20:26:22Z,2019-06-14T21:56:35Z,2019-06-14T21:56:35Z,MERGED,True,7,0,1,https://github.com/castulo,Adding a progress overflow protection,1,[],https://github.com/clearlinux/swupd-client/pull/954,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/954,"When reporting download progress, we should never have a percentage
bigger than 100%, but if for some reason we do (due to a bug), we don't
want that percentage slipping all the way to the end user.
This commit limits the percentage we display to 100 maximum.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When reporting download progress, we should never have a percentage
bigger than 100%, but if for some reason we do (due to a bug), we don't
want that percentage slipping all the way to the end user.
This commit limits the percentage we display to 100 maximum.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,956,2019-06-13T15:39:34Z,2019-06-13T16:33:35Z,2019-06-13T16:52:32Z,MERGED,True,2,0,1,https://github.com/jurobystricky,Makefile.am: add files to distribution,1,[],https://github.com/clearlinux/swupd-client/pull/956,https://github.com/jurobystricky,1,https://github.com/clearlinux/swupd-client/pull/956,"A compressed distribution tarball created via
$ make dist
is missing some files needed to run the standard
sequence of build commands:
$ ./configure
$ make
$ make check
In particular, when running ""make check"" we get:
../../test/unit/test_signature.c:9:10: fatal error: test_helper.h: No such file or directory
9 | #include ""test_helper.h""
|          ^~~~~~~~~~~~~~~
compilation terminated.
This patch modifies the distribiton tarrball by adding files/folders:

test/unit/test_helper.h (to fix the above build error)
test/unit/data  (files reference by the test/unit/ binaries
test/functional (files referenced by Makefile)

With this patch ""make check"" reports:
Testsuite summary for swupd-client 3.20.0
Signed-off-by: Juro Bystricky juro.bystricky@intel.com","A compressed distribution tarball created via
$ make dist
is missing some files needed to run the standard
sequence of build commands:
$ ./configure
$ make
$ make check
In particular, when running ""make check"" we get:
../../test/unit/test_signature.c:9:10: fatal error: test_helper.h: No such file or directory
9 | #include ""test_helper.h""
|          ^~~~~~~~~~~~~~~
compilation terminated.
This patch modifies the distribiton tarrball by adding files/folders:

test/unit/test_helper.h (to fix the above build error)
test/unit/data  (files reference by the test/unit/ binaries
test/functional (files referenced by Makefile)

With this patch ""make check"" reports:
Testsuite summary for swupd-client 3.20.0
Signed-off-by: Juro Bystricky juro.bystricky@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/958,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/miguelinux,2,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-504493148,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Hi, I've not review the code, and have a question.
Is this file stateless complain?
I mean it could be on
/etc/swupd/config
/runt/swupd/config
/usr/share/swupd/config",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-504493849,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Hi, I've not review the code, and have a question.
Is this file stateless complain?
I mean it could be on
/etc/swupd/config
/runt/swupd/config
/usr/share/swupd/config


As of now it is in here -> /usr/share/clear/swupd.config, but we are in dialog about where should be the most appropriate place",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/miguelinux,4,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-504495630,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","> ```
 > /etc/swupd/config
 > /run/swupd/config
 > /usr/share/swupd/config
 > ```

 As of now it is in here -> /usr/share/clear/swupd.config
Can I ask to be stateless as others packages software in CL?

Just a rule

```
if exist /etc/swupd/config
 open it
else
if exist /run/swupd/config
 open it
else
 open/usr/share/swupd/config
```",True,"{'THUMBS_UP': ['https://github.com/castulo', 'https://github.com/otaviobp']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/miguelinux,5,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-504560713,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Ok, change of plans, it will go to  /usr/share/defaults/swupd/config as you requested 

Thanks guys :)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-504566058,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","btw, I didn't know about /run/. thanks for pointing this.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/miguelinux,7,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-504590569,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","btw, I didn't know about /run/. thanks for pointing this.
I learned it from systemd files ;-)

and is useful when you test config files and don't want to disturb
your admin config from /etc",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,958,2019-06-19T19:47:16Z,2019-06-28T20:06:12Z,2019-06-28T20:06:13Z,MERGED,True,1255,112,22,https://github.com/castulo,Adding configuration file parser for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/958,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/958#issuecomment-506528522,"swupd has many flags that can be used for fine tunning its
functionality. In some cases users may want to include a flag with every
swupd command they run.
This commit gives the ability to provide swupd flags via options in a
configuration file that swupd will read before running the command.
The configuration file is an INI style file tha  can include sections
so users can specify options that should only apply to a specific
command. The biggest advantage of this is to be able to fine tune the
flags that should apply for each command.
For example a user could set a global flag that would apply to every
swupd command, and then turn that flag off for a specific command by
unsetting it in the command's section.
Closes #952
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp this PR is ready to be reviewed again, I have addressed all your concerns.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,959,2019-06-21T00:31:41Z,2019-06-27T21:48:51Z,2019-06-27T21:48:51Z,MERGED,True,119,43,14,https://github.com/castulo,Require a force flag to continue with insecure URL,2,[],https://github.com/clearlinux/swupd-client/pull/959,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/959,"Currently users can set content and version urls based on http or https
protocols. This pose a security risk if users decide to use http.
This commit blocks swupd from working with http unless is specifically
allowed by using the --allow-insecure-http flag.
Closes #953","Currently users can set content and version urls based on http or https
protocols. This pose a security risk if users decide to use http.
This commit blocks swupd from working with http unless is specifically
allowed by using the --allow-insecure-http flag.
Closes #953",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,959,2019-06-21T00:31:41Z,2019-06-27T21:48:51Z,2019-06-27T21:48:51Z,MERGED,True,119,43,14,https://github.com/castulo,Require a force flag to continue with insecure URL,2,[],https://github.com/clearlinux/swupd-client/pull/959,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/959#issuecomment-504246035,"Currently users can set content and version urls based on http or https
protocols. This pose a security risk if users decide to use http.
This commit blocks swupd from working with http unless is specifically
allowed by using the --allow-insecure-http flag.
Closes #953","This PR is still missing this part:

Users have a mirror or default server pointing to a http server and no configuration file forcing that flag: We need to notify him that autoupdate is disabled on system logins with instructions on what to do about that.

This will be added as soon as PR #958 merges",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,964,2019-06-24T18:06:54Z,2019-06-25T22:50:06Z,2019-06-26T07:19:43Z,MERGED,True,6,6,1,https://github.com/castulo,Consistency in global options help menu,1,[],https://github.com/clearlinux/swupd-client/pull/964,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/964,"Some of the global flags require a value and some do not. However when
printing the help for these global options, there is an inconsistency in
the way we display help, some of the flags that require values show that
they do require a value but some other do not. This makes it confusing.
This commit changes the help menu so all globals that require a value
show that they require it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some of the global flags require a value and some do not. However when
printing the help for these global options, there is an inconsistency in
the way we display help, some of the flags that require values show that
they do require a value but some other do not. This makes it confusing.
This commit changes the help menu so all globals that require a value
show that they require it.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,965,2019-06-24T19:52:07Z,2019-06-25T22:50:38Z,2019-06-25T22:50:38Z,MERGED,True,14,4,2,https://github.com/castulo,Return correct code when current version unknown,1,[],https://github.com/clearlinux/swupd-client/pull/965,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/965,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,966,2019-06-24T20:04:16Z,2019-06-25T22:51:01Z,2019-06-25T22:51:01Z,MERGED,True,6,6,1,https://github.com/castulo,"Make ""clean"" help consistent with other commands",1,[],https://github.com/clearlinux/swupd-client/pull/966,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/966,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,967,2019-06-24T20:31:49Z,2019-06-25T22:51:30Z,2019-06-25T22:51:30Z,MERGED,True,26,0,3,https://github.com/castulo,Return correct code when bad path in picky-tree,1,[],https://github.com/clearlinux/swupd-client/pull/967,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/967,"When using ""diagnose --picky --picky-tree /fake/path"" swupd was exiting
with error code 34 (SWUPD_OUT_OF_MEMORY_ERROR) which was incorrect.
This commit fixes the issue by returning the correct code 29
(SWUPD_COULDNT_LIST_DIR) in those situations.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When using ""diagnose --picky --picky-tree /fake/path"" swupd was exiting
with error code 34 (SWUPD_OUT_OF_MEMORY_ERROR) which was incorrect.
This commit fixes the issue by returning the correct code 29
(SWUPD_COULDNT_LIST_DIR) in those situations.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,969,2019-06-25T01:14:47Z,2019-06-25T22:56:51Z,2019-06-25T22:56:52Z,MERGED,True,8,1,1,https://github.com/busykai,Prevent swupd from running interactive commands. ,2,[],https://github.com/clearlinux/swupd-client/pull/969,https://github.com/busykai,1,https://github.com/clearlinux/swupd-client/pull/969,"Replace stdin with /dev/null for children. This addresses the issue with
hangs when running update hooks which for whatever reason may expect
interactive input.","Replace stdin with /dev/null for children. This addresses the issue with
hangs when running update hooks which for whatever reason may expect
interactive input.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,969,2019-06-25T01:14:47Z,2019-06-25T22:56:51Z,2019-06-25T22:56:52Z,MERGED,True,8,1,1,https://github.com/busykai,Prevent swupd from running interactive commands. ,2,[],https://github.com/clearlinux/swupd-client/pull/969,https://github.com/thiagomacieira,2,https://github.com/clearlinux/swupd-client/pull/969#issuecomment-505249220,"Replace stdin with /dev/null for children. This addresses the issue with
hangs when running update hooks which for whatever reason may expect
interactive input.","May require an extra step, to disassociate with the termrinal:
    /* detach from the controlling TTY */
    tty = open(""/dev/tty"", O_RDWR | O_NOCTTY);
    if (tty != -1) {
        ioctl(tty, TIOCNOTTY);
        close(tty);
    }",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,969,2019-06-25T01:14:47Z,2019-06-25T22:56:51Z,2019-06-25T22:56:52Z,MERGED,True,8,1,1,https://github.com/busykai,Prevent swupd from running interactive commands. ,2,[],https://github.com/clearlinux/swupd-client/pull/969,https://github.com/busykai,3,https://github.com/clearlinux/swupd-client/pull/969#issuecomment-505259448,"Replace stdin with /dev/null for children. This addresses the issue with
hangs when running update hooks which for whatever reason may expect
interactive input.","May require an extra step, to disassociate with the termrinal:

I though about that, but after some testing confirmed this was enough. systemctl does not spawn any children (polkit or systemd-tty-ask-password).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,970,2019-06-26T22:13:19Z,2019-06-28T21:49:14Z,2019-07-23T16:58:12Z,MERGED,True,576,24,10,https://github.com/otaviobp,More tests to validate signature checking,5,[],https://github.com/clearlinux/swupd-client/pull/970,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/970,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,970,2019-06-26T22:13:19Z,2019-06-28T21:49:14Z,2019-07-23T16:58:12Z,MERGED,True,576,24,10,https://github.com/otaviobp,More tests to validate signature checking,5,[],https://github.com/clearlinux/swupd-client/pull/970,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/970#issuecomment-506801628,,Fixed. thanks.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,970,2019-06-26T22:13:19Z,2019-06-28T21:49:14Z,2019-07-23T16:58:12Z,MERGED,True,576,24,10,https://github.com/otaviobp,More tests to validate signature checking,5,[],https://github.com/clearlinux/swupd-client/pull/970,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/970#issuecomment-506867801,,Required changes fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,972,2019-06-27T21:58:46Z,2019-06-28T16:17:15Z,2019-06-28T16:17:15Z,MERGED,True,4,15,2,https://github.com/otaviobp,curl: Don't look at content_url and version_url on is_url_allowed() f,1,[],https://github.com/clearlinux/swupd-client/pull/972,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/972,"unction
Instead of using the globals content_url and version_url in is_url_allowed()
we could use them in the function that calls it so is_url_allowed() is more
generic.","unction
Instead of using the globals content_url and version_url in is_url_allowed()
we could use them in the function that calls it so is_url_allowed() is more
generic.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,973,2019-06-27T22:50:35Z,2019-06-27T23:24:47Z,2019-06-27T23:24:47Z,MERGED,True,4,7,2,https://github.com/castulo,Removing short option from --allow-insecure-http,1,[],https://github.com/clearlinux/swupd-client/pull/973,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/973,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,974,2019-06-28T21:26:27Z,2019-06-28T22:52:17Z,2019-07-23T16:58:13Z,MERGED,True,114,0,1,https://github.com/otaviobp,docs: Add document explaining how we do signature verification on swupd,1,[],https://github.com/clearlinux/swupd-client/pull/974,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/974,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,976,2019-07-01T20:06:11Z,2019-07-02T00:18:51Z,2019-07-02T00:18:56Z,MERGED,True,11,0,3,https://github.com/castulo,Warn user setting mirror to http,1,[],https://github.com/clearlinux/swupd-client/pull/976,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/976,"If a user sets a mirror that uses http, it is going to cause autoupdates
to stop working since autoupdate would need the --allow-insecure-http
flag to continue with the insecure connection. In order for autoupdate
to work the user will need to add the key/value allow-insecure-http=true
in the swupd config file.
This commit warns the user about this when setting up a mirror with http
so they can take steps to re-enable autoupdate.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","If a user sets a mirror that uses http, it is going to cause autoupdates
to stop working since autoupdate would need the --allow-insecure-http
flag to continue with the insecure connection. In order for autoupdate
to work the user will need to add the key/value allow-insecure-http=true
in the swupd config file.
This commit warns the user about this when setting up a mirror with http
so they can take steps to re-enable autoupdate.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,977,2019-07-01T22:04:55Z,2019-07-01T23:12:10Z,2019-07-23T16:57:58Z,MERGED,True,111,31,4,https://github.com/otaviobp,allow-insecure-http tests,3,[],https://github.com/clearlinux/swupd-client/pull/977,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/977,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,978,2019-07-01T23:02:49Z,2019-07-01T23:28:27Z,2019-07-01T23:28:27Z,MERGED,True,18,1,1,https://github.com/castulo,Wait until the config file is deleted in tests,1,[],https://github.com/clearlinux/swupd-client/pull/978,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/978,"When running tests that use the config file, it is important to make
sure the config file from the previous test is deleted before the next
test is run. This is necessary since config files are not contained to
the test environment of each test as the rest of the test resources. So
a config file from one test can affect the output of another test if we
don't wait.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running tests that use the config file, it is important to make
sure the config file from the previous test is deleted before the next
test is run. This is necessary since config files are not contained to
the test environment of each test as the rest of the test resources. So
a config file from one test can affect the output of another test if we
don't wait.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,979,2019-07-02T23:22:42Z,2019-07-08T07:25:39Z,2019-07-08T07:25:39Z,CLOSED,False,2,3,1,https://github.com/lebensterben,Fixed: Correctly show installed bundles,62,[],https://github.com/clearlinux/swupd-client/pull/979,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/979,"This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.","This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,979,2019-07-02T23:22:42Z,2019-07-08T07:25:39Z,2019-07-08T07:25:39Z,CLOSED,False,2,3,1,https://github.com/lebensterben,Fixed: Correctly show installed bundles,62,[],https://github.com/clearlinux/swupd-client/pull/979,https://github.com/lebensterben,2,https://github.com/clearlinux/swupd-client/pull/979#issuecomment-508266466,"This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.","Yes indeed the history is messed up.
How to fix this? git rebase -i  and git push --force ?
Sent with GitHawk",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,979,2019-07-02T23:22:42Z,2019-07-08T07:25:39Z,2019-07-08T07:25:39Z,CLOSED,False,2,3,1,https://github.com/lebensterben,Fixed: Correctly show installed bundles,62,[],https://github.com/clearlinux/swupd-client/pull/979,https://github.com/miguelinux,3,https://github.com/clearlinux/swupd-client/pull/979#issuecomment-508272913,"This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.","How to fix this? `git rebase -i ` and `git push --force` ?
Yes",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,979,2019-07-02T23:22:42Z,2019-07-08T07:25:39Z,2019-07-08T07:25:39Z,CLOSED,False,2,3,1,https://github.com/lebensterben,Fixed: Correctly show installed bundles,62,[],https://github.com/clearlinux/swupd-client/pull/979,https://github.com/lebensterben,4,https://github.com/clearlinux/swupd-client/pull/979#issuecomment-508292787,"This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.",Well I was struggling with git and hopefully this looks clear enough.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,979,2019-07-02T23:22:42Z,2019-07-08T07:25:39Z,2019-07-08T07:25:39Z,CLOSED,False,2,3,1,https://github.com/lebensterben,Fixed: Correctly show installed bundles,62,[],https://github.com/clearlinux/swupd-client/pull/979,https://github.com/lebensterben,5,https://github.com/clearlinux/swupd-client/pull/979#issuecomment-509111333,"This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.",I made a new Pull Request #982 whose commit history should be clean.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,980,2019-07-03T22:39:16Z,2019-07-08T20:58:25Z,2019-07-08T20:58:25Z,MERGED,True,9,12,8,https://github.com/otaviobp,Rename optional flag to also-add,2,[],https://github.com/clearlinux/swupd-client/pull/980,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/980,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,982,2019-07-08T07:24:48Z,2019-07-08T16:35:59Z,2019-07-08T16:35:59Z,MERGED,True,2,3,1,https://github.com/lebensterben,Fixed: Correctly show installed bundles,1,[],https://github.com/clearlinux/swupd-client/pull/982,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/982,"This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.","This fixed the zsh completion.
Previously some installed bundles are not shown for
swupd bundle-remove and swupd diagnose --bundles=,
it is fixed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,983,2019-07-08T18:50:00Z,2019-07-08T20:03:19Z,2019-07-08T20:03:19Z,MERGED,True,4,2,1,https://github.com/castulo,Running config file tests separatelly,1,[],https://github.com/clearlinux/swupd-client/pull/983,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/983,"Config files cannot be isolated to a test environment, they are system
wide, so those tests need to be run separatelly so they don't interfere
with other tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Config files cannot be isolated to a test environment, they are system
wide, so those tests need to be run separatelly so they don't interfere
with other tests.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,985,2019-07-10T20:08:34Z,2019-07-10T20:37:03Z,2019-07-10T20:37:03Z,MERGED,True,1,1,1,https://github.com/castulo,Fix bug in mirror-allow-http.bats test,1,[],https://github.com/clearlinux/swupd-client/pull/985,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/985,"This test is yielding different results depending on if it is being run
in a system that has a proxy set up o there is no proxy.
This is happening because when usnig a non existing  server, if
there is a proxy set up, the proxy does respond during curl
initialization instead of the specified server, which allows swupd to
initialize only to fail further down the process when requesting the MoM
to the server. If the system where the test is run doesn't have a proxy
set up, curl fails to initialize since it gets no reply from the server,
which causes swupd to fail initialization, so swupd exits earlier in the
process and with different exit code.
This commit fixes the ambiguity of the test by not checking for an exit
code explicitelly but only making sure it does get an error code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This test is yielding different results depending on if it is being run
in a system that has a proxy set up o there is no proxy.
This is happening because when usnig a non existing  server, if
there is a proxy set up, the proxy does respond during curl
initialization instead of the specified server, which allows swupd to
initialize only to fail further down the process when requesting the MoM
to the server. If the system where the test is run doesn't have a proxy
set up, curl fails to initialize since it gets no reply from the server,
which causes swupd to fail initialization, so swupd exits earlier in the
process and with different exit code.
This commit fixes the ambiguity of the test by not checking for an exit
code explicitelly but only making sure it does get an error code.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,986,2019-07-10T20:20:31Z,2019-07-10T20:22:28Z,2019-07-10T20:22:28Z,CLOSED,False,1,1,1,https://github.com/castulo,Adding unit tests to Travis,1,[],https://github.com/clearlinux/swupd-client/pull/986,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/986,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,986,2019-07-10T20:20:31Z,2019-07-10T20:22:28Z,2019-07-10T20:22:28Z,CLOSED,False,1,1,1,https://github.com/castulo,Adding unit tests to Travis,1,[],https://github.com/clearlinux/swupd-client/pull/986,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/986#issuecomment-510214242,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,"I just realized that we are already running this in Travis, I missed it. I'm closing this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,987,2019-07-11T22:57:52Z,2019-07-12T22:44:26Z,2019-07-12T22:44:26Z,MERGED,True,280,2,8,https://github.com/otaviobp,"also-add: Update, diagnose and repair shoudn't consider the also-add ",1,[],https://github.com/clearlinux/swupd-client/pull/987,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/987,"bundles
In the case that we have a bundle installed as also-add and removed later,
repair shouldn't reinstall that bundle. The same is valid for diagnose and update.
Os-install is the only exception. We should always install all bundles that are
listed as also-add in os-install.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","bundles
In the case that we have a bundle installed as also-add and removed later,
repair shouldn't reinstall that bundle. The same is valid for diagnose and update.
Os-install is the only exception. We should always install all bundles that are
listed as also-add in os-install.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,987,2019-07-11T22:57:52Z,2019-07-12T22:44:26Z,2019-07-12T22:44:26Z,MERGED,True,280,2,8,https://github.com/otaviobp,"also-add: Update, diagnose and repair shoudn't consider the also-add ",1,[],https://github.com/clearlinux/swupd-client/pull/987,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/987#issuecomment-511037899,"bundles
In the case that we have a bundle installed as also-add and removed later,
repair shouldn't reinstall that bundle. The same is valid for diagnose and update.
Os-install is the only exception. We should always install all bundles that are
listed as also-add in os-install.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Sent new versions with updated changes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,988,2019-07-12T00:16:36Z,2019-07-12T21:28:06Z,2019-07-12T21:47:12Z,MERGED,True,210,24,8,https://github.com/castulo,Adding flag validation to the swupd build process,2,[],https://github.com/clearlinux/swupd-client/pull/988,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/988,"swupd supports global flags and supports local flags that are specific
to subcommands. Flags that are specific to subcommands can be reused in
a different subcommand. Global flags should be unique and should not be
reused as local flags to avoid conflicts.
This commit adds a bash script that checks that the flags currently used
in swupd are valid (have no conflicts with other flags from the same
command or with the global flags). This script will be run as part of
the build process so in case an invalid flag is found the build will be
stopped. Alternatively, the script can be used by developers to validate
a new flag during the implementation time.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","swupd supports global flags and supports local flags that are specific
to subcommands. Flags that are specific to subcommands can be reused in
a different subcommand. Global flags should be unique and should not be
reused as local flags to avoid conflicts.
This commit adds a bash script that checks that the flags currently used
in swupd are valid (have no conflicts with other flags from the same
command or with the global flags). This script will be run as part of
the build process so in case an invalid flag is found the build will be
stopped. Alternatively, the script can be used by developers to validate
a new flag during the implementation time.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,989,2019-07-12T17:35:11Z,2019-07-12T18:17:14Z,2019-07-12T18:17:15Z,MERGED,True,1,1,1,https://github.com/otaviobp,test: Add missing NULL parameter to run_command() call,1,[],https://github.com/clearlinux/swupd-client/pull/989,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/989,"Last parameter was missing on a run_command() call and tests were breaking for some specific configurations.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Last parameter was missing on a run_command() call and tests were breaking for some specific configurations.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,990,2019-07-12T19:41:16Z,2019-07-12T21:24:17Z,2019-07-12T21:24:17Z,CLOSED,False,32,14,5,https://github.com/otaviobp,This is suppose to break the build,2,[],https://github.com/clearlinux/swupd-client/pull/990,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/990,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,991,2019-07-12T21:25:08Z,2019-07-12T23:32:20Z,2019-07-23T16:57:57Z,MERGED,True,30,14,3,https://github.com/otaviobp,test: Shellcheck tests should return an error on fails,1,[],https://github.com/clearlinux/swupd-client/pull/991,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/991,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,992,2019-07-12T22:22:11Z,2019-07-15T18:44:25Z,2019-07-23T16:57:56Z,MERGED,True,38,2,7,https://github.com/otaviobp, autoupdate: Don't report progress on autoupdate ,2,[],https://github.com/clearlinux/swupd-client/pull/992,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/992,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,992,2019-07-12T22:22:11Z,2019-07-15T18:44:25Z,2019-07-23T16:57:56Z,MERGED,True,38,2,7,https://github.com/otaviobp, autoupdate: Don't report progress on autoupdate ,2,[],https://github.com/clearlinux/swupd-client/pull/992,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/992#issuecomment-511502108,,Fixed reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,993,2019-07-13T22:13:13Z,2019-07-15T22:45:28Z,2019-07-17T23:52:13Z,MERGED,True,4,4,1,https://github.com/lebensterben,Updated swupd.zsh to reflect changes,2,[],https://github.com/clearlinux/swupd-client/pull/993,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/993,"zsh-completion updated in accordance to
10bc311","zsh-completion updated in accordance to
10bc311",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,993,2019-07-13T22:13:13Z,2019-07-15T22:45:28Z,2019-07-17T23:52:13Z,MERGED,True,4,4,1,https://github.com/lebensterben,Updated swupd.zsh to reflect changes,2,[],https://github.com/clearlinux/swupd-client/pull/993,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/993#issuecomment-511476405,"zsh-completion updated in accordance to
10bc311","Thanks and sorry for forgetting to update those.
@castulo Can you check if the flags are correct?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,993,2019-07-13T22:13:13Z,2019-07-15T22:45:28Z,2019-07-17T23:52:13Z,MERGED,True,4,4,1,https://github.com/lebensterben,Updated swupd.zsh to reflect changes,2,[],https://github.com/clearlinux/swupd-client/pull/993,https://github.com/lebensterben,3,https://github.com/clearlinux/swupd-client/pull/993#issuecomment-511535978,"zsh-completion updated in accordance to
10bc311","I found some other changes I need to make.
For example in one of the commit swupd bundle add has a new option to ignore optional package.
So please hold on and I will get this done later today.
Sent with GitHawk",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,993,2019-07-13T22:13:13Z,2019-07-15T22:45:28Z,2019-07-17T23:52:13Z,MERGED,True,4,4,1,https://github.com/lebensterben,Updated swupd.zsh to reflect changes,2,[],https://github.com/clearlinux/swupd-client/pull/993,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/993#issuecomment-511550263,"zsh-completion updated in accordance to
10bc311","I found some other changes I need to make.
For example in one of the commit swupd bundle add has a new option to ignore optional package.
So please hold on and I will get this done later today.
Sent with GitHawk

yes, also another PR just merged today too that adds a global option called --no-progress",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,994,2019-07-15T21:34:01Z,2019-07-16T00:24:13Z,2019-07-23T16:57:53Z,MERGED,True,37,26,5,https://github.com/otaviobp,bundle: Support circular includes/also-adds,2,[],https://github.com/clearlinux/swupd-client/pull/994,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/994,"Circular includes shoudn't exist, but we can handle that without crashing.
Also-add circular includes are common and expected. So we just add the
first occurence found.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Circular includes shoudn't exist, but we can handle that without crashing.
Also-add circular includes are common and expected. So we just add the
first occurence found.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,995,2019-07-15T22:05:59Z,2019-07-15T23:23:51Z,2019-07-23T16:57:55Z,MERGED,True,31,36,8,https://github.com/otaviobp,Flags,5,[],https://github.com/clearlinux/swupd-client/pull/995,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/995,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,996,2019-07-15T23:00:21Z,2019-07-16T00:42:40Z,2019-07-23T16:57:52Z,MERGED,True,4,10,1,https://github.com/otaviobp,global: Don't check for result of void functions,1,[],https://github.com/clearlinux/swupd-client/pull/996,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/996,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1000,2019-07-16T19:02:53Z,2019-07-17T21:24:03Z,2019-07-25T17:45:57Z,MERGED,True,13,2,3,https://github.com/castulo,Progress overlap,2,[],https://github.com/clearlinux/swupd-client/pull/1000,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1000,"Fix format of do_staging when reporting progress
The function do_staging is regularly used within a loop to stage all the files for a given bundle-add or update, repair, etc. However when the loop contains a progress report (with a percentage), if there are errors in the do_staging function, they get printed in the same line as the percentage, messing up the output. Like this:
...22%Warning: Update target directory does not exist: some_file...

This commit fixes that output by adding a carriage return at the beginning of each message do_staging could print so it would overlap with the percentage value effectively deleting it.","Fix format of do_staging when reporting progress
The function do_staging is regularly used within a loop to stage all the files for a given bundle-add or update, repair, etc. However when the loop contains a progress report (with a percentage), if there are errors in the do_staging function, they get printed in the same line as the percentage, messing up the output. Like this:
...22%Warning: Update target directory does not exist: some_file...

This commit fixes that output by adding a carriage return at the beginning of each message do_staging could print so it would overlap with the percentage value effectively deleting it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1000,2019-07-16T19:02:53Z,2019-07-17T21:24:03Z,2019-07-25T17:45:57Z,MERGED,True,13,2,3,https://github.com/castulo,Progress overlap,2,[],https://github.com/clearlinux/swupd-client/pull/1000,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1000#issuecomment-512504861,"Fix format of do_staging when reporting progress
The function do_staging is regularly used within a loop to stage all the files for a given bundle-add or update, repair, etc. However when the loop contains a progress report (with a percentage), if there are errors in the do_staging function, they get printed in the same line as the percentage, messing up the output. Like this:
...22%Warning: Update target directory does not exist: some_file...

This commit fixes that output by adding a carriage return at the beginning of each message do_staging could print so it would overlap with the percentage value effectively deleting it.","A suggestion on how to fix the \r problem when redirecting to a file.
Instead of adding the \r to the start of functions that are printed during progress we could always print a \r at the end of the progress report. So if a new message is printed it will print over the progress bar. In that funciton we have information if it is a file or tty, so we can prevent printing \r if it is a file.

That is a good idea",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1001,2019-07-16T20:41:28Z,2019-07-16T21:39:38Z,2019-07-16T21:39:38Z,MERGED,True,11,0,2,https://github.com/otaviobp,Config: Improvements in swupd -v,2,[],https://github.com/clearlinux/swupd-client/pull/1001,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1001,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1002,2019-07-16T22:59:55Z,2019-07-17T16:04:38Z,2019-07-17T16:04:38Z,MERGED,True,1,1,1,https://github.com/jwakre,Use lowercase URL comparison for is_url_allowed(),1,[],https://github.com/clearlinux/swupd-client/pull/1002,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/1002,"The URL value must be set to lowercase to prevent support for mixed case
or uppercase HTTP strings without the --allow-insecure-http flag.
Signed-off-by: John Akre john.w.akre@intel.com","The URL value must be set to lowercase to prevent support for mixed case
or uppercase HTTP strings without the --allow-insecure-http flag.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1003,2019-07-17T00:19:00Z,2019-07-17T17:50:19Z,2019-07-17T17:50:34Z,MERGED,True,23,6,9,https://github.com/castulo,Adding --wait-for-scripts flag,1,[],https://github.com/clearlinux/swupd-client/pull/1003,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1003,"When running tasks that require to run post update scripts in swupd,
for most users we don't want to wait for the scripts to finish running,
those can be run in the background so we can finish the task faster.
However for some users like DevOps, clr-installer, and QA, it is useful
to have a way to instruct swupd to wait until these scripts have finish
running.
This commit adds a way of doing this by introducing the
--wait-for-scripts flag.
Closes #909
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running tasks that require to run post update scripts in swupd,
for most users we don't want to wait for the scripts to finish running,
those can be run in the background so we can finish the task faster.
However for some users like DevOps, clr-installer, and QA, it is useful
to have a way to instruct swupd to wait until these scripts have finish
running.
This commit adds a way of doing this by introducing the
--wait-for-scripts flag.
Closes #909
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1004,2019-07-17T03:56:06Z,2019-07-17T21:16:58Z,2019-07-17T21:16:58Z,MERGED,True,323,389,56,https://github.com/otaviobp,Config - Cleanup,10,[],https://github.com/clearlinux/swupd-client/pull/1004,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1004,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1004,2019-07-17T03:56:06Z,2019-07-17T21:16:58Z,2019-07-17T21:16:58Z,MERGED,True,323,389,56,https://github.com/otaviobp,Config - Cleanup,10,[],https://github.com/clearlinux/swupd-client/pull/1004,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1004#issuecomment-512537838,,Sent another commit cleaning up all cases where we print '.' at the end of a line,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1004,2019-07-17T03:56:06Z,2019-07-17T21:16:58Z,2019-07-17T21:16:58Z,MERGED,True,323,389,56,https://github.com/otaviobp,Config - Cleanup,10,[],https://github.com/clearlinux/swupd-client/pull/1004,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1004#issuecomment-512553213,,fixing tests and free_string(),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1005,2019-07-17T13:57:31Z,2019-07-18T06:09:06Z,2019-07-18T06:09:06Z,CLOSED,False,14605,4828,265,https://github.com/litcoder,Display distribution information,223,[],https://github.com/clearlinux/swupd-client/pull/1005,https://github.com/litcoder,1,https://github.com/clearlinux/swupd-client/pull/1005,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1005,2019-07-17T13:57:31Z,2019-07-18T06:09:06Z,2019-07-18T06:09:06Z,CLOSED,False,14605,4828,265,https://github.com/litcoder,Display distribution information,223,[],https://github.com/clearlinux/swupd-client/pull/1005,https://github.com/litcoder,2,https://github.com/clearlinux/swupd-client/pull/1005#issuecomment-512678531,,I having a problem in removing duplicated commits. Let me close this and open a new.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1007,2019-07-17T20:42:36Z,2019-07-17T21:22:20Z,2019-07-25T17:46:15Z,MERGED,True,5,1,1,https://github.com/castulo,"Fix diagnose help for the ""-Y"" flag",1,[],https://github.com/clearlinux/swupd-client/pull/1007,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1007,"The help currently displayed for the ""-Y"" flag for the diagnose command
is not accurate since ""--fix"" should not be user, we encourage users to
use repair instead.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The help currently displayed for the ""-Y"" flag for the diagnose command
is not accurate since ""--fix"" should not be user, we encourage users to
use repair instead.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1008,2019-07-17T21:37:30Z,2019-07-19T21:18:06Z,2019-07-19T21:18:06Z,MERGED,True,256,312,12,https://github.com/otaviobp,Config - Cleanup 2,8,[],https://github.com/clearlinux/swupd-client/pull/1008,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1008,And also stopping using static variable for the config_parser () callls. With this we can use the config parser to parse the os-release file intestead of having other parser implementation on version.c,And also stopping using static variable for the config_parser () callls. With this we can use the config parser to parse the os-release file intestead of having other parser implementation on version.c,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1008,2019-07-17T21:37:30Z,2019-07-19T21:18:06Z,2019-07-19T21:18:06Z,MERGED,True,256,312,12,https://github.com/otaviobp,Config - Cleanup 2,8,[],https://github.com/clearlinux/swupd-client/pull/1008,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1008#issuecomment-513320637,And also stopping using static variable for the config_parser () callls. With this we can use the config parser to parse the os-release file intestead of having other parser implementation on version.c,Fixed the repoted problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1008,2019-07-17T21:37:30Z,2019-07-19T21:18:06Z,2019-07-19T21:18:06Z,MERGED,True,256,312,12,https://github.com/otaviobp,Config - Cleanup 2,8,[],https://github.com/clearlinux/swupd-client/pull/1008,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1008#issuecomment-513324629,And also stopping using static variable for the config_parser () callls. With this we can use the config parser to parse the os-release file intestead of having other parser implementation on version.c,Except that I'm using free instead of free_string in some cases. There was some memory leaks when using free_string. I'm going to check that to find out what's going on. But for now I'll keep using free for local variables.,True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1010,2019-07-18T01:22:51Z,2019-07-18T16:38:39Z,2019-07-19T20:20:52Z,MERGED,True,10,8,1,https://github.com/lebensterben,swupd.zsh: Multiple Changes,1,[],https://github.com/clearlinux/swupd-client/pull/1010,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1010,"Added --no-progress and --skip-optional flags
Improved on syntax, removed unecessary option exclusion rules
Changed the ordering and wording for global options for easier maintenance, see
commit aa361c7","Added --no-progress and --skip-optional flags
Improved on syntax, removed unecessary option exclusion rules
Changed the ordering and wording for global options for easier maintenance, see
commit aa361c7",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1011,2019-07-18T08:01:14Z,2019-07-19T17:32:10Z,2019-07-19T17:32:10Z,CLOSED,False,104,40,10,https://github.com/litcoder,Display distribution on swupd info,7,[],https://github.com/clearlinux/swupd-client/pull/1011,https://github.com/litcoder,1,https://github.com/clearlinux/swupd-client/pull/1011,"Display distribution information on swupd info which is from PRETTY_NAME filed
in os-release file to support distinguishable version information display
in down streams.
Signed-off-by: Brandon Hong brandon.hong@intel.com","Display distribution information on swupd info which is from PRETTY_NAME filed
in os-release file to support distinguishable version information display
in down streams.
Signed-off-by: Brandon Hong brandon.hong@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1011,2019-07-18T08:01:14Z,2019-07-19T17:32:10Z,2019-07-19T17:32:10Z,CLOSED,False,104,40,10,https://github.com/litcoder,Display distribution on swupd info,7,[],https://github.com/clearlinux/swupd-client/pull/1011,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1011#issuecomment-513012413,"Display distribution information on swupd info which is from PRETTY_NAME filed
in os-release file to support distinguishable version information display
in down streams.
Signed-off-by: Brandon Hong brandon.hong@intel.com",There was a patch that was merged that may help you when running tests too. I recommend rebasing it again,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1011,2019-07-18T08:01:14Z,2019-07-19T17:32:10Z,2019-07-19T17:32:10Z,CLOSED,False,104,40,10,https://github.com/litcoder,Display distribution on swupd info,7,[],https://github.com/clearlinux/swupd-client/pull/1011,https://github.com/litcoder,3,https://github.com/clearlinux/swupd-client/pull/1011#issuecomment-513079515,"Display distribution information on swupd info which is from PRETTY_NAME filed
in os-release file to support distinguishable version information display
in down streams.
Signed-off-by: Brandon Hong brandon.hong@intel.com","I updated some of test cases to reflect the new swupd info output however I'm still seeing some failures in usa-config-files.bats when I run local testing. Since those errors were still observed without the patch, I'm thinking this might not directly related to my patch.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1011,2019-07-18T08:01:14Z,2019-07-19T17:32:10Z,2019-07-19T17:32:10Z,CLOSED,False,104,40,10,https://github.com/litcoder,Display distribution on swupd info,7,[],https://github.com/clearlinux/swupd-client/pull/1011,https://github.com/litcoder,4,https://github.com/clearlinux/swupd-client/pull/1011#issuecomment-513085023,"Display distribution information on swupd info which is from PRETTY_NAME filed
in os-release file to support distinguishable version information display
in down streams.
Signed-off-by: Brandon Hong brandon.hong@intel.com","After the rebase, most of the issues gone but still have a issue with the test case USA010 and this still fails without the patch in my local testing.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1011,2019-07-18T08:01:14Z,2019-07-19T17:32:10Z,2019-07-19T17:32:10Z,CLOSED,False,104,40,10,https://github.com/litcoder,Display distribution on swupd info,7,[],https://github.com/clearlinux/swupd-client/pull/1011,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1011#issuecomment-513306357,"Display distribution information on swupd info which is from PRETTY_NAME filed
in os-release file to support distinguishable version information display
in down streams.
Signed-off-by: Brandon Hong brandon.hong@intel.com",merged. thanks,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1012,2019-07-18T17:53:33Z,2019-07-18T21:56:34Z,2019-07-23T16:57:50Z,MERGED,True,10,0,1,https://github.com/otaviobp,test: Don't run config file tests on developers machine,1,[],https://github.com/clearlinux/swupd-client/pull/1012,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1012,"config file tests require one special configuration on build time, so
skiping this unless we are running on travis.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","config file tests require one special configuration on build time, so
skiping this unless we are running on travis.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1013,2019-07-18T18:56:25Z,2019-07-18T22:48:25Z,2019-07-23T16:57:48Z,MERGED,True,5,8,1,https://github.com/otaviobp,config_parser: Don't allocate extra memory for key and value,1,[],https://github.com/clearlinux/swupd-client/pull/1013,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1013,"Key and value are already valid strings so we can use them without
duplicating them in memory.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Key and value are already valid strings so we can use them without
duplicating them in memory.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1014,2019-07-18T21:49:58Z,2019-07-19T17:46:22Z,2019-07-25T17:46:30Z,MERGED,True,685,278,29,https://github.com/castulo,Changes in diagnose flags: --picky and --extra-files-only,2,[],https://github.com/clearlinux/swupd-client/pull/1014,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1014,"Things in this PR:

Makes diagnose --picky a superset of diagnose. Running swupd diagnose --picky used to result in only identifying the extra files in the system, but it wouldn't run the other standard checks that a swupd diagnose would do, like checking for missing files and corrupt files. swupd diagnose --picky now does everything swupd diagnose do plus searching for the extra files.
Adds the --extra-files-only flag for diagnose and repair so there is still the option to only check or remove the extra files in a system.
The PR also refactors the verify function to simplify its workflow and remove code duplication
It also adds some validations for flags that are mutually exclusive in verify, diagnose and repair.
Minor updates to the documentation

Closes #932","Things in this PR:

Makes diagnose --picky a superset of diagnose. Running swupd diagnose --picky used to result in only identifying the extra files in the system, but it wouldn't run the other standard checks that a swupd diagnose would do, like checking for missing files and corrupt files. swupd diagnose --picky now does everything swupd diagnose do plus searching for the extra files.
Adds the --extra-files-only flag for diagnose and repair so there is still the option to only check or remove the extra files in a system.
The PR also refactors the verify function to simplify its workflow and remove code duplication
It also adds some validations for flags that are mutually exclusive in verify, diagnose and repair.
Minor updates to the documentation

Closes #932",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1015,2019-07-19T18:57:28Z,2019-07-25T17:17:25Z,2019-07-25T17:45:49Z,MERGED,True,57,25,2,https://github.com/castulo,Fix logger format when printing debug messages,1,[],https://github.com/clearlinux/swupd-client/pull/1015,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1015,"Debug messages need to be treated a little differently from other
messages, since they include more information, like the time, file and
line of code. So certain things like having carriage returns and
messages with only a line break should not be allowed since they would
mess up the debug output.
This commit fixes that issue
Closes #1009
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Debug messages need to be treated a little differently from other
messages, since they include more information, like the time, file and
line of code. So certain things like having carriage returns and
messages with only a line break should not be allowed since they would
mess up the debug output.
This commit fixes that issue
Closes #1009
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1015,2019-07-19T18:57:28Z,2019-07-25T17:17:25Z,2019-07-25T17:45:49Z,MERGED,True,57,25,2,https://github.com/castulo,Fix logger format when printing debug messages,1,[],https://github.com/clearlinux/swupd-client/pull/1015,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1015#issuecomment-513420983,"Debug messages need to be treated a little differently from other
messages, since they include more information, like the time, file and
line of code. So certain things like having carriage returns and
messages with only a line break should not be allowed since they would
mess up the debug output.
This commit fixes that issue
Closes #1009
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Fixed all the reported issues,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1015,2019-07-19T18:57:28Z,2019-07-25T17:17:25Z,2019-07-25T17:45:49Z,MERGED,True,57,25,2,https://github.com/castulo,Fix logger format when printing debug messages,1,[],https://github.com/clearlinux/swupd-client/pull/1015,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1015#issuecomment-514388400,"Debug messages need to be treated a little differently from other
messages, since they include more information, like the time, file and
line of code. So certain things like having carriage returns and
messages with only a line break should not be allowed since they would
mess up the debug output.
This commit fixes that issue
Closes #1009
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I tested the output and it looks good, with the exception of empty lines. I think we should print them in debug mode. Debug mode isn't suppose to be used unless you are debugging a problem, so it's better to have more than less.
I'm convinced that it's a good thing to handle the \r on log too.

I'll include those in debug mode then.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1015,2019-07-19T18:57:28Z,2019-07-25T17:17:25Z,2019-07-25T17:45:49Z,MERGED,True,57,25,2,https://github.com/castulo,Fix logger format when printing debug messages,1,[],https://github.com/clearlinux/swupd-client/pull/1015,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1015#issuecomment-514824045,"Debug messages need to be treated a little differently from other
messages, since they include more information, like the time, file and
line of code. So certain things like having carriage returns and
messages with only a line break should not be allowed since they would
mess up the debug output.
This commit fixes that issue
Closes #1009
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Removed the extra code I was using for testing.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1018,2019-07-19T22:49:16Z,2019-07-25T17:45:07Z,2019-07-25T17:45:07Z,MERGED,True,438,431,32,https://github.com/otaviobp,globals: Group globals functions and variables in a header file,1,[],https://github.com/clearlinux/swupd-client/pull/1018,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1018,"To make it easier to document and to read, group global related functions
and variables in an exclusive header file
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","To make it easier to document and to read, group global related functions
and variables in an exclusive header file
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1021,2019-07-22T21:19:49Z,2019-07-24T22:49:49Z,2019-07-24T22:49:49Z,MERGED,True,37,85,6,https://github.com/otaviobp,Real test: Fixing problems and adding improvements,8,[],https://github.com/clearlinux/swupd-client/pull/1021,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1021,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1022,2019-07-23T17:36:09Z,2019-07-23T20:35:23Z,2019-07-25T17:46:45Z,MERGED,True,21,3,1,https://github.com/castulo,"Parsing ""clean"" long options consistently",1,[],https://github.com/clearlinux/swupd-client/pull/1022,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1022,"This commit makes parsing the long options from the clean command
consistent with the way they are being parsed for the rest of the
swupd commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit makes parsing the long options from the clean command
consistent with the way they are being parsed for the rest of the
swupd commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1023,2019-07-23T21:38:31Z,2019-07-25T21:06:29Z,2019-07-25T21:06:29Z,MERGED,True,399,71,10,https://github.com/otaviobp,Mirror: fix bug #941,4,[],https://github.com/clearlinux/swupd-client/pull/1023,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1023,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1023,2019-07-23T21:38:31Z,2019-07-25T21:06:29Z,2019-07-25T21:06:29Z,MERGED,True,399,71,10,https://github.com/otaviobp,Mirror: fix bug #941,4,[],https://github.com/clearlinux/swupd-client/pull/1023,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1023#issuecomment-515130468,,Fixed proposed changes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1024,2019-07-24T19:56:57Z,2019-07-29T20:33:18Z,2020-05-01T06:45:04Z,MERGED,True,131,80,1,https://github.com/lebensterben,swupd.zsh: Multiple Improvement,3,[],https://github.com/clearlinux/swupd-client/pull/1024,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1024,"This should be consistent to the swupd client up to 8590464


Added bundle name completion for swupd search FOO [--deps=|--has-deps=],
Improved completion for swupd search-file [-B=|-l=].

For -B, only files in /usr/bin directory are listed
For -l, only .a or .so files under /usr/lib or /usr/lib64 are
listed


Completions for diagnose and repair are handled separtely because of
non-trivial differences in descriptions of certain options.
--quiet and --debug options of swupd hashdump are mutually exclusive
since only one of them takes effect when both are supplied.
If -p|--path= option and its argument is supplied to swupd hashdump,
completions for the non-option argument is generated by the zsh's native
_path_files function, instead of external program find. This path
completion support partial match, e.g. /u/s/z/5/f is completed to
/usr/share/zsh/5.7.1/functions. This implementation also supports relative
path and  filename expansion (~).
Improved the way how all available bundles are extracted from Manifest file,
it's about 4 times faster in my test.
For completions of bundle names, now the filtering of bundles already in the
buffers is achieved by array difference instead of for loop, which is also
considerably faster.
Multiple helper functions are combined into into three.

_swupd_installed_bundles

Arguments of swupd bundle-remove
Option arguments of swupd bundle diagnose|repair -b|--bundles=
Option arguments of swupd bundle-list -D|--deps=|--has-deps=


_swupd_all_bundles

Arguments of swupd bundle-add, with installed bundles filtered out
Option arguments of swupd os-install -b|--bundles=


_swupd_hashdump

Arguments of swupd hashdump




In an argument/option specification, if the action part calls a function,
A space is prepended so that any words following the function name is passed
to the function itself. (See man zshcompsys)
Changed the wording and ordering of certain options so they're in consistent
with help message.","This should be consistent to the swupd client up to 8590464


Added bundle name completion for swupd search FOO [--deps=|--has-deps=],
Improved completion for swupd search-file [-B=|-l=].

For -B, only files in /usr/bin directory are listed
For -l, only .a or .so files under /usr/lib or /usr/lib64 are
listed


Completions for diagnose and repair are handled separtely because of
non-trivial differences in descriptions of certain options.
--quiet and --debug options of swupd hashdump are mutually exclusive
since only one of them takes effect when both are supplied.
If -p|--path= option and its argument is supplied to swupd hashdump,
completions for the non-option argument is generated by the zsh's native
_path_files function, instead of external program find. This path
completion support partial match, e.g. /u/s/z/5/f is completed to
/usr/share/zsh/5.7.1/functions. This implementation also supports relative
path and  filename expansion (~).
Improved the way how all available bundles are extracted from Manifest file,
it's about 4 times faster in my test.
For completions of bundle names, now the filtering of bundles already in the
buffers is achieved by array difference instead of for loop, which is also
considerably faster.
Multiple helper functions are combined into into three.

_swupd_installed_bundles

Arguments of swupd bundle-remove
Option arguments of swupd bundle diagnose|repair -b|--bundles=
Option arguments of swupd bundle-list -D|--deps=|--has-deps=


_swupd_all_bundles

Arguments of swupd bundle-add, with installed bundles filtered out
Option arguments of swupd os-install -b|--bundles=


_swupd_hashdump

Arguments of swupd hashdump




In an argument/option specification, if the action part calls a function,
A space is prepended so that any words following the function name is passed
to the function itself. (See man zshcompsys)
Changed the wording and ordering of certain options so they're in consistent
with help message.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1025,2019-07-25T07:34:12Z,2019-07-25T17:23:24Z,2020-05-01T06:44:40Z,MERGED,True,1,1,1,https://github.com/lebensterben,swupd.bash: faster bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/1025,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1025,"I tried several implementation and found this is the fastest one.
#!/usr/bin/bash
MoM=/var/tmp/swupd/Manifest.MoM

start=$(date +%s%N)
sed '1,/^$/d; s/^.*\t/ /; /.*\.I\..*/d;s/\n/ /g' ""$MoM"" &> /dev/null 
end=$(date +%s%N)
echo ""Current"" ""$(expr $end - $start)""

start=$(date +%s%N)
awk '/M.../{print $4}' ""$MoM"" &> /dev/null
end=$(date +%s%N)
echo ""awk    "" ""$(expr $end - $start)""

start=$(date +%s%N)
sed -e '/M\.\.\./!d;s/.*      //' ""$MoM"" &> /dev/null
sed '/^[^M]/d;' ""$MoM"" &>/dev/null 
end=$(date +%s%N)
echo ""sed    "" ""$(expr $end - $start)""

start=$(date +%s%N)
awk '/M.../' ""$MoM"" | cut -f4 &> /dev/null
end=$(date +%s%N)
echo ""awk|cut"" ""$(expr $end - $start)""

start=$(date +%s%N)
sed '/^[^M]/d' ""$MoM"" | cut -f4 &> /dev/null
end=$(date +%s%N)
echo ""sed|cut"" ""$(expr $end - $start)""
the result is in nanoseconds
Current 4672004
awk     1934649
sed     2425911
awk|cut 1881427
sed|cut 1579226","I tried several implementation and found this is the fastest one.
#!/usr/bin/bash
MoM=/var/tmp/swupd/Manifest.MoM

start=$(date +%s%N)
sed '1,/^$/d; s/^.*\t/ /; /.*\.I\..*/d;s/\n/ /g' ""$MoM"" &> /dev/null 
end=$(date +%s%N)
echo ""Current"" ""$(expr $end - $start)""

start=$(date +%s%N)
awk '/M.../{print $4}' ""$MoM"" &> /dev/null
end=$(date +%s%N)
echo ""awk    "" ""$(expr $end - $start)""

start=$(date +%s%N)
sed -e '/M\.\.\./!d;s/.*      //' ""$MoM"" &> /dev/null
sed '/^[^M]/d;' ""$MoM"" &>/dev/null 
end=$(date +%s%N)
echo ""sed    "" ""$(expr $end - $start)""

start=$(date +%s%N)
awk '/M.../' ""$MoM"" | cut -f4 &> /dev/null
end=$(date +%s%N)
echo ""awk|cut"" ""$(expr $end - $start)""

start=$(date +%s%N)
sed '/^[^M]/d' ""$MoM"" | cut -f4 &> /dev/null
end=$(date +%s%N)
echo ""sed|cut"" ""$(expr $end - $start)""
the result is in nanoseconds
Current 4672004
awk     1934649
sed     2425911
awk|cut 1881427
sed|cut 1579226",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1027,2019-07-26T17:47:22Z,2019-07-29T22:20:58Z,2019-07-30T00:09:03Z,MERGED,True,344,309,15,https://github.com/castulo,"Changes to avoid misuse of ""swupd verify -B""",8,[],https://github.com/clearlinux/swupd-client/pull/1027,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1027,"swupd verify -B is a confusing option which is often misused by users which end up deleting system files they did not intended to. The -B option was mainly designed to work along with --install to install a Clear OS that included some bundles, but the flag was never restricted to also work with other flags like --fix or --picky. If used carefully, -B has its use case when combined with --fix or --picky, but since the option is often misunderstood it causes confusion with users which end up doing unintended actions on their system. To mitigate this problem this PR implements the following actions:

Removes the -B/--bundle option from swupd diagnose and swupd repair, so it is only available at os-install where it is safe to use it. It is also left available at verify for backward compatibility, but verify in general has been superseded and we discourage users from using verify.
Changes the verify help to try to make it clearer what the -B option is for.
Limits the use of -B within swupd verify so it can only be used along with the --fix flag (and the other flags supported with --fix).
When using -B a warning is printed explaining the possible side effects of using the -B option and the other flags used with it.
Updates the man documentation to reflect this changes.

Closes #981","swupd verify -B is a confusing option which is often misused by users which end up deleting system files they did not intended to. The -B option was mainly designed to work along with --install to install a Clear OS that included some bundles, but the flag was never restricted to also work with other flags like --fix or --picky. If used carefully, -B has its use case when combined with --fix or --picky, but since the option is often misunderstood it causes confusion with users which end up doing unintended actions on their system. To mitigate this problem this PR implements the following actions:

Removes the -B/--bundle option from swupd diagnose and swupd repair, so it is only available at os-install where it is safe to use it. It is also left available at verify for backward compatibility, but verify in general has been superseded and we discourage users from using verify.
Changes the verify help to try to make it clearer what the -B option is for.
Limits the use of -B within swupd verify so it can only be used along with the --fix flag (and the other flags supported with --fix).
When using -B a warning is printed explaining the possible side effects of using the -B option and the other flags used with it.
Updates the man documentation to reflect this changes.

Closes #981",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1027,2019-07-26T17:47:22Z,2019-07-29T22:20:58Z,2019-07-30T00:09:03Z,MERGED,True,344,309,15,https://github.com/castulo,"Changes to avoid misuse of ""swupd verify -B""",8,[],https://github.com/clearlinux/swupd-client/pull/1027,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1027#issuecomment-516172462,"swupd verify -B is a confusing option which is often misused by users which end up deleting system files they did not intended to. The -B option was mainly designed to work along with --install to install a Clear OS that included some bundles, but the flag was never restricted to also work with other flags like --fix or --picky. If used carefully, -B has its use case when combined with --fix or --picky, but since the option is often misunderstood it causes confusion with users which end up doing unintended actions on their system. To mitigate this problem this PR implements the following actions:

Removes the -B/--bundle option from swupd diagnose and swupd repair, so it is only available at os-install where it is safe to use it. It is also left available at verify for backward compatibility, but verify in general has been superseded and we discourage users from using verify.
Changes the verify help to try to make it clearer what the -B option is for.
Limits the use of -B within swupd verify so it can only be used along with the --fix flag (and the other flags supported with --fix).
When using -B a warning is printed explaining the possible side effects of using the -B option and the other flags used with it.
Updates the man documentation to reflect this changes.

Closes #981",Rebased it and fixed the conflicts,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1027,2019-07-26T17:47:22Z,2019-07-29T22:20:58Z,2019-07-30T00:09:03Z,MERGED,True,344,309,15,https://github.com/castulo,"Changes to avoid misuse of ""swupd verify -B""",8,[],https://github.com/clearlinux/swupd-client/pull/1027,https://github.com/lebensterben,3,https://github.com/clearlinux/swupd-client/pull/1027#issuecomment-516200706,"swupd verify -B is a confusing option which is often misused by users which end up deleting system files they did not intended to. The -B option was mainly designed to work along with --install to install a Clear OS that included some bundles, but the flag was never restricted to also work with other flags like --fix or --picky. If used carefully, -B has its use case when combined with --fix or --picky, but since the option is often misunderstood it causes confusion with users which end up doing unintended actions on their system. To mitigate this problem this PR implements the following actions:

Removes the -B/--bundle option from swupd diagnose and swupd repair, so it is only available at os-install where it is safe to use it. It is also left available at verify for backward compatibility, but verify in general has been superseded and we discourage users from using verify.
Changes the verify help to try to make it clearer what the -B option is for.
Limits the use of -B within swupd verify so it can only be used along with the --fix flag (and the other flags supported with --fix).
When using -B a warning is printed explaining the possible side effects of using the -B option and the other flags used with it.
Updates the man documentation to reflect this changes.

Closes #981","There's one problem if this is removed, in tutorial on installing NVDIA driver, there's a command swupd repair --quick --bundles=lib-opengl.
Since this is removed, I'd like to know whether there is any alternative methods to perform the same thing.
Sent with GitHawk",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1027,2019-07-26T17:47:22Z,2019-07-29T22:20:58Z,2019-07-30T00:09:03Z,MERGED,True,344,309,15,https://github.com/castulo,"Changes to avoid misuse of ""swupd verify -B""",8,[],https://github.com/clearlinux/swupd-client/pull/1027,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1027#issuecomment-516207967,"swupd verify -B is a confusing option which is often misused by users which end up deleting system files they did not intended to. The -B option was mainly designed to work along with --install to install a Clear OS that included some bundles, but the flag was never restricted to also work with other flags like --fix or --picky. If used carefully, -B has its use case when combined with --fix or --picky, but since the option is often misunderstood it causes confusion with users which end up doing unintended actions on their system. To mitigate this problem this PR implements the following actions:

Removes the -B/--bundle option from swupd diagnose and swupd repair, so it is only available at os-install where it is safe to use it. It is also left available at verify for backward compatibility, but verify in general has been superseded and we discourage users from using verify.
Changes the verify help to try to make it clearer what the -B option is for.
Limits the use of -B within swupd verify so it can only be used along with the --fix flag (and the other flags supported with --fix).
When using -B a warning is printed explaining the possible side effects of using the -B option and the other flags used with it.
Updates the man documentation to reflect this changes.

Closes #981",we are going to add it back to diagnose and repair as soon as we implement it in a safe way. Check #1035,True,{'THUMBS_UP': ['https://github.com/lebensterben']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1028,2019-07-26T18:07:20Z,2019-07-29T20:43:50Z,2019-07-29T20:43:50Z,MERGED,True,213,212,12,https://github.com/castulo,Fixes a bug when deleting extra files,1,[],https://github.com/clearlinux/swupd-client/pull/1028,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1028,"When swupd repair is run with --picky or --extra-files-only it attempts
to remove all those files that are in the picky tree and that are not
mentioned in any manifest (from installed bundles). If swupd
encounters an error removing any of these files or directories, it
prints a message showing the failure. This message was wrong since it
was not showing the whole path to the file being deleted when the path
included a prefix.
This commit fixes the issue by appending the prefix to the path so it
shows correctly.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When swupd repair is run with --picky or --extra-files-only it attempts
to remove all those files that are in the picky tree and that are not
mentioned in any manifest (from installed bundles). If swupd
encounters an error removing any of these files or directories, it
prints a message showing the failure. This message was wrong since it
was not showing the whole path to the file being deleted when the path
included a prefix.
This commit fixes the issue by appending the prefix to the path so it
shows correctly.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1028,2019-07-26T18:07:20Z,2019-07-29T20:43:50Z,2019-07-29T20:43:50Z,MERGED,True,213,212,12,https://github.com/castulo,Fixes a bug when deleting extra files,1,[],https://github.com/clearlinux/swupd-client/pull/1028,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1028#issuecomment-515621186,"When swupd repair is run with --picky or --extra-files-only it attempts
to remove all those files that are in the picky tree and that are not
mentioned in any manifest (from installed bundles). If swupd
encounters an error removing any of these files or directories, it
prints a message showing the failure. This message was wrong since it
was not showing the whole path to the file being deleted when the path
included a prefix.
This commit fixes the issue by appending the prefix to the path so it
shows correctly.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Fixed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1029,2019-07-26T20:44:50Z,2019-07-26T20:54:43Z,2019-09-17T16:51:27Z,CLOSED,False,46,31,3,https://github.com/otaviobp,globals: Use ifdef instead of if to check for precompiler defined const,3,[],https://github.com/clearlinux/swupd-client/pull/1029,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1029,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1030,2019-07-26T20:55:27Z,2019-07-26T22:52:58Z,2019-07-26T22:52:58Z,MERGED,True,45,31,3,https://github.com/otaviobp,fixing some random error handling errors,3,[],https://github.com/clearlinux/swupd-client/pull/1030,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1030,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1031,2019-07-26T21:40:51Z,2019-07-30T16:54:58Z,2019-07-30T16:54:58Z,MERGED,True,120,25,2,https://github.com/castulo,Multiple updates to the man pages,2,[],https://github.com/clearlinux/swupd-client/pull/1031,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1031,"This PR includes multiple updates to the man page including explanation about the config file.
Closes #1020","This PR includes multiple updates to the man page including explanation about the config file.
Closes #1020",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1032,2019-07-27T00:01:29Z,2019-07-29T20:48:41Z,2019-07-29T20:48:41Z,MERGED,True,2,2,1,https://github.com/castulo,Change to clarify the use of -l/-B in search-file,1,[],https://github.com/clearlinux/swupd-client/pull/1032,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1032,"Closes #1019
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Closes #1019
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1034,2019-07-29T18:34:58Z,2019-07-29T20:52:48Z,2019-07-29T20:52:48Z,MERGED,True,12,11,1,https://github.com/castulo,Test swupd-update.timer also for autoupdate status,1,[],https://github.com/clearlinux/swupd-client/pull/1034,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1034,"When determining if autoupdate is enabled, swupd should not only check
the status of swupd-update.service but has to check swupd-update.timer
as well.
Closes #968
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When determining if autoupdate is enabled, swupd should not only check
the status of swupd-update.service but has to check swupd-update.timer
as well.
Closes #968
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1036,2019-07-29T21:37:21Z,2019-07-29T22:04:52Z,2019-09-17T16:51:26Z,MERGED,True,1,4,1,https://github.com/otaviobp,Makefile: Clean manpages only on distclean,1,[],https://github.com/clearlinux/swupd-client/pull/1036,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1036,"Manpages are created in make dist so we should clean them only on distclean.
For example if you run:
$ make dist
$ tar xf swupd-client-version.tar.gz && cd swupd-client
$ make clean
All manpages are going to be deleted and the source files aren't available on
the tarball. So you are going to be blocked in a build.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Manpages are created in make dist so we should clean them only on distclean.
For example if you run:
$ make dist
$ tar xf swupd-client-version.tar.gz && cd swupd-client
$ make clean
All manpages are going to be deleted and the source files aren't available on
the tarball. So you are going to be blocked in a build.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1037,2019-07-30T16:55:55Z,2019-08-02T23:29:33Z,2019-09-17T16:51:23Z,MERGED,True,99,56,12,https://github.com/otaviobp,Some random error checking fixes,11,[],https://github.com/clearlinux/swupd-client/pull/1037,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1037,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1038,2019-07-31T18:49:31Z,2019-07-31T19:16:14Z,2019-09-17T16:51:25Z,MERGED,True,1,1,1,https://github.com/otaviobp,sys: Add NULL on run_command() call,1,[],https://github.com/clearlinux/swupd-client/pull/1038,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1038,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1039,2019-08-01T20:33:30Z,2019-08-01T20:36:48Z,2019-08-01T20:36:49Z,MERGED,True,2,1,1,https://github.com/otaviobp,"real_tests: repair doesn't support -B anymore, so use verify --fix",1,[],https://github.com/clearlinux/swupd-client/pull/1039,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1039,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1040,2019-08-01T21:08:05Z,2019-08-01T22:11:59Z,2019-09-17T16:51:24Z,MERGED,True,1,1,1,https://github.com/otaviobp,mirror: Removing invalid ! in check connection,1,[],https://github.com/clearlinux/swupd-client/pull/1040,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1040,"check_connection() returns an int. We shouldn't use ! before comparing it to zero.
If check_connection() return is zero it's a success.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","check_connection() returns an int. We shouldn't use ! before comparing it to zero.
If check_connection() return is zero it's a success.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1041,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035","The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-519622198,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035",@otaviobp I figured out a way of avoiding printing the double warning without muting the log. It should be fine now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-521397346,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035","I also found a memory leak when I run:
$ swupd clean
$ swupd repair -B vim",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-523164238,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035",WIP,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-523246806,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035","@otaviobp this is still a WIP, I'm going to modify the sanitize_files so it filters files from all_files instead of creating a new list.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-531335629,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035","I merged one commit ""Don't allow --fix or --install with diagnose"" that is independent from other commits and it was good to go",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-533300059,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035",@otaviobp here is a new update. It is ready to be reviewed again.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1041,2019-08-01T23:13:21Z,2019-09-20T22:26:52Z,2019-09-20T22:26:52Z,MERGED,True,753,132,21,https://github.com/castulo,Enabling --bundles for diagnose and repair,9,[],https://github.com/clearlinux/swupd-client/pull/1041,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1041#issuecomment-533718688,"The PR addresses the following things:

This PR enables the -B / --bundles option to diagnose or repair only the specified list of bundles in a safe way.
When using --bundles and a file is being marked as deleted for one of the specified bundles, it makes sure it is not needed by any of the other installed bundles before deleting it.
Disallow the use of --bundles together with --picky or --extra-files-only for diagnose or repair. That combination of options is only allowed for verify for backward compatibility.

Closes #1035","nice! looks good now

Finally! ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1042,2019-08-02T19:57:53Z,2019-08-02T21:17:20Z,2019-08-02T21:17:21Z,MERGED,True,4,2,3,https://github.com/castulo,Fixing a bug using ignore-ilst files in tests,1,[],https://github.com/clearlinux/swupd-client/pull/1042,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1042,"When using testlib to create tests, ignore lists can be used which
include lines of output that should be ignored when running tests.
The ignore lists can exist at three different levels:

an ignore file that applies to all tests
an ignore file that applies to all files of one theme
an ignore file that applies to all tests within the same file

There was a bug in this last one that was causing ignore-list files to
be unrecognized unless the test number was also used as part of the
ignore-list name. This was causing issues because the test number
can change depending on how you run the test.
This commit fixes the issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When using testlib to create tests, ignore lists can be used which
include lines of output that should be ignored when running tests.
The ignore lists can exist at three different levels:

an ignore file that applies to all tests
an ignore file that applies to all files of one theme
an ignore file that applies to all tests within the same file

There was a bug in this last one that was causing ignore-list files to
be unrecognized unless the test number was also used as part of the
ignore-list name. This was causing issues because the test number
can change depending on how you run the test.
This commit fixes the issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1042,2019-08-02T19:57:53Z,2019-08-02T21:17:20Z,2019-08-02T21:17:21Z,MERGED,True,4,2,3,https://github.com/castulo,Fixing a bug using ignore-ilst files in tests,1,[],https://github.com/clearlinux/swupd-client/pull/1042,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1042#issuecomment-517838579,"When using testlib to create tests, ignore lists can be used which
include lines of output that should be ignored when running tests.
The ignore lists can exist at three different levels:

an ignore file that applies to all tests
an ignore file that applies to all files of one theme
an ignore file that applies to all tests within the same file

There was a bug in this last one that was causing ignore-list files to
be unrecognized unless the test number was also used as part of the
ignore-list name. This was causing issues because the test number
can change depending on how you run the test.
This commit fixes the issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Ups, I forgot to update one test. Updated it now.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1045,2019-08-05T16:50:48Z,2019-08-05T23:10:03Z,2019-09-17T16:51:22Z,MERGED,True,7,7,3,https://github.com/otaviobp,log: Print download sizes in MB and not Mb,1,[],https://github.com/clearlinux/swupd-client/pull/1045,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1045,"MB stands for Megabyte and Mb stands for Megabit, so use the correct
unit.
Fixes #1044
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","MB stands for Megabyte and Mb stands for Megabit, so use the correct
unit.
Fixes #1044
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1046,2019-08-05T17:32:35Z,2019-08-07T21:12:36Z,2019-08-07T21:12:36Z,MERGED,True,80,3,10,https://github.com/jwakre,os-install: Add download flag,2,[],https://github.com/clearlinux/swupd-client/pull/1046,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/1046,"When the --download flag is set for the os-install command, update
content will be downloaded to the statedir and no content will be
installed.
Signed-off-by: John Akre john.w.akre@intel.com","When the --download flag is set for the os-install command, update
content will be downloaded to the statedir and no content will be
installed.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1046,2019-08-05T17:32:35Z,2019-08-07T21:12:36Z,2019-08-07T21:12:36Z,MERGED,True,80,3,10,https://github.com/jwakre,os-install: Add download flag,2,[],https://github.com/clearlinux/swupd-client/pull/1046,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/1046#issuecomment-518353722,"When the --download flag is set for the os-install command, update
content will be downloaded to the statedir and no content will be
installed.
Signed-off-by: John Akre john.w.akre@intel.com","This change adds the support for the download feature described in #1017. I only need the --download flag for the os-install command, so I decided not to add this flag to verify. If it is desirable to add --download to verify, I can update the PR.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1046,2019-08-05T17:32:35Z,2019-08-07T21:12:36Z,2019-08-07T21:12:36Z,MERGED,True,80,3,10,https://github.com/jwakre,os-install: Add download flag,2,[],https://github.com/clearlinux/swupd-client/pull/1046,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1046#issuecomment-518448541,"When the --download flag is set for the os-install command, update
content will be downloaded to the statedir and no content will be
installed.
Signed-off-by: John Akre john.w.akre@intel.com","This change adds the support for the download feature described in #1017. I only need the --download flag for the os-install command, so I decided not to add this flag to verify. If it is desirable to add --download to verify, I can update the PR.

+1 for only adding this to os-install, it is not really needed for any other command, so there is no point on adding it, it would just cause confusion.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1046,2019-08-05T17:32:35Z,2019-08-07T21:12:36Z,2019-08-07T21:12:36Z,MERGED,True,80,3,10,https://github.com/jwakre,os-install: Add download flag,2,[],https://github.com/clearlinux/swupd-client/pull/1046,https://github.com/jwakre,4,https://github.com/clearlinux/swupd-client/pull/1046#issuecomment-519215571,"When the --download flag is set for the os-install command, update
content will be downloaded to the statedir and no content will be
installed.
Signed-off-by: John Akre john.w.akre@intel.com","@castulo I added bash/zsh completions, a config entry, and updated the print messages.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1047,2019-08-05T20:08:26Z,2019-08-07T16:43:42Z,2019-08-07T16:43:42Z,MERGED,True,2,2,2,https://github.com/castulo,Fixing message when using repair and --picky,1,[],https://github.com/clearlinux/swupd-client/pull/1047,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1047,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1048,2019-08-06T23:50:17Z,2019-08-07T16:42:52Z,2019-08-07T16:42:52Z,MERGED,True,0,1,1,https://github.com/castulo,Removing unused assignment to variable,1,[],https://github.com/clearlinux/swupd-client/pull/1048,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1048,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1049,2019-08-07T19:37:46Z,2019-08-07T22:52:05Z,2019-08-07T22:52:05Z,MERGED,True,55,53,12,https://github.com/castulo,Multiple configuration files,3,[],https://github.com/clearlinux/swupd-client/pull/1049,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1049,Enable the ability to provide many paths for the configuration file and read configuration from all of them. If the same option is defined in more than one configuration file it will just be overwritten by the one last read.,Enable the ability to provide many paths for the configuration file and read configuration from all of them. If the same option is defined in more than one configuration file it will just be overwritten by the one last read.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1049,2019-08-07T19:37:46Z,2019-08-07T22:52:05Z,2019-08-07T22:52:05Z,MERGED,True,55,53,12,https://github.com/castulo,Multiple configuration files,3,[],https://github.com/clearlinux/swupd-client/pull/1049,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1049#issuecomment-519277482,Enable the ability to provide many paths for the configuration file and read configuration from all of them. If the same option is defined in more than one configuration file it will just be overwritten by the one last read.,@otaviobp I addressed your comments,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1049,2019-08-07T19:37:46Z,2019-08-07T22:52:05Z,2019-08-07T22:52:05Z,MERGED,True,55,53,12,https://github.com/castulo,Multiple configuration files,3,[],https://github.com/clearlinux/swupd-client/pull/1049,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1049#issuecomment-519278858,Enable the ability to provide many paths for the configuration file and read configuration from all of them. If the same option is defined in more than one configuration file it will just be overwritten by the one last read.,"The continue is still in the code. And I noticed now that you are overloading the config_found variable so if there's no /etc/swupd/config we will print ""No configuration file was found"".
Actually I would get rid of the print, but if you want that we need to return the correct value on config_found.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1049,2019-08-07T19:37:46Z,2019-08-07T22:52:05Z,2019-08-07T22:52:05Z,MERGED,True,55,53,12,https://github.com/castulo,Multiple configuration files,3,[],https://github.com/clearlinux/swupd-client/pull/1049,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1049#issuecomment-519281389,Enable the ability to provide many paths for the configuration file and read configuration from all of them. If the same option is defined in more than one configuration file it will just be overwritten by the one last read.,"The continue is still in the code

haha ups, forgot to remove the continue

And I noticed now that you are overloading the config_found variable so if there's no /etc/swupd/config we will print ""No configuration file was found"".

You are right",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1050,2019-08-07T21:29:44Z,2019-08-07T22:51:11Z,2019-08-07T22:51:11Z,MERGED,True,0,3,1,https://github.com/otaviobp,test: Don't check the hashes twice on real tests,1,[],https://github.com/clearlinux/swupd-client/pull/1050,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1050,"Diagnose picky behavior has changed so now we can use just one call
to swupd to verify if there's no extra file and no corruption.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Diagnose picky behavior has changed so now we can use just one call
to swupd to verify if there's no extra file and no corruption.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1052,2019-08-07T22:00:01Z,2019-08-07T22:50:54Z,2019-09-17T16:51:22Z,MERGED,True,11,4,1,https://github.com/otaviobp,"globals: If path_prefix doens't exist, creates it",1,[],https://github.com/clearlinux/swupd-client/pull/1052,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1052,"This is very handy for testing because we can just run:
$ swupd os-install --path testing/
And the testing/ directory will be automatically created. It's the same
behavior we have for the state dir.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","This is very handy for testing because we can just run:
$ swupd os-install --path testing/
And the testing/ directory will be automatically created. It's the same
behavior we have for the state dir.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1053,2019-08-07T23:28:13Z,2019-08-14T20:41:05Z,2019-09-17T16:51:20Z,CLOSED,False,123,41,15,https://github.com/otaviobp,update: Download search-files indexes on update,3,[],https://github.com/clearlinux/swupd-client/pull/1053,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1053,"If --update-search-file-index flag is used on update, all search-file indexes, i.e.
all Manifests will be downloaded on update. This shouldn't be used if you have
disk or network restrictions, but it shouldn't be very download intensive after the
first usage because delta manifests are going to be used.","If --update-search-file-index flag is used on update, all search-file indexes, i.e.
all Manifests will be downloaded on update. This shouldn't be used if you have
disk or network restrictions, but it shouldn't be very download intensive after the
first usage because delta manifests are going to be used.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1055,2019-08-08T21:49:52Z,2019-08-14T21:31:34Z,2019-09-20T22:28:15Z,MERGED,True,91,25,8,https://github.com/castulo,Show the real latest version using check-update,2,[],https://github.com/clearlinux/swupd-client/pull/1055,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1055,"When running the check-update command we get the latest version for the
format we are currently in, but we really want to get the latest version
regardless of the format.
This commit fixes the issue.
Closes #482
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running the check-update command we get the latest version for the
format we are currently in, but we really want to get the latest version
regardless of the format.
This commit fixes the issue.
Closes #482
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1056,2019-08-08T22:44:35Z,2019-08-29T21:04:49Z,2019-08-29T21:04:49Z,CLOSED,False,7,2,1,https://github.com/castulo,Don't check network when listing bundles locally,1,[],https://github.com/clearlinux/swupd-client/pull/1056,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1056,"When listing local bundles swupd doesn't really require network to
list them, it only requires it to report which of those local bundles are
experimental.
This commit allows users to run the command to list local bundles
without checking for network connectivity.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When listing local bundles swupd doesn't really require network to
list them, it only requires it to report which of those local bundles are
experimental.
This commit allows users to run the command to list local bundles
without checking for network connectivity.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1056,2019-08-08T22:44:35Z,2019-08-29T21:04:49Z,2019-08-29T21:04:49Z,CLOSED,False,7,2,1,https://github.com/castulo,Don't check network when listing bundles locally,1,[],https://github.com/clearlinux/swupd-client/pull/1056,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1056#issuecomment-523170554,"When listing local bundles swupd doesn't really require network to
list them, it only requires it to report which of those local bundles are
experimental.
This commit allows users to run the command to list local bundles
without checking for network connectivity.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some changes on curl reinit were made and this PR will need to be reworked.
Now we don't initialize curl on init. We just need to make sure we will fail fast when there's no network",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1056,2019-08-08T22:44:35Z,2019-08-29T21:04:49Z,2019-08-29T21:04:49Z,CLOSED,False,7,2,1,https://github.com/castulo,Don't check network when listing bundles locally,1,[],https://github.com/clearlinux/swupd-client/pull/1056,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1056#issuecomment-526361119,"When listing local bundles swupd doesn't really require network to
list them, it only requires it to report which of those local bundles are
experimental.
This commit allows users to run the command to list local bundles
without checking for network connectivity.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Since there were many changes in the curl code, I think is best to close this PR and submit a new one.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1057,2019-08-09T17:57:43Z,2019-08-12T21:38:35Z,2019-08-12T21:38:35Z,MERGED,True,83,12,4,https://github.com/jwakre,bundle.c: Return included manifest loading errors,1,[],https://github.com/clearlinux/swupd-client/pull/1057,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/1057,"Previously, errors when adding included manifests were thrown away which
resulted in swupd operations that could succeed, even when failing to
load an included manifest. Now when an included manifest fails to load,
swupd will return a failure.
Signed-off-by: John Akre john.w.akre@intel.com","Previously, errors when adding included manifests were thrown away which
resulted in swupd operations that could succeed, even when failing to
load an included manifest. Now when an included manifest fails to load,
swupd will return a failure.
Signed-off-by: John Akre john.w.akre@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1058,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-520038651,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",This PR is part 1 of 2 to fix issue #891 but it is still a work in progress,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-531382577,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Merged commit: ""Always print ""Removing bundle"" when removing""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-531390643,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I reverted that actually. I didn't noticed that the tests were not fixed in the same commit,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-533738661,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This is still no ready to be reviewed again, it needs a couple more changes based on review feedback",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-534731518,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Ready for review again, the PR went through a major refactor",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-535106138,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","But I noticed that this function is way slower when I ask it to remove only bundles that can't be removed.

Removing multiple valid bundles is now way faster.
With master:
$ time sudo ./swupd bundle-remove ansible blender xterm
Removing bundle: ansible
Deleting bundle files...
Total deleted files: 9490
Removing bundle: blender
Deleting bundle files...
Total deleted files: 2083
Removing bundle: xterm
Deleting bundle files...
Total deleted files: 36
Successfully removed 3 bundles

real	0m10.684s
user	0m10.134s
sys	0m0.493s

With this PR:
$ time sudo ./swupd bundle-remove ansible blender xterm

Removing bundle: ansible

Removing bundle: blender

Removing bundle: xterm

Deleting bundle files...
	...100%
Total deleted files: 12120

Successfully removed 3 bundles

real	0m3.856s
user	0m3.496s
sys	0m0.319s

So it took about 1/3 of the time than the previous implementation.
When testing it with bundles that cannot be removed (due to dependencies), in my test I still saw a very slight time improvement with this PR:
With master:
$ time sudo ./swupd bundle-remove python3-basic c-basic
...
...
real	0m4.739s
user	0m4.316s
sys	0m0.414s

With PR:
real	0m4.688s
user	0m4.431s
sys	0m0.247s

The only case where I saw the performance worsen was when only using invalid bundle names:
With master:
$ time sudo ./swupd bundle-remove fake1 fake2 fake3 fake4
Warning: Bundle ""fake1"" is not installed, skipping it...
Warning: Bundle ""fake2"" is not installed, skipping it...
Warning: Bundle ""fake3"" is not installed, skipping it...
Warning: Bundle ""fake4"" is not installed, skipping it...
Failed to remove 4 of 4 bundles

real	0m0.014s
user	0m0.009s
sys	0m0.006s

With PR:
$ time sudo ./swupd bundle-remove fake1 fake2 fake3 fake4

Warning: Bundle ""fake1"" is invalid, skipping it...

Warning: Bundle ""fake2"" is invalid, skipping it...

Warning: Bundle ""fake3"" is invalid, skipping it...

Warning: Bundle ""fake4"" is invalid, skipping it...

Failed to remove 4 of 4 bundles

real	0m3.709s
user	0m3.438s
sys	0m0.263s

This is because I switched the order of the checks with do with the provided bundles. In the original code we first check to see if the bundle is installed in the system, if it is not we skip it. In the submitted code it first checks to see if the bundle is valid (is in the MoM). Looking for a tracking file is faster than looking through the MoM, but the new implementation has the advantage that now the message we show is more accurate. In master if you enter an invalid bundle, it will tell you the bundle is not installed (which may be misleading). And besides that, the only moment you will see the performance worsen is if the user enters a bunch of invalid bundles in the same command, which is highly unlikely.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/otaviobp,8,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-535111098,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Removing multiple valid bundles is now way faster.

This is really really nice. Can you gather some data on that so we can add this info in next release notes? Removing one bundle and a list of big bundles to compare the time spent on remove operation and check how much in % we are better",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-535112838,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","$ time sudo ./swupd bundle-remove python3-basic c-basic
...
...
real	0m4.739s
user	0m4.316s
sys	0m0.414s

This is very very slow. Are you running that with libasan or in a slow machine? if so, can you test it with default CL CFlags?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,10,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-535116215,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","$ time sudo ./swupd bundle-remove python3-basic c-basic
...
...
real	0m4.739s
user	0m4.316s
sys	0m0.414s

This is very very slow. Are you running that with libasan or in a slow machine? if so, can you test it with default CL CFlags?

yeah I'm using libasan, I can test with default CFlags. Bu I'll take a look at your suggestion about not consolidating files from bundles if there is nothing to install. ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,11,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-535229401,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I tested removing 20 bundles and the time was improved by almost 90%.
Released swupd:
$ time sudo swupd bundle-remove -p target1 -S state1 ansible blender xterm automotive-tools cassandra cockpit django games kamera jupyter krita nginx openqa productivity vnc-server xscreensaver desktop wireshark vinagre unison
Removing bundle: ansible
Deleting bundle files...
Total deleted files: 9490
Removing bundle: blender
Deleting bundle files...
Total deleted files: 2070
Removing bundle: xterm
Deleting bundle files...
Total deleted files: 34
Removing bundle: automotive-tools
Deleting bundle files...
Total deleted files: 29
Removing bundle: cassandra
Deleting bundle files...
Total deleted files: 252
Removing bundle: cockpit
Deleting bundle files...
Total deleted files: 1057
Removing bundle: django
Deleting bundle files...
Total deleted files: 728
Removing bundle: games
Deleting bundle files...
Total deleted files: 1056
Removing bundle: kamera
Deleting bundle files...
Total deleted files: 89
Removing bundle: jupyter
Deleting bundle files...
Total deleted files: 4426
Removing bundle: krita
Deleting bundle files...
Total deleted files: 1191
Removing bundle: nginx
Deleting bundle files...
Total deleted files: 26
Removing bundle: openqa
Deleting bundle files...
Total deleted files: 1417
Removing bundle: productivity
Deleting bundle files...
Total deleted files: 333
Removing bundle: vnc-server
Deleting bundle files...
Total deleted files: 1
Removing bundle: xscreensaver
Deleting bundle files...
Total deleted files: 180
Removing bundle: desktop
Deleting bundle files...
Total deleted files: 21273
Removing bundle: wireshark
Deleting bundle files...
Total deleted files: 419
Removing bundle: vinagre
Deleting bundle files...
Total deleted files: 147
Removing bundle: unison
Deleting bundle files...
Total deleted files: 6
Successfully removed 20 bundles

real	0m15.485s
user	0m14.779s
sys	0m0.581s

swupd from PR:
$ time sudo ./swupd bundle-remove -p target2 -S state2 ansible blender xterm automotive-tools cassandra cockpit django games kamera jupyter krita nginx openqa productivity vnc-server xscreensaver desktop wireshark vinagre unison

Removing bundle: ansible

Removing bundle: blender

Removing bundle: xterm

Removing bundle: automotive-tools

Removing bundle: cassandra

Removing bundle: cockpit

Removing bundle: django

Removing bundle: games

Removing bundle: kamera

Removing bundle: jupyter

Removing bundle: krita

Removing bundle: nginx

Removing bundle: openqa

Removing bundle: productivity

Removing bundle: vnc-server

Removing bundle: xscreensaver

Removing bundle: desktop

Removing bundle: wireshark

Removing bundle: vinagre

Removing bundle: unison

Deleting bundle files...
	...100%
Total deleted files: 51801

Successfully removed 20 bundles

real	0m1.323s
user	0m0.987s
sys	0m0.330s",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1058,2019-08-09T19:33:19Z,2019-09-30T21:40:03Z,2019-09-30T21:40:03Z,MERGED,True,737,356,24,https://github.com/castulo,Improvements for bundle-remove,6,[],https://github.com/clearlinux/swupd-client/pull/1058,https://github.com/castulo,12,https://github.com/clearlinux/swupd-client/pull/1058#issuecomment-535598668,"This PR includes a couple of improvements for bundle-remove>

When listing the dependencies of a given bundle, swupd uses a tree view
that includes all bundles that depend on the specified bundle, plus all
the bundles that depend on that dependendant bundle, and so on.
Some times for some bundles the list can grow quite large (over 1000
lines) which make the output useless. This PR fixes the issue by simplifying
the list of dependencies if the list is big so it is easier to read.
A --force flag was added to bundle-remove to be used in cases where
a user wants to remove a bundle that is required by other installed bundles
without having to delete one by one.
Removes non critical notifications being sent to telemetry when user was doing
user mistakes while removing

Closes #891
Closes #732
Closes #674
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Can you guys take another look at this PR? @otaviobp @karthikprabhuvinod,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1061,2019-08-12T21:08:42Z,2019-08-20T17:48:21Z,2019-09-17T16:51:14Z,MERGED,True,211,154,31,https://github.com/otaviobp,curl: Initialize curl as needed,7,[],https://github.com/clearlinux/swupd-client/pull/1061,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1061,"Instead of initializing curl library on start, initialize it only when needed.
The advantage of this approach is that we can run some commands offline, if
there's no file to download.
Fixes #801
Fixes #895
@jwakre This wont solve your problem, but it may help","Instead of initializing curl library on start, initialize it only when needed.
The advantage of this approach is that we can run some commands offline, if
there's no file to download.
Fixes #801
Fixes #895
@jwakre This wont solve your problem, but it may help",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1061,2019-08-12T21:08:42Z,2019-08-20T17:48:21Z,2019-09-17T16:51:14Z,MERGED,True,211,154,31,https://github.com/otaviobp,curl: Initialize curl as needed,7,[],https://github.com/clearlinux/swupd-client/pull/1061,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1061#issuecomment-520616418,"Instead of initializing curl library on start, initialize it only when needed.
The advantage of this approach is that we can run some commands offline, if
there's no file to download.
Fixes #801
Fixes #895
@jwakre This wont solve your problem, but it may help","When performing asynchronous curl downloads without a network connection, swupd will hang. We could place a network check when creating the handle in swupd_curl_parallel_download_start.

I haven't really tried that in a system without network connections and it looks like I need to do that. I'll test this PR more and fix this problem. It looks like we need to call curl_init in async too. I though we didn't need that.

Now I can successfully run some commands without internet connection, but I see a list of network connection errors. It seems like these errors are from swupd_curl_query_content_size. Is this a fatal error?

This looks like the users of swupd_curl_query_content_size() aren't checking that correctly. I'll review that. this wasn't expected.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1061,2019-08-12T21:08:42Z,2019-08-20T17:48:21Z,2019-09-17T16:51:14Z,MERGED,True,211,154,31,https://github.com/otaviobp,curl: Initialize curl as needed,7,[],https://github.com/clearlinux/swupd-client/pull/1061,https://github.com/jwakre,3,https://github.com/clearlinux/swupd-client/pull/1061#issuecomment-520618409,"Instead of initializing curl library on start, initialize it only when needed.
The advantage of this approach is that we can run some commands offline, if
there's no file to download.
Fixes #801
Fixes #895
@jwakre This wont solve your problem, but it may help","I haven't really tried that in a system without network connections and it looks like I need to do that. I'll test this PR more and fix this problem. It looks like we need to call curl_init in async too. I though we didn't need that.

The async curl code calls curl_multi_init, but a valid network connection is assumed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1061,2019-08-12T21:08:42Z,2019-08-20T17:48:21Z,2019-09-17T16:51:14Z,MERGED,True,211,154,31,https://github.com/otaviobp,curl: Initialize curl as needed,7,[],https://github.com/clearlinux/swupd-client/pull/1061,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1061#issuecomment-520619184,"Instead of initializing curl library on start, initialize it only when needed.
The advantage of this approach is that we can run some commands offline, if
there's no file to download.
Fixes #801
Fixes #895
@jwakre This wont solve your problem, but it may help",I'm calling the curl init on async now. Can you check if this works for you?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1061,2019-08-12T21:08:42Z,2019-08-20T17:48:21Z,2019-09-17T16:51:14Z,MERGED,True,211,154,31,https://github.com/otaviobp,curl: Initialize curl as needed,7,[],https://github.com/clearlinux/swupd-client/pull/1061,https://github.com/jwakre,5,https://github.com/clearlinux/swupd-client/pull/1061#issuecomment-520633604,"Instead of initializing curl library on start, initialize it only when needed.
The advantage of this approach is that we can run some commands offline, if
there's no file to download.
Fixes #801
Fixes #895
@jwakre This wont solve your problem, but it may help","I'm calling the curl init on async now. Can you check if this works for you?

The async curl initialization is much better now. It quickly fails when there is no network connection.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1063,2019-08-14T00:26:48Z,2019-08-20T21:45:35Z,2019-08-21T21:04:43Z,MERGED,True,549,42,16,https://github.com/jwakre,Add Support for statedir-cache,4,[],https://github.com/clearlinux/swupd-client/pull/1063,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/1063,"The --statedir-cache flag specifies a secondary statedir that will be checked before downloading files over the network. This flag is only supported for the os-install command.
The primary reason to use the statedir-cache is to enable the os-install
command to take advantage of hardlinks when installing content across
partitions. In this case, update content stored in the statedir-cache
(source partition) will be copied to the statedir (target partition) before
installing content into the target partition. Since the update content
will exist on the target partition before installation, hardlinks can be
used instead of copies.
NOTE: This PR depends on #1061 and the offline functional tests will fail due to this dependency.","The --statedir-cache flag specifies a secondary statedir that will be checked before downloading files over the network. This flag is only supported for the os-install command.
The primary reason to use the statedir-cache is to enable the os-install
command to take advantage of hardlinks when installing content across
partitions. In this case, update content stored in the statedir-cache
(source partition) will be copied to the statedir (target partition) before
installing content into the target partition. Since the update content
will exist on the target partition before installation, hardlinks can be
used instead of copies.
NOTE: This PR depends on #1061 and the offline functional tests will fail due to this dependency.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1063,2019-08-14T00:26:48Z,2019-08-20T21:45:35Z,2019-08-21T21:04:43Z,MERGED,True,549,42,16,https://github.com/jwakre,Add Support for statedir-cache,4,[],https://github.com/clearlinux/swupd-client/pull/1063,https://github.com/jwakre,2,https://github.com/clearlinux/swupd-client/pull/1063#issuecomment-523202917,"The --statedir-cache flag specifies a secondary statedir that will be checked before downloading files over the network. This flag is only supported for the os-install command.
The primary reason to use the statedir-cache is to enable the os-install
command to take advantage of hardlinks when installing content across
partitions. In this case, update content stored in the statedir-cache
(source partition) will be copied to the statedir (target partition) before
installing content into the target partition. Since the update content
will exist on the target partition before installation, hardlinks can be
used instead of copies.
NOTE: This PR depends on #1061 and the offline functional tests will fail due to this dependency.",This PR closes #1016,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1069,2019-08-15T20:17:13Z,2019-08-15T22:23:57Z,2019-09-17T16:51:20Z,MERGED,True,17,11,1,https://github.com/otaviobp,update: Save swupd binary path before executing any update process,1,[],https://github.com/clearlinux/swupd-client/pull/1069,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1069,"On updates swupd binary can be replaced so readlink will fail to get the
swudp binary path. In this case we should run that before running any update
process.
And besides that hardcode /usr/bin/swupd as the default swupd path in the case
there's something wrong with readlink
Fixes #1067
Fixes #1068
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","On updates swupd binary can be replaced so readlink will fail to get the
swudp binary path. In this case we should run that before running any update
process.
And besides that hardcode /usr/bin/swupd as the default swupd path in the case
there's something wrong with readlink
Fixes #1067
Fixes #1068
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1071,2019-08-21T20:48:42Z,2019-08-21T21:19:28Z,2019-08-21T21:19:28Z,MERGED,True,5,3,3,https://github.com/karthikprabhuvinod,Fix minor code issues,1,[],https://github.com/clearlinux/swupd-client/pull/1071,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1071,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1072,2019-08-21T21:12:25Z,2019-08-22T18:05:32Z,2019-08-22T18:05:32Z,MERGED,True,7,7,1,https://github.com/castulo,Values in config file should use underscores,1,[],https://github.com/clearlinux/swupd-client/pull/1072,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1072,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1073,2019-08-21T21:18:06Z,2019-08-22T16:07:22Z,2019-08-22T16:07:22Z,MERGED,True,2,2,1,https://github.com/castulo,Adding missing void to functions,1,[],https://github.com/clearlinux/swupd-client/pull/1073,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1073,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1074,2019-08-22T19:32:01Z,2019-08-29T23:08:15Z,2019-09-17T16:51:04Z,MERGED,True,89,52,2,https://github.com/otaviobp,signature: Create a helper to verify the signature on files in memory,1,[],https://github.com/clearlinux/swupd-client/pull/1074,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1074,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1075,2019-08-22T23:22:21Z,2019-08-22T23:49:03Z,2019-09-17T16:51:01Z,MERGED,True,9,9,1,https://github.com/otaviobp,test: Fix tests for http proxy configuration,1,[],https://github.com/clearlinux/swupd-client/pull/1075,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1075,"Never use on tests fake url without specifying the protocol because proxies can
respond differently. Use https pointing to localhost in this cases.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Never use on tests fake url without specifying the protocol because proxies can
respond differently. Use https pointing to localhost in this cases.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1076,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-524411172,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",two tests pending,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-528524983,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@castulo So I have made the changes. Also squashed the commits. Please take a look and let me know. Appreciate the help!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-529044669,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@castulo  I got them all this time :),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-530153908,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","you need to either force push your changes on the same commit or add a new commit that makes sense, not only adding one with ""new changes"", that would make no sense looking at the project history",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/karthikprabhuvinod,6,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-530178515,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@otaviobp @castulo : I forgot I could demonstrate some single responsibility principle. This one is much cleaner than before. Please have a look.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/karthikprabhuvinod,7,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-530179754,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@otaviobp I think that missing signature test is done as part of test/functional/signature/version-sig-check.bats line 20. Did you still want a dedicated test?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-530599973,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",Your first PR has been merged @karthikprabhuvinod  ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1076,2019-08-23T18:09:36Z,2019-09-11T22:25:34Z,2019-09-11T23:09:40Z,MERGED,True,205,16,8,https://github.com/karthikprabhuvinod,Update: Perform sig check on latest files,1,[],https://github.com/clearlinux/swupd-client/pull/1076,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/1076#issuecomment-530600073,"Fixes #1051
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",2nd. hahahaha,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1077,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1077#issuecomment-530144793,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I'm unsure if we should change the timeout on check_connection(). If the user's network is slow we may be timing out even if there is a connection available.
If there's no network available curl should fail fast. I couldn't reproduce a case where it get stuck trying to check the connection. Do you know what was the case where we are having that?

No, I never really tested that. That is a good point, maybe it cannot even be reproduced anymore.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1077#issuecomment-530144874,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I have reproduced the problem here in the case where a proxy is used. Not sure yet if it's a good idea to reduce the timeout,True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1077#issuecomment-530145038,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",what do you suggest then?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/karthikprabhuvinod,5,https://github.com/clearlinux/swupd-client/pull/1077#issuecomment-530613505,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp : Did yours timeout for around 60 secs like in the #895 ?
@castulo I could not reproduce this with bundle-list no args as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1077#issuecomment-531036405,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","what do you suggest then?

Try to reproduce that first and check what specific case we are hanging.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1077,2019-08-29T21:11:50Z,2019-09-16T20:44:02Z,2019-09-16T20:44:02Z,CLOSED,False,17,3,1,https://github.com/castulo,Fail fast when testing connection with server,1,[],https://github.com/clearlinux/swupd-client/pull/1077,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1077#issuecomment-531950386,"When curl is being initialized, we test the connection with the server.
curl is being initialized (if not already) on demand every time we need
to use curl to get a file. In some cases swupd performs an
alternate path if there is no network connectivity, and in those cases
we don't want to wait too long before taking that path so we don't
impact respose time from swupd.
This commit modifies the timeout value when testing for connectivity
during curl initialization so it fails fast in case the connectivity
test is unsuccessful.
Closes #895
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","We are closing this PR, swupd is only hanging when there is a proxy set up and there is no network connection with it, and we cannot do anything about that. In that case it will only wait for 30 seconds and timeout.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1079,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-529030307,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The size needed in disk to install a bundle if not installed


At the moment there is one limitation related to this size calculation.
The size needed to install a bundle is currently being calculated by adding the size of the bundle + the size of all the bundle dependencies - the size of the dependencies already installed in the system.
We can know what dependencies are already installed in the system and which ones are not. But if a dependency is not installed it doesn't mean all the files from the dependency are not installed either, as a matter of fact many files could already be installed in the system. A good example is with the ""emacs"" bundle. The size of that bundle is 138.75 MB, and it has no dependencies (other than os-core). The emacs bundle has 4121, but 4120 of its 4121 files are also included in other bundles, so if those bundles are already installed in the system, that means emacs is basically already installed (even when it is officially not at least to swupd).
Now, the only way I can think of to know what is the real size we would need for a bundle in a system is by collecting the list of files in the bundle and its dependencies, removing the files already present in the system from the list and then adding up the size of each one of the remaining files. The problem is, this could be very expensive in terms of resources/time since the only way we have to know each file's size is by using curl to request the header of each one of those files and getting the size from it. This is really not feasible unless the missing files are less than a few hundreds.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-529056216,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Now, the only way I can think of to know what is the real size we would need for a bundle in a system is by collecting the list of files in the bundle and its dependencies, removing the files already present in the system from the list and then adding up the size of each one of the remaining files.

As a second thought, I can get the consolidated list of files for the bundle (including files from dependencies), then I can iterate through the list and see if the file is already installed, if it is, I can grab its size from the local file system and subtract that size from the total size of the bundle. That way I could get the net increase in disk usage if the bundle is installed without having to query the content server. I'll give this a try. I'll push an update with this soon.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-529781206,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",I think have full names for functional test makes more sense. Something like bundle_info.bats,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-530140464,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Built and tried running
swupd bundle-info os-install
It received an invalid bundle and went into a segmentation fault. I know its a not bundle, but I am guessing we need a graceful exit

yeah, I missed that in my latest update, Just fixed it. Good catch.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-531992954,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","And we need to have an output that can be used by scripts. Maybe we can use the --quiet flag for that. And don't print the general info if other flags are used. We need to support somehow the use cases:
 swupd bundle-info --files | my_script
 swupd bundle-info --includes | my_script",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-537566443,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","And we need to have an output that can be used by scripts. Maybe we can use the --quiet flag for that. And don't print the general info if other flags are used. We need to support somehow the use cases:
 swupd bundle-info --files | my_script
 swupd bundle-info --includes | my_script


Done, the --quiet flag will be used for that. Example:
swupd bundle-info vim --files --quiet | my_script",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-537566828,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",The PR has been updated based on feedback and it is ready to be reviewed again,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1079,2019-09-06T21:51:30Z,2019-10-04T15:42:57Z,2019-10-04T19:07:10Z,MERGED,True,957,5,15,https://github.com/castulo,Implement bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1079,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/1079#issuecomment-538148897,"The bundle-info command shows detailed data related to a specified
bundle. Among the data currently displayed it includes:

If the bundle is installed or not
If the bundle is experimental or not
If the bundle is installed, it shows if there is an existing update
for the bundle
The latest available version of the bundle
The size of the bundle and all its dependencies
The size needed in disk to install a bundle if not installed

This commit also adds the following command flags:
--version: so a user can display information for a bundle in a
specific version, not only the current version.
--includes: this flag can be used to show all optional and required
bundles that are directly and indirectly included by the specified
bundle.
--files: this flag can be used to show all files that are part of a
given bundle.
All flags can be combined to show specific data.
This is the first of a series of PRs to implement the bundle-info
features referred to at #461.
Closes #971
Closes #784
Closes #531
Closes #530
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Other than that it looks good to be merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1081,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-530607226,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"Again, one general comment is that I think you should squash your commits into one, and remove the ""WIP"" from the first commit. You don't necessarily need to always use one commit in a PR, you can use as many as you want as long as it make sense to have them separately. Usually we try to keep the commits that add or fix tests for a new functionality in the same commit, unless you are doing TDD in which case the tests would be pushed first than the implementation.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-530608685,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"Remember you can (and should) use ""closes #PR_Number"" in the PR description if there is a related issue so it is closed when this PR is merged. Pleas try to add a detailed description of what your PR is implementing (unless is very obvious), that make the PR so much easier to review (by the way I think this is one of those cases where that is not necessary cause it is very obvious).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-532307245,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@castulo :  In some cases like this example, if you trace the code with recurse_manifest while running diagnose,
the problem is that recurse_manifest does not get called before add_subscriptions and add_subscriptions directly calls load_manifest. So the manifests are downloaded even before recurse_manifest.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-532374802,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@castulo : In some cases like this example, if you trace the code with recurse_manifest while running diagnose,
the problem is that recurse_manifest does not get called before add_subscriptions and add_subscriptions directly calls load_manifest. So the manifests are downloaded even before recurse_manifest.

I would implement the download manifest progress thing for both functions then. The manifest download progress ideally should be a function that could be called from recurse_manifest or add_subscriptions or whatever other function we use that loads many manifests... but if a generic function can't be implemented for those cases, I guess we would need to implement that separately.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-532378080,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"We have a problem here that I haven't thought about when I suggested that change. There's no way for us to know how many manifests we need to download or load before calling the recurse_manifest() function. And we need to download manifests to know what's the dependency list. We just know the total number of manifests we need to download at the end of the process.
@castulo am I missing something here? Can you think in a way on estimating that?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/karthikprabhuvinod,7,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-532515100,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Closing one as I created a PR,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1081,2019-09-09T21:20:00Z,2019-09-18T04:39:30Z,2019-09-18T20:15:03Z,CLOSED,False,203,23,116,https://github.com/karthikprabhuvinod,Progress bar for manifest download,3,[],https://github.com/clearlinux/swupd-client/pull/1081,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1081#issuecomment-532847952,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"We have a problem here that I haven't thought about when I suggested that change. There's no way for us to know how many manifests we need to download or load before calling the recurse_manifest() function. And we need to download manifests to know what's the dependency list. We just know the total number of manifests we need to download at the end of the process.
@castulo am I missing something here? Can you think in a way on estimating that?

No @otaviobp you are right, we need the manifests first to get our dependency list ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1083,2019-09-11T23:12:23Z,2019-09-17T00:34:20Z,2019-09-20T22:27:58Z,MERGED,True,89,7,3,https://github.com/castulo,Showing indirect bundles installed by bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/1083,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1083,"When installing a bundle using bundle-add, swupd also installs any
dependency not already installed in the system (if any). When the
bundle-add operation is complete, swupd reports how many of the
requested bundles were successfully installed and how many failed, but
if there are bundles that got installed as a side effect because they
are dependencies of the requested bundle(s), they are not included in
the summary of bundle-add.
This commit adds the number of dependencies installed in the summary of
bundle-add so it provides a more accurate view of the changes in the
system.
Closes #679
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When installing a bundle using bundle-add, swupd also installs any
dependency not already installed in the system (if any). When the
bundle-add operation is complete, swupd reports how many of the
requested bundles were successfully installed and how many failed, but
if there are bundles that got installed as a side effect because they
are dependencies of the requested bundle(s), they are not included in
the summary of bundle-add.
This commit adds the number of dependencies installed in the summary of
bundle-add so it provides a more accurate view of the changes in the
system.
Closes #679
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1083,2019-09-11T23:12:23Z,2019-09-17T00:34:20Z,2019-09-20T22:27:58Z,MERGED,True,89,7,3,https://github.com/castulo,Showing indirect bundles installed by bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/1083,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1083#issuecomment-531422549,"When installing a bundle using bundle-add, swupd also installs any
dependency not already installed in the system (if any). When the
bundle-add operation is complete, swupd reports how many of the
requested bundles were successfully installed and how many failed, but
if there are bundles that got installed as a side effect because they
are dependencies of the requested bundle(s), they are not included in
the summary of bundle-add.
This commit adds the number of dependencies installed in the summary of
bundle-add so it provides a more accurate view of the changes in the
system.
Closes #679
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@castulo Do you think its worth counting the deps in case of a single bundle?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1083,2019-09-11T23:12:23Z,2019-09-17T00:34:20Z,2019-09-20T22:27:58Z,MERGED,True,89,7,3,https://github.com/castulo,Showing indirect bundles installed by bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/1083,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1083#issuecomment-532002303,"When installing a bundle using bundle-add, swupd also installs any
dependency not already installed in the system (if any). When the
bundle-add operation is complete, swupd reports how many of the
requested bundles were successfully installed and how many failed, but
if there are bundles that got installed as a side effect because they
are dependencies of the requested bundle(s), they are not included in
the summary of bundle-add.
This commit adds the number of dependencies installed in the summary of
bundle-add so it provides a more accurate view of the changes in the
system.
Closes #679
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo Do you think its worth counting the deps in case of a single bundle?

that is not ideal, it may confuse users to show different outputs depending on how many bundles they add to the command",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1084,2019-09-11T23:24:34Z,2019-09-18T21:22:31Z,2019-09-18T21:22:47Z,MERGED,True,144,12,13,https://github.com/karthikprabhuvinod,Show format number,1,[],https://github.com/clearlinux/swupd-client/pull/1084,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1084,"Now, we have global option
and info_verbose logging level.
For this PR, we have verbose for info,
check-update which shows format versions.
This also helps future implementations leverage
the use of a verbose option for their own need.
commands:
swupd check-update --verbose
swupd info --verbose","Now, we have global option
and info_verbose logging level.
For this PR, we have verbose for info,
check-update which shows format versions.
This also helps future implementations leverage
the use of a verbose option for their own need.
commands:
swupd check-update --verbose
swupd info --verbose",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1084,2019-09-11T23:24:34Z,2019-09-18T21:22:31Z,2019-09-18T21:22:47Z,MERGED,True,144,12,13,https://github.com/karthikprabhuvinod,Show format number,1,[],https://github.com/clearlinux/swupd-client/pull/1084,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1084#issuecomment-531415781,"Now, we have global option
and info_verbose logging level.
For this PR, we have verbose for info,
check-update which shows format versions.
This also helps future implementations leverage
the use of a verbose option for their own need.
commands:
swupd check-update --verbose
swupd info --verbose",@otaviobp : Done with all. I was thinking of a way to implement and print those unknowns in a functional. Not sure how!!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1084,2019-09-11T23:24:34Z,2019-09-18T21:22:31Z,2019-09-18T21:22:47Z,MERGED,True,144,12,13,https://github.com/karthikprabhuvinod,Show format number,1,[],https://github.com/clearlinux/swupd-client/pull/1084,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1084#issuecomment-531907089,"Now, we have global option
and info_verbose logging level.
For this PR, we have verbose for info,
check-update which shows format versions.
This also helps future implementations leverage
the use of a verbose option for their own need.
commands:
swupd check-update --verbose
swupd info --verbose",You need to sign your commit @karthikprabhuvinod,True,{'THUMBS_UP': ['https://github.com/karthikprabhuvinod']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1084,2019-09-11T23:24:34Z,2019-09-18T21:22:31Z,2019-09-18T21:22:47Z,MERGED,True,144,12,13,https://github.com/karthikprabhuvinod,Show format number,1,[],https://github.com/clearlinux/swupd-client/pull/1084,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1084#issuecomment-531977365,"Now, we have global option
and info_verbose logging level.
For this PR, we have verbose for info,
check-update which shows format versions.
This also helps future implementations leverage
the use of a verbose option for their own need.
commands:
swupd check-update --verbose
swupd info --verbose",There's another thing I forgot. Every time we are adding a new flag we need to update the documentation too,True,"{'THUMBS_UP': ['https://github.com/castulo', 'https://github.com/karthikprabhuvinod']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1086,2019-09-12T22:50:11Z,2019-09-13T22:35:05Z,2019-09-17T16:51:03Z,MERGED,True,49,20,6,https://github.com/otaviobp,test: Support running tests in a different directory,1,[],https://github.com/clearlinux/swupd-client/pull/1086,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1086,"All files that are written by tests should be written in the directory
where the tests were executed and not the directory where code is.
Make distcheck now works fine
Fixes #343
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","All files that are written by tests should be written in the directory
where the tests were executed and not the directory where code is.
Make distcheck now works fine
Fixes #343
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1086,2019-09-12T22:50:11Z,2019-09-13T22:35:05Z,2019-09-17T16:51:03Z,MERGED,True,49,20,6,https://github.com/otaviobp,test: Support running tests in a different directory,1,[],https://github.com/clearlinux/swupd-client/pull/1086,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1086#issuecomment-531045518,"All files that are written by tests should be written in the directory
where the tests were executed and not the directory where code is.
Make distcheck now works fine
Fixes #343
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Running tests with bats is working fine for me if you run the prereq first. But there are some tests that are broken if you run this way, even on master. Can you check if the test you are having problem works on master?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1086,2019-09-12T22:50:11Z,2019-09-13T22:35:05Z,2019-09-17T16:51:03Z,MERGED,True,49,20,6,https://github.com/otaviobp,test: Support running tests in a different directory,1,[],https://github.com/clearlinux/swupd-client/pull/1086,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1086#issuecomment-531050174,"All files that are written by tests should be written in the directory
where the tests were executed and not the directory where code is.
Make distcheck now works fine
Fixes #343
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If I run this on master:
swupd-client/test/functional/bats bundleremove/ bundleadd/ bundlelist/
I get this failures:
 LST014: List all available bundles including experimental
 LST015: List all installed bundles including experimental
 LST016: List all installed bundles including experimental when the MoM fails to be retrieved

92 tests, 3 failures, 9 skipped, 22 not run

First of all, I don't know why is this happening on master, we should not have tests failing, I don't know why they were not caught by Travis.
But if I run the tests with your patch:
swupd-client/test/functional $ bats generate-cert.prereq
swupd-client/test/functional $ bats bundleremove/ bundleadd/ bundlelist/
92 tests, 54 failures, 9 skipped, 29 not run",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1086,2019-09-12T22:50:11Z,2019-09-13T22:35:05Z,2019-09-17T16:51:03Z,MERGED,True,49,20,6,https://github.com/otaviobp,test: Support running tests in a different directory,1,[],https://github.com/clearlinux/swupd-client/pull/1086,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1086#issuecomment-531383026,"All files that are written by tests should be written in the directory
where the tests were executed and not the directory where code is.
Make distcheck now works fine
Fixes #343
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",oops. squashed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1087,2019-09-16T18:30:49Z,2019-09-16T22:22:09Z,2019-09-16T22:22:13Z,MERGED,True,196,96,10,https://github.com/castulo,Testlib fixes,6,[],https://github.com/clearlinux/swupd-client/pull/1087,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1087,"This PR includes several fixes and improvements for the swupd test library.

It adds a debug_msg function to print messages for troubleshooting tests.
It enables printing the debug messages and saving a copy of the test environment separately using two environment variables: DEBUG_TEST and KEEP_ENV.
It add a --force flag to destroy_test_environment() to force the removal of an environment even when the KEEP_ENV variable is set to true. This is useful to remove leftover environments before starting a new execution.
It fixes an issue with the logic of the library to call the global_setup() and global_teardown() functions. The functions were being called correctly when running the tests using ""make check"" but they were not being called when running the tests using ""bats <directory>/"".
Adds a missing test ID in a test.","This PR includes several fixes and improvements for the swupd test library.

It adds a debug_msg function to print messages for troubleshooting tests.
It enables printing the debug messages and saving a copy of the test environment separately using two environment variables: DEBUG_TEST and KEEP_ENV.
It add a --force flag to destroy_test_environment() to force the removal of an environment even when the KEEP_ENV variable is set to true. This is useful to remove leftover environments before starting a new execution.
It fixes an issue with the logic of the library to call the global_setup() and global_teardown() functions. The functions were being called correctly when running the tests using ""make check"" but they were not being called when running the tests using ""bats <directory>/"".
Adds a missing test ID in a test.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1087,2019-09-16T18:30:49Z,2019-09-16T22:22:09Z,2019-09-16T22:22:13Z,MERGED,True,196,96,10,https://github.com/castulo,Testlib fixes,6,[],https://github.com/clearlinux/swupd-client/pull/1087,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1087#issuecomment-531973332,"This PR includes several fixes and improvements for the swupd test library.

It adds a debug_msg function to print messages for troubleshooting tests.
It enables printing the debug messages and saving a copy of the test environment separately using two environment variables: DEBUG_TEST and KEEP_ENV.
It add a --force flag to destroy_test_environment() to force the removal of an environment even when the KEEP_ENV variable is set to true. This is useful to remove leftover environments before starting a new execution.
It fixes an issue with the logic of the library to call the global_setup() and global_teardown() functions. The functions were being called correctly when running the tests using ""make check"" but they were not being called when running the tests using ""bats <directory>/"".
Adds a missing test ID in a test.","I forgot to update the certificate tests that only run in Travis, that is why there were failures. I just fixed them, I took the opportunity to add more debug messages to some functions which helped me determine the problem with the failing tests. I think we can add those debug messages on demand when we encounter test failures due struggle to fix.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1088,2019-09-17T16:49:47Z,2019-09-18T16:14:22Z,2019-09-25T19:48:25Z,MERGED,True,3,3,3,https://github.com/otaviobp,test: Change the prefix of real content tests,1,[],https://github.com/clearlinux/swupd-client/pull/1088,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1088,"Now 3 characters are enforced on test prefix, so renaming the real content
tests to RCT
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Now 3 characters are enforced on test prefix, so renaming the real content
tests to RCT
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1088,2019-09-17T16:49:47Z,2019-09-18T16:14:22Z,2019-09-25T19:48:25Z,MERGED,True,3,3,3,https://github.com/otaviobp,test: Change the prefix of real content tests,1,[],https://github.com/clearlinux/swupd-client/pull/1088,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1088#issuecomment-532314235,"Now 3 characters are enforced on test prefix, so renaming the real content
tests to RCT
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Th job again failed while running ""sudo apt-get install python3-docutils"".  So i restarted it",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1089,2019-09-17T19:32:42Z,2019-09-19T15:49:13Z,2019-09-25T19:48:22Z,MERGED,True,33,29,6,https://github.com/otaviobp,manifest: Remove code from load_mom() that is unrleated to loading th,1,[],https://github.com/clearlinux/swupd-client/pull/1089,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1089,"e mom
Saving mom for autocompletion is something we should do in another function.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","e mom
Saving mom for autocompletion is something we should do in another function.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1090,2019-09-18T04:34:55Z,2019-09-23T17:36:51Z,2019-09-24T20:35:28Z,MERGED,True,147,1,52,https://github.com/karthikprabhuvinod,Progress bar for manifest download,1,[],https://github.com/clearlinux/swupd-client/pull/1090,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1090,"This ensures we have a callback function
for full_file curl download. The function
implements a spinner for progress
Fixes #1060
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","This ensures we have a callback function
for full_file curl download. The function
implements a spinner for progress
Fixes #1060
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1090,2019-09-18T04:34:55Z,2019-09-23T17:36:51Z,2019-09-24T20:35:28Z,MERGED,True,147,1,52,https://github.com/karthikprabhuvinod,Progress bar for manifest download,1,[],https://github.com/clearlinux/swupd-client/pull/1090,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1090#issuecomment-533210470,"This ensures we have a callback function
for full_file curl download. The function
implements a spinner for progress
Fixes #1060
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","Some improvements suggested.
And now another challenge. We need to have a good output in the case the use runs with --debug or outputs that to a file.
@castulo Any opinions about what we should do? I would just hide the spinner in those cases

yes, hidding the spinner may be the best idea",True,{'THUMBS_UP': ['https://github.com/karthikprabhuvinod']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1090,2019-09-18T04:34:55Z,2019-09-23T17:36:51Z,2019-09-24T20:35:28Z,MERGED,True,147,1,52,https://github.com/karthikprabhuvinod,Progress bar for manifest download,1,[],https://github.com/clearlinux/swupd-client/pull/1090,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1090#issuecomment-533338511,"This ensures we have a callback function
for full_file curl download. The function
implements a spinner for progress
Fixes #1060
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","@otaviobp I think now the spinner works only in non-debug mode & wont print to a file. If you like it so far, I can start taking a look at the tests",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1090,2019-09-18T04:34:55Z,2019-09-23T17:36:51Z,2019-09-24T20:35:28Z,MERGED,True,147,1,52,https://github.com/karthikprabhuvinod,Progress bar for manifest download,1,[],https://github.com/clearlinux/swupd-client/pull/1090,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1090#issuecomment-533680331,"This ensures we have a callback function
for full_file curl download. The function
implements a spinner for progress
Fixes #1060
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","[
{ ""type"" : ""start"", ""section"" : ""verify"" },
{ ""type"" : ""progress"", ""currentStep"" : 1, ""totalSteps"" : 7, ""stepCompletion"" : 100, ""stepDescription"" : ""get_versions"" },
{ ""type"" : ""info"", ""msg"" : ""Diagnosing version 30940 "" },
{ ""type"" : ""progress"", ""currentStep"" : 2, ""totalSteps"" : 7, ""stepCompletion"" : 100, ""stepDescription"" : ""cleanup_download_dir"" },
{ ""type"" : ""info"", ""msg"" : ""Download missing manifests ... "" },
{ ""type"" : ""progress"", ""currentStep"" : 3, ""totalSteps"" : 7, ""stepCompletion"" : -1, ""stepDescription"" : ""load_manifests"" },
{ ""type"" : ""progress"", ""currentStep"" : 3, ""totalSteps"" : 7, ""stepCompletion"" : 100, ""stepDescription"" : ""load_manifests"" },
{ ""type"" : ""progress"", ""currentStep"" : 4, ""totalSteps"" : 7, ""stepCompletion"" : 100, ""stepDescription"" : ""consolidate_files"" },
{ ""type"" : ""info"", ""msg"" : "" Checking for missing files "" },
{ ""type"" : ""progress"", ""currentStep"" : 5, ""totalSteps"" : 7, ""stepCompletion"" : 0, ""stepDescription"" : ""add_missing_files"" },
{ ""type"" : ""progress"", ""currentStep"" : 5, ""totalSteps"" : 7, ""stepCompletion"" : 1, ""stepDescription"" : ""add_missing_files"" },
{ ""type"" : ""progress"", ""currentStep"" : 5, ""totalSteps"" : 7, ""stepCompletion"" : 2, ""stepDescription"" : ""add_missing_files"" },
{ ""type"" : ""progress"", ""currentStep"" : 5, ""totalSteps"" : 7, ""stepCompletion"" : 3, ""stepDescription"" : ""add_missing_files"" },
{ ""type"" : ""progress"", ""currentStep"" : 5, ""totalSteps"" : 7, ""stepCompletion"" : 4, ""stepDescription"" : ""add_missing_files"" },",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1090,2019-09-18T04:34:55Z,2019-09-23T17:36:51Z,2019-09-24T20:35:28Z,MERGED,True,147,1,52,https://github.com/karthikprabhuvinod,Progress bar for manifest download,1,[],https://github.com/clearlinux/swupd-client/pull/1090,https://github.com/karthikprabhuvinod,5,https://github.com/clearlinux/swupd-client/pull/1090#issuecomment-533680508,"This ensures we have a callback function
for full_file curl download. The function
implements a spinner for progress
Fixes #1060
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",Thats output i get for sudo ./swupd diagnose --json-output,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1091,2019-09-23T17:16:02Z,2019-09-24T21:51:28Z,2019-09-25T19:48:19Z,MERGED,True,5,8,2,https://github.com/otaviobp,List,2,[],https://github.com/clearlinux/swupd-client/pull/1091,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1091,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1092,2019-09-23T17:37:17Z,2019-09-24T17:17:56Z,2019-09-25T19:48:15Z,MERGED,True,97,82,50,https://github.com/otaviobp,Progress,4,[],https://github.com/clearlinux/swupd-client/pull/1092,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1092,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1092,2019-09-23T17:37:17Z,2019-09-24T17:17:56Z,2019-09-25T19:48:15Z,MERGED,True,97,82,50,https://github.com/otaviobp,Progress,4,[],https://github.com/clearlinux/swupd-client/pull/1092,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1092#issuecomment-534265444,,Sorry for missing the 100% progress_report in the last PR :(.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1093,2019-09-23T19:18:16Z,2019-09-23T20:27:12Z,2019-09-25T19:48:18Z,MERGED,True,3,3,1,https://github.com/otaviobp,verify: Fix printf arguments types and quantity,1,[],https://github.com/clearlinux/swupd-client/pull/1093,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1093,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1094,2019-09-24T19:56:17Z,2019-09-24T22:02:43Z,2019-11-11T21:08:02Z,CLOSED,False,59,2,3,https://github.com/otaviobp,list: List deduplicate wasn't deduplicating elements with more than 2,1,[],https://github.com/clearlinux/swupd-client/pull/1094,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1094," elements
When a duplicated element was found it was removed and then the iterator was
moved to next element. So the original element was never checked again. So if
there were more than 2 identical elements in the list some duplications were left
behind.
Also adding a unit test to validate that the fix is working.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com"," elements
When a duplicated element was found it was removed and then the iterator was
moved to next element. So the original element was never checked again. So if
there were more than 2 identical elements in the list some duplications were left
behind.
Also adding a unit test to validate that the fix is working.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1094,2019-09-24T19:56:17Z,2019-09-24T22:02:43Z,2019-11-11T21:08:02Z,CLOSED,False,59,2,3,https://github.com/otaviobp,list: List deduplicate wasn't deduplicating elements with more than 2,1,[],https://github.com/clearlinux/swupd-client/pull/1094,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1094#issuecomment-534743502," elements
When a duplicated element was found it was removed and then the iterator was
moved to next element. So the original element was never checked again. So if
there were more than 2 identical elements in the list some duplications were left
behind.
Also adding a unit test to validate that the fix is working.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Ha, I had already fixed this too in PR #1058",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1095,2019-09-24T20:47:11Z,2019-09-24T21:34:15Z,2019-09-24T21:34:15Z,MERGED,True,77,77,48,https://github.com/karthikprabhuvinod,Fix `Download` to `Downloading`,1,[],https://github.com/clearlinux/swupd-client/pull/1095,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1095,"Fix from Download missing manifests to Downloading missing manifests
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","Fix from Download missing manifests to Downloading missing manifests
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1096,2019-09-24T23:21:20Z,2019-09-25T20:38:23Z,2019-09-26T03:45:18Z,MERGED,True,6,7,4,https://github.com/karthikprabhuvinod,Fixing missing json messages while file redirect,1,[],https://github.com/clearlinux/swupd-client/pull/1096,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1096,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1096,2019-09-24T23:21:20Z,2019-09-25T20:38:23Z,2019-09-26T03:45:18Z,MERGED,True,6,7,4,https://github.com/karthikprabhuvinod,Fixing missing json messages while file redirect,1,[],https://github.com/clearlinux/swupd-client/pull/1096,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1096#issuecomment-535144033,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,@otaviobp : Fixed it,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1096,2019-09-24T23:21:20Z,2019-09-25T20:38:23Z,2019-09-26T03:45:18Z,MERGED,True,6,7,4,https://github.com/karthikprabhuvinod,Fixing missing json messages while file redirect,1,[],https://github.com/clearlinux/swupd-client/pull/1096,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1096#issuecomment-535178615,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@castulo : Please take a look and let me know if that makes sense
@otaviobp : Please take a look",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1097,2019-09-24T23:46:58Z,2019-09-25T16:09:26Z,2019-09-25T16:09:27Z,MERGED,True,63,3,3,https://github.com/castulo,Fix a bug in list_deduplicate,2,[],https://github.com/clearlinux/swupd-client/pull/1097,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1097,Function list_deduplicate was not removing all duplicates when there were multiple duplicates of some element.,Function list_deduplicate was not removing all duplicates when there were multiple duplicates of some element.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1098,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-535584306,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"this is the link to the sample os-install log file:
https://gist.github.com/karthikprabhuvinod/609a5bce99774e87cf025192b3ce4288",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-536066971,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"So you got the pack extraction part right....We have one more place where we need this. When we download fullfiles, we need to find out if the files exist on the same system(check fullfile.c download_fullfile), we have to add an extra step like you did for pack_extraction called check_files_exists. and report a progress bar around it.
I have written some code already for it..Let me know if sharing helps",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-536067827,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,https://github.com/clearlinux/swupd-client/blob/master/src/fullfile.c#L177-L188,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-536078718,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"So you got the pack extraction part right....We have one more place where we need this. When we download fullfiles, we need to find out if the files exist on the same system(check fullfile.c download_fullfile), we have to add an extra step like you did for pack_extraction called check_files_exists. and report a progress bar around it.

I'm unsure if we need that for fullfiles. That's suppose to be way faster than packs extraction. And this isn't suppose to affect installation too.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-536078865,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,I updated the comment in header,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/karthikprabhuvinod,7,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-536079723,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@otaviobp : But it will still check for files on the system even for installation. Maybe we can tackle this part later. But I correctly remember Mark pointing this as well. It is marked in this gist
https://gist.github.com/karthikprabhuvinod/609a5bce99774e87cf025192b3ce4288",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/mdhorn,8,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-538040656,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Let me know when I can pull this branch and test integration with the installer.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1098,2019-09-25T22:04:09Z,2019-10-04T22:02:00Z,2019-10-04T22:02:00Z,CLOSED,False,208,171,13,https://github.com/karthikprabhuvinod,Fix os-install progress pts,3,[],https://github.com/clearlinux/swupd-client/pull/1098,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/1098#issuecomment-538574213,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,I'm closing this pull request because I'll bring back this changes in a new branch soon,True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1099,2019-09-25T22:52:15Z,2019-10-04T22:43:20Z,2019-11-06T20:35:32Z,MERGED,True,1287,1204,84,https://github.com/otaviobp,Bundle add performance improvements,9,[],https://github.com/clearlinux/swupd-client/pull/1099,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1099,Fixes #855,Fixes #855,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1099,2019-09-25T22:52:15Z,2019-10-04T22:43:20Z,2019-11-06T20:35:32Z,MERGED,True,1287,1204,84,https://github.com/otaviobp,Bundle add performance improvements,9,[],https://github.com/clearlinux/swupd-client/pull/1099,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1099#issuecomment-536762753,Fixes #855,Rebased again on master,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1099,2019-09-25T22:52:15Z,2019-10-04T22:43:20Z,2019-11-06T20:35:32Z,MERGED,True,1287,1204,84,https://github.com/otaviobp,Bundle add performance improvements,9,[],https://github.com/clearlinux/swupd-client/pull/1099,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1099#issuecomment-538127145,Fixes #855,"Fixed reported problems.
Waiting on feedback for next steps.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1100,2019-09-26T17:44:28Z,2019-09-26T23:23:56Z,2019-09-26T23:23:56Z,MERGED,True,3,5,3,https://github.com/otaviobp,manifest: Always check the hash of a manifest event if it's just for ,1,[],https://github.com/clearlinux/swupd-client/pull/1100,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1100,"the header
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","the header
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1101,2019-09-26T20:58:10Z,2019-09-26T23:24:06Z,2019-11-06T20:36:04Z,MERGED,True,3,2,2,https://github.com/otaviobp,abort: Don't use abort unless is an OOM error,1,[],https://github.com/clearlinux/swupd-client/pull/1101,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1101,"We should fail with a correct return code on errors, instead of aborting.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We should fail with a correct return code on errors, instead of aborting.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1102,2019-09-26T22:56:24Z,2019-10-02T04:30:16Z,2019-11-06T20:35:30Z,MERGED,True,300,258,16,https://github.com/otaviobp,Fixes on general usages of stat,9,[],https://github.com/clearlinux/swupd-client/pull/1102,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1102,Trying to prevent here to run stat + file operation. Prefer to run the file operation and on errors evaluate the result.,Trying to prevent here to run stat + file operation. Prefer to run the file operation and on errors evaluate the result.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1102,2019-09-26T22:56:24Z,2019-10-02T04:30:16Z,2019-11-06T20:35:30Z,MERGED,True,300,258,16,https://github.com/otaviobp,Fixes on general usages of stat,9,[],https://github.com/clearlinux/swupd-client/pull/1102,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1102#issuecomment-536757030,Trying to prevent here to run stat + file operation. Prefer to run the file operation and on errors evaluate the result.,Fixed the reported problems and rebased on master,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1103,2019-09-27T21:34:36Z,2019-09-27T22:08:03Z,2019-11-06T20:36:03Z,MERGED,True,7,5,2,https://github.com/otaviobp,version: Make signature check optional before next FB,1,[],https://github.com/clearlinux/swupd-client/pull/1103,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1103,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1105,2019-09-30T20:17:38Z,2019-10-03T22:26:55Z,2019-11-06T20:35:29Z,MERGED,True,165,178,33,https://github.com/otaviobp,Json,6,[],https://github.com/clearlinux/swupd-client/pull/1105,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1105,Some improvements in json formatter I did when I was reworking the progress code.,Some improvements in json formatter I did when I was reworking the progress code.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1110,2019-09-30T21:09:50Z,2019-10-01T23:06:24Z,2019-11-06T20:36:02Z,MERGED,True,14,0,1,https://github.com/otaviobp,Release Notes Draft,1,[],https://github.com/clearlinux/swupd-client/pull/1110,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1110,"Introducing a release notes draft to help writing release notes on next releases
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Introducing a release notes draft to help writing release notes on next releases
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1111,2019-09-30T22:03:17Z,2019-10-02T19:49:04Z,2019-11-06T20:36:05Z,MERGED,True,35,12,3,https://github.com/otaviobp,Suggestion: Check update,2,[],https://github.com/clearlinux/swupd-client/pull/1111,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1111,"Suggested change on check-update --verbose. Print extra line with latest version in current format.o
The only 2 cases where this will be different from latest version is in the case of a format bump or
in the case where a format is explicitly stated using -F.
Some samples:
$ swupd check-update --verbose

current os version: 31130 (format 29) 
latest server version: 31130 (format 29) 
latest version in format 29: 31130
there are no updates available


$ swupd check-update -F staging --verbose

Current OS version: 31140 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format staging: 31140 (format 29) 
There are no updates available


$ swupd check-update -F 28 --verbose

Current OS version: 31130 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format 28: 30760
There are no updates available","Suggested change on check-update --verbose. Print extra line with latest version in current format.o
The only 2 cases where this will be different from latest version is in the case of a format bump or
in the case where a format is explicitly stated using -F.
Some samples:
$ swupd check-update --verbose

current os version: 31130 (format 29) 
latest server version: 31130 (format 29) 
latest version in format 29: 31130
there are no updates available


$ swupd check-update -F staging --verbose

Current OS version: 31140 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format staging: 31140 (format 29) 
There are no updates available


$ swupd check-update -F 28 --verbose

Current OS version: 31130 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format 28: 30760
There are no updates available",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1111,2019-09-30T22:03:17Z,2019-10-02T19:49:04Z,2019-11-06T20:36:05Z,MERGED,True,35,12,3,https://github.com/otaviobp,Suggestion: Check update,2,[],https://github.com/clearlinux/swupd-client/pull/1111,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1111#issuecomment-536777644,"Suggested change on check-update --verbose. Print extra line with latest version in current format.o
The only 2 cases where this will be different from latest version is in the case of a format bump or
in the case where a format is explicitly stated using -F.
Some samples:
$ swupd check-update --verbose

current os version: 31130 (format 29) 
latest server version: 31130 (format 29) 
latest version in format 29: 31130
there are no updates available


$ swupd check-update -F staging --verbose

Current OS version: 31140 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format staging: 31140 (format 29) 
There are no updates available


$ swupd check-update -F 28 --verbose

Current OS version: 31130 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format 28: 30760
There are no updates available","Another option is to show this as:
$ sudo ./swupd check-update --verbose
Current OS version: 31090 (format 29)
Latest server version: 31130 (format 29)
Latest version in format 29: 31130
There is a new OS version available: 31130",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1111,2019-09-30T22:03:17Z,2019-10-02T19:49:04Z,2019-11-06T20:36:05Z,MERGED,True,35,12,3,https://github.com/otaviobp,Suggestion: Check update,2,[],https://github.com/clearlinux/swupd-client/pull/1111,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1111#issuecomment-537209850,"Suggested change on check-update --verbose. Print extra line with latest version in current format.o
The only 2 cases where this will be different from latest version is in the case of a format bump or
in the case where a format is explicitly stated using -F.
Some samples:
$ swupd check-update --verbose

current os version: 31130 (format 29) 
latest server version: 31130 (format 29) 
latest version in format 29: 31130
there are no updates available


$ swupd check-update -F staging --verbose

Current OS version: 31140 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format staging: 31140 (format 29) 
There are no updates available


$ swupd check-update -F 28 --verbose

Current OS version: 31130 (format 29) 
Latest server version: 31130 (format 29) 
Latest version in format 28: 30760
There are no updates available",Implemented it again with your solution. It's slightly different only in the case of the staging.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1112,2019-10-01T16:15:27Z,2019-10-02T20:01:13Z,2019-11-06T20:36:02Z,MERGED,True,15,2,2,https://github.com/otaviobp,docs: Fix --certpah documentation,2,[],https://github.com/clearlinux/swupd-client/pull/1112,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1112,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1113,2019-10-01T17:14:38Z,2019-10-04T23:05:22Z,2019-10-04T23:05:22Z,MERGED,True,183,156,20,https://github.com/otaviobp,Compliant: adding more code style checks,4,[],https://github.com/clearlinux/swupd-client/pull/1113,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1113,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1113,2019-10-01T17:14:38Z,2019-10-04T23:05:22Z,2019-10-04T23:05:22Z,MERGED,True,183,156,20,https://github.com/otaviobp,Compliant: adding more code style checks,4,[],https://github.com/clearlinux/swupd-client/pull/1113,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1113#issuecomment-537722497,,Fixed the reported issues except the LC_COLLATE one,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1113,2019-10-01T17:14:38Z,2019-10-04T23:05:22Z,2019-10-04T23:05:22Z,MERGED,True,183,156,20,https://github.com/otaviobp,Compliant: adding more code style checks,4,[],https://github.com/clearlinux/swupd-client/pull/1113,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1113#issuecomment-538579428,,Update PR sorting now using en_US.UTF-8,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1126,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1126#issuecomment-537645779,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@otaviobp @castulo Please take a look. I would suggest taking a look at readme first, Also what licenses do i need to add?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1126#issuecomment-538139913,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"Not for now, but maybe we should add a test to make sure we aren't going to break this script by changing the output",True,{'THUMBS_UP': ['https://github.com/karthikprabhuvinod']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1126#issuecomment-538144266,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"Overall the scripts look good. I added some comments to the shellscript.
@castulo can you take a closer look to the python script?

yeah, I'll take a look",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/karthikprabhuvinod,5,https://github.com/clearlinux/swupd-client/pull/1126#issuecomment-541988938,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@castulo Thanks for your input, Addressed them all",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/karthikprabhuvinod,6,https://github.com/clearlinux/swupd-client/pull/1126#issuecomment-542314203,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"@otaviobp @castulo : I just received office lan connectivity for my dev machine.. I have set it for collection of data first. Will keep you updated
I needed to know one more thing: What license should be including for bash and python?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1126,2019-10-02T19:32:57Z,2020-02-05T16:56:00Z,2020-02-05T16:56:00Z,CLOSED,False,995,0,8,https://github.com/karthikprabhuvinod,Adding Swupd performance monitoring scripts,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1126,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/1126#issuecomment-582504915,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,"I pushed this PR to a feature branch performace_monitor.
We aren't focusing on improving the performance monitor now, but I want to save this for we to approach that in the future.
I'm closnig the PR then.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1129,2019-10-02T21:30:46Z,2019-10-02T23:02:20Z,2019-11-06T20:35:30Z,MERGED,True,36,19,5,https://github.com/otaviobp,version: Turn on partially the latest signature check,1,[],https://github.com/clearlinux/swupd-client/pull/1129,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1129,"Turning on again, but partially the signature check for latest version file.

If signature is missing (i.e. older mixer was used to generate the update),
swupd will print warnings and proceed.
If signature is wrong, swupd will print error messages and fail the operation.
This isn't suppose to happen even if users are using old mixers.
If flag --nosigcheck is used swupd will print warnings and proceed.

Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Turning on again, but partially the signature check for latest version file.

If signature is missing (i.e. older mixer was used to generate the update),
swupd will print warnings and proceed.
If signature is wrong, swupd will print error messages and fail the operation.
This isn't suppose to happen even if users are using old mixers.
If flag --nosigcheck is used swupd will print warnings and proceed.

Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1131,2019-10-03T20:15:54Z,2019-10-03T22:14:12Z,2019-11-06T20:35:31Z,MERGED,True,12,9,6,https://github.com/otaviobp,Stat,2,[],https://github.com/clearlinux/swupd-client/pull/1131,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1131,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1132,2019-10-03T20:58:54Z,2019-10-09T20:57:54Z,2019-10-10T15:06:33Z,MERGED,True,34,2,1,https://github.com/karthikprabhuvinod,Fix: To Jsonify helper script output,1,[],https://github.com/clearlinux/swupd-client/pull/1132,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1132,"Earlier the output of each helper script
run through execve was redirected directly
to the standard-output or standard error.
Hence messages printed like raw strings even if
json-format was selected
This fix ensures that we redirect the output of those
scripts to swupd so that we get a chance to process them
or format them before printing
Fixes #1127","Earlier the output of each helper script
run through execve was redirected directly
to the standard-output or standard error.
Hence messages printed like raw strings even if
json-format was selected
This fix ensures that we redirect the output of those
scripts to swupd so that we get a chance to process them
or format them before printing
Fixes #1127",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1133,2019-10-04T18:21:51Z,2019-10-04T19:39:50Z,2019-10-04T19:39:59Z,MERGED,True,8,8,3,https://github.com/castulo,Adding bundle-info and verify-legacy tests to CI,1,[],https://github.com/clearlinux/swupd-client/pull/1133,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1133,"Adding functional tests related to the bundle-info and verify (legacy) commands to be run in Travis as part of the CI.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Adding functional tests related to the bundle-info and verify (legacy) commands to be run in Travis as part of the CI.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1134,2019-10-04T19:10:14Z,2019-10-04T20:17:26Z,2019-10-04T20:17:29Z,MERGED,True,0,13,1,https://github.com/castulo,Removing unused struct from bundle-info,1,[],https://github.com/clearlinux/swupd-client/pull/1134,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1134,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1136,2019-10-07T15:17:45Z,2019-10-08T17:32:53Z,2019-10-08T17:32:53Z,MERGED,True,13,10,4,https://github.com/castulo,Fixing some code errors,1,[],https://github.com/clearlinux/swupd-client/pull/1136,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1136,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1138,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527","Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1138#issuecomment-539600355,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527",@otaviobp : Please could you provide some early feedback,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1138#issuecomment-540699818,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527",@castulo : Thanks for the detailed review.  I have addressed most of the things you asked for and left the others open for @otaviobp to reply on.,True,"{'HOORAY': ['https://github.com/castulo'], 'THUMBS_UP': ['https://github.com/castulo']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1138#issuecomment-540854800,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527",@otaviobp @castulo : done please review,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/karthikprabhuvinod,5,https://github.com/clearlinux/swupd-client/pull/1138#issuecomment-541161289,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527","@otaviobp :So we can turn enabled to disabled, but wont be able to turn disabled to enabled ..for auto-update to be show enabled, swupd-update.timer has to be restarted which we cant for a path",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1138#issuecomment-541164390,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527","@otaviobp :So we can turn enabled to disabled, but wont be able to turn disabled to enabled ..for auto-update to be show enabled, swupd-update.timer has to be restarted which we cant for a path

I think it's safe to ignore the timer if path_prefix != NULL",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1138,2019-10-07T19:10:12Z,2019-10-21T19:26:49Z,2019-10-21T19:26:49Z,MERGED,True,155,48,10,https://github.com/karthikprabhuvinod,Add --path to autoupdate mechanism,1,[],https://github.com/clearlinux/swupd-client/pull/1138,https://github.com/karthikprabhuvinod,7,https://github.com/clearlinux/swupd-client/pull/1138#issuecomment-543392058,"Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com
Fixes #527",@otaviobp : Thanks for helping find the issue. Please could you review this?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1139,2019-10-08T22:47:19Z,2019-10-08T22:53:09Z,2019-10-08T22:53:09Z,CLOSED,False,28,28,5,https://github.com/otaviobp,fix new reported compliant issues,2,[],https://github.com/clearlinux/swupd-client/pull/1139,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1139,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1140,2019-10-09T21:05:07Z,2019-10-10T16:08:58Z,2019-11-06T20:35:32Z,MERGED,True,31,29,6,https://github.com/otaviobp,Fix new reported compliant issues,1,[],https://github.com/clearlinux/swupd-client/pull/1140,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1140,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1142,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-541968908,,"`sudo ./swupd os-install -B os-core,os-core-update --path=/home/user/test_os_install
Warning: /home/user/test_os_install//usr/share/clear/versionstamp does not exist!
Installing OS version 31300 (latest)
Downloading missing manifests...
Downloading packs (35.53 MB) for:

os-core-plus
libstdcpp
libglib
findutils
p11-kit
os-core-webproxy
os-core
os-core-update
[100%]

Finishing packs extraction...
Checking for corrupt files
[100%]
[100%]
No extra files need to be downloaded
Installing base OS and selected bundles
[100%]
Inspected 5136 files
5026 files were missing
5026 of 5026 missing files were installed
0 of 5026 missing files were not installed
Calling post-update helper scripts
Warning: helper script (/home/user/test_os_install//usr/bin/clr-boot-manager) not found, it will be skipped
Installation successful`",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-541969121,,@otaviobp Checking for corrupt files gave two 100%. We need to print something before that.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-541969292,,"Yes, you're right, I'll fix that",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-542863987,,Fixed everything pending. @castulo @karthikprabhuvinod Can you take a look?,True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/karthikprabhuvinod,6,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-542942917,,"I wanted to try a big package so I ran the below
sudo ./swupd os-install -B os-core-update,big-data-basic --path=/test_os_it --json-output
[
{ ""type"" : ""start"", ""section"" : ""os-install"" },
{ ""type"" : ""warning"", ""msg"" : ""/home/kp/swupd-client/test_os_it//usr/share/clear/versionstamp does not exist!"" },
{ ""type"" : ""progress"", ""currentStep"" : 1, ""totalSteps"" : 9, ""stepCompletion"" : -1, ""stepDescription"" : ""load_manifests"" },
{ ""type"" : ""info"", ""msg"" : ""Installing OS version 31310 (latest)"" },
{ ""type"" : ""info"", ""msg"" : ""Downloading missing manifests..."" },
{ ""type"" : ""progress"", ""currentStep"" : 1, ""totalSteps"" : 9, ""stepCompletion"" : 100, ""stepDescription"" : ""load_manifests"" },
{ ""type"" : ""progress"", ""currentStep"" : 2, ""totalSteps"" : 9, ""stepCompletion"" : 0, ""stepDescription"" : ""download_packs"" },
{ ""type"" : ""info"", ""msg"" : ""Downloading packs (32.46 MB) for:"" },
{ ""type"" : ""info"", ""msg"" : "" - elasticsearch"" },
{ ""type"" : ""progress"", ""currentStep"" : 2, ""totalSteps"" : 9, ""stepCompletion"" : 0, ""stepDescription"" : ""download_packs"" },
I saw a the same progress being repeated twice..I am guessing this should happen",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-543285958,,Fixed the @karthikprabhuvinod reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/karthikprabhuvinod,8,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-543334676,,@otaviobp I tested os-install & verify and it looks good to me. Great stuff.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1142,2019-10-11T16:47:57Z,2019-10-18T16:27:27Z,2019-11-06T20:35:40Z,MERGED,True,917,633,112,https://github.com/otaviobp,Progress bar improvements,13,[],https://github.com/clearlinux/swupd-client/pull/1142,https://github.com/mdhorn,9,https://github.com/clearlinux/swupd-client/pull/1142#issuecomment-545198060,,"@otaviobp @jwakre
A new release of clr-installer was made today which supports these changes
https://github.com/clearlinux/clr-installer/releases/tag/2.3.2
It was pushed to koji and will be in tonight's Clear Linux OS build.
We should be good to have a new swupd release.",True,{'THUMBS_UP': ['https://github.com/otaviobp']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1143,2019-10-11T21:25:30Z,2019-10-14T23:05:23Z,2019-11-06T20:35:33Z,CLOSED,False,699,631,32,https://github.com/otaviobp,Progress2 test - For installer testing,12,['WIP'],https://github.com/clearlinux/swupd-client/pull/1143,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1143,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1144,2019-10-14T20:26:03Z,2019-10-14T23:04:46Z,2019-11-06T20:35:36Z,MERGED,True,10,12,3,https://github.com/otaviobp,Broken tests: Fix broken real_content tests,2,[],https://github.com/clearlinux/swupd-client/pull/1144,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1144,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1146,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-543970638,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","For example, I tested that:
$ sudo ./swupd os-install -B os-clr-on-clr --path /opt/swupd/root
$ sudo cp /usr/share/clear/bundles/* /var/lib/swupd/bundles #simulate that all bundles were installed using bundle-add
$ sudo rm /var/lib/swupd/bundles/vim #except vim
$ sudo ./swupd bundle-remove os-clr-on-clr --recursive
...
The following bundles are being removed:

vim
os-clr-on-clr
...

But vim is also-added by editors, so we can't remove it.

when you ran this test, did you also use --path for steps 2, 3 an 4? E.g$ sudo cp /opt/swupd/root/usr/share/clear/bundles/* /opt/swupd/root/var/lib/swupd/bundles",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-543971495,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","when you ran this test, did you also use --path for steps 2, 3 an 4? E.g$ sudo cp /opt/swupd/root/usr/share/clear/bundles/* /opt/swupd/root/var/lib/swupd/bundles

Yes, sorry, it wasn't clear in my comments.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-543972700,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","when you ran this test, did you also use --path for steps 2, 3 an 4? E.g$ sudo cp /opt/swupd/root/usr/share/clear/bundles/* /opt/swupd/root/var/lib/swupd/bundles

Yes, sorry, it wasn't clear in my comments.

Ok, that should not happen, I'll try to recreate the failure you are describing.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-544007397,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","I just realized I didn't add this flag to the default config file, I'll add it",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-544029712,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","@otaviobp I was able to recreate this behavior but after looking at it closer I think this is working as expected. After following your steps this is the result I got:
$ sudo ./swupd bundle-remove --recursive os-clr-on-clr --path /home/castulo/testfs/target --statedir /home/castulo/testfs/target/state
 [|]
The --recursive option was used, the specified bundle and its dependencies will be removed from the system

The following bundles are being removed:
 - vim
 - os-clr-on-clr

Deleting bundle files...
 [100%]

Total deleted files: 1056

Successfully removed 1 bundle
1 bundle that was installed as a dependency was removed

Let's analyze what happened. This is what we did:

we installed os-clr-on-clr (which installs a bunch of dependencies ~311)
we then marked all installed bundles as ""tracked"" by copying all files from <path>/usr/share/clear/bundles to <statedir>/bundles
then we deleted the tracking file from vim, so this will make swupd think this is the only bundle that was installed as a result of being a dependency
We ran bundle-remove --recursive os-clr-on-clr. This will remove the ""os-clr-on-clr"" bundle since that was the specified bundle, and ""os-clr-on-clr"" is not required by any other installed bundle, so we are good for removing it. Then since --recursive was used, swupd will check the 311 bundles included by os-clr-on-clr to see if they can be removed as well:

All bundles except ""vim"" were manually installed by the user (tracked files) so swupd skip removing all these
vim is not tracked, so swupd proceeds to see if the bundle is required by other bundles. The editors bundle also-add this bundle, but it is an optional bundle, so it is ok to remove it.


vim and os-clr-on-clr are removed.

We can confirm this with bundle-info:
$ sudo ./swupd bundle-info --path /home/castulo/testfs/target --statedir /home/castulo/testfs/target/state --dependencies editors
__________________________
 Info for bundle: editors
__________________________

Status: Installed

Bundle editors is up to date:
 - Installed bundle last updated in version: 31270
 - Latest available version: 31270

Bundle size:
 - Size of bundle: 692.64 KB
 - Size bundle takes on disk (includes dependencies): 431.51 MB

Direct dependencies (4):
 - os-core
 - emacs (optional, installed)
 - joe (optional, installed)
 - vim (optional, not installed)

Indirect dependencies (6):
 - findutils
 - lib-openssl
 - libstdcpp
 - p11-kit
 - perl-basic
 - python3-basic

If I repeat the same steps but using python3-basic instead of vim I get this:
$ sudo ./swupd bundle-remove --recursive os-clr-on-clr --path /home/castulo/testfs/target --statedir /home/castulo/testfs/target/state

The --recursive option was used, the specified bundle and its dependencies will be removed from the system

Bundle ""python3-basic"" is required by the following bundles:
 - Babel
 - Sphinx
 - <more bundles here>...

The following bundles are being removed:
 - os-clr-on-clr

Deleting bundle files...
 [100%]

Total deleted files: 868

Successfully removed 1 bundle

This seems to be working as designed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-544627963,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","I still think it's a problem. sudo swupd bundle-remove --recursive os-clr-on-clr should remove os-clr-on-clr because it ""is not required by any other installed bundle"", as you stated.
But we shouldn't remove vim, because it is required by an installed bundle, editors. Editors also-add vim so vim shouldn't be removed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/otaviobp,8,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-544634028,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","Not sure if I was clear on the reason where I think this is a problem. I'll describe a set of steps on how this would affect an expected use case:
$ swupd os-install --path /path
$ swupd bundle-add --path /path editors
$ #vim is installed and user is using it
$ swupd bundle-add --path /path os-clr-on-clr
$ #user realizes it doesn't need os-clr-on-clr anymore and any other extra dependencies
$ swupd bundle-remove --path /path os-clr-on-clr
$ # vim is gone",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,9,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-544675035,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","I still think it's a problem. sudo swupd bundle-remove --recursive os-clr-on-clr should remove os-clr-on-clr because it ""is not required by any other installed bundle"", as you stated.
But we shouldn't remove vim, because it is required by an installed bundle, editors. Editors also-add vim so vim shouldn't be removed.

I didn't realize ""also-add"" should be treated as ""include"", I thought this could be removed. I'll update the PR so also-add bundles are treated as includes as far as bundle-remove --recursive is concerned.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/otaviobp,10,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-544680932,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455",Can you also move all functions that are exclusively needed for bundle removal from bundle.c to bundle_remove.c?,True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,11,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-545229275,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455",I believe all the reported issues have been addressed and the PR is ready to be reviewed again.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,12,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-546015289,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","I just pushed an update to the release notes draft.
PR is ready for review.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,13,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-546496866,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","Version 2:

Removed the flag restriction between --recursive and --force, they are now supported together (suggested by @otaviobp)
Changed messages about the --recursive and --force flags from type info to warn to attract more attention (suggested by @otaviobp)
Updated release notes to make the statement shorter (suggested by @otaviobp)
Changed the bundle-remove command so when --recursive is used, if the tracking directory does not exist or is empty, the command defaults to considering all installed bundles as tracked (suggested by @otaviobp)
Updated the tests to reflect these changes.

All requested changes have been addressed and the PR is ready for review again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/castulo,14,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-547088965,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","Version 3:

Added a warning for --force and --recursive flags in the swupd documentation (as suggested by @otaviobp).
The validate_tracking_dir() function is now called on create_state_dir() so we always know that the directory is valid when we are using any tracked function (as suggested by @otaviobp).

All comments have been addressed and the PR is ready to be reviewed again.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1146,2019-10-15T18:14:58Z,2019-10-30T19:38:43Z,2020-02-04T05:41:31Z,MERGED,True,812,385,25,https://github.com/castulo,Implementing the --recursive flag for bundle-remove,11,[],https://github.com/clearlinux/swupd-client/pull/1146,https://github.com/lebensterben,15,https://github.com/clearlinux/swupd-client/pull/1146#issuecomment-581752073,"If a bundle has dependencies (include or also-add bundles) and is removed using the --recursive flag, the bundle and all its dependencies should be removed from the system, with the following two exceptions:

If the dependency is also a dependency of another installed bundle (unless it is also being removed in the same operation). Removing this bundle would break the other installed bundle.
If the dependency was previously added by the user directly (via bundle-add), because this means the user specifically wanted this bundle installed in the system, to remove this bundle the user would have to specifically remove it via the bundle-remove command.

Tasks:

 Functional tests
 Add --recursive flag to bundle-remove (without functionality)
 Add documentation to man pages.
 Add flag to autocompletion scripts swupd.bash and swupd.zsh
 Add dependencies to list of bundles to be removed
 Skip dependency os-core
 Skip dependency if tracked (installed by user)
 Skip dependency if required by an installed bundle
 Remove requested bundle and ""deletable"" dependencies
 Validate integration with other bundle-remove flags
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Add flag to the config file
 Compare performance of bundle-remove before and after flag implementation
 Test with real content (ad-hoc)
 Update release notes draft.

Closes #455","Hey guys,
I came up with an idea that could distinguish bundle added by users from bundle added as dependencies. It also avoids writing anything to /var directory, which as pointed out by @otaviobp , it could be removed by the user and that would cause problem.
So currently we store the names of all installed bundles under /usr/share/clear/bundles/, and my idea is to add dependency count into those files, which are currently empty.

When the bundle is added, create a file with file name same as bundle name

If the bundle is added as a dependency, its initial content is 2
If the bundle is added by user specifically, its initial content is 1


If the bundle is already added, but later on the user add another bundle that depends on it, increment the value by 2
When removing a bundle, also decrement all its dependencies' contained values by 2
Therefore,

If /usr/share/clear/bundles/FOO has an odd value, its added by user
If /usr/share/clear/bundles/FOO has an even value, its added as a dependency


A bundle could be safely removed only when its value is 0
Suppose the user doesn't specify --recursive flag when removing a bundle, and some of its dependencies have value 0, then we can also easily find those bundles. Maybe we could have swupd clean to remove them.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1147,2019-10-15T21:20:21Z,2019-10-15T22:24:37Z,2019-10-15T22:24:37Z,MERGED,True,26,14,2,https://github.com/otaviobp,Travis problem fixes,2,[],https://github.com/clearlinux/swupd-client/pull/1147,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1147,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1147,2019-10-15T21:20:21Z,2019-10-15T22:24:37Z,2019-10-15T22:24:37Z,MERGED,True,26,14,2,https://github.com/otaviobp,Travis problem fixes,2,[],https://github.com/clearlinux/swupd-client/pull/1147,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1147#issuecomment-542410810,,Any reason why you switched to bionic?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1147,2019-10-15T21:20:21Z,2019-10-15T22:24:37Z,2019-10-15T22:24:37Z,MERGED,True,26,14,2,https://github.com/otaviobp,Travis problem fixes,2,[],https://github.com/clearlinux/swupd-client/pull/1147,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1147#issuecomment-542430495,,"Any reason why you switched to bionic?

I added that to the commit message.

clang-format was broken for xenial
we can use libcheck from ubuntu instead of building from source

And it's better to run that in a more updated system.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1148,2019-10-15T22:15:28Z,2019-10-15T22:32:50Z,2019-11-06T20:35:38Z,CLOSED,False,28,15,3,https://github.com/otaviobp,teste,4,['WIP'],https://github.com/clearlinux/swupd-client/pull/1148,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1148,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1149,2019-10-15T22:38:07Z,2019-10-18T16:27:16Z,2019-10-18T16:27:16Z,MERGED,True,0,5,1,https://github.com/otaviobp,travis: Don't install clearlinux certificates on travis,1,[],https://github.com/clearlinux/swupd-client/pull/1149,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1149,"We don't need the Clearlinux certificates to run standard tests, so
don't install them anymore
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We don't need the Clearlinux certificates to run standard tests, so
don't install them anymore
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1157,2019-10-21T18:42:34Z,2019-10-22T00:38:39Z,2019-10-22T00:38:43Z,MERGED,True,0,2,1,https://github.com/karthikprabhuvinod,Cleaning & Deprecating config file items,1,[],https://github.com/clearlinux/swupd-client/pull/1157,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1157,"We dont use config option LOCK_DIR as /run/lock anymore. We only
use the lock file in the STATE_DIR. This PR performs that cleanup","We dont use config option LOCK_DIR as /run/lock anymore. We only
use the lock file in the STATE_DIR. This PR performs that cleanup",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1160,2019-10-21T19:55:57Z,2019-10-21T21:56:36Z,2019-11-06T20:35:41Z,MERGED,True,322,292,4,https://github.com/otaviobp,bundle: Reorganize functions on bundle.c,1,[],https://github.com/clearlinux/swupd-client/pull/1160,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1160,"Move functions specific from bundle_list to bundle_list.c. Keep in bundle.c only
generic bundle functions and create a bundle header file to export them.
Bundle-remove is still left to avoid rebase conflicts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Move functions specific from bundle_list to bundle_list.c. Keep in bundle.c only
generic bundle functions and create a bundle header file to export them.
Bundle-remove is still left to avoid rebase conflicts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1160,2019-10-21T19:55:57Z,2019-10-21T21:56:36Z,2019-11-06T20:35:41Z,MERGED,True,322,292,4,https://github.com/otaviobp,bundle: Reorganize functions on bundle.c,1,[],https://github.com/clearlinux/swupd-client/pull/1160,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1160#issuecomment-544691492,"Move functions specific from bundle_list to bundle_list.c. Keep in bundle.c only
generic bundle functions and create a bundle header file to export them.
Bundle-remove is still left to avoid rebase conflicts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","nflicts.

Small typo ""Move specific functions from bundle.c to bundle_list.c""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1161,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-546011269,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","@otaviobp : I have a working third_party_repo PR...Tests are still pending and PR needs a bit of finishing. At this moment, could you  take a look from an early feedback & feature standpoint ?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-546491669,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","@otaviobp
I have addressed all your comments with remarks like ""Makes sense will change in next push"" except two i guess.
With this PR, I made sure the skeleton exists, The add, delete list command lines parsers are created. But they don't do much.
Please could give it a second quick look? Anything you want to be removed for now?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-547573024,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","This PR seems to be moving in the right direction but there are still many things that need to be addressed first. I added comments with all my observations in the PR. I also noted there are no tests whatsoever for this PR, it introduces lots of new functionality so I think having tests is crucial.

This PR isn't really adding a new functionality, so there's no way on creating tests to it. It's just adding the skeleton so we can move forward.",True,{'EYES': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-547573351,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@karthikprabhuvinod Can you remove all functions from this PR that aren't related to the skeleton? And you can add later when you really need them.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/karthikprabhuvinod,6,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-547661358,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","@karthikprabhuvinod Can you remove all functions from this PR that aren't related to the skeleton? And you can add later when you really need them.

Okay done",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-548001308,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","ignore

What should I ignore?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/karthikprabhuvinod,8,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-548003589,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","ignore

What should I ignore?

I accidently reviewed my own PR..so had to paste some comment",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1161,2019-10-22T21:12:58Z,2019-10-31T17:23:01Z,2019-10-31T17:23:04Z,MERGED,True,526,33,12,https://github.com/karthikprabhuvinod,Add third-party skeletal features,1,[],https://github.com/clearlinux/swupd-client/pull/1161,https://github.com/karthikprabhuvinod,9,https://github.com/clearlinux/swupd-client/pull/1161#issuecomment-548095194,"This PR starts the third-party repo-add, delete, list feature
for swupd. This PR also add support for configure flag
to build swupd optionally, off by default.
Repo Add:
sudo swupd 3rd-party add <repo_name> <url>
Repo Remove:
sudo swupd 3rd-party remove <repo_name>
Repos List:
sudo swupd 3rd-party list
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@otaviobp @castulo Looks like all comments are addressed. I think it looks ready now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1164,2019-10-24T00:50:35Z,2019-10-24T23:22:01Z,2019-10-24T23:22:06Z,MERGED,True,154,73,11,https://github.com/castulo,Track bundles specified in os-install,1,[],https://github.com/clearlinux/swupd-client/pull/1164,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1164,"When os-install is used to install an OS and the --bundles option is used
to specify some bundles that should be installed in the system along
with the OS, the bundles specified should be tracked.
Closes #1153
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When os-install is used to install an OS and the --bundles option is used
to specify some bundles that should be installed in the system along
with the OS, the bundles specified should be tracked.
Closes #1153
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1164,2019-10-24T00:50:35Z,2019-10-24T23:22:01Z,2019-10-24T23:22:06Z,MERGED,True,154,73,11,https://github.com/castulo,Track bundles specified in os-install,1,[],https://github.com/clearlinux/swupd-client/pull/1164,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1164#issuecomment-546002675,"When os-install is used to install an OS and the --bundles option is used
to specify some bundles that should be installed in the system along
with the OS, the bundles specified should be tracked.
Closes #1153
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",V1 of this PR is ready to be reviewed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1164,2019-10-24T00:50:35Z,2019-10-24T23:22:01Z,2019-10-24T23:22:06Z,MERGED,True,154,73,11,https://github.com/castulo,Track bundles specified in os-install,1,[],https://github.com/clearlinux/swupd-client/pull/1164,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1164#issuecomment-546127598,"When os-install is used to install an OS and the --bundles option is used
to specify some bundles that should be installed in the system along
with the OS, the bundles specified should be tracked.
Closes #1153
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Updated version 2:

Renamed function track_bundle() to track_bundle_in_statedir(), and renamed track_installed() to track_bundle() as suggested by @otaviobp.
Fixed the documentation of  track_bundle_in_statedir() in bundle.h as requested by @karthikprabhuvinod.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1170,2019-10-24T21:55:22Z,2019-10-25T21:42:22Z,2019-11-06T20:35:15Z,CLOSED,False,408,412,17,https://github.com/otaviobp,Tabs: Don't mix tabs and spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1170,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1170,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1171,2019-10-24T21:56:27Z,2019-10-28T19:56:47Z,2019-11-06T20:35:12Z,MERGED,True,1,1,1,https://github.com/otaviobp, signature: Show more information when signature file open fails,1,[],https://github.com/clearlinux/swupd-client/pull/1171,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1171,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1172,2019-10-24T22:17:04Z,2019-10-28T19:59:01Z,2019-11-06T20:35:16Z,MERGED,True,29,61,10,https://github.com/otaviobp,sys: Use function from sys instead of mk_full_filename,1,[],https://github.com/clearlinux/swupd-client/pull/1172,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1172,"mk_full_filename() and sys_path_join() does almost the same thing.
sys_path_join() was prefered because it works best with null strings and
there were problems when using mk_full_filename() for urls
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","mk_full_filename() and sys_path_join() does almost the same thing.
sys_path_join() was prefered because it works best with null strings and
there were problems when using mk_full_filename() for urls
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1173,2019-10-25T16:54:52Z,2019-10-28T19:57:59Z,2019-11-06T20:35:16Z,MERGED,True,132,144,22,https://github.com/otaviobp,List: Adding some list improvements,10,[],https://github.com/clearlinux/swupd-client/pull/1173,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1173,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1174,2019-10-25T19:10:21Z,2019-10-25T19:12:35Z,2019-11-06T20:35:45Z,CLOSED,False,0,442,1,https://github.com/otaviobp,break build,1,[],https://github.com/clearlinux/swupd-client/pull/1174,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1174,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1175,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-546525735,,@castulo : Good point ! Maybe then I need to change my PR to do that then. Also look like I need get a different vimrc for python :/,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-546532207,,"I would really to stick to spaces (4 spaces) for indentation in all Python scripts, we can use tabs everywhere else. Using tabs in Python makes formatting the scripts a lot harder, specially sine Python relies in formatting to work properly and since according to PEP8 lines in scripts should not be bigger than 79 characters.

No problem. I'll fix. I like to be consistent, so forcing spaces on all python scripts is fine.
Is tab on shell ok?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/lebensterben,4,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-546617765,,"I prefer having spaces, either 2 or 4. This is not for aesthetics but for practicality, because many editors by default use 'soft-tabs', well I think Vim is an exception).
And often developers enables features like 'format on save', which will likely replaces all tabs with spaces.
If a contributor send a patch for review, the git-diff would list many differences unless it's told to ignore white spaces. So either you would see a bloated list of differences, or you might apply a patch which doesn't replace the tabs, but you end up with a script with mixed tabs and spaces.
Sent with GitHawk",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547035435,,"No problem. I'll fix. I like to be consistent, so forcing spaces on all python scripts is fine.
Is tab on shell ok?

Thanks. I have no preference for shell scripts, I believe I always use tabs in my shell scripts, but as @lebensterben mentioned, I can just set my editor to interpret a tab as 4 spaces as well.",True,{'THUMBS_UP': ['https://github.com/lebensterben']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547125030,,"Thank you for the suggestions. In this patch I tried to keep the most used style for each filetype. I'm totally ok on changing the python one to spaces. The source/header files are using tabs for a long time and as clang-forma is checking that it hasn't been a problem so far.
The major problem we had on mixing tabs and spaces were other files.
So for now it looks like the ideal would be:

.c .h .bash. .sh
Always indent with tabs, tabsize is 8 spaces. (same style used for source files from our history)
python:
4 spaces (python standard)
zsh
4 spaces (that's the style used by other zsh autocomplete scripts on clear)
Autotools files:
Autotools is very sensible to this, so I won't change. Just follow the style in the file you are changing.

I'll fix this patch to follow that and send a V2. Is there any other file I should change let me know",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547125751,,"If a contributor send a patch for review, the git-diff would list many differences unless it's told to ignore white spaces. So either you would see a bloated list of differences, or you might apply a patch which doesn't replace the tabs, but you end up with a script with mixed tabs and spaces.

The ideal is to have an automated check for any style we want to enforce. clang-format is doing that for our sources and make compliant applies some other minor checks. For now let's try to check that manually for other files, but if it's easy to add a script to check I'm ok with that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,8,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547126849,,"I realized now that there are multiple styles for zsh on clear. So I'll leave it with 2 spaces ident, like the original",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,9,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547128244,,V2: Use 4 spaces instead of a tab in python scripts.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,10,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547135467,,For some weird reason travis tests are not running on this PR. so please review and I'll run that manually before merging.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/lebensterben,11,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547187548,,"If a contributor send a patch for review, the git-diff would list many differences unless it's told to ignore white spaces. So either you would see a bloated list of differences, or you might apply a patch which doesn't replace the tabs, but you end up with a script with mixed tabs and spaces. ...


@otaviobp The only zsh script currently in the project is the auto-completion. Unfortunately shellcheck doesn't support it. And neither does zsh has style checker like bashate.
On top of this, zsh completion system has its own unique syntax, which is too complicated and not well documented. I wrote the script but after 2 months I cannot remember many syntax.
To consistently employ the test-driven paradigm this project has, we may consider do this.


The baseline is to use _gnu_generic function to automatically generate completion by having zsh call swupd -h in the background. And It's also possible to call swupd -h manually in background and use sed, awk or whatever external command to format the result. This approach only requires a consistent help message style.


To provide more functionality like bundle name completion, we may let zsh call an external helper script to generate the result. This helper should be coded in a language that automatic tests and code style checks are available, such as bash, Python, or C.


The advantage for this design is:

The usage of zsh specific syntax, and especially zsh completion specific syntax, is minimal. So for future maintainers of this project, they don't have to spent hours learning zsh completion system.
The completions are up to date with the latest release of swupd-client, as long as the help message is updated.
Helper script can be used not only by zsh, but also bash! This would greatly help to improve the bash completion.
Helper is could be tested and a consistent format can be enforced.

Sent with GitHawk",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1175,2019-10-25T21:42:51Z,2019-10-29T18:54:26Z,2019-11-06T20:35:07Z,MERGED,True,156,160,16,https://github.com/otaviobp,Spaces,2,[],https://github.com/clearlinux/swupd-client/pull/1175,https://github.com/otaviobp,12,https://github.com/clearlinux/swupd-client/pull/1175#issuecomment-547576782,,"On top of this, zsh completion system has its own unique syntax, which is too complicated and not well documented. I wrote the script but after 2 months I cannot remember many syntax.

I'm not changing the style of zsh for now then. Just enforcing what we have.

To provide more functionality like bundle name completion, we may let zsh call an external helper script to generate the result. This helper should be coded in a language that automatic tests and code style checks are available, such as bash, Python, or C.

I like the idea on creating something in common for the bash and zsh autocomplete. My concern is adding an dependency to things we dont need. So a system may have zsh, but not shell or python. I think that autogenerating the autocomplete scripts is easier than trying to maintain another binary that is called to return the autocomplete code. What's is painful on what we have now is that we need to update 2 scripts every time we change any flag in swupd. And all this information is already available in the C code, so it would be way easier to maintain if we had a C code generating the scripts.
#1064",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1180,2019-10-28T22:24:06Z,2019-10-29T18:54:40Z,2019-11-06T20:35:11Z,MERGED,True,67,30,6,https://github.com/otaviobp,Verify: main cleanup ,3,[],https://github.com/clearlinux/swupd-client/pull/1180,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1180,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1180,2019-10-28T22:24:06Z,2019-10-29T18:54:40Z,2019-11-06T20:35:11Z,MERGED,True,67,30,6,https://github.com/otaviobp,Verify: main cleanup ,3,[],https://github.com/clearlinux/swupd-client/pull/1180,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1180#issuecomment-547191447,,LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1181,2019-10-28T22:34:56Z,2019-10-29T16:10:37Z,2019-11-06T20:35:11Z,MERGED,True,57,38,15,https://github.com/otaviobp,More sane usage of dirname() and basename() in clear,3,[],https://github.com/clearlinux/swupd-client/pull/1181,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1181,"Dirname is tricky to be used. And basename() has 2 different implementations that are conflicting.
Make a wrapper to reduce the problems on misusing them","Dirname is tricky to be used. And basename() has 2 different implementations that are conflicting.
Make a wrapper to reduce the problems on misusing them",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1183,2019-10-29T20:07:49Z,2019-10-31T16:12:22Z,2019-10-31T16:12:22Z,MERGED,True,83,4,9,https://github.com/jwakre,os_install: Skip optional bundles when flag set,1,[],https://github.com/clearlinux/swupd-client/pull/1183,https://github.com/jwakre,1,https://github.com/clearlinux/swupd-client/pull/1183,"When the --skip-optional flag is set, optional (also-add) bundles will
be skipped.
Fixes: #1182","When the --skip-optional flag is set, optional (also-add) bundles will
be skipped.
Fixes: #1182",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1184,2019-10-30T16:14:06Z,2019-10-30T16:51:36Z,2019-11-06T20:35:07Z,MERGED,True,65,65,1,https://github.com/otaviobp,travis: Use spaces instead of tabs in travis,1,[],https://github.com/clearlinux/swupd-client/pull/1184,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1184,"Travis isn't working when tabs are used instead of spaces.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Travis isn't working when tabs are used instead of spaces.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1185,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list","Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548228001,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list",I'm not sure if adding INI parsing to swupd-client is the right approach here.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548459055,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list","@otaviobp Marking Otavio so that he is in loop.
@bryteise : So we choose ini over toml. Is your objection to choice of format?
We are planning to track all repos which users create & store it in the ini. So parsing is required to perform checks if a repo already exists or can be removed etc.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548468207,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list","@bryteise we decided to store repository information locally in an ini file because we already have a parser that we use for config file so it's the easiest format to store information right now. It's not an exact replace from the toml file and it's not how we are going to read/keep the binary list for example.
@karthikprabhuvinod we already have a parser in src/lib/config_parser.c. You can just use it to read the repository file",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/bryteise,5,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548471590,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list",Ah alrighty.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/bryteise,6,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548472115,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list",I assume that parser has already been fuzzed reasonably well because this is an attack vector.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/karthikprabhuvinod,7,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548562619,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list","I assume that parser has already been fuzzed reasonably well because this is an attack vector.

Right will default to using the same parser",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/karthikprabhuvinod,8,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-548904328,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list","@otaviobp @castulo So I have a working repo-add,remove & list. Wanted to check with you guys before adding tests & cleaning up. Needed an early feedback.
Could you guys give it a shot?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1185,2019-10-31T00:41:54Z,2019-11-16T00:22:43Z,2019-11-16T00:22:58Z,CLOSED,False,870,27,16,https://github.com/karthikprabhuvinod,"[DO NOT REVIEW]Adding more concrete features for 3rd-party add,delete, remove",3,['WIP'],https://github.com/clearlinux/swupd-client/pull/1185,https://github.com/karthikprabhuvinod,9,https://github.com/clearlinux/swupd-client/pull/1185#issuecomment-554580498,"Adding concrete repo list, remove,add  functionality
How to test:
sudo swupd 3rd-party add  
sudo swupd 3rd-party remove 
sudo swupd 3rd-party list",@otaviobp @castulo Abandoning this as this is split into #1208 #1204 #1199,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1186,2019-10-31T18:34:55Z,2019-10-31T21:13:01Z,2019-10-31T21:13:01Z,MERGED,True,7,7,2,https://github.com/castulo,3rd-party help menu improvements,1,[],https://github.com/clearlinux/swupd-client/pull/1186,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1186,"This commit makes a few small improvements to the help menu of swupd
3rd-party.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit makes a few small improvements to the help menu of swupd
3rd-party.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1189,2019-11-04T21:46:14Z,2019-11-05T18:48:06Z,2019-11-05T18:48:06Z,MERGED,True,0,1,1,https://github.com/karthikprabhuvinod,Removing Extra entry for autoupdate from readme,1,[],https://github.com/clearlinux/swupd-client/pull/1189,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1189,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1190,2019-11-05T21:36:01Z,2019-11-05T21:36:21Z,2019-11-05T21:36:21Z,CLOSED,False,229,60,33,https://github.com/otaviobp,Test,4,[],https://github.com/clearlinux/swupd-client/pull/1190,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1190,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1191,2019-11-05T21:41:26Z,2019-11-06T21:33:16Z,2019-11-11T21:07:58Z,CLOSED,False,1,0,1,https://github.com/otaviobp,test,1,[],https://github.com/clearlinux/swupd-client/pull/1191,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1191,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1191,2019-11-05T21:41:26Z,2019-11-06T21:33:16Z,2019-11-11T21:07:58Z,CLOSED,False,1,0,1,https://github.com/otaviobp,test,1,[],https://github.com/clearlinux/swupd-client/pull/1191,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1191#issuecomment-550034202,,,True,{'LAUGH': ['https://github.com/karthikprabhuvinod']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1192,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-551998013,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",thanks for the early review @karthikprabhuvinod  ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-554014441,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There are things that are still not implemented in this PR (noted in the task list in the description), but as suggested by @otaviobp I'm setting this PR as ready for review so it can be merged with the progress it currently has. I can implement the missing tasks in a new PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-555252295,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Version 2 has the following updates:

Removed global variables related to 3rd-party
Parse the whole repo config file once and store the data in a list
Avoid running scripts and heuristics when adding 3rd-party bundles",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-557197912,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3

Added the configuration options from 3rd-part bundle-add to the default config file
Added a test to validate we are parsing the config file correctly with sections that include subcommands like [3rd-party-bundle-add]",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-557207451,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V4:

Fixing the output of a test that was not deterministic",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-557244229,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V5:

Adding 3rd-party bundle-add options to autocompletion scripts",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-557669035,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V5:

Just rebased and updated the PR to use the recently merged code for 3rd-party repos.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,9,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-557711492,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V6:

Added the --repo option so the user can specify what 3rd-party repo to use to add a bundle",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,10,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-558284666,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V7:

make sure the state directories of the 3rd-party repo exist before trying to add a repo

I have tested 3rd-party bundle-add my-bundle with real content using a mix and it is working.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,11,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-558808001,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","v8:

Extracted some code that was really not part of this implementation and submitted it in different PRs
Rebased the code
Reusing the create_state_dirs function instead of adding a new one for 3rd-party",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,12,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-559210494,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","v9:

Decoupled the bundle_add.c and 3rd_party_bundle_add.c",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1192,2019-11-06T01:16:45Z,2019-11-27T22:56:12Z,2019-11-27T22:56:22Z,MERGED,True,859,201,24,https://github.com/castulo,Add ability to install bundles from 3rd-party repositories,9,[],https://github.com/clearlinux/swupd-client/pull/1192,https://github.com/castulo,13,https://github.com/clearlinux/swupd-client/pull/1192#issuecomment-559274721,"Implement a command swupd 3rd-party bundle-add that can install bundles from a 3rd party repository.
Tasks:

 Add support for 3rd-party bundle-add to the testlib
 Add functional tests for adding bundles from a 3rd-party repo
 Add new test group to Travis/github actions
 Add the 3rd-party bundle-add command to swupd (without functionality)
 Add documentation to man pages.
 Add command to autocompletion script swupd.bash
 Add command to autocompletion script swupd.zsh
 Add command to the config file
 Search for 3rd-party bundles in a hardcoded 3rd-party repo URL, and install it (as POC)
 Search for the bundle in 3rd-party repos registered in repo.ini
 When getting the URL of the 3rd-party repo, if there are multiple repos, we need to search for the bundle in all of them
 If the bundle is in multiple bundles we need to ask the user to specify a repo
 When using a 3rd-party repo, we need to get the current version of the system from the appropriate section of the repo.ini config file
 When tracking the installed bundle, we need to track it in the state dir that is specific to the 3rd-party repo.
 Check output correctness and consistency with other commands (including output using --quiet, --verbose, --debug)
 Update release notes draft

Closes #1177
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Code rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1193,2019-11-06T19:21:16Z,2019-11-11T23:15:19Z,2019-11-11T23:15:19Z,CLOSED,False,4,9,1,https://github.com/castulo,Re-balancing functional tests in Travis,1,[],https://github.com/clearlinux/swupd-client/pull/1193,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1193,"The number of functional tests that run in Travis have grown
considerably since the last time the jobs that run the tests were
balanced. This commit re-balances these jobs so tests take similar time
to run in each job.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The number of functional tests that run in Travis have grown
considerably since the last time the jobs that run the tests were
balanced. This commit re-balances these jobs so tests take similar time
to run in each job.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1193,2019-11-06T19:21:16Z,2019-11-11T23:15:19Z,2019-11-11T23:15:19Z,CLOSED,False,4,9,1,https://github.com/castulo,Re-balancing functional tests in Travis,1,[],https://github.com/clearlinux/swupd-client/pull/1193,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1193#issuecomment-552660428,"The number of functional tests that run in Travis have grown
considerably since the last time the jobs that run the tests were
balanced. This commit re-balances these jobs so tests take similar time
to run in each job.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Looks like this PR is no longer relevant since the project is moving to using GitHub actions for running Functional tests instead of using Travis (PR #1196).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1194,2019-11-06T20:07:55Z,2019-11-06T20:29:01Z,2019-11-06T20:29:01Z,MERGED,True,2,2,1,https://github.com/otaviobp,actions: Remove trailing whitespace in ccpp yml,1,[],https://github.com/clearlinux/swupd-client/pull/1194,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1194,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1195,2019-11-06T20:31:06Z,2019-11-06T21:07:25Z,2019-11-06T21:07:38Z,CLOSED,False,7,0,2,https://github.com/otaviobp,testing actions,1,[],https://github.com/clearlinux/swupd-client/pull/1195,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1195,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1196,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552613330,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,17 minutes!  ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552617835,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,"v2: now running all tests including travis tests

Autoupdate test was disabled, I'll try to fix that on another PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552643629,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,v3: Reorganized tests to run faster.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552653895,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,15 minutes! ,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552661138,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,V4: Running now all update tests,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/otaviobp,7,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552674858,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,"* os-install: the job ran 25 tests, `list_tests os-install` shows 26 tests


INS016 doesn't exit

* repair: the job ran 37 tests, `list_tests repair` shows 36 tests


REP033 is duplicated.",True,{'CONFUSED': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1196,2019-11-06T23:14:24Z,2019-11-12T00:26:47Z,2019-12-02T22:13:45Z,MERGED,True,212,13,4,https://github.com/otaviobp,actions: Build dependencies to support swupd builds,5,[],https://github.com/clearlinux/swupd-client/pull/1196,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1196#issuecomment-552677961,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,"* os-install: the job ran 25 tests, `list_tests os-install` shows 26 tests


INS016 doesn't exit

* repair: the job ran 37 tests, `list_tests repair` shows 36 tests


REP033 is duplicated.

I thought we had a way to automatically verify our test IDs were correct :(",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1198,2019-11-08T22:22:27Z,2019-11-12T21:24:48Z,2019-12-02T22:13:44Z,MERGED,True,34,40,12,https://github.com/otaviobp,static: Make some functions static,1,[],https://github.com/clearlinux/swupd-client/pull/1198,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1198,"Some static functions were not set as static. Setting them.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Some static functions were not set as static. Setting them.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1199,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-552044707,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@castulo : The imports keeping re-reorganizing themselves even though I edit them. Somehow make compliant does this,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-552044961,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","@castulo @otaviobp : I created a new PR just for add, I will need to add tests at the end since they work well if tested together.
Is this easier to review?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-553179373,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","@castulo : Thank you so much for the detailed review! I have either replied to a few and addressed most of them.
When I checked last, These are still open conservations are:
#1199 (comment)
#1199 (comment)
#1199 (comment)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,5,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-554158572,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","I think I dont need this right now, so will remove it:
#1199 (comment)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,6,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-554219839,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","#1199 (comment)
Thats the same thing i find with ./scripts/flag_validator.bash update add -k.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/karthikprabhuvinod,7,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-554220041,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",@otaviobp @castulo I think I have addressed all the points. Please a final look,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1199,2019-11-08T23:51:58Z,2019-11-19T00:33:46Z,2019-11-19T00:33:46Z,CLOSED,False,801,141,18,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo add,1,[],https://github.com/clearlinux/swupd-client/pull/1199,https://github.com/otaviobp,8,https://github.com/clearlinux/swupd-client/pull/1199#issuecomment-555275633,"sudo swupd 3rd-party add <repo_name> <upstream_url>
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",Closing in favor of #1210,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1200,2019-11-11T23:03:05Z,2019-11-12T21:15:26Z,2019-11-12T21:15:33Z,MERGED,True,18,21,3,https://github.com/otaviobp,test: Don't conflict config tests with other tests,1,[],https://github.com/clearlinux/swupd-client/pull/1200,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1200,"Always save the config file in another directory so we won't have
problems on running the config tests in parallel. Before this patch
if you run the config tests in parallel with any other tests you could
end up having false-negatives.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Always save the config file in another directory so we won't have
problems on running the config tests in parallel. Before this patch
if you run the config tests in parallel with any other tests you could
end up having false-negatives.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1200,2019-11-11T23:03:05Z,2019-11-12T21:15:26Z,2019-11-12T21:15:33Z,MERGED,True,18,21,3,https://github.com/otaviobp,test: Don't conflict config tests with other tests,1,[],https://github.com/clearlinux/swupd-client/pull/1200,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1200#issuecomment-552659182,"Always save the config file in another directory so we won't have
problems on running the config tests in parallel. Before this patch
if you run the config tests in parallel with any other tests you could
end up having false-negatives.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Just as a FYI, remember we have a function in testlib to write to files owned by root:
Usage:
    write_to_protected_file [-a] <file> <stream>

Options:
    -a    If used the text will be appended to the file, otherwise it will be overwritten",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1200,2019-11-11T23:03:05Z,2019-11-12T21:15:26Z,2019-11-12T21:15:33Z,MERGED,True,18,21,3,https://github.com/otaviobp,test: Don't conflict config tests with other tests,1,[],https://github.com/clearlinux/swupd-client/pull/1200,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1200#issuecomment-552681865,"Always save the config file in another directory so we won't have
problems on running the config tests in parallel. Before this patch
if you run the config tests in parallel with any other tests you could
end up having false-negatives.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","V2:

Rebased on top of master to run tests on actions
Remove configuration to run this tests isolated
Using write_to_protected_file where appropriate
Don't skip test anymore when not in TRAVIS",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1201,2019-11-12T00:26:19Z,2019-11-13T21:21:08Z,2019-12-02T22:13:44Z,MERGED,True,28,45,3,https://github.com/otaviobp,Duplicate: Improve test to check if IDs are correct ,2,[],https://github.com/clearlinux/swupd-client/pull/1201,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1201,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1202,2019-11-12T21:04:14Z,2019-11-13T21:22:29Z,2019-12-02T22:13:41Z,MERGED,True,10,0,1,https://github.com/otaviobp,actions: Set a timeout of 1 hour to github jobs,1,[],https://github.com/clearlinux/swupd-client/pull/1202,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1202,"Github job timeout is 6 hours, but we are sure that any job will take around
20~30 minutes to run. Set a one hour timeout to make sure that hung jobs aren't
going to be blocking us for a long time.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Github job timeout is 6 hours, but we are sure that any job will take around
20~30 minutes to run. Set a one hour timeout to make sure that hung jobs aren't
going to be blocking us for a long time.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1203,2019-11-12T21:44:47Z,2019-11-12T21:53:38Z,2019-12-02T22:13:42Z,CLOSED,False,54,35,1,https://github.com/otaviobp,actions: Build dependencies in parallel to have a faster build,1,[],https://github.com/clearlinux/swupd-client/pull/1203,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1203,"Download and build depedencies in parallel to try to maximize usage of CPU,
by building things at the same time we run downloads
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Download and build depedencies in parallel to try to maximize usage of CPU,
by building things at the same time we run downloads
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1203,2019-11-12T21:44:47Z,2019-11-12T21:53:38Z,2019-12-02T22:13:42Z,CLOSED,False,54,35,1,https://github.com/otaviobp,actions: Build dependencies in parallel to have a faster build,1,[],https://github.com/clearlinux/swupd-client/pull/1203,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1203#issuecomment-553133535,"Download and build depedencies in parallel to try to maximize usage of CPU,
by building things at the same time we run downloads
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Actually I realized that this is not working. Closing PR,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1204,2019-11-13T00:57:36Z,2019-11-22T00:37:31Z,2019-11-22T00:37:31Z,CLOSED,False,1183,150,23,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo remove,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1204,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1204,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1204,2019-11-13T00:57:36Z,2019-11-22T00:37:31Z,2019-11-22T00:37:31Z,CLOSED,False,1183,150,23,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo remove,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1204,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1204#issuecomment-557335562,,Closed in favor of #1215,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1206,2019-11-14T18:32:39Z,2019-11-18T23:48:11Z,2019-12-02T22:13:40Z,MERGED,True,37,199,3,https://github.com/otaviobp,Makefile: Change behavior of make check,1,[],https://github.com/clearlinux/swupd-client/pull/1206,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1206,"Now make check is only running unit tests and a new target,
functional-check is used for bat tests. The major win on that
was that now we can use find to look for all bat tests in the
functional library and we don't need to keep the BATS list
updated.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Now make check is only running unit tests and a new target,
functional-check is used for bat tests. The major win on that
was that now we can use find to look for all bat tests in the
functional library and we don't need to keep the BATS list
updated.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1208,2019-11-15T23:36:14Z,2019-11-21T23:16:25Z,2019-11-21T23:16:25Z,CLOSED,False,909,142,20,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo list,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1208,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1208,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1208,2019-11-15T23:36:14Z,2019-11-21T23:16:25Z,2019-11-21T23:16:25Z,CLOSED,False,909,142,20,https://github.com/karthikprabhuvinod,Concrete implementation for third-party repo list,2,['WIP'],https://github.com/clearlinux/swupd-client/pull/1208,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1208#issuecomment-557315400,,closed in favor of #1214,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1209,2019-11-19T00:14:10Z,2019-11-19T17:18:05Z,2019-12-02T22:13:40Z,MERGED,True,0,90,1,https://github.com/otaviobp,travis: Remove travis config file,1,[],https://github.com/clearlinux/swupd-client/pull/1209,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1209,"We have moved from travis to github actions, so now we can safely remove
the config file.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We have moved from travis to github actions, so now we can safely remove
the config file.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1210,2019-11-19T00:32:54Z,2019-11-21T21:16:34Z,2019-12-02T22:13:36Z,MERGED,True,516,59,18,https://github.com/otaviobp,Repo add: Concrete implementation for third-party repo add,6,[],https://github.com/clearlinux/swupd-client/pull/1210,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1210,Opening a new pull request with my proposed changes on top of karthik PR,Opening a new pull request with my proposed changes on top of karthik PR,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1210,2019-11-19T00:32:54Z,2019-11-21T21:16:34Z,2019-12-02T22:13:36Z,MERGED,True,516,59,18,https://github.com/otaviobp,Repo add: Concrete implementation for third-party repo add,6,[],https://github.com/clearlinux/swupd-client/pull/1210,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1210#issuecomment-556399812,Opening a new pull request with my proposed changes on top of karthik PR,"V2:

Fixing the incorrect values used and code style
Enforcing the http_insecure rule",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1210,2019-11-19T00:32:54Z,2019-11-21T21:16:34Z,2019-12-02T22:13:36Z,MERGED,True,516,59,18,https://github.com/otaviobp,Repo add: Concrete implementation for third-party repo add,6,[],https://github.com/clearlinux/swupd-client/pull/1210,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1210#issuecomment-557256345,Opening a new pull request with my proposed changes on top of karthik PR,"V3:

Adding a line break before new section in config files if not first section
Adding a version=0 line every time a new repository is added.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1211,2019-11-19T18:22:39Z,2019-11-19T20:05:42Z,2019-12-02T22:13:36Z,MERGED,True,3,0,1,https://github.com/otaviobp,actions: Test make distcheck on github actions,1,[],https://github.com/clearlinux/swupd-client/pull/1211,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1211,"Distcheck is light now, so adding it to github actions to make sure
we aren't breaking the build on a dist package
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Distcheck is light now, so adding it to github actions to make sure
we aren't breaking the build on a dist package
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1212,2019-11-19T22:14:14Z,2019-11-20T22:36:03Z,2019-11-20T22:36:12Z,MERGED,True,18,6,1,https://github.com/castulo,Fix memory leak downloading files to a full disk,1,[],https://github.com/clearlinux/swupd-client/pull/1212,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1212,"When swupd is downloading fullfiles, if it runs out of free disk space
it is exiting without freeing the curl handle. This commit fixes the
issue by  freeing it when this condition occurrs.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When swupd is downloading fullfiles, if it runs out of free disk space
it is exiting without freeing the curl handle. This commit fixes the
issue by  freeing it when this condition occurrs.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1212,2019-11-19T22:14:14Z,2019-11-20T22:36:03Z,2019-11-20T22:36:12Z,MERGED,True,18,6,1,https://github.com/castulo,Fix memory leak downloading files to a full disk,1,[],https://github.com/clearlinux/swupd-client/pull/1212,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1212#issuecomment-555757551,"When swupd is downloading fullfiles, if it runs out of free disk space
it is exiting without freeing the curl handle. This commit fixes the
issue by  freeing it when this condition occurrs.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp  All comments have been addressed in this update.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1213,2019-11-20T22:28:48Z,2019-11-21T00:53:19Z,2019-11-21T16:19:53Z,MERGED,True,13,0,1,https://github.com/castulo,Fix problem when running config-file tests,1,[],https://github.com/clearlinux/swupd-client/pull/1213,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1213,"The commit also fixes a bug with the same tests which was causing the
test environment to be left behind.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The commit also fixes a bug with the same tests which was causing the
test environment to be left behind.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1213,2019-11-20T22:28:48Z,2019-11-21T00:53:19Z,2019-11-21T16:19:53Z,MERGED,True,13,0,1,https://github.com/castulo,Fix problem when running config-file tests,1,[],https://github.com/clearlinux/swupd-client/pull/1213,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1213#issuecomment-556562322,"The commit also fixes a bug with the same tests which was causing the
test environment to be left behind.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

Removed the code that looked for an absolute path in the config file
Skip the config tests if the env is not configured correctly to run the tests
Make sure the working directory is returned to the original so the test environment gets removed correctly",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1214,2019-11-21T23:14:48Z,2019-11-22T00:34:48Z,2019-12-02T22:13:35Z,MERGED,True,125,37,9,https://github.com/otaviobp,Repo list: Rework of 3rd-party list,5,[],https://github.com/clearlinux/swupd-client/pull/1214,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1214,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1215,2019-11-22T00:37:09Z,2019-11-25T21:41:53Z,2019-12-02T22:13:35Z,MERGED,True,334,14,5,https://github.com/otaviobp,Repo remove: Rework of 3rd-party remove,2,[],https://github.com/clearlinux/swupd-client/pull/1215,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1215,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1215,2019-11-22T00:37:09Z,2019-11-25T21:41:53Z,2019-12-02T22:13:35Z,MERGED,True,334,14,5,https://github.com/otaviobp,Repo remove: Rework of 3rd-party remove,2,[],https://github.com/clearlinux/swupd-client/pull/1215,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1215#issuecomment-558337124,,V2: Fixed the reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1216,2019-11-25T19:36:35Z,2019-12-05T23:44:52Z,2019-12-05T23:44:56Z,MERGED,True,578,91,22,https://github.com/castulo,Implement 3rd-party bundle-list,2,[],https://github.com/clearlinux/swupd-client/pull/1216,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1216,"Implementation of the swupd 3rd-party bundle-list command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com
Closes #1179","Implementation of the swupd 3rd-party bundle-list command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com
Closes #1179",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1216,2019-11-25T19:36:35Z,2019-12-05T23:44:52Z,2019-12-05T23:44:56Z,MERGED,True,578,91,22,https://github.com/castulo,Implement 3rd-party bundle-list,2,[],https://github.com/clearlinux/swupd-client/pull/1216,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1216#issuecomment-560919290,"Implementation of the swupd 3rd-party bundle-list command.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com
Closes #1179","V2:

Removed magic number from print_repo_header()
split changes unrelated to 3rd_party bundle-list implementation to a separate commit
removed tests related to code that is not yet being implemented from this PR",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1218,2019-11-25T21:30:04Z,2019-11-25T22:17:48Z,2019-11-25T22:17:58Z,MERGED,True,8,9,2,https://github.com/castulo,Make the config parser case insensitive,1,[],https://github.com/clearlinux/swupd-client/pull/1218,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1218,"Section and keys are case insensitive in INI files, so this commit
make changes to the config parser so it converts the sections and keys
while reading them from the file so we don't have to deal with that with
every function that uses the parser.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Section and keys are case insensitive in INI files, so this commit
make changes to the config parser so it converts the sections and keys
while reading them from the file so we don't have to deal with that with
every function that uses the parser.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1219,2019-11-25T22:41:41Z,2019-11-25T23:13:18Z,2019-11-25T23:17:02Z,MERGED,True,8,8,9,https://github.com/castulo,Rebalancing functional tests,1,[],https://github.com/clearlinux/swupd-client/pull/1219,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1219,"This commit separates the 3rd-party tests in their own job since we will
be adding several tests related to 3rd-party in the upcoming days.
This commit also rebalances the tests in the update groups so they are
better balanced.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit separates the 3rd-party tests in their own job since we will
be adding several tests related to 3rd-party in the upcoming days.
This commit also rebalances the tests in the update groups so they are
better balanced.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1220,2019-11-25T23:21:10Z,2019-11-26T16:23:48Z,2019-11-26T16:23:54Z,MERGED,True,136,44,1,https://github.com/castulo,Enabling the use of 3rd-party repos in the testlib,1,[],https://github.com/clearlinux/swupd-client/pull/1220,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1220,"This commit enables the use of 3rd-party repos in some of the testlib
functions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit enables the use of 3rd-party repos in some of the testlib
functions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1222,2019-11-26T19:46:52Z,2019-11-27T22:18:27Z,2019-11-27T22:18:30Z,MERGED,True,12,9,2,https://github.com/castulo,Fix output adding bundles with staging errors,1,[],https://github.com/clearlinux/swupd-client/pull/1222,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1222,"There is an error in the output of the bundle-add command that causes
some messages to go unnoticed when there are failures staging files.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There is an error in the output of the bundle-add command that causes
some messages to go unnoticed when there are failures staging files.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1223,2019-11-27T18:50:30Z,2019-11-27T21:56:37Z,2019-11-27T21:56:40Z,MERGED,True,1,2,1,https://github.com/castulo,Fix error calculating number of files staged,1,[],https://github.com/clearlinux/swupd-client/pull/1223,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1223,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1224,2019-12-02T19:12:26Z,2019-12-02T22:52:58Z,2019-12-02T22:53:02Z,MERGED,True,1,0,1,https://github.com/castulo,Missing --repo flag to 3rd-party bundle-add help,1,[],https://github.com/clearlinux/swupd-client/pull/1224,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1224,"This commit adds a missing flag in the help menu of 3rd-party
bundle-add.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a missing flag in the help menu of 3rd-party
bundle-add.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1225,2019-12-02T20:01:20Z,2019-12-06T00:05:53Z,2019-12-06T00:05:55Z,MERGED,True,87,3,7,https://github.com/castulo,Implement --repo flag for 3rd-party bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/1225,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1225,"This commit adds the --repo flag for the 3rd-party bundle-list command
which can be used to specify the repository from which the bundles are
going to be listed.
This PR is built on top of #1216
Closes #1179","This commit adds the --repo flag for the 3rd-party bundle-list command
which can be used to specify the repository from which the bundles are
going to be listed.
This PR is built on top of #1216
Closes #1179",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1226,2019-12-02T22:49:30Z,2019-12-06T00:26:32Z,2019-12-06T00:26:35Z,MERGED,True,374,230,19,https://github.com/castulo,3rd party os core,6,[],https://github.com/clearlinux/swupd-client/pull/1226,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1226,"When using a 3rd-party repository we need to know the current version of the system related to the 3rd-party repository. This version may be different than the version related to the upstream content. The original idea of 3rd-party repositories was that this version would be tracked inside the repo.ini config file. This was not ideal cause it differ from the way swupd tracks version for upstream content. This PR makes a few updates so 3rd-party bundles are handled similarly to the way we handle upstream content.
The PR includes these updates:

Removes all the code related to handling the version key/value in the
repo.ini file.
When doing 3rd-party operations, instead of getting the current version of a 3rd-party repo from the repo.ini file, it will now be gotten from the os-release file in the appropriate path_prefix for the repo.
Installs the os-core bundle when a 3rd-party repository is added so swupd can track the version of the 3rd-party repo.
Updates functions in testlib that facilitate the creation of tests.
Updates 3rd-party tests.

Note: This PR is built on top of #1216  and #1225, these need to be reviewed and merged first.","When using a 3rd-party repository we need to know the current version of the system related to the 3rd-party repository. This version may be different than the version related to the upstream content. The original idea of 3rd-party repositories was that this version would be tracked inside the repo.ini config file. This was not ideal cause it differ from the way swupd tracks version for upstream content. This PR makes a few updates so 3rd-party bundles are handled similarly to the way we handle upstream content.
The PR includes these updates:

Removes all the code related to handling the version key/value in the
repo.ini file.
When doing 3rd-party operations, instead of getting the current version of a 3rd-party repo from the repo.ini file, it will now be gotten from the os-release file in the appropriate path_prefix for the repo.
Installs the os-core bundle when a 3rd-party repository is added so swupd can track the version of the 3rd-party repo.
Updates functions in testlib that facilitate the creation of tests.
Updates 3rd-party tests.

Note: This PR is built on top of #1216  and #1225, these need to be reviewed and merged first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1227,2019-12-04T23:01:41Z,2019-12-12T00:11:36Z,2019-12-12T00:11:40Z,MERGED,True,630,140,14,https://github.com/castulo,Implementing a command to remove 3rd-party bundles,2,[],https://github.com/clearlinux/swupd-client/pull/1227,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1227,"Implementing the 3rd-party bundle-remove command
This PR adds the ability to remove 3rd-party bundles. If a repo is not specified the bundle will be searched for in all repositories. All options from the normal bundle-remove command are supported with 3rd-party bundles.
Note: This PR is built on top of these PRs: #1216, #1225, #1226 and #1227, so they need to be reviewed first (in that order).","Implementing the 3rd-party bundle-remove command
This PR adds the ability to remove 3rd-party bundles. If a repo is not specified the bundle will be searched for in all repositories. All options from the normal bundle-remove command are supported with 3rd-party bundles.
Note: This PR is built on top of these PRs: #1216, #1225, #1226 and #1227, so they need to be reviewed first (in that order).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1228,2019-12-05T22:20:20Z,2019-12-06T16:21:50Z,2019-12-06T16:21:54Z,MERGED,True,64,21,1,https://github.com/castulo,Fixing flag_validator to work with 3rd-party,1,[],https://github.com/clearlinux/swupd-client/pull/1228,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1228,"This commit makes changes to the flag_validator script so it works
properly with 3rd-party commands/subcommands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit makes changes to the flag_validator script so it works
properly with 3rd-party commands/subcommands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1229,2019-12-06T19:30:02Z,2019-12-12T16:17:56Z,2019-12-12T16:17:59Z,MERGED,True,357,11,12,https://github.com/castulo,Implementation of 3rd-party bundle-info command,1,[],https://github.com/clearlinux/swupd-client/pull/1229,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1229,"This commit adds a new ""3rd-party bundle-info"" command which can be used to show information about a bundle from a 3rd-party repository. If no 3rd-party repository is specified, the bundle is searched for in all available repositories.
This PR is built on top of #1227 and has to be reviewed first.","This commit adds a new ""3rd-party bundle-info"" command which can be used to show information about a bundle from a 3rd-party repository. If no 3rd-party repository is specified, the bundle is searched for in all available repositories.
This PR is built on top of #1227 and has to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1230,2019-12-07T00:11:38Z,2019-12-12T16:41:46Z,2019-12-12T16:41:50Z,MERGED,True,578,74,22,https://github.com/castulo,Implementing 3rd-party update command,2,[],https://github.com/clearlinux/swupd-client/pull/1230,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1230,"This commit adds the ability to update the system based on the 3rd-party repositories the user have.
Closes #1178
This PR is built on top of #1227 and #1229  and have to be reviewed first.","This commit adds the ability to update the system based on the 3rd-party repositories the user have.
Closes #1178
This PR is built on top of #1227 and #1229  and have to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1231,2019-12-09T22:32:52Z,2019-12-12T17:17:28Z,2019-12-12T17:17:28Z,MERGED,True,5,106,3,https://github.com/castulo,Removing superseded commands from the help menu,1,[],https://github.com/clearlinux/swupd-client/pull/1231,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1231,"After a grace time period, superseded or deprecated commands should be
removed from the help menu so people is not encouraged to use them. They
should continue to work though for backward compatibility.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","After a grace time period, superseded or deprecated commands should be
removed from the help menu so people is not encouraged to use them. They
should continue to work though for backward compatibility.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1232,2019-12-11T22:19:37Z,2019-12-20T18:57:39Z,2019-12-20T18:57:42Z,MERGED,True,649,141,22,https://github.com/castulo,"Implementing the ""3rd-party diagnose"" command",2,[],https://github.com/clearlinux/swupd-client/pull/1232,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1232,This PR adds the ability to diagnose bundles from 3rd-party repos.,This PR adds the ability to diagnose bundles from 3rd-party repos.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1233,2019-12-12T19:20:15Z,2019-12-20T19:23:38Z,2019-12-20T19:23:41Z,MERGED,True,520,1,7,https://github.com/castulo,"Implementing the ""3rd-party repair"" command",1,[],https://github.com/clearlinux/swupd-client/pull/1233,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1233,"This PR adds the ability to repair bundles from 3rd-party repos.
This PR is built on top of #1232  and has to be reviewed first.","This PR adds the ability to repair bundles from 3rd-party repos.
This PR is built on top of #1232  and has to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1234,2019-12-12T20:50:27Z,2019-12-20T19:50:35Z,2019-12-20T19:50:37Z,MERGED,True,217,1,7,https://github.com/castulo,"Implementing the ""3rd-party check-update"" command",1,[],https://github.com/clearlinux/swupd-client/pull/1234,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1234,"This PR adds the ability to check for updates on 3rd-party repos.
This PR is built on top of #1232 and #1233 and have to be reviewed first.","This PR adds the ability to check for updates on 3rd-party repos.
This PR is built on top of #1232 and #1233 and have to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1235,2019-12-12T21:29:30Z,2019-12-20T20:14:10Z,2019-12-20T20:14:13Z,MERGED,True,169,20,14,https://github.com/castulo,3rd party housekeeping,1,[],https://github.com/clearlinux/swupd-client/pull/1235,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1235,"Housekeeping on 3rd-party commands
This commit does some housekeeping in the 3rd-party commands:

Initialize the function ""progress"" only after swupd has initialized successfully.
Make functions that are not used outside of a file static.
Avoid using regex or partial verifications on tests when possible.
Add 3rd-party command flags to the default config file.
Don't use ""repo"" in help menus, use the whole ""repository"" word.
Add 3rd-party sub-commands to the flag_validator script.
Add missing values from the autocompletion scripts.

This PR is built on top of #1232, #1233 and #1234 and have to be reviewed first.","Housekeeping on 3rd-party commands
This commit does some housekeeping in the 3rd-party commands:

Initialize the function ""progress"" only after swupd has initialized successfully.
Make functions that are not used outside of a file static.
Avoid using regex or partial verifications on tests when possible.
Add 3rd-party command flags to the default config file.
Don't use ""repo"" in help menus, use the whole ""repository"" word.
Add 3rd-party sub-commands to the flag_validator script.
Add missing values from the autocompletion scripts.

This PR is built on top of #1232, #1233 and #1234 and have to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1235,2019-12-12T21:29:30Z,2019-12-20T20:14:10Z,2019-12-20T20:14:13Z,MERGED,True,169,20,14,https://github.com/castulo,3rd party housekeeping,1,[],https://github.com/clearlinux/swupd-client/pull/1235,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1235#issuecomment-566198240,"Housekeeping on 3rd-party commands
This commit does some housekeeping in the 3rd-party commands:

Initialize the function ""progress"" only after swupd has initialized successfully.
Make functions that are not used outside of a file static.
Avoid using regex or partial verifications on tests when possible.
Add 3rd-party command flags to the default config file.
Don't use ""repo"" in help menus, use the whole ""repository"" word.
Add 3rd-party sub-commands to the flag_validator script.
Add missing values from the autocompletion scripts.

This PR is built on top of #1232, #1233 and #1234 and have to be reviewed first.","@castulo: nit pick: Since you have this open, Please could you spell correct thir_party_update_main to third_party_update_main in these files src/3rd_party.c, src/3rd_party_update.c and src/swupd_internal.h",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1235,2019-12-12T21:29:30Z,2019-12-20T20:14:10Z,2019-12-20T20:14:13Z,MERGED,True,169,20,14,https://github.com/castulo,3rd party housekeeping,1,[],https://github.com/clearlinux/swupd-client/pull/1235,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1235#issuecomment-566224147,"Housekeeping on 3rd-party commands
This commit does some housekeeping in the 3rd-party commands:

Initialize the function ""progress"" only after swupd has initialized successfully.
Make functions that are not used outside of a file static.
Avoid using regex or partial verifications on tests when possible.
Add 3rd-party command flags to the default config file.
Don't use ""repo"" in help menus, use the whole ""repository"" word.
Add 3rd-party sub-commands to the flag_validator script.
Add missing values from the autocompletion scripts.

This PR is built on top of #1232, #1233 and #1234 and have to be reviewed first.","@castulo: nit pick: Since you have this open, Please could you spell correct thir_party_update_main to third_party_update_main in these files src/3rd_party.c, src/3rd_party_update.c and src/swupd_internal.h

Hey @karthikprabhuvinod nice catch, I'll add that correction to this PR",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1235,2019-12-12T21:29:30Z,2019-12-20T20:14:10Z,2019-12-20T20:14:13Z,MERGED,True,169,20,14,https://github.com/castulo,3rd party housekeeping,1,[],https://github.com/clearlinux/swupd-client/pull/1235,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1235#issuecomment-566679410,"Housekeeping on 3rd-party commands
This commit does some housekeeping in the 3rd-party commands:

Initialize the function ""progress"" only after swupd has initialized successfully.
Make functions that are not used outside of a file static.
Avoid using regex or partial verifications on tests when possible.
Add 3rd-party command flags to the default config file.
Don't use ""repo"" in help menus, use the whole ""repository"" word.
Add 3rd-party sub-commands to the flag_validator script.
Add missing values from the autocompletion scripts.

This PR is built on top of #1232, #1233 and #1234 and have to be reviewed first.",@castulo : The PR title is a little misleading. We are saying housekeeping but implement new 3rd-party functions,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1236,2019-12-16T19:43:20Z,2019-12-20T20:43:12Z,2019-12-20T20:43:17Z,MERGED,True,80,24,4,https://github.com/castulo,Revert operation when theres an error adding repos,1,[],https://github.com/clearlinux/swupd-client/pull/1236,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1236,"When adding 3rd-party repositories, errors may occur, in these cases the
operation has to be reverted completely because we don't want to be left
with an invalid repo.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When adding 3rd-party repositories, errors may occur, in these cases the
operation has to be reverted completely because we don't want to be left
with an invalid repo.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1236,2019-12-16T19:43:20Z,2019-12-20T20:43:12Z,2019-12-20T20:43:17Z,MERGED,True,80,24,4,https://github.com/castulo,Revert operation when theres an error adding repos,1,[],https://github.com/clearlinux/swupd-client/pull/1236,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1236#issuecomment-566678856,"When adding 3rd-party repositories, errors may occur, in these cases the
operation has to be reverted completely because we don't want to be left
with an invalid repo.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@castulo LGTM.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1237,2019-12-17T22:02:00Z,2019-12-20T22:05:13Z,2019-12-20T22:05:16Z,MERGED,True,17,10,4,https://github.com/castulo,3rd-party: Ignoring invalid bundle error if exist in one repo,1,[],https://github.com/clearlinux/swupd-client/pull/1237,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1237,"When listing bundles using the --deps or --has-dep flags which take a BUNDLE as argument, one or more repositories may not have the specified BUNDLE, but we should not return a SWUPD_INVALID_BUNDLE error unless the bundle is not found in any repository.
This PR enforces that behavior and also modify the output of the different list options to make them more consistent with one another.
This PR is built on top of #1232, #1233, #1234 and #1235 and have to be reviewed first.","When listing bundles using the --deps or --has-dep flags which take a BUNDLE as argument, one or more repositories may not have the specified BUNDLE, but we should not return a SWUPD_INVALID_BUNDLE error unless the bundle is not found in any repository.
This PR enforces that behavior and also modify the output of the different list options to make them more consistent with one another.
This PR is built on top of #1232, #1233, #1234 and #1235 and have to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1238,2019-12-18T18:08:05Z,2019-12-23T17:43:10Z,2019-12-23T17:43:14Z,MERGED,True,107,86,11,https://github.com/castulo,Consistency with signature verification messages,2,[],https://github.com/clearlinux/swupd-client/pull/1238,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1238,"This commit enhance the consistency and readability, of the messages
shown when the signature verification is skipped or fails.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit enhance the consistency and readability, of the messages
shown when the signature verification is skipped or fails.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1238,2019-12-18T18:08:05Z,2019-12-23T17:43:10Z,2019-12-23T17:43:14Z,MERGED,True,107,86,11,https://github.com/castulo,Consistency with signature verification messages,2,[],https://github.com/clearlinux/swupd-client/pull/1238,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1238#issuecomment-568120503,"This commit enhance the consistency and readability, of the messages
shown when the signature verification is skipped or fails.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","looks good

@otaviobp are you ok with converting those messages that right now are with UPPER CASE to be normal lower case? @karthikprabhuvinod and I agree it would look better, but wanted to double check with you",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1238,2019-12-18T18:08:05Z,2019-12-23T17:43:10Z,2019-12-23T17:43:14Z,MERGED,True,107,86,11,https://github.com/castulo,Consistency with signature verification messages,2,[],https://github.com/clearlinux/swupd-client/pull/1238,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1238#issuecomment-568123673,"This commit enhance the consistency and readability, of the messages
shown when the signature verification is skipped or fails.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","looks good

@otaviobp are you ok with converting those messages that right now are with UPPER CASE to be normal lower case? @karthikprabhuvinod and I agree it would look better, but wanted to double check with you

Yes, I liked that. upper case looks like it's screaming.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1238,2019-12-18T18:08:05Z,2019-12-23T17:43:10Z,2019-12-23T17:43:14Z,MERGED,True,107,86,11,https://github.com/castulo,Consistency with signature verification messages,2,[],https://github.com/clearlinux/swupd-client/pull/1238,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1238#issuecomment-568128047,"This commit enhance the consistency and readability, of the messages
shown when the signature verification is skipped or fails.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","v2:

I just change ""Failed open"" with ""Failed to open""

We decided to leave the certificate messages as uppercase.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1240,2019-12-19T18:37:01Z,2019-12-21T00:08:06Z,2019-12-21T00:08:10Z,MERGED,True,69,32,9,https://github.com/castulo,3rd party certificate,1,[],https://github.com/clearlinux/swupd-client/pull/1240,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1240,"When running an operation, swupd uses a certificate to validate things like the MoM and the version file. The certificate that needs to be used for 3rd-party repos is different than the one that has to be used for upstream.
This commit enables the use of the 3rd-party repo certificate that will be installed in the repo's directory with all swupd operations, except when adding the repository, in those cases, since the os-core bundle hasn't been installed yet, we need to provide the cert path through other means, like using the -C flag.
note: this PR is built on top of other PRs that have to be reviewed first.","When running an operation, swupd uses a certificate to validate things like the MoM and the version file. The certificate that needs to be used for 3rd-party repos is different than the one that has to be used for upstream.
This commit enables the use of the 3rd-party repo certificate that will be installed in the repo's directory with all swupd operations, except when adding the repository, in those cases, since the os-core bundle hasn't been installed yet, we need to provide the cert path through other means, like using the -C flag.
note: this PR is built on top of other PRs that have to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1241,2019-12-19T19:27:50Z,2019-12-20T23:35:13Z,2019-12-20T23:35:17Z,MERGED,True,5,0,1,https://github.com/karthikprabhuvinod,Prevent memory leak,3,[],https://github.com/clearlinux/swupd-client/pull/1241,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1241,"This makes sure we always deallocate memory if there was an
error after the initial global_init
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","This makes sure we always deallocate memory if there was an
error after the initial global_init
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1242,2019-12-20T18:16:13Z,2019-12-23T18:52:14Z,2019-12-23T18:52:23Z,MERGED,True,28,11,2,https://github.com/castulo,Remove the state dir when removing 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1242,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1242,"When we remove a 3rd-party repo from the system, we remove the directory
where all its contents got installed, but we don't remove its state
directory.
This commit removes it since we no longer need that state directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When we remove a 3rd-party repo from the system, we remove the directory
where all its contents got installed, but we don't remove its state
directory.
This commit removes it since we no longer need that state directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1242,2019-12-20T18:16:13Z,2019-12-23T18:52:14Z,2019-12-23T18:52:23Z,MERGED,True,28,11,2,https://github.com/castulo,Remove the state dir when removing 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1242,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1242#issuecomment-568092669,"When we remove a 3rd-party repo from the system, we remove the directory
where all its contents got installed, but we don't remove its state
directory.
This commit removes it since we no longer need that state directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Should we add a funcitonal test?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1242,2019-12-20T18:16:13Z,2019-12-23T18:52:14Z,2019-12-23T18:52:23Z,MERGED,True,28,11,2,https://github.com/castulo,Remove the state dir when removing 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1242,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1242#issuecomment-568093654,"When we remove a 3rd-party repo from the system, we remove the directory
where all its contents got installed, but we don't remove its state
directory.
This commit removes it since we no longer need that state directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Should we add a funcitonal test?

Good idea, I think I can add a validation of this into an existing test",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1242,2019-12-20T18:16:13Z,2019-12-23T18:52:14Z,2019-12-23T18:52:23Z,MERGED,True,28,11,2,https://github.com/castulo,Remove the state dir when removing 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1242,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1242#issuecomment-568098312,"When we remove a 3rd-party repo from the system, we remove the directory
where all its contents got installed, but we don't remove its state
directory.
This commit removes it since we no longer need that state directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

Adding validation of the state dir being removed in a functional test",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1243,2019-12-20T18:56:11Z,2019-12-20T22:52:36Z,2019-12-20T22:52:38Z,MERGED,True,19,4,4,https://github.com/castulo,Verifying the URL of a repo doesn't exist already,1,[],https://github.com/clearlinux/swupd-client/pull/1243,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1243,"When adding a 3rd-party repository we need to make sure that the URL
provided by the user is not already assigned to another 3rd-arty
repository, otherwise we can end up having the same repository multiple
times, just with different names.
This commit checks the URL doesn't already exists.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When adding a 3rd-party repository we need to make sure that the URL
provided by the user is not already assigned to another 3rd-arty
repository, otherwise we can end up having the same repository multiple
times, just with different names.
This commit checks the URL doesn't already exists.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1244,2019-12-20T21:30:21Z,2019-12-21T00:38:42Z,2019-12-21T00:38:43Z,MERGED,True,177,25,9,https://github.com/castulo,"Adding ""3rd-party clean"" command",1,[],https://github.com/clearlinux/swupd-client/pull/1244,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1244,This commit implements the swupd clean command for the 3rd-party bundles so users are able to clean the cache on their state directories.,This commit implements the swupd clean command for the 3rd-party bundles so users are able to clean the cache on their state directories.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1245,2019-12-23T18:24:31Z,2019-12-24T17:57:10Z,2019-12-24T17:57:16Z,MERGED,True,63,38,10,https://github.com/castulo,"Formating 3rd-party add,list,remove command output",1,[],https://github.com/clearlinux/swupd-client/pull/1245,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1245,"This commit makes a few small changes to the output of the commands to
make it look cleaner and to be consistent with the output of other swupd
commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit makes a few small changes to the output of the commands to
make it look cleaner and to be consistent with the output of other swupd
commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1245,2019-12-23T18:24:31Z,2019-12-24T17:57:10Z,2019-12-24T17:57:16Z,MERGED,True,63,38,10,https://github.com/castulo,"Formating 3rd-party add,list,remove command output",1,[],https://github.com/clearlinux/swupd-client/pull/1245,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1245#issuecomment-568610726,"This commit makes a few small changes to the output of the commands to
make it look cleaner and to be consistent with the output of other swupd
commands.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@castulo : left you with some suggestions for wording the errors.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1246,2019-12-23T22:56:35Z,2019-12-24T00:17:04Z,2019-12-24T00:17:08Z,MERGED,True,5,2,2,https://github.com/castulo,Fix buffer overflow when adding 3rd-party repos,1,[],https://github.com/clearlinux/swupd-client/pull/1246,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1246,"This commit fixes a buffer overflow that was being triggered when adding
3rd-party repositories.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit fixes a buffer overflow that was being triggered when adding
3rd-party repositories.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1247,2019-12-24T20:49:19Z,2019-12-26T22:10:17Z,2019-12-26T22:10:17Z,MERGED,True,128,96,8,https://github.com/castulo,Improvements for swupd output,2,[],https://github.com/clearlinux/swupd-client/pull/1247,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1247,"This PR improves swupd output by doing two things:

Removes the spinner once it finished its function
Fixes the line breaks between lines of output for the verify family of commands","This PR improves swupd output by doing two things:

Removes the spinner once it finished its function
Fixes the line breaks between lines of output for the verify family of commands",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1248,2019-12-26T22:09:58Z,2019-12-28T01:29:50Z,2019-12-28T01:29:54Z,MERGED,True,479,381,32,https://github.com/castulo,Incraese the total steps if inaccurate,2,[],https://github.com/clearlinux/swupd-client/pull/1248,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1248,"When performing a swupd operation, if the progress steps are defined incorrectly, a buffer overflow may be triggered. This commit makes sure the steps are still within the specified range by redefining the total number of steps to avoid the memory problem.
PR built on top of #1249 and needs to be reviewed first
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When performing a swupd operation, if the progress steps are defined incorrectly, a buffer overflow may be triggered. This commit makes sure the steps are still within the specified range by redefining the total number of steps to avoid the memory problem.
PR built on top of #1249 and needs to be reviewed first
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1249,2019-12-27T22:40:13Z,2019-12-28T01:28:54Z,2019-12-28T01:28:58Z,MERGED,True,469,379,31,https://github.com/castulo,Fix the number of steps in swupd functions,1,[],https://github.com/clearlinux/swupd-client/pull/1249,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1249,"In order to report progress accuratelly, currently swupd requires a
hardcoded number of steps per operation so we can report how far in the
operation we are. Most of these step totals are wrong.
This commit fixes the number of steps in many swupd functions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","In order to report progress accuratelly, currently swupd requires a
hardcoded number of steps per operation so we can report how far in the
operation we are. Most of these step totals are wrong.
This commit fixes the number of steps in many swupd functions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1250,2020-01-02T23:48:28Z,2020-01-16T21:40:52Z,2020-01-16T21:40:52Z,MERGED,True,168,20,5,https://github.com/castulo,Show what indirect dependencies are optional,1,[],https://github.com/clearlinux/swupd-client/pull/1250,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1250,"When using ""bundle-info BUNDLE --dependencies"", information regarding
BUNDLE is presented to the user, this information includes the list of
direct and indirect dependencies BUNDLE has. All direct includes that
are optional (also-add) are marked as such, while there is no way to
distiguish what indirect dependencies are optional with the provided
information.
This commit expands the information shown by the command so indirect
dependencies that are optional are shown as such along with info about
the status of that dependency.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When using ""bundle-info BUNDLE --dependencies"", information regarding
BUNDLE is presented to the user, this information includes the list of
direct and indirect dependencies BUNDLE has. All direct includes that
are optional (also-add) are marked as such, while there is no way to
distiguish what indirect dependencies are optional with the provided
information.
This commit expands the information shown by the command so indirect
dependencies that are optional are shown as such along with info about
the status of that dependency.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1250,2020-01-02T23:48:28Z,2020-01-16T21:40:52Z,2020-01-16T21:40:52Z,MERGED,True,168,20,5,https://github.com/castulo,Show what indirect dependencies are optional,1,[],https://github.com/clearlinux/swupd-client/pull/1250,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1250#issuecomment-571222624,"When using ""bundle-info BUNDLE --dependencies"", information regarding
BUNDLE is presented to the user, this information includes the list of
direct and indirect dependencies BUNDLE has. All direct includes that
are optional (also-add) are marked as such, while there is no way to
distiguish what indirect dependencies are optional with the provided
information.
This commit expands the information shown by the command so indirect
dependencies that are optional are shown as such along with info about
the status of that dependency.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There is a similar problematic in this command to that discussed in PR #1251.
Currently when using the --dependencies option with bundle-info, swupd shows the list of dependencies needed by the specified bundle, using ""editors"" as an example:
$ sudo swupd bundle-info editors --dependencies
__________________________
 Info for bundle: editors
__________________________

Status: Installed

Bundle editors is up to date:
 - Installed bundle last updated in version: 31980
 - Latest available version: 31980

Bundle size:
 - Size of bundle: 921.13 KB
 - Size bundle takes on disk (includes dependencies): 427.76 MB

Direct dependencies (4):
 - os-core
 - emacs (optional, installed)
 - joe (optional, installed)
 - vim (optional, installed)

Indirect dependencies (6):
 - findutils
 - lib-openssl
 - libstdcpp
 - p11-kit
 - perl-basic
 - python3-basic

As it is shown in this example, the direct dependencies show which of these are optional and which are not. However the Indirect dependencies don't make this distinction. This can be misleading because it looks like all indirect dependencies are mandatory, when in fact, they are not. In this example, all of the indirect dependencies are mandatory dependencies of ""emacs"", ""joe"" or ""vim"", which are optional, and because of this, they may or may not be installed when the ""editors"" bundle is installed.
To avoid the problem mentioned above, with this PR, I decided to show all dependencies (mandatory or optional) as optional if the bundle that is including them is optional. Using the same example it would show like this""
$ sudo ./swupd bundle-info editors --dependencies
__________________________
 Info for bundle: editors
__________________________

Status: Installed

Bundle editors is up to date:
 - Installed bundle last updated in version: 31980
 - Latest available version: 31980

Bundle size:
 - Size of bundle: 921.13 KB
 - Size bundle takes on disk (includes dependencies): 427.76 MB

Direct dependencies (4):
 - os-core
 - emacs (optional, installed)
 - joe (optional, installed)
 - vim (optional, installed)

Indirect dependencies (6):
 - findutils (optional, installed)
 - lib-openssl (optional, installed)
 - libstdcpp (optional, installed)
 - p11-kit (optional, installed)
 - perl-basic (optional, installed)
 - python3-basic (optional, installed)

This example is a little radical because all its bundles are optional.
If direct dependencies are mandatory, then their indirect bundles show either as optional or mandatory depending on their actual status. For example:
$ sudo ./swupd bundle-info editors-dev --dependencies
Password:
______________________________
 Info for bundle: editors-dev
______________________________

Status: Installed

Bundle editors-dev is up to date:
 - Installed bundle last updated in version: 31930
 - Latest available version: 31930

Bundle size:
 - Size of bundle: 149.30 KB
 - Size bundle takes on disk (includes dependencies): 1.32 GB

Direct dependencies (18):
 - binutils
 - dev-utils
 - devpkg-ncurses
 - devpkg-systemd
 - diffutils
 - editors
 - git
 - glibc-locale
 - gzip
 - make
 - os-core
 - os-core-dev
 - patch
 - plzip
 - strace
 - unzip
 - which
 - xz

Indirect dependencies (92):
 - bc
 - bison
 - c-basic
 - ... lots more bundles...
 - python3-basic
 - rsync
 - texinfo
 - the_silver_searcher (optional, not installed)
 - valgrind
 - vim (optional, installed) 

But I'm unsure if this is the way to go or if I should just be printing the actual status of an indirect bundle regardless of the status of the direct bundle that includes it. I'd like to hear your opinions @otaviobp @karthikprabhuvinod .",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1251,2020-01-03T17:32:29Z,2020-01-16T23:28:25Z,2020-01-16T23:28:29Z,MERGED,True,57,5,4,https://github.com/castulo,Show optional includes with bundle-list --has-dep,1,[],https://github.com/clearlinux/swupd-client/pull/1251,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1251,"Using the ""bundle-list --has-dep BUNDLE"" command shows a list of bundles
that have BUNDLE as a dependency. However this list is not considering
the bundles that have BUNDLE as an optional dependency.
This commit completes the list by including these bundles.
Closes #1159
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Using the ""bundle-list --has-dep BUNDLE"" command shows a list of bundles
that have BUNDLE as a dependency. However this list is not considering
the bundles that have BUNDLE as an optional dependency.
This commit completes the list by including these bundles.
Closes #1159
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1251,2020-01-03T17:32:29Z,2020-01-16T23:28:25Z,2020-01-16T23:28:29Z,MERGED,True,57,5,4,https://github.com/castulo,Show optional includes with bundle-list --has-dep,1,[],https://github.com/clearlinux/swupd-client/pull/1251,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1251#issuecomment-571213805,"Using the ""bundle-list --has-dep BUNDLE"" command shows a list of bundles
that have BUNDLE as a dependency. However this list is not considering
the bundles that have BUNDLE as an optional dependency.
This commit completes the list by including these bundles.
Closes #1159
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Here is an example of how this implementation works. If you run the command to see what bundles have ""vim"" as a dependency it show this:
$ sudo ./swupd bundle-list --has-dep vim
Installed bundles that have vim as a dependency:
 - editors (as optional)

Total: 1

So swupd will tell you that the ""editors"" bundle has ""vim"" as an optional dependency.
However there are four other bundles that have ""editors"" as a mandatory dependency. So if you run the same command for the editors bundle, you will get this result:
$ sudo ./swupd bundle-list --has-dep editors
Installed bundles that have editors as a dependency:
 - editors-dev
 - os-clr-on-clr
 - os-clr-on-clr-dev
 - user-basic

Total: 4

In this case, since vim is only an optional dependency for editors, it may not necessarily be a dependency for the other four bundles, so I decided to not recurse bundles when looking for bundles that optionally depend on another bundle. If I had recurse bundles, the result from the first command would have looked like this:
$ sudo ./swupd bundle-list --has-dep vim
Installed bundles that have editors as a dependency:
 - editors (as optional)
 - editors-dev
 - os-clr-on-clr
 - os-clr-on-clr-dev
 - user-basic

Total: 5

I think this just makes the result confusing because it would look like vim is a mandatory dependency of the other bundles, so I prefer not to show those bundles....
I guess another option would be to just show it as an optional dependency of the other bundles as well, something like this:
$ sudo ./swupd bundle-list --has-dep vim
Installed bundles that have editors as a dependency:
 - editors (as optional)
 - editors-dev (as optional)
 - os-clr-on-clr (as optional)
 - os-clr-on-clr-dev (as optional)
 - user-basic (as optional)

Total: 5

I would like to hear opinions? @otaviobp @karthikprabhuvinod",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1251,2020-01-03T17:32:29Z,2020-01-16T23:28:25Z,2020-01-16T23:28:29Z,MERGED,True,57,5,4,https://github.com/castulo,Show optional includes with bundle-list --has-dep,1,[],https://github.com/clearlinux/swupd-client/pull/1251,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1251#issuecomment-571245898,"Using the ""bundle-list --has-dep BUNDLE"" command shows a list of bundles
that have BUNDLE as a dependency. However this list is not considering
the bundles that have BUNDLE as an optional dependency.
This commit completes the list by including these bundles.
Closes #1159
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : I feel that term ""optional dependency"" is kind of misnomer. Generally, as a user, I would expect a dependency to be something mandatory(like a blocker for other bundles) and not print any optional ones.
sudo ./swupd bundle-list --has-dep vim
No bundles have vim as a dependency
Total: 0

I think isnt this the current behavior?
OR
Maybe we can enable what you said by means of another option like --optional. Just an idea",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1251,2020-01-03T17:32:29Z,2020-01-16T23:28:25Z,2020-01-16T23:28:29Z,MERGED,True,57,5,4,https://github.com/castulo,Show optional includes with bundle-list --has-dep,1,[],https://github.com/clearlinux/swupd-client/pull/1251,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1251#issuecomment-571345316,"Using the ""bundle-list --has-dep BUNDLE"" command shows a list of bundles
that have BUNDLE as a dependency. However this list is not considering
the bundles that have BUNDLE as an optional dependency.
This commit completes the list by including these bundles.
Closes #1159
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : I feel that term ""optional dependency"" is kind of misnomer. Generally, as a user, I would expect a dependency to be something mandatory(like a blocker for other bundles) and not print any optional ones.
sudo ./swupd bundle-list --has-dep vim
No bundles have vim as a dependency
Total: 0

I think isnt this the current behavior?

Yes, the current behavior is not showing those, but in a previous discussion we determined that to be a bug.

Maybe we can enable what you said by means of another option like --optional. Just an idea

Even if we added an --optional flag it would not solve the problem I asked above about how to print the information in a way that is clear to the user.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1252,2020-01-03T18:40:45Z,2020-01-03T22:29:12Z,2020-01-03T22:29:15Z,MERGED,True,50,10,11,https://github.com/castulo,Show spinner when loading manifests in bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/1252,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1252,"For some options of bundle-list, like --deps and --has-dep, we sometimes
need to download a considerable amount of manifests, if that happens
swupd just seems to hang for some time, this time could be considerably
in slow networks.
This commit enables the spinner while the manifests are baing downloaded
during a bundle-list operation so users know swupd is not hung and it is
doing some downloading.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","For some options of bundle-list, like --deps and --has-dep, we sometimes
need to download a considerable amount of manifests, if that happens
swupd just seems to hang for some time, this time could be considerably
in slow networks.
This commit enables the spinner while the manifests are baing downloaded
during a bundle-list operation so users know swupd is not hung and it is
doing some downloading.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1253,2020-01-03T18:55:49Z,2020-01-03T21:13:47Z,2020-01-03T22:00:13Z,MERGED,True,1,1,1,https://github.com/castulo,Fix an error showing the size during bundle-info,1,[],https://github.com/clearlinux/swupd-client/pull/1253,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1253,"When showing the information of a large bundle, there was a variable
that was incorrectly declared so it was overflowing, turning the size of
the bundle into a negative number.
This commit fixes the issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When showing the information of a large bundle, there was a variable
that was incorrectly declared so it was overflowing, turning the size of
the bundle into a negative number.
This commit fixes the issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1254,2020-01-03T19:09:29Z,2020-01-03T21:59:48Z,2020-01-03T21:59:52Z,MERGED,True,18,12,4,https://github.com/castulo,Function to print a header,1,[],https://github.com/clearlinux/swupd-client/pull/1254,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1254,"This commit adds a function to print a header in a consistent manner
accross different swupd functions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a function to print a header in a consistent manner
accross different swupd functions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1255,2020-01-03T21:58:40Z,2020-01-07T21:27:23Z,2020-01-07T21:27:23Z,CLOSED,False,34,3,25,https://github.com/castulo,Adding command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/1255,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1255,"This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1255,2020-01-03T21:58:40Z,2020-01-07T21:27:23Z,2020-01-07T21:27:23Z,CLOSED,False,34,3,25,https://github.com/castulo,Adding command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/1255,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1255#issuecomment-570721946,"This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : Hey Castulo , this is a good addition. I was thinking we should also have something like example section for all swupd commands which lists a few popular ways of using it.... helps a beginner ramp up fast if he/she comes from another linux distro world?
for eg for update:
Usage:
Description:
Example:
swupd update -V 10  -- update to a specific version
swupd update            -- updates to latest version
Maybe we can discuss this once @otaviobp is back. Let me know what you feel?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1255,2020-01-03T21:58:40Z,2020-01-07T21:27:23Z,2020-01-07T21:27:23Z,CLOSED,False,34,3,25,https://github.com/castulo,Adding command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/1255,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1255#issuecomment-570723795,"This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : Hey Castulo , this is a good addition. I was thinking we should also have something like example section for all swupd commands which lists a few popular ways of using it.... helps a beginner ramp up fast if he/she comes from another linux distro world?
for eg for update:
Usage:
Description:
Example:
swupd update -V 10 -- update to a specific version
swupd update -- updates to latest version
Maybe we can discuss this once @otaviobp is back. Let me know what you feel?

 yeah we can discuss it with @otaviobp, I like the idea of having examples but I'm not sure the ""--help"" menus are the best place for them or if we should just have them in the manual. In either case that is separate from this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1255,2020-01-03T21:58:40Z,2020-01-07T21:27:23Z,2020-01-07T21:27:23Z,CLOSED,False,34,3,25,https://github.com/castulo,Adding command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/1255,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1255#issuecomment-571264734,"This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : Suggest to add a print inside print_help for third_party command like
print(""3rd-party provides users a mechanism to build, add custom packages which are not present upstream \n\n"");
Because if I am new to swupd and type sudo ./swupd 3rd-party ...there is no way for me to really understand what the term actually means
https://github.com/clearlinux/swupd-client/blob/master/src/3rd_party.c#L43-L58",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1255,2020-01-03T21:58:40Z,2020-01-07T21:27:23Z,2020-01-07T21:27:23Z,CLOSED,False,34,3,25,https://github.com/castulo,Adding command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/1255,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1255#issuecomment-571340476,"This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : Suggest to add a print inside print_help for third_party command like

Good catch @karthikprabhuvinod , I forgot that general command. I'll add a short description to it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1255,2020-01-03T21:58:40Z,2020-01-07T21:27:23Z,2020-01-07T21:27:23Z,CLOSED,False,34,3,25,https://github.com/castulo,Adding command descriptions,1,[],https://github.com/clearlinux/swupd-client/pull/1255,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1255#issuecomment-571780848,"This commit adds a shoort description for the help menu of all swupd
commands.
Closes #1108
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Moved this commit to PR #1260 so I'm closing this PR.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1256,2020-01-04T00:17:22Z,2020-01-22T21:01:54Z,2020-01-31T21:50:43Z,MERGED,True,38,19,3,https://github.com/karthikprabhuvinod,autoupdate: adding auto-update test back,1,[],https://github.com/clearlinux/swupd-client/pull/1256,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1256,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1256,2020-01-04T00:17:22Z,2020-01-22T21:01:54Z,2020-01-31T21:50:43Z,MERGED,True,38,19,3,https://github.com/karthikprabhuvinod,autoupdate: adding auto-update test back,1,[],https://github.com/clearlinux/swupd-client/pull/1256,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1256#issuecomment-570736827,Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com,#1120,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1257,2020-01-04T00:35:14Z,2020-01-05T02:43:59Z,2020-01-05T02:44:04Z,MERGED,True,38,0,1,https://github.com/castulo,Testlib option to create a replica of a test env,1,[],https://github.com/clearlinux/swupd-client/pull/1257,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1257,"Sometimes when a test finds a problem in the source code it is difficult
to determine what is the problem in the code, so the code needs to be
debugged. In order to do this, the test environment of the particular
test has to be created but without running the test, so we can run the
command executed by the test with the debugger.
This commit adds a function (create_test_environment_only) to create a
specific test environment based on a bats file, but without running the
test.
Closes #1166
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Sometimes when a test finds a problem in the source code it is difficult
to determine what is the problem in the code, so the code needs to be
debugged. In order to do this, the test environment of the particular
test has to be created but without running the test, so we can run the
command executed by the test with the debugger.
This commit adds a function (create_test_environment_only) to create a
specific test environment based on a bats file, but without running the
test.
Closes #1166
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1258,2020-01-06T17:52:56Z,2020-01-08T19:36:49Z,2020-01-08T19:36:53Z,MERGED,True,77,8,6,https://github.com/castulo,Add ability to search files in specific version,1,[],https://github.com/clearlinux/swupd-client/pull/1258,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1258,"The search-file command is restricted to looking for files in the
current version. This commit adds the --version option to the command
that can be used to seach for files in specific versions of Clear.
Closes #1155
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The search-file command is restricted to looking for files in the
current version. This commit adds the --version option to the command
that can be used to seach for files in specific versions of Clear.
Closes #1155
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1259,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1259#issuecomment-572194448,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : I had a general question, cant we use the --path instead of new option of --file or --folder? The option --file does not directly mean that it is a folder. Path on the other hand, could mean it could be a file/folder.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1259#issuecomment-572220637,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : I had a general question, cant we use the --path instead of new option of --file or --folder? The option --file does not directly mean that it is a folder. Path on the other hand, could mean it could be a file/folder.

I though of that, but --path is already a global variable used for something completely different (it adds a path prefix to all swupd operations). And since everything is a file in Linux I decided to go with that. I'm open to change that if we find a better flag.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/karthikprabhuvinod,4,https://github.com/clearlinux/swupd-client/pull/1259#issuecomment-572228402,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : I had a general question, cant we use the --path instead of new option of --file or --folder? The option --file does not directly mean that it is a folder. Path on the other hand, could mean it could be a file/folder.

I though of that, but --path is already a global variable used for something completely different (it adds a path prefix to all swupd operations). And since everything is a file in Linux I decided to go with that. I'm open to change that if we find a better flag.

Hmm. I feel path has a different context for each swupd command. Like --path for os-install would mean creating a new os installed in a given path.
I feel --path for diagnose/repair actually gives out the real meaning to the user without side-effects. Also added advantage of one less to learn
the --file option on the other hand could mean folder/file. I have a feeling it can lead to confusions.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1259#issuecomment-572231403,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@castulo : I had a general question, cant we use the --path instead of new option of --file or --folder? The option --file does not directly mean that it is a folder. Path on the other hand, could mean it could be a file/folder.

I though of that, but --path is already a global variable used for something completely different (it adds a path prefix to all swupd operations). And since everything is a file in Linux I decided to go with that. I'm open to change that if we find a better flag.

Hmm. I feel path has a different context for each swupd command. Like --path for os-install would mean creating a new os installed in a given path.
I feel --path for diagnose/repair actually gives out the real meaning to the user without side-effects. Also added advantage of one less to learn
the --file option on the other hand could mean folder/file. I have a feeling it can lead to confusions.

I think you are confused, --path has the same meaning everywhere in swupd since it is a global variable. Even in os-install it has the same meaning, in that case we are changing the path_prefix using --path so we can just use ""repair/verify --fix"" to install missing files in that path.
So as I was saying, I'm open to using a different flag if we find something better than --file but definitely --path is not that since we are already using it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1259#issuecomment-578201767,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Summarizing some of the changes required in functionality:

When --file is used along with --picky, swupd should look for extra files in the path or file provided by the user. Example: swupd repair --file /my/path --picky will only repair files in /my/path and will also just check for extra files in /my/path.
When --file is used along with --picky and --picky-tree then swupd will only diagnose/repair files in the provided path, but will check for extra files in the path provided by --picky-tree
The same applies for --extra-files-only, if used with --file the extra files will be looked for in the path provided by --file unless the user also provides the --picky-tree flag in which case that path should be used.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1259,2020-01-06T20:51:46Z,2020-01-28T23:01:49Z,2020-01-29T00:39:45Z,MERGED,True,677,60,17,https://github.com/castulo,Implement --file option for diagnose and repair,2,[],https://github.com/clearlinux/swupd-client/pull/1259,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1259#issuecomment-578275801,"When diagnosing/repairing a system, sometimes is useful to only diagnose/repair a
specific file or path.
This commit implements the --file option for diagnose/repair so a file or path
can be diagnosed/repaired only instead of doing it to the whole OS or a whole
bundle.
Closes #1150
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

code rebased
Changed log function names: error_unmarked -> error_unlabeled and warn_unmarked -> warn_unlabeled
Using the 'remove_trailing_slash()` function in the command parser
Allow the use of the --file flag along with --bundles, --picky and --extra-files-only
Disallow the use of the --file flag with the legacy verify command to discourage users from using it",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1260,2020-01-07T21:25:45Z,2020-01-16T23:37:17Z,2020-01-17T00:07:53Z,MERGED,True,70,26,26,https://github.com/castulo,swupd documentation improvements,2,[],https://github.com/clearlinux/swupd-client/pull/1260,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1260,"This PR makes a couple of improvements in the swupd documentation:

Adds a short description to all swupd commands.
Rephrases the --picky related documentation to make it clearer to the user.

Closes #1205
Closes #1108","This PR makes a couple of improvements in the swupd documentation:

Adds a short description to all swupd commands.
Rephrases the --picky related documentation to make it clearer to the user.

Closes #1205
Closes #1108",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1261,2020-01-08T19:16:27Z,2020-01-17T21:36:23Z,2020-01-17T21:36:26Z,MERGED,True,110,70,5,https://github.com/castulo,Implementing tree view for `bundle-list --deps`,2,[],https://github.com/clearlinux/swupd-client/pull/1261,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1261,"Sometimes is useful to see the list of dependencies in a tree view form, for example when trying to remove bundles from a system.
This commit adds the ability of listing the dependencies of a bundle in  a tree view when --verbose is used.
Example:
$ sudo ./swupd bundle-list --deps vim
Loading required manifests...

Bundles included by vim:
 - findutils
 - lib-openssl
 - libstdcpp
 - os-core
 - p11-kit
 - perl-basic
 - python3-basic

Total: 7

$ sudo ./swupd bundle-list --deps vim --verbose
Loading required manifests...

Bundles included by vim:
  * vim
    |-- perl-basic
        |-- lib-openssl
            |-- p11-kit
                |-- findutils
                    |-- os-core
                |-- os-core
            |-- os-core
        |-- os-core
    |-- python3-basic
        |-- libstdcpp
            |-- os-core
        |-- p11-kit
            |-- findutils
                |-- os-core
            |-- os-core
        |-- os-core
    |-- os-core

Total: 7

Closes #929","Sometimes is useful to see the list of dependencies in a tree view form, for example when trying to remove bundles from a system.
This commit adds the ability of listing the dependencies of a bundle in  a tree view when --verbose is used.
Example:
$ sudo ./swupd bundle-list --deps vim
Loading required manifests...

Bundles included by vim:
 - findutils
 - lib-openssl
 - libstdcpp
 - os-core
 - p11-kit
 - perl-basic
 - python3-basic

Total: 7

$ sudo ./swupd bundle-list --deps vim --verbose
Loading required manifests...

Bundles included by vim:
  * vim
    |-- perl-basic
        |-- lib-openssl
            |-- p11-kit
                |-- findutils
                    |-- os-core
                |-- os-core
            |-- os-core
        |-- os-core
    |-- python3-basic
        |-- libstdcpp
            |-- os-core
        |-- p11-kit
            |-- findutils
                |-- os-core
            |-- os-core
        |-- os-core
    |-- os-core

Total: 7

Closes #929",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1261,2020-01-08T19:16:27Z,2020-01-17T21:36:23Z,2020-01-17T21:36:26Z,MERGED,True,110,70,5,https://github.com/castulo,Implementing tree view for `bundle-list --deps`,2,[],https://github.com/clearlinux/swupd-client/pull/1261,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1261#issuecomment-575793276,"Sometimes is useful to see the list of dependencies in a tree view form, for example when trying to remove bundles from a system.
This commit adds the ability of listing the dependencies of a bundle in  a tree view when --verbose is used.
Example:
$ sudo ./swupd bundle-list --deps vim
Loading required manifests...

Bundles included by vim:
 - findutils
 - lib-openssl
 - libstdcpp
 - os-core
 - p11-kit
 - perl-basic
 - python3-basic

Total: 7

$ sudo ./swupd bundle-list --deps vim --verbose
Loading required manifests...

Bundles included by vim:
  * vim
    |-- perl-basic
        |-- lib-openssl
            |-- p11-kit
                |-- findutils
                    |-- os-core
                |-- os-core
            |-- os-core
        |-- os-core
    |-- python3-basic
        |-- libstdcpp
            |-- os-core
        |-- p11-kit
            |-- findutils
                |-- os-core
            |-- os-core
        |-- os-core
    |-- os-core

Total: 7

Closes #929","V2:

rebased on master",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1262,2020-01-08T21:10:30Z,2020-01-10T23:25:10Z,2020-01-10T23:25:13Z,MERGED,True,52,1,2,https://github.com/karthikprabhuvinod,Add functional test for info,1,[],https://github.com/clearlinux/swupd-client/pull/1262,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1262,"Add info tests
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","Add info tests
Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1263,2020-01-09T23:19:10Z,2020-01-17T17:45:19Z,2020-01-17T18:37:00Z,MERGED,True,38,5,1,https://github.com/castulo,Showing how much space was freed when cleaning,1,[],https://github.com/clearlinux/swupd-client/pull/1263,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1263,"Closes #1107
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Closes #1107
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1264,2020-01-09T23:28:48Z,2020-01-21T20:43:18Z,2020-01-21T20:43:18Z,CLOSED,False,166,27,4,https://github.com/karthikprabhuvinod,(WIP) check-update: Add more functional tests,1,[],https://github.com/clearlinux/swupd-client/pull/1264,https://github.com/karthikprabhuvinod,1,https://github.com/clearlinux/swupd-client/pull/1264,"This PR adds more functional tests for check-update
to test below functionality

 check-update --nosigcheck
 check-update -u
 check-update -v -c
 check-update -u -P
 check-update --ignore-time

Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com","This PR adds more functional tests for check-update
to test below functionality

 check-update --nosigcheck
 check-update -u
 check-update -v -c
 check-update -u -P
 check-update --ignore-time

Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1264,2020-01-09T23:28:48Z,2020-01-21T20:43:18Z,2020-01-21T20:43:18Z,CLOSED,False,166,27,4,https://github.com/karthikprabhuvinod,(WIP) check-update: Add more functional tests,1,[],https://github.com/clearlinux/swupd-client/pull/1264,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1264#issuecomment-576872220,"This PR adds more functional tests for check-update
to test below functionality

 check-update --nosigcheck
 check-update -u
 check-update -v -c
 check-update -u -P
 check-update --ignore-time

Signed-off-by: Karthik Prabhu Vinod karthik.prabhu.vinod@intel.com",Closing this for now..can reference this in future,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1265,2020-01-10T22:15:19Z,2020-01-11T00:14:02Z,2020-01-11T00:14:06Z,MERGED,True,160,158,20,https://github.com/castulo,Fix name of 3rd-party directory,2,[],https://github.com/clearlinux/swupd-client/pull/1265,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1265,"The name of the 3rd-party repository directory is currently 3rd_party, this name is incorrect and needs to be changed to 3rd-party. This PR fixes that.","The name of the 3rd-party repository directory is currently 3rd_party, this name is incorrect and needs to be changed to 3rd-party. This PR fixes that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1265,2020-01-10T22:15:19Z,2020-01-11T00:14:02Z,2020-01-11T00:14:06Z,MERGED,True,160,158,20,https://github.com/castulo,Fix name of 3rd-party directory,2,[],https://github.com/clearlinux/swupd-client/pull/1265,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1265#issuecomment-573242142,"The name of the 3rd-party repository directory is currently 3rd_party, this name is incorrect and needs to be changed to 3rd-party. This PR fixes that.","V2:

Use a constant to define the name of the 3rd-party directory to use instead of hard-coding it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1266,2020-01-13T18:47:27Z,2020-02-07T16:58:46Z,2020-02-07T16:58:49Z,MERGED,True,9,2,3,https://github.com/castulo,Use the user specified path for 3rd-party cert,1,[],https://github.com/clearlinux/swupd-client/pull/1266,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1266,"When using 3rd-party repos, swupd looks for the certificate to use
inside the repository directory, if the user specifies another location
it is just ignored.
If the user specifies a different path for the certificate, it should be
used. This commit fixes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When using 3rd-party repos, swupd looks for the certificate to use
inside the repository directory, if the user specifies another location
it is just ignored.
If the user specifies a different path for the certificate, it should be
used. This commit fixes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1266,2020-01-13T18:47:27Z,2020-02-07T16:58:46Z,2020-02-07T16:58:49Z,MERGED,True,9,2,3,https://github.com/castulo,Use the user specified path for 3rd-party cert,1,[],https://github.com/clearlinux/swupd-client/pull/1266,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1266#issuecomment-573840789,"When using 3rd-party repos, swupd looks for the certificate to use
inside the repository directory, if the user specifies another location
it is just ignored.
If the user specifies a different path for the certificate, it should be
used. This commit fixes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",LGTM to me @castulo,True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1266,2020-01-13T18:47:27Z,2020-02-07T16:58:46Z,2020-02-07T16:58:49Z,MERGED,True,9,2,3,https://github.com/castulo,Use the user specified path for 3rd-party cert,1,[],https://github.com/clearlinux/swupd-client/pull/1266,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1266#issuecomment-576391793,"When using 3rd-party repos, swupd looks for the certificate to use
inside the repository directory, if the user specifies another location
it is just ignored.
If the user specifies a different path for the certificate, it should be
used. This commit fixes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

Removed a TODO that was not applicable anymore.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1266,2020-01-13T18:47:27Z,2020-02-07T16:58:46Z,2020-02-07T16:58:49Z,MERGED,True,9,2,3,https://github.com/castulo,Use the user specified path for 3rd-party cert,1,[],https://github.com/clearlinux/swupd-client/pull/1266,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1266#issuecomment-578864157,"When using 3rd-party repos, swupd looks for the certificate to use
inside the repository directory, if the user specifies another location
it is just ignored.
If the user specifies a different path for the certificate, it should be
used. This commit fixes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3:

added a new global variable that would indicate if a user specified a cert path.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1267,2020-01-13T23:32:26Z,2020-01-16T23:43:30Z,2020-01-16T23:43:30Z,MERGED,True,111,109,16,https://github.com/castulo,Moving the content from 3rd-party bundles,1,[],https://github.com/clearlinux/swupd-client/pull/1267,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1267,"This commit moves the path where the content from 3rd-party bundles is
going to be installed from opt/3rd-party/<bundle_name> to
/opt/3rd-party/bundles/<bundle_name> so bundle directories are separated
from other top level directories like bin.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit moves the path where the content from 3rd-party bundles is
going to be installed from opt/3rd-party/<bundle_name> to
/opt/3rd-party/bundles/<bundle_name> so bundle directories are separated
from other top level directories like bin.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1267,2020-01-13T23:32:26Z,2020-01-16T23:43:30Z,2020-01-16T23:43:30Z,MERGED,True,111,109,16,https://github.com/castulo,Moving the content from 3rd-party bundles,1,[],https://github.com/clearlinux/swupd-client/pull/1267,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1267#issuecomment-573925852,"This commit moves the path where the content from 3rd-party bundles is
going to be installed from opt/3rd-party/<bundle_name> to
/opt/3rd-party/bundles/<bundle_name> so bundle directories are separated
from other top level directories like bin.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1268,2020-01-14T20:26:42Z,2020-01-22T21:06:48Z,2020-01-22T21:06:49Z,MERGED,True,9,3,3,https://github.com/castulo,Do not run scripts after updating from 3rd-party,1,[],https://github.com/clearlinux/swupd-client/pull/1268,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1268,"Swupd should not run post-update scripts after updating content from a
3rd-party repo since it may threaten the security of the system.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Swupd should not run post-update scripts after updating content from a
3rd-party repo since it may threaten the security of the system.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1268,2020-01-14T20:26:42Z,2020-01-22T21:06:48Z,2020-01-22T21:06:49Z,MERGED,True,9,3,3,https://github.com/castulo,Do not run scripts after updating from 3rd-party,1,[],https://github.com/clearlinux/swupd-client/pull/1268,https://github.com/karthikprabhuvinod,2,https://github.com/clearlinux/swupd-client/pull/1268#issuecomment-575281905,"Swupd should not run post-update scripts after updating content from a
3rd-party repo since it may threaten the security of the system.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",whats the security threat here?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1269,2020-01-16T16:55:45Z,2020-01-22T21:08:19Z,2020-01-22T21:08:19Z,MERGED,True,300,217,21,https://github.com/castulo,Organizing compare-like functions,1,[],https://github.com/clearlinux/swupd-client/pull/1269,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1269,"We used compare-like functions as arguments to other functions that
filter, sort, compare data. These functions are scattered accros the
code and they are sometimes difficult to identify so there is a lot of
code duplication.
This commit organizes all the compare like functions throughout the code
in the same place and with standard naming so it is easier to find them
and reuse them.
Closes #1167
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","We used compare-like functions as arguments to other functions that
filter, sort, compare data. These functions are scattered accros the
code and they are sometimes difficult to identify so there is a lot of
code duplication.
This commit organizes all the compare like functions throughout the code
in the same place and with standard naming so it is easier to find them
and reuse them.
Closes #1167
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1269,2020-01-16T16:55:45Z,2020-01-22T21:08:19Z,2020-01-22T21:08:19Z,MERGED,True,300,217,21,https://github.com/castulo,Organizing compare-like functions,1,[],https://github.com/clearlinux/swupd-client/pull/1269,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1269#issuecomment-575842988,"We used compare-like functions as arguments to other functions that
filter, sort, compare data. These functions are scattered accros the
code and they are sometimes difficult to identify so there is a lot of
code duplication.
This commit organizes all the compare like functions throughout the code
in the same place and with standard naming so it is easier to find them
and reuse them.
Closes #1167
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

Removed the categories and renamed all the functions following the same name convention
Returned functions that were too specific (and unlikely to reuse) as static functions in the file where they are used
Moved all functions in their own header file instead of using swupd.h",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1271,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575382925,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270",LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/karthikprabhuvinod,3,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575388799,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","@castulo The content changes its formatting right after first occurrence of
-C, --certpath
I am not sure why!! checking",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575397068,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","@castulo The content changes its formatting right after first occurrence of
-C, --certpath
I am not sure why!! checking

What do you mean? Did you use rst2man to convert the file to man format and opened it using the man command and you saw problems with the formatting? I did that and it looks good on my side.
Plus there is only one occurrence of --certpath, so I'm not sure what you mean. ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/karthikprabhuvinod,5,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575398966,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","@castulo The content changes its formatting right after first occurrence of
-C, --certpath
I am not sure why!! checking

What do you mean? Did you use rst2man to convert the file to man format and opened it using the man command and you saw problems with the formatting? I did that and it looks good on my side.
Plus there is only one occurrence of --certpath, so I'm not sure what you mean. 

if you open the file(swupd.1.rst) in github and check the first occurence you will see the explanation of --certpath is greyed out",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575403589,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","if you open the file in github and check the first occurence you will see the explanation of --certpath is greyed out

I still don't know what you mean, I don't see anything wrong/weird, and as I said --certpath exists only once in the document, so I don't know why you see more occurrences.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/phmccarty,7,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575483091,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","I see the rendering oddity as well:

Click Files changed tab
Click the ... dropdown at the top-right of the diff view of docs/swupd.1.rst, and select View file
Scroll down the where the -S, --statedir={path} options are documented. You will see that the documentation for that option is rendered normally. But compare with the rendering of the doc for -C, --certpath that follows. There is a grey vertical bar that appears to indicate a blockquote, and it's indented further. The remainder of the man page renders in a similar, unexpected way, where lines are blockquoted.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,8,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575708947,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","I see the rendering oddity as well:

Click Files changed tab
Click the ... dropdown at the top-right of the diff view of docs/swupd.1.rst, and select View file
Scroll down the where the -S, --statedir={path} options are documented. You will see that the documentation for that option is rendered normally. But compare with the rendering of the doc for -C, --certpath that follows. There is a grey vertical bar that appears to indicate a blockquote, and it's indented further. The remainder of the man page renders in a similar, unexpected way, where lines are blockquoted.


Ahh I see it now, thanks for the detailed explanation  @phmccarty.
It is strange in deed, as I mentioned, if I convert that file to a man page locally and open it with man it renders correctly. I'll investigate further. ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,9,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575712584,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","I see now that the document looks like that in master too. But I think I know what is causing it, I'll submit an update to fix it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/karthikprabhuvinod,10,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575727208,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270",@castulo: Its corrected now but still appears in Subcommands section now of the same document,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,11,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575732418,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","Ok, I see now what is going on @karthikprabhuvinod @phmccarty. A paragraph with different indentation in reStructuredText (.rst) is considered a blockquote as @phmccarty mentioned.
""A text block that is indented relative to the preceding text, without preceding markup indicating it to be a literal block or other content, is a block quote. ""
So when GitHub is rendering the file, it is rendering it as an rst file. However we really don't care about the correct rendering of the file in rst mode since we are further converting that file from .rst to man format using rst2man. If I remove the indentation in the document so it renders properly in rst form, we loose the indentation we want in the man page, which is the one we care about.
This is an excerpt of the man page when removing the indentation from the description of the info command:
SUBCOMMANDS
       info

       Shows the current OS version and the URLs used for updates.

       autoupdate [--enable|--disable]
          Enables or disables automatic updates, or reports current status. Enabling updates does not cause an immediate update -
          use swupd update to force one if desired.

You can see how the description from info has different indentation than that of autoupdate, so we cannot really remove the indentation so it renders fine on .rst unless we are ok with loosing the indentation in the man page as shown above.
In that example doesn't look that bad since it was one line, but if removing the indentation from more lines it looks like this:
SUBCOMMANDS
       info

       Shows the current OS version and the URLs used for updates.

       autoupdate [--enable|--disable]

       Enables  or  disables  automatic updates, or reports current status. Enabling updates does not cause an immediate update -
       use swupd update to force one if desired.

       check-update

       Checks whether an update is available and prints out the information if so. Does not download update content.

       update

       Performs a system software update.

       The program will contact the version server at the version url, and check to see if a system software update is available.
       If  an  update  is  available, the update content will be downloaded from the content url and stored in the /var/lib/swupd
       state path. Once all content is downloaded and verified, the update is applied to the system.

       In case any problem arises during a software update, the program attempts to correct the issue, possibly by  performing  a
       swupd repair operation, which corrects broken or missing files and other issues.

       After the update is applied, the system performs an array of post-update actions. These actions are triggered through sys
       temd(1) and reside in the update-triggers.target(4) system target.

        -V, --version

         Update to a specific version, also accepts 'latest' (default).

IMO the swupd commands get lost very easily. I like it better when they are indented.
Opinions @otaviobp @karthikprabhuvinod @phmccarty ?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/phmccarty,12,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575823286,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","@castulo Any reason to not use a bulleted list for the subcommands as well, similar to the option list?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/castulo,13,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-575826265,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","@castulo Any reason to not use a bulleted list for the subcommands as well, similar to the option list?

Not really, at least not from my side, whoever created the manual initially decided to go with this format, but it could be changed I guess.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/otaviobp,14,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-577390469,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270","@castulo Any reason to not use a bulleted list for the subcommands as well, similar to the option list?

Actually for me it's very weird to use a bullet list for options. I never saw a man page like that. So I would remove that. Options list from globals is also rendered differently from the list in the sub-commands. But as this wasn't introduced by this patch, I won't consider this a problem.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/otaviobp,15,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-577392470,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270",merged.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1271,2020-01-16T22:22:22Z,2020-01-22T21:23:53Z,2020-01-22T21:27:09Z,CLOSED,False,481,343,2,https://github.com/castulo,3rd party manual,5,[],https://github.com/clearlinux/swupd-client/pull/1271,https://github.com/otaviobp,16,https://github.com/clearlinux/swupd-client/pull/1271#issuecomment-577393717,"This PR makes a few updates to the swupd man page, and adds the 3rd-party related documentation.
Closes #1270",I created an issue to cover the reported problems: #1285,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1276,2020-01-20T23:35:15Z,2020-01-22T21:10:50Z,2020-01-22T21:10:50Z,MERGED,True,267,28,16,https://github.com/castulo,Show what bundles are explicitly installed vs implicitly installed with bundle-list,2,[],https://github.com/clearlinux/swupd-client/pull/1276,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1276,"The ""bundle-list"" command can be used to show all installed bundles in the system, however, currently there is no way to know which of those installed bundles were implicitly or explicitly installed. Issue #1272 was opened to implement a way of getting this information with swupd.
This PR implements the ""--status"" flag for bundle-list which can be used to show which bundles were explicitly or implicitly installed.
This PR also adds this information to the installation status of the bundle-info command.
Closes #1272","The ""bundle-list"" command can be used to show all installed bundles in the system, however, currently there is no way to know which of those installed bundles were implicitly or explicitly installed. Issue #1272 was opened to implement a way of getting this information with swupd.
This PR implements the ""--status"" flag for bundle-list which can be used to show which bundles were explicitly or implicitly installed.
This PR also adds this information to the installation status of the bundle-info command.
Closes #1272",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1284,2020-01-22T18:56:53Z,2020-01-23T18:20:31Z,2020-01-23T18:20:31Z,MERGED,True,9,8,1,https://github.com/castulo,Fix return value overwriting during bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/1284,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1284,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1284,2020-01-22T18:56:53Z,2020-01-23T18:20:31Z,2020-01-23T18:20:31Z,MERGED,True,9,8,1,https://github.com/castulo,Fix return value overwriting during bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/1284,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1284#issuecomment-577372886,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,"V2:

fixed the error codes returned by the function.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1284,2020-01-22T18:56:53Z,2020-01-23T18:20:31Z,2020-01-23T18:20:31Z,MERGED,True,9,8,1,https://github.com/castulo,Fix return value overwriting during bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/1284,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1284#issuecomment-577426900,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,"V3:

removed unnecessary ret_code assignments",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1286,2020-01-23T20:58:59Z,2020-01-28T17:21:41Z,2020-02-20T21:24:16Z,MERGED,True,45,30,8,https://github.com/otaviobp,docs: Explicitly adding a list of files in the doc check exclude list,1,[],https://github.com/clearlinux/swupd-client/pull/1286,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1286,"We have a list of header files that weren't documented yet. Add them explicitly
to the check to prevent us to lower the quality of the documentation of headers
that are well documented.
Also fixing some documentation that weren't included because of incorrect style.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We have a list of header files that weren't documented yet. Add them explicitly
to the check to prevent us to lower the quality of the documentation of headers
that are well documented.
Also fixing some documentation that weren't included because of incorrect style.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1287,2020-01-23T21:40:15Z,2020-01-29T23:36:52Z,2020-01-29T23:36:52Z,CLOSED,False,351,38,12,https://github.com/castulo,Implementation: create links to binaries exported by a 3rd-party repository on bundle-add,4,[],https://github.com/clearlinux/swupd-client/pull/1287,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1287,"This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277","This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1287,2020-01-23T21:40:15Z,2020-01-29T23:36:52Z,2020-01-29T23:36:52Z,CLOSED,False,351,38,12,https://github.com/castulo,Implementation: create links to binaries exported by a 3rd-party repository on bundle-add,4,[],https://github.com/clearlinux/swupd-client/pull/1287,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1287#issuecomment-578328330,"This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277","V2:

Validating that the binaries won't have conflicts before installing the bundle",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1287,2020-01-23T21:40:15Z,2020-01-29T23:36:52Z,2020-01-29T23:36:52Z,CLOSED,False,351,38,12,https://github.com/castulo,Implementation: create links to binaries exported by a 3rd-party repository on bundle-add,4,[],https://github.com/clearlinux/swupd-client/pull/1287,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1287#issuecomment-578936572,"This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277","V3:

added a test to validate that bundles with conflicting binaries won't get installed",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1287,2020-01-23T21:40:15Z,2020-01-29T23:36:52Z,2020-01-29T23:36:52Z,CLOSED,False,351,38,12,https://github.com/castulo,Implementation: create links to binaries exported by a 3rd-party repository on bundle-add,4,[],https://github.com/clearlinux/swupd-client/pull/1287,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1287#issuecomment-579938879,"This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277","V4:

Rebased against master.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1287,2020-01-23T21:40:15Z,2020-01-29T23:36:52Z,2020-01-29T23:36:52Z,CLOSED,False,351,38,12,https://github.com/castulo,Implementation: create links to binaries exported by a 3rd-party repository on bundle-add,4,[],https://github.com/clearlinux/swupd-client/pull/1287,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1287#issuecomment-579989154,"This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277",@otaviobp I addressed all your comments in this new update,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1287,2020-01-23T21:40:15Z,2020-01-29T23:36:52Z,2020-01-29T23:36:52Z,CLOSED,False,351,38,12,https://github.com/castulo,Implementation: create links to binaries exported by a 3rd-party repository on bundle-add,4,[],https://github.com/clearlinux/swupd-client/pull/1287,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1287#issuecomment-580014510,"This PR implements the workflow described in issue #1277.
When installing a bundle from a 3rd-party repository, if the bundle has files that are marked with 'x' in the manifest (as exported), and the files have one of the qualifying paths for binaries ('/bin', '/usr/bin', '/usr/local/bin'), these files will be made available to the user via a script file that will reside in '/opt/3rd-party/bin'.
These scripts will export the appropriate PATH and libraries and will call the correct binary from the 3rd-party content.
Closes #1277","I'm going to reorganize the code from PRs #1287, #1290 and #1295, since they are all related. I will open new PR(s) to replace these 3.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1288,2020-01-24T20:10:20Z,2020-01-28T23:02:22Z,2020-01-29T00:39:33Z,MERGED,True,1,4,1,https://github.com/castulo,Removing legacy verify command from autocompletion,1,[],https://github.com/clearlinux/swupd-client/pull/1288,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1288,"The ""verify"" command was superceded many months ago. The command
still works and will continue to work for backward compatibility, but
users are discouraged to use it. To motivate users to use the newer
commands, all references to the legacy command has now been removed
from the swupd man page and the help menus.
This commit removes the command from the bash autocompletion script too.
This should have been done as part of PR #1231
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The ""verify"" command was superceded many months ago. The command
still works and will continue to work for backward compatibility, but
users are discouraged to use it. To motivate users to use the newer
commands, all references to the legacy command has now been removed
from the swupd man page and the help menus.
This commit removes the command from the bash autocompletion script too.
This should have been done as part of PR #1231
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1290,2020-01-27T21:26:54Z,2020-01-29T23:36:58Z,2020-01-29T23:36:58Z,CLOSED,False,520,61,26,https://github.com/castulo,Implementation: remove links to binaries exported by a 3rd-party repository on bundle-remove,5,[],https://github.com/clearlinux/swupd-client/pull/1290,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1290,"When removing a 3rd-party bundle, all scripts that export the binaries of the bundle should be removed from the target system unless they are still required by another installed 3rd-party bundle.
Closes #1278
Note: This PR was created o top of PR #1287, that PR needs to be reviewed first.","When removing a 3rd-party bundle, all scripts that export the binaries of the bundle should be removed from the target system unless they are still required by another installed 3rd-party bundle.
Closes #1278
Note: This PR was created o top of PR #1287, that PR needs to be reviewed first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1290,2020-01-27T21:26:54Z,2020-01-29T23:36:58Z,2020-01-29T23:36:58Z,CLOSED,False,520,61,26,https://github.com/castulo,Implementation: remove links to binaries exported by a 3rd-party repository on bundle-remove,5,[],https://github.com/clearlinux/swupd-client/pull/1290,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1290#issuecomment-580014533,"When removing a 3rd-party bundle, all scripts that export the binaries of the bundle should be removed from the target system unless they are still required by another installed 3rd-party bundle.
Closes #1278
Note: This PR was created o top of PR #1287, that PR needs to be reviewed first.","I'm going to reorganize the code from PRs #1287, #1290 and #1295, since they are all related. I will open new PR(s) to replace these 3.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1292,2020-01-28T17:49:26Z,2020-01-28T18:20:02Z,2020-01-28T18:20:07Z,MERGED,True,4,8,4,https://github.com/castulo,Force to run all 3rd-party commands with root,1,[],https://github.com/clearlinux/swupd-client/pull/1292,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1292,"Some of the regular swupd commands can be run with a regular user, for
example check-update, however this is not the case for 3rd-party
commands, all of them require root privileges since they all need to at
least read data from root owned directories.
This commit enables swupd to require root privileges for all 3rd-party
commands at initialization time.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some of the regular swupd commands can be run with a regular user, for
example check-update, however this is not the case for 3rd-party
commands, all of them require root privileges since they all need to at
least read data from root owned directories.
This commit enables swupd to require root privileges for all 3rd-party
commands at initialization time.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1293,2020-01-28T21:24:12Z,2020-01-29T20:03:30Z,2020-01-29T20:05:40Z,MERGED,True,109,23,1,https://github.com/castulo,Rebalancing tests for github actions,1,[],https://github.com/clearlinux/swupd-client/pull/1293,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1293,"This PR brings back down the test execution time to about ~15 minutes.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This PR brings back down the test execution time to about ~15 minutes.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1294,2020-01-28T23:27:34Z,2020-02-10T18:17:00Z,2020-02-10T18:17:00Z,CLOSED,False,0,94,7,https://github.com/otaviobp,verify: Quick and extra files are not mutually exclusive,1,[],https://github.com/clearlinux/swupd-client/pull/1294,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1294,"According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1294,2020-01-28T23:27:34Z,2020-02-10T18:17:00Z,2020-02-10T18:17:00Z,CLOSED,False,0,94,7,https://github.com/otaviobp,verify: Quick and extra files are not mutually exclusive,1,[],https://github.com/clearlinux/swupd-client/pull/1294,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1294#issuecomment-583016672,"According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When --quick and --picky are used, swupd will only add missing files and exit, so using --picky will have no effect, it will just get ignored.


When --quick and --extra-files-only are used, swupd will only check for extra files and will ignore adding missing files, so --quick gets ignored.


I think that if we remove the flag restrictions is just going to confuse users, specially since the flags are really not that clear. --extra-files-only is very self explanatory, but --picky and --quick are not. --quick should really be called something like --missing-files-only or something like that so it would make sense. My point is that we have flags that isolate the execution of only one of the 4 tasks verify does (like --picky or --extra-files-only), while we have flags that do not isolate the execution of the task but run it in addition to the other tasks, IMO this behavior is very confusing as a user.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1294,2020-01-28T23:27:34Z,2020-02-10T18:17:00Z,2020-02-10T18:17:00Z,CLOSED,False,0,94,7,https://github.com/otaviobp,verify: Quick and extra files are not mutually exclusive,1,[],https://github.com/clearlinux/swupd-client/pull/1294,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1294#issuecomment-583027090,"According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","I agree that --picky is confusing, but --quick is self explanatory and documentation is very clear.
And I really miss not having swupd repair --picky --quick. Right now there's no way to run that and the only reason is because we artificially block that.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1294,2020-01-28T23:27:34Z,2020-02-10T18:17:00Z,2020-02-10T18:17:00Z,CLOSED,False,0,94,7,https://github.com/otaviobp,verify: Quick and extra files are not mutually exclusive,1,[],https://github.com/clearlinux/swupd-client/pull/1294,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1294#issuecomment-583035586,"According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","I agree that --picky is confusing, but --quick is self explanatory and documentation is very clear.
And I really miss not having swupd repair --picky --quick. Right now there's no way to run that and the only reason is because we artificially block that.

But I'm still not getting why you are missing that, if you just run --quick now you will get the same outcome as if we didn't block --picky + --quick and you would run that, since the code enabled by--picky gets skipped because of --quick.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1294,2020-01-28T23:27:34Z,2020-02-10T18:17:00Z,2020-02-10T18:17:00Z,CLOSED,False,0,94,7,https://github.com/otaviobp,verify: Quick and extra files are not mutually exclusive,1,[],https://github.com/clearlinux/swupd-client/pull/1294,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1294#issuecomment-583044467,"According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If the code is skipped, it shouldn't. So I need to stop using this in this PR",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1294,2020-01-28T23:27:34Z,2020-02-10T18:17:00Z,2020-02-10T18:17:00Z,CLOSED,False,0,94,7,https://github.com/otaviobp,verify: Quick and extra files are not mutually exclusive,1,[],https://github.com/clearlinux/swupd-client/pull/1294,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1294#issuecomment-583052753,"According to the man page, ""Omit checking hash values. Instead only looks
for missing files and directories and/or symlinks."".
When --quick and --picky or --extra-files-only is used that's exactly what
swupd does, so there's no reason to block that.
For --picky there's a real use case that is repair your system without hash
checks. For --extra-files-only in practice the --quick will be ignored, but
it's not inconsistent, so there's no reason to block it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","So I need to stop using this in this PR

What do you mean by that? ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1295,2020-01-29T00:39:12Z,2020-01-29T23:37:06Z,2020-01-29T23:37:06Z,CLOSED,False,695,244,31,https://github.com/castulo,Remove all exported binaries when removing a 3rd-party repo,7,[],https://github.com/clearlinux/swupd-client/pull/1295,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1295,"When a 3rd-party repository is removed, all the content installed from it must be removed from the system. But also those exported binaries from the repo being deleted should also be deleted.
Closes #1291
Note: This PR is built on top of #1290 and has to be reviewed and merged first.","When a 3rd-party repository is removed, all the content installed from it must be removed from the system. But also those exported binaries from the repo being deleted should also be deleted.
Closes #1291
Note: This PR is built on top of #1290 and has to be reviewed and merged first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1295,2020-01-29T00:39:12Z,2020-01-29T23:37:06Z,2020-01-29T23:37:06Z,CLOSED,False,695,244,31,https://github.com/castulo,Remove all exported binaries when removing a 3rd-party repo,7,[],https://github.com/clearlinux/swupd-client/pull/1295,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1295#issuecomment-580014564,"When a 3rd-party repository is removed, all the content installed from it must be removed from the system. But also those exported binaries from the repo being deleted should also be deleted.
Closes #1291
Note: This PR is built on top of #1290 and has to be reviewed and merged first.","I'm going to reorganize the code from PRs #1287, #1290 and #1295, since they are all related. I will open new PR(s) to replace these 3.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1298,2020-01-29T23:37:30Z,2020-01-29T23:58:03Z,2020-01-29T23:58:06Z,MERGED,True,48,21,1,https://github.com/castulo,testlib: Adding support for exported files,1,[],https://github.com/clearlinux/swupd-client/pull/1298,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1298,"This commit makes possible the creation of bundles with exported files
in test environments. These bundles will have the 'x' in the appropriate
place in the manifest plus those bundles that are to be installed in the
environment will have the ""exporting script"" created in the 3rd-party
bin directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit makes possible the creation of bundles with exported files
in test environments. These bundles will have the 'x' in the appropriate
place in the manifest plus those bundles that are to be installed in the
environment will have the ""exporting script"" created in the 3rd-party
bin directory.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1299,2020-01-29T23:44:01Z,2020-01-30T00:01:08Z,2020-01-30T00:01:11Z,MERGED,True,3,0,2,https://github.com/castulo,Add support for 'x' in the manifest parser,1,[],https://github.com/clearlinux/swupd-client/pull/1299,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1299,"Add the 'x' to the manifest parser in the 4th column of file attributes,
this will indicate a file should be ""exported"".
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Add the 'x' to the manifest parser in the 4th column of file attributes,
this will indicate a file should be ""exported"".
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1301,2020-01-29T23:57:44Z,2020-01-30T16:52:52Z,2020-02-05T17:05:14Z,MERGED,True,78,68,5,https://github.com/castulo,Backup global variables used by 3rd-party ops,2,[],https://github.com/clearlinux/swupd-client/pull/1301,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1301,"When running 3rd-party operations, most of the times these need to
overwrite some of the global variables in order to reuse the code
use for normal swupd operations.
This commit add means to backup those global variables, so they can be
recovered as necessary.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running 3rd-party operations, most of the times these need to
overwrite some of the global variables in order to reuse the code
use for normal swupd operations.
This commit add means to backup those global variables, so they can be
recovered as necessary.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1303,2020-02-05T20:00:15Z,2020-02-06T17:18:02Z,2020-02-06T17:34:09Z,MERGED,True,361,53,12,https://github.com/castulo,Export binaries of 3rd-party bundles after installing them,2,[],https://github.com/clearlinux/swupd-client/pull/1303,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1303,"When a 3rd-party bundle is installed, in order for the user to be able to use the binaries the bundle provides, it needs to have them exported.
This PR exports those binaries after they have been successfully installed.
Closes #1277","When a 3rd-party bundle is installed, in order for the user to be able to use the binaries the bundle provides, it needs to have them exported.
This PR exports those binaries after they have been successfully installed.
Closes #1277",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1303,2020-02-05T20:00:15Z,2020-02-06T17:18:02Z,2020-02-06T17:34:09Z,MERGED,True,361,53,12,https://github.com/castulo,Export binaries of 3rd-party bundles after installing them,2,[],https://github.com/clearlinux/swupd-client/pull/1303,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1303#issuecomment-582676003,"When a 3rd-party bundle is installed, in order for the user to be able to use the binaries the bundle provides, it needs to have them exported.
This PR exports those binaries after they have been successfully installed.
Closes #1277",all comments have been addressed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1304,2020-02-05T21:17:27Z,2020-02-10T18:18:38Z,2020-02-10T20:35:45Z,MERGED,True,109,8,8,https://github.com/castulo,Remove exported 3rd-party binaries after bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/1304,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1304,"When removing a 3rd-party bundle, all scripts that export the binaries of the bundle should be removed from the target system unless they are still required by another installed 3rd-party bundle.
This PR is built on top of #1303 and it has to be reviewed and merged first.
Closes #1278","When removing a 3rd-party bundle, all scripts that export the binaries of the bundle should be removed from the target system unless they are still required by another installed 3rd-party bundle.
This PR is built on top of #1303 and it has to be reviewed and merged first.
Closes #1278",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1304,2020-02-05T21:17:27Z,2020-02-10T18:18:38Z,2020-02-10T20:35:45Z,MERGED,True,109,8,8,https://github.com/castulo,Remove exported 3rd-party binaries after bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/1304,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1304#issuecomment-583041041,"When removing a 3rd-party bundle, all scripts that export the binaries of the bundle should be removed from the target system unless they are still required by another installed 3rd-party bundle.
This PR is built on top of #1303 and it has to be reviewed and merged first.
Closes #1278","V2:

Rebased and addressed comments from @otaviobp",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1305,2020-02-05T21:50:50Z,2020-02-11T17:59:31Z,2020-02-11T18:01:17Z,MERGED,True,226,125,11,https://github.com/castulo,Remove all exported binaries from 3rd-party bundles when removing a repo,2,[],https://github.com/clearlinux/swupd-client/pull/1305,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1305,"When a 3rd-party repository is removed, all the content installed from it must be removed from the system. But also those exported binaries from the repo being deleted should also be deleted.
This PR is built on top of #1303 and #1304 and they have to be reviewed first in that order.
Closes #1291","When a 3rd-party repository is removed, all the content installed from it must be removed from the system. But also those exported binaries from the repo being deleted should also be deleted.
This PR is built on top of #1303 and #1304 and they have to be reviewed first in that order.
Closes #1291",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1305,2020-02-05T21:50:50Z,2020-02-11T17:59:31Z,2020-02-11T18:01:17Z,MERGED,True,226,125,11,https://github.com/castulo,Remove all exported binaries from 3rd-party bundles when removing a repo,2,[],https://github.com/clearlinux/swupd-client/pull/1305,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1305#issuecomment-584342366,"When a 3rd-party repository is removed, all the content installed from it must be removed from the system. But also those exported binaries from the repo being deleted should also be deleted.
This PR is built on top of #1303 and #1304 and they have to be reviewed first in that order.
Closes #1291",This PR has already been rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1306,2020-02-05T21:58:10Z,2020-02-05T22:20:49Z,2020-02-05T22:22:40Z,MERGED,True,0,0,1,https://github.com/castulo,Fix name of functional test,1,[],https://github.com/clearlinux/swupd-client/pull/1306,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1306,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1307,2020-02-06T19:02:39Z,2020-02-06T22:33:08Z,2020-02-06T22:50:34Z,MERGED,True,1,0,1,https://github.com/castulo,Warn user when a 3rd-party binary isn't executable,1,[],https://github.com/clearlinux/swupd-client/pull/1307,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1307,"This commit notifies the user that the 3rd-party bundle they installed
isn't configured properly so they can know something about the quality
of the 3rd-party repository they are using.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit notifies the user that the 3rd-party bundle they installed
isn't configured properly so they can know something about the quality
of the 3rd-party repository they are using.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1307,2020-02-06T19:02:39Z,2020-02-06T22:33:08Z,2020-02-06T22:50:34Z,MERGED,True,1,0,1,https://github.com/castulo,Warn user when a 3rd-party binary isn't executable,1,[],https://github.com/clearlinux/swupd-client/pull/1307,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1307#issuecomment-583140683,"This commit notifies the user that the 3rd-party bundle they installed
isn't configured properly so they can know something about the quality
of the 3rd-party repository they are using.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1310,2020-02-10T23:12:40Z,2020-02-13T00:22:13Z,2020-02-13T00:35:14Z,MERGED,True,271,103,10,https://github.com/castulo,"Update exported binaries during a ""swupd 3rd-party update""",1,[],https://github.com/clearlinux/swupd-client/pull/1310,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1310,"When a 3rd-party repository is updated, if one of the updated bundles
has updated binaries, the scripts that export those binaries should also
be updated. This commit implements that update.
Closes #1279","When a 3rd-party repository is updated, if one of the updated bundles
has updated binaries, the scripts that export those binaries should also
be updated. This commit implements that update.
Closes #1279",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1310,2020-02-10T23:12:40Z,2020-02-13T00:22:13Z,2020-02-13T00:35:14Z,MERGED,True,271,103,10,https://github.com/castulo,"Update exported binaries during a ""swupd 3rd-party update""",1,[],https://github.com/clearlinux/swupd-client/pull/1310,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1310#issuecomment-584878502,"When a 3rd-party repository is updated, if one of the updated bundles
has updated binaries, the scripts that export those binaries should also
be updated. This commit implements that update.
Closes #1279",This looks fine to me.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1311,2020-02-11T23:07:48Z,2020-02-12T17:30:54Z,2020-02-12T17:52:57Z,MERGED,True,1,0,1,https://github.com/castulo,Enabling autoupdate of 3rd-party content,1,[],https://github.com/clearlinux/swupd-client/pull/1311,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1311,"Instead of creating a command and service for enabling and disabling autoupdates specifically for 3rd-party content, this PR piggybacks into the current swupd-update.service to also perform an update of the 3rd-party content based on swupd-update.timer. This means the user will have to enable/disable autoupdate for both, the swupd upstream content and 3rd-party content.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com
Closes #1283","Instead of creating a command and service for enabling and disabling autoupdates specifically for 3rd-party content, this PR piggybacks into the current swupd-update.service to also perform an update of the 3rd-party content based on swupd-update.timer. This means the user will have to enable/disable autoupdate for both, the swupd upstream content and 3rd-party content.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com
Closes #1283",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1312,2020-02-12T22:58:10Z,2020-02-21T21:17:06Z,2020-02-27T20:45:49Z,MERGED,True,347,20,6,https://github.com/otaviobp,3rd-party: Import certificate from 3rd-party repository on repo add,3,[],https://github.com/clearlinux/swupd-client/pull/1312,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1312,"When trying to add the repository for the first time, download the public
certificate published by the 3rd party repository and with a user confirmation,
use it to install the 3rd-party os-core. After that the official certificate will
be installed for future commands.","When trying to add the repository for the first time, download the public
certificate published by the 3rd party repository and with a user confirmation,
use it to install the 3rd-party os-core. After that the official certificate will
be installed for future commands.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1312,2020-02-12T22:58:10Z,2020-02-21T21:17:06Z,2020-02-27T20:45:49Z,MERGED,True,347,20,6,https://github.com/otaviobp,3rd-party: Import certificate from 3rd-party repository on repo add,3,[],https://github.com/clearlinux/swupd-client/pull/1312,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1312#issuecomment-588489832,"When trying to add the repository for the first time, download the public
certificate published by the 3rd party repository and with a user confirmation,
use it to install the 3rd-party os-core. After that the official certificate will
be installed for future commands.",Overall LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1312,2020-02-12T22:58:10Z,2020-02-21T21:17:06Z,2020-02-27T20:45:49Z,MERGED,True,347,20,6,https://github.com/otaviobp,3rd-party: Import certificate from 3rd-party repository on repo add,3,[],https://github.com/clearlinux/swupd-client/pull/1312,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1312#issuecomment-589330738,"When trying to add the repository for the first time, download the public
certificate published by the 3rd party repository and with a user confirmation,
use it to install the 3rd-party os-core. After that the official certificate will
be installed for future commands.","V2: Fixed the proposed changes, other than the ones I commented.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1312,2020-02-12T22:58:10Z,2020-02-21T21:17:06Z,2020-02-27T20:45:49Z,MERGED,True,347,20,6,https://github.com/otaviobp,3rd-party: Import certificate from 3rd-party repository on repo add,3,[],https://github.com/clearlinux/swupd-client/pull/1312,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1312#issuecomment-589406314,"When trying to add the repository for the first time, download the public
certificate published by the 3rd party repository and with a user confirmation,
use it to install the 3rd-party os-core. After that the official certificate will
be installed for future commands.","v3: Sorry, now addressing them",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1313,2020-02-12T23:57:28Z,2020-02-20T21:22:56Z,2020-02-20T21:24:13Z,CLOSED,False,124,93,3,https://github.com/otaviobp,test: Auto rebalance test CI based on the number of tests,1,[],https://github.com/clearlinux/swupd-client/pull/1313,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1313,"Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1313,2020-02-12T23:57:28Z,2020-02-20T21:22:56Z,2020-02-20T21:24:13Z,CLOSED,False,124,93,3,https://github.com/otaviobp,test: Auto rebalance test CI based on the number of tests,1,[],https://github.com/clearlinux/swupd-client/pull/1313,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1313#issuecomment-585999702,"Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",I added repair to the list of penalty tests and it got better. Now we are faster than the human-balanced one even with less jobs (10).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1313,2020-02-12T23:57:28Z,2020-02-20T21:22:56Z,2020-02-20T21:24:13Z,CLOSED,False,124,93,3,https://github.com/otaviobp,test: Auto rebalance test CI based on the number of tests,1,[],https://github.com/clearlinux/swupd-client/pull/1313,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1313#issuecomment-586414439,"Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","I played around with this code in my system, I fixed the issue I reported earlier and made a few tweaks and I ran this in GitHub actions -> https://github.com/castulo/swupd-client/actions/runs/39460437, I still see a 1 minute improvement in execution time vs the manually balanced tests.

Auto balanced: 21 minutes, 8 seconds (with 10 jobs)
Manually balanced: 22 minutes, 9 seconds (with 13 jobs)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1313,2020-02-12T23:57:28Z,2020-02-20T21:22:56Z,2020-02-20T21:24:13Z,CLOSED,False,124,93,3,https://github.com/otaviobp,test: Auto rebalance test CI based on the number of tests,1,[],https://github.com/clearlinux/swupd-client/pull/1313,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1313#issuecomment-586451870,"Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Found another problem (the last job was not processing anything) and fixed it locally, and here I was able to bring this down to 18 minutes and 37 seconds -> https://github.com/castulo/swupd-client/actions/runs/39502659. That makes a 3.5 minutes improvement.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1313,2020-02-12T23:57:28Z,2020-02-20T21:22:56Z,2020-02-20T21:24:13Z,CLOSED,False,124,93,3,https://github.com/otaviobp,test: Auto rebalance test CI based on the number of tests,1,[],https://github.com/clearlinux/swupd-client/pull/1313,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1313#issuecomment-586476800,"Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","As I mentioned before, I like the ""weighting system"" you are implementing for balancing the tests across the jobs, but I think we can do better when weighting those tests.
For example, these are the average times each test group take to run (on my system):
( total seconds / number of test )

3rd-party = 261 / 58 = 4.5  ~ 4 s/t
repair = 148 / 44 = 3.4 ~ 3 s/t
diagnose = 82 / 27 = 3 s/t
signature = 51 / 20 = 2.5 ~ 2 s/t
update = 140 / 60 = 2.3	~ 2 s/t
bundleremove = 62 / 29 = 2.1 ~ 2 s/t
verify-legacy = 12 / 6 = 2 s/t
checkupdate = 21 / 11 = 1.9 ~ 2 s/t
bundlelist = 47 / 26 = 1.8 ~ 2 s/t
bundleadd = 81 / 53 = 1.5 ~ 1 s/t
bundleinfo = 20 / 14 = 1.4 ~ 1 s/t
os-install = 35 / 25 = 1.4 ~ 1 s/t
autoupdate = 1 s/t
usability = 17 / 19 = 0.9 ~ 1 s/t
search = 23 / 30 = 0.8 ~ 1 s/t
info = 1.6 / 2 = 0.8 ~ 1s/t
mirror = 7 / 18 = 0.3s/t
hashdump = 1 / 3 = 0.3 ~ 1 s/t

So if we round up or down to the closes integer for each group we can create 4 different ""weight groups"" that go from 1 to 4 (which represent average seconds a test in a group takes to complete). Using those 4 values we can average like this:
average() {
    i=$1
    TESTS=$2

	# start with the special cases
	if [[ $i == *'UPD025'* ]]; then
		TESTS=$((TESTS * 120))
	elif [[ $i == *'/3rd-party/'* ]]; then
		TESTS=$((TESTS * 4))
	elif [[ $i == *'/repair/'* || $i == *'/diagnose/'* ]]; then
		TESTS=$((TESTS * 3))
	elif [[ $i == *'/signature/'* || $i == *'/update/'* || $i == *'/bundleremove/'* || $i == *'/verify-legacy/'* || $i == *'/checkupdate/'* || $i == *'/bundlelist/'* ]]; then
		TESTS=$((TESTS * 2))
	fi
    echo $TESTS
}

I have made some other small tweaks that you can see here -> master...castulo:auto_balancing",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1313,2020-02-12T23:57:28Z,2020-02-20T21:22:56Z,2020-02-20T21:24:13Z,CLOSED,False,124,93,3,https://github.com/otaviobp,test: Auto rebalance test CI based on the number of tests,1,[],https://github.com/clearlinux/swupd-client/pull/1313,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1313#issuecomment-589325084,"Count the number of tests and distribute tests in jobs to try to have around
the same number of tests for each job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Closed in favor of #1321,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1314,2020-02-13T00:05:40Z,2020-02-20T22:01:31Z,2020-02-20T22:28:48Z,MERGED,True,207,30,16,https://github.com/castulo,Do not install dangerous files from 3rd-party repos unless user accepts the risk,1,[],https://github.com/clearlinux/swupd-client/pull/1314,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1314,"If a 3rd-party bundle include files that have either the setuid, setgid
or sticky bits set, then it should not be installed since they could
compromise the security of the system. In this case the user should be
asked to see if they want to assume the risk and continue, or abort the
process.
Closes #1281
Closes #1282","If a 3rd-party bundle include files that have either the setuid, setgid
or sticky bits set, then it should not be installed since they could
compromise the security of the system. In this case the user should be
asked to see if they want to assume the risk and continue, or abort the
process.
Closes #1281
Closes #1282",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1314,2020-02-13T00:05:40Z,2020-02-20T22:01:31Z,2020-02-20T22:28:48Z,MERGED,True,207,30,16,https://github.com/castulo,Do not install dangerous files from 3rd-party repos unless user accepts the risk,1,[],https://github.com/clearlinux/swupd-client/pull/1314,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1314#issuecomment-588494297,"If a 3rd-party bundle include files that have either the setuid, setgid
or sticky bits set, then it should not be installed since they could
compromise the security of the system. In this case the user should be
asked to see if they want to assume the risk and continue, or abort the
process.
Closes #1281
Closes #1282",One question but LGTM.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1315,2020-02-13T17:34:06Z,2020-02-13T18:36:47Z,2020-02-13T18:39:18Z,MERGED,True,2,1,1,https://github.com/castulo,Fixing a bug removing a 3rd-party repo that fails,1,[],https://github.com/clearlinux/swupd-client/pull/1315,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1315,"When removing a 3rd-party repository, if there is an error while setting
up the global variables of the repository, the error code is lost and
swupd reports as if the removal was successful even when it failed. This
commit fixes that issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When removing a 3rd-party repository, if there is an error while setting
up the global variables of the repository, the error code is lost and
swupd reports as if the removal was successful even when it failed. This
commit fixes that issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1316,2020-02-13T18:38:59Z,2020-02-13T22:04:00Z,2020-02-20T21:24:09Z,MERGED,True,0,6,1,https://github.com/otaviobp,curl: Remove unused variable,1,[],https://github.com/clearlinux/swupd-client/pull/1316,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1316,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1318,2020-02-17T15:48:47Z,2020-02-20T21:25:47Z,2020-02-20T21:25:47Z,MERGED,True,7,1,1,https://github.com/andred,staging: don't convert symlinks to hardlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1318,https://github.com/andred,1,https://github.com/clearlinux/swupd-client/pull/1318,"If there are multiple symlinks to the same destination, there
will only be one file in staging for all of the symlinks, and
the current code will opportunistically try to link(2) all of
them into their final destination.
This will usually succeed, but link(2) on linux doesn't follow
symlinks.
This means all the original symlinks will be converted from
being individual files into one file with multiple hardlinks.
As an example, we get this:
root@host:~# ls -li /a/bin/ash /a/bin/busybox.nosuid /a/bin/cat /a/bin/date
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /a/bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/cat -> /bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/date -> /bin/busybox.nosuid

(all the 172 symlinks share the same inode 24), but we really
want the following (to match the original file system, from
which the update was created):
root@host:~# ls -li /b/bin/ash /b/bin/busybox.nosuid /b/bin/cat /b/bin/date
   3670 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /b/bin/busybox.nosuid
   3672 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/cat -> /b/bin/busybox.nosuid
   3679 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/date -> /b/bin/busybox.nosuid

There are two issues with this:

the file system structure created using the swupd client doesn't
match the original file system (which was more like case /b)
it becomes impossible to copy the directory tree using bsdtar [1]

The first one is a real issue, while the 2nd case is a nuisance and
probably a bug in bsdtar (as GNU tar still works fine).
To fix this behaviour, we can simply use linkat(2) instead of
link(2) to instruct the kernel to follow the symlink if the
Manifest states that the file should be a symlink. This ensures
that the new file created is a symlink itself, not a hardlink to
a pre-existing symlink.
linkat(2) as used in this patch is available since linux v2.6.18
and glibc 2.10 as well as musl-libc.
[1] bsdtar seems to not like restoring symlinks sharing the same
inode:
root@host:~# bsdtar -C /a/ -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
./bin/cat: Hard-link target './bin/ash' does not exist.
./bin/date: Hard-link target './bin/ash' does not exist.
bsdtar: Error exit delayed from previous errors.
root@host:~# ls -lA /tmp/bin/
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid

vs.
root@host:~# bsdtar -C / -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
root@host:~# ls -lA /tmp/bin/
lrwxrwxrwx    1 root     root            19 Mar  9  2018 ash -> /bin/busybox.nosuid
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 cat -> /bin/busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 date -> /bin/busybox.nosuid

Signed-off-by: Andr Draszik git@andred.net","If there are multiple symlinks to the same destination, there
will only be one file in staging for all of the symlinks, and
the current code will opportunistically try to link(2) all of
them into their final destination.
This will usually succeed, but link(2) on linux doesn't follow
symlinks.
This means all the original symlinks will be converted from
being individual files into one file with multiple hardlinks.
As an example, we get this:
root@host:~# ls -li /a/bin/ash /a/bin/busybox.nosuid /a/bin/cat /a/bin/date
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /a/bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/cat -> /bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/date -> /bin/busybox.nosuid

(all the 172 symlinks share the same inode 24), but we really
want the following (to match the original file system, from
which the update was created):
root@host:~# ls -li /b/bin/ash /b/bin/busybox.nosuid /b/bin/cat /b/bin/date
   3670 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /b/bin/busybox.nosuid
   3672 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/cat -> /b/bin/busybox.nosuid
   3679 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/date -> /b/bin/busybox.nosuid

There are two issues with this:

the file system structure created using the swupd client doesn't
match the original file system (which was more like case /b)
it becomes impossible to copy the directory tree using bsdtar [1]

The first one is a real issue, while the 2nd case is a nuisance and
probably a bug in bsdtar (as GNU tar still works fine).
To fix this behaviour, we can simply use linkat(2) instead of
link(2) to instruct the kernel to follow the symlink if the
Manifest states that the file should be a symlink. This ensures
that the new file created is a symlink itself, not a hardlink to
a pre-existing symlink.
linkat(2) as used in this patch is available since linux v2.6.18
and glibc 2.10 as well as musl-libc.
[1] bsdtar seems to not like restoring symlinks sharing the same
inode:
root@host:~# bsdtar -C /a/ -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
./bin/cat: Hard-link target './bin/ash' does not exist.
./bin/date: Hard-link target './bin/ash' does not exist.
bsdtar: Error exit delayed from previous errors.
root@host:~# ls -lA /tmp/bin/
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid

vs.
root@host:~# bsdtar -C / -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
root@host:~# ls -lA /tmp/bin/
lrwxrwxrwx    1 root     root            19 Mar  9  2018 ash -> /bin/busybox.nosuid
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 cat -> /bin/busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 date -> /bin/busybox.nosuid

Signed-off-by: Andr Draszik git@andred.net",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1318,2020-02-17T15:48:47Z,2020-02-20T21:25:47Z,2020-02-20T21:25:47Z,MERGED,True,7,1,1,https://github.com/andred,staging: don't convert symlinks to hardlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1318,https://github.com/andred,2,https://github.com/clearlinux/swupd-client/pull/1318#issuecomment-587055354,"If there are multiple symlinks to the same destination, there
will only be one file in staging for all of the symlinks, and
the current code will opportunistically try to link(2) all of
them into their final destination.
This will usually succeed, but link(2) on linux doesn't follow
symlinks.
This means all the original symlinks will be converted from
being individual files into one file with multiple hardlinks.
As an example, we get this:
root@host:~# ls -li /a/bin/ash /a/bin/busybox.nosuid /a/bin/cat /a/bin/date
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /a/bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/cat -> /bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/date -> /bin/busybox.nosuid

(all the 172 symlinks share the same inode 24), but we really
want the following (to match the original file system, from
which the update was created):
root@host:~# ls -li /b/bin/ash /b/bin/busybox.nosuid /b/bin/cat /b/bin/date
   3670 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /b/bin/busybox.nosuid
   3672 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/cat -> /b/bin/busybox.nosuid
   3679 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/date -> /b/bin/busybox.nosuid

There are two issues with this:

the file system structure created using the swupd client doesn't
match the original file system (which was more like case /b)
it becomes impossible to copy the directory tree using bsdtar [1]

The first one is a real issue, while the 2nd case is a nuisance and
probably a bug in bsdtar (as GNU tar still works fine).
To fix this behaviour, we can simply use linkat(2) instead of
link(2) to instruct the kernel to follow the symlink if the
Manifest states that the file should be a symlink. This ensures
that the new file created is a symlink itself, not a hardlink to
a pre-existing symlink.
linkat(2) as used in this patch is available since linux v2.6.18
and glibc 2.10 as well as musl-libc.
[1] bsdtar seems to not like restoring symlinks sharing the same
inode:
root@host:~# bsdtar -C /a/ -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
./bin/cat: Hard-link target './bin/ash' does not exist.
./bin/date: Hard-link target './bin/ash' does not exist.
bsdtar: Error exit delayed from previous errors.
root@host:~# ls -lA /tmp/bin/
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid

vs.
root@host:~# bsdtar -C / -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
root@host:~# ls -lA /tmp/bin/
lrwxrwxrwx    1 root     root            19 Mar  9  2018 ash -> /bin/busybox.nosuid
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 cat -> /bin/busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 date -> /bin/busybox.nosuid

Signed-off-by: Andr Draszik git@andred.net","FYI, I use swupd in a yocto-based project.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1318,2020-02-17T15:48:47Z,2020-02-20T21:25:47Z,2020-02-20T21:25:47Z,MERGED,True,7,1,1,https://github.com/andred,staging: don't convert symlinks to hardlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1318,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1318#issuecomment-588516519,"If there are multiple symlinks to the same destination, there
will only be one file in staging for all of the symlinks, and
the current code will opportunistically try to link(2) all of
them into their final destination.
This will usually succeed, but link(2) on linux doesn't follow
symlinks.
This means all the original symlinks will be converted from
being individual files into one file with multiple hardlinks.
As an example, we get this:
root@host:~# ls -li /a/bin/ash /a/bin/busybox.nosuid /a/bin/cat /a/bin/date
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /a/bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/cat -> /bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/date -> /bin/busybox.nosuid

(all the 172 symlinks share the same inode 24), but we really
want the following (to match the original file system, from
which the update was created):
root@host:~# ls -li /b/bin/ash /b/bin/busybox.nosuid /b/bin/cat /b/bin/date
   3670 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /b/bin/busybox.nosuid
   3672 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/cat -> /b/bin/busybox.nosuid
   3679 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/date -> /b/bin/busybox.nosuid

There are two issues with this:

the file system structure created using the swupd client doesn't
match the original file system (which was more like case /b)
it becomes impossible to copy the directory tree using bsdtar [1]

The first one is a real issue, while the 2nd case is a nuisance and
probably a bug in bsdtar (as GNU tar still works fine).
To fix this behaviour, we can simply use linkat(2) instead of
link(2) to instruct the kernel to follow the symlink if the
Manifest states that the file should be a symlink. This ensures
that the new file created is a symlink itself, not a hardlink to
a pre-existing symlink.
linkat(2) as used in this patch is available since linux v2.6.18
and glibc 2.10 as well as musl-libc.
[1] bsdtar seems to not like restoring symlinks sharing the same
inode:
root@host:~# bsdtar -C /a/ -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
./bin/cat: Hard-link target './bin/ash' does not exist.
./bin/date: Hard-link target './bin/ash' does not exist.
bsdtar: Error exit delayed from previous errors.
root@host:~# ls -lA /tmp/bin/
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid

vs.
root@host:~# bsdtar -C / -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
root@host:~# ls -lA /tmp/bin/
lrwxrwxrwx    1 root     root            19 Mar  9  2018 ash -> /bin/busybox.nosuid
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 cat -> /bin/busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 date -> /bin/busybox.nosuid

Signed-off-by: Andr Draszik git@andred.net","I'm ok on merging this PR because I don't see a real use for having hardlinked sysmlinks. Just want to confirm with @bryteise if there's any case where this is wanted.
I just have some considerations about the problems you listed.

There are two issues with this:
1. the file system structure created using the swupd client doesn't
   match the original file system (which was more like case /b)


Actually this is working as designed. We don't guarantee that the installed system will be identical to the original filesystem. If there are 2 files that have exactly the same hash they will be hardlinked even if they are different files in the orginal system.

2. it becomes impossible to copy the directory tree using bsdtar [1]


Do you know if this is a problem for any hardlinked file or just hardlinked symlinks?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1318,2020-02-17T15:48:47Z,2020-02-20T21:25:47Z,2020-02-20T21:25:47Z,MERGED,True,7,1,1,https://github.com/andred,staging: don't convert symlinks to hardlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1318,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/1318#issuecomment-588528481,"If there are multiple symlinks to the same destination, there
will only be one file in staging for all of the symlinks, and
the current code will opportunistically try to link(2) all of
them into their final destination.
This will usually succeed, but link(2) on linux doesn't follow
symlinks.
This means all the original symlinks will be converted from
being individual files into one file with multiple hardlinks.
As an example, we get this:
root@host:~# ls -li /a/bin/ash /a/bin/busybox.nosuid /a/bin/cat /a/bin/date
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /a/bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/cat -> /bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/date -> /bin/busybox.nosuid

(all the 172 symlinks share the same inode 24), but we really
want the following (to match the original file system, from
which the update was created):
root@host:~# ls -li /b/bin/ash /b/bin/busybox.nosuid /b/bin/cat /b/bin/date
   3670 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /b/bin/busybox.nosuid
   3672 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/cat -> /b/bin/busybox.nosuid
   3679 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/date -> /b/bin/busybox.nosuid

There are two issues with this:

the file system structure created using the swupd client doesn't
match the original file system (which was more like case /b)
it becomes impossible to copy the directory tree using bsdtar [1]

The first one is a real issue, while the 2nd case is a nuisance and
probably a bug in bsdtar (as GNU tar still works fine).
To fix this behaviour, we can simply use linkat(2) instead of
link(2) to instruct the kernel to follow the symlink if the
Manifest states that the file should be a symlink. This ensures
that the new file created is a symlink itself, not a hardlink to
a pre-existing symlink.
linkat(2) as used in this patch is available since linux v2.6.18
and glibc 2.10 as well as musl-libc.
[1] bsdtar seems to not like restoring symlinks sharing the same
inode:
root@host:~# bsdtar -C /a/ -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
./bin/cat: Hard-link target './bin/ash' does not exist.
./bin/date: Hard-link target './bin/ash' does not exist.
bsdtar: Error exit delayed from previous errors.
root@host:~# ls -lA /tmp/bin/
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid

vs.
root@host:~# bsdtar -C / -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
root@host:~# ls -lA /tmp/bin/
lrwxrwxrwx    1 root     root            19 Mar  9  2018 ash -> /bin/busybox.nosuid
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 cat -> /bin/busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 date -> /bin/busybox.nosuid

Signed-off-by: Andr Draszik git@andred.net",The hardlinking is a swupd optimization so it isn't important to me that symlinks are themselves hardlinked as there isn't any real gains to be had with that.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1318,2020-02-17T15:48:47Z,2020-02-20T21:25:47Z,2020-02-20T21:25:47Z,MERGED,True,7,1,1,https://github.com/andred,staging: don't convert symlinks to hardlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1318,https://github.com/andred,5,https://github.com/clearlinux/swupd-client/pull/1318#issuecomment-588817032,"If there are multiple symlinks to the same destination, there
will only be one file in staging for all of the symlinks, and
the current code will opportunistically try to link(2) all of
them into their final destination.
This will usually succeed, but link(2) on linux doesn't follow
symlinks.
This means all the original symlinks will be converted from
being individual files into one file with multiple hardlinks.
As an example, we get this:
root@host:~# ls -li /a/bin/ash /a/bin/busybox.nosuid /a/bin/cat /a/bin/date
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /a/bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/cat -> /bin/busybox.nosuid
     24 lrwxrwxrwx  172 root     root            19 Mar  9  2018 /a/bin/date -> /bin/busybox.nosuid

(all the 172 symlinks share the same inode 24), but we really
want the following (to match the original file system, from
which the update was created):
root@host:~# ls -li /b/bin/ash /b/bin/busybox.nosuid /b/bin/cat /b/bin/date
   3670 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/ash -> /bin/busybox.nosuid
     26 -rwxr-xr-x    1 root     root        488760 Mar  9  2018 /b/bin/busybox.nosuid
   3672 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/cat -> /b/bin/busybox.nosuid
   3679 lrwxrwxrwx    1 root     root            19 Mar  9  2018 /b/bin/date -> /b/bin/busybox.nosuid

There are two issues with this:

the file system structure created using the swupd client doesn't
match the original file system (which was more like case /b)
it becomes impossible to copy the directory tree using bsdtar [1]

The first one is a real issue, while the 2nd case is a nuisance and
probably a bug in bsdtar (as GNU tar still works fine).
To fix this behaviour, we can simply use linkat(2) instead of
link(2) to instruct the kernel to follow the symlink if the
Manifest states that the file should be a symlink. This ensures
that the new file created is a symlink itself, not a hardlink to
a pre-existing symlink.
linkat(2) as used in this patch is available since linux v2.6.18
and glibc 2.10 as well as musl-libc.
[1] bsdtar seems to not like restoring symlinks sharing the same
inode:
root@host:~# bsdtar -C /a/ -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
./bin/cat: Hard-link target './bin/ash' does not exist.
./bin/date: Hard-link target './bin/ash' does not exist.
bsdtar: Error exit delayed from previous errors.
root@host:~# ls -lA /tmp/bin/
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid

vs.
root@host:~# bsdtar -C / -cf - ./bin/ash ./bin/busybox.nosuid ./bin/cat ./bin/date | bsdtar -C /tmp/ -xf -
root@host:~# ls -lA /tmp/bin/
lrwxrwxrwx    1 root     root            19 Mar  9  2018 ash -> /bin/busybox.nosuid
-rwxr-xr-x    1 root     root        488760 Mar  9  2018 busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 cat -> /bin/busybox.nosuid
lrwxrwxrwx    1 root     root            19 Mar  9  2018 date -> /bin/busybox.nosuid

Signed-off-by: Andr Draszik git@andred.net","2. it becomes impossible to copy the directory tree using bsdtar [1]


Do you know if this is a problem for any hardlinked file or just hardlinked symlinks?

Normal hardlinked files work fine with bsdtar, it only has issues with hardlinked symlinks.
Point taken regarding behaving as designed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1319,2020-02-19T00:30:55Z,2020-02-21T20:57:30Z,2020-02-21T21:03:08Z,MERGED,True,514,64,18,https://github.com/castulo,Don't allow 3rd-party updates with dangerous flags,3,[],https://github.com/clearlinux/swupd-client/pull/1319,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1319,"This PR implements the following things:

If an update of 3rd-party content includes files with dangerous flags, the user should be notified and the update should only continue if the user interactively accepts the risk, otherwise the update should be aborted.
It introduces the --non-interactive=[Y|N] flag that can be used to set an automatic response to prompts to run commands that otherwise would require interactive interaction, non-interactively.
Uses the `--non-interactive=no"" flag to run ""3rd-party update"" during autoupdate.

Note: This PR is built on top of #1314 and it needs to be reviewed/merged first.
Closes #1283","This PR implements the following things:

If an update of 3rd-party content includes files with dangerous flags, the user should be notified and the update should only continue if the user interactively accepts the risk, otherwise the update should be aborted.
It introduces the --non-interactive=[Y|N] flag that can be used to set an automatic response to prompts to run commands that otherwise would require interactive interaction, non-interactively.
Uses the `--non-interactive=no"" flag to run ""3rd-party update"" during autoupdate.

Note: This PR is built on top of #1314 and it needs to be reviewed/merged first.
Closes #1283",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1319,2020-02-19T00:30:55Z,2020-02-21T20:57:30Z,2020-02-21T21:03:08Z,MERGED,True,514,64,18,https://github.com/castulo,Don't allow 3rd-party updates with dangerous flags,3,[],https://github.com/clearlinux/swupd-client/pull/1319,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1319#issuecomment-588482770,"This PR implements the following things:

If an update of 3rd-party content includes files with dangerous flags, the user should be notified and the update should only continue if the user interactively accepts the risk, otherwise the update should be aborted.
It introduces the --non-interactive=[Y|N] flag that can be used to set an automatic response to prompts to run commands that otherwise would require interactive interaction, non-interactively.
Uses the `--non-interactive=no"" flag to run ""3rd-party update"" during autoupdate.

Note: This PR is built on top of #1314 and it needs to be reviewed/merged first.
Closes #1283","@bryteise I added you as a reviewer, but it is optional, feel free to ignore my request to review ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1319,2020-02-19T00:30:55Z,2020-02-21T20:57:30Z,2020-02-21T21:03:08Z,MERGED,True,514,64,18,https://github.com/castulo,Don't allow 3rd-party updates with dangerous flags,3,[],https://github.com/clearlinux/swupd-client/pull/1319,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/1319#issuecomment-588524389,"This PR implements the following things:

If an update of 3rd-party content includes files with dangerous flags, the user should be notified and the update should only continue if the user interactively accepts the risk, otherwise the update should be aborted.
It introduces the --non-interactive=[Y|N] flag that can be used to set an automatic response to prompts to run commands that otherwise would require interactive interaction, non-interactively.
Uses the `--non-interactive=no"" flag to run ""3rd-party update"" during autoupdate.

Note: This PR is built on top of #1314 and it needs to be reviewed/merged first.
Closes #1283",LGTM other than my one comment.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1320,2020-02-19T21:06:34Z,2020-02-19T21:31:18Z,2020-02-20T21:23:28Z,MERGED,True,19,14,3,https://github.com/otaviobp,test: Reduce build time of bats test,1,[],https://github.com/clearlinux/swupd-client/pull/1320,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1320,"There are some build requirements that are only necessary for style check.
Reduce the build time by running them only for style check job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","There are some build requirements that are only necessary for style check.
Reduce the build time by running them only for style check job.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1321,2020-02-19T22:47:13Z,2020-02-20T21:22:32Z,2020-02-20T21:23:28Z,MERGED,True,369,96,216,https://github.com/otaviobp,tests: Auto rebalance tests based on how long they take to long,1,[],https://github.com/clearlinux/swupd-client/pull/1321,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1321,"This patch adds 2 scripts used to balance test execution. The weight_tests.bash
runs all tests and sets a weight to them based on how long they take to run. The
other, filter_bats_list.bash, use this information to split the tests in groups to
be executed by github actions.
When a new test is added the script will consider it with an average weight, so this
shouldn't unbalance the system right away. After some time, if we notice that the
system is not balanced anymore we can just run the weight_tests.bash again to rebalance.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","This patch adds 2 scripts used to balance test execution. The weight_tests.bash
runs all tests and sets a weight to them based on how long they take to run. The
other, filter_bats_list.bash, use this information to split the tests in groups to
be executed by github actions.
When a new test is added the script will consider it with an average weight, so this
shouldn't unbalance the system right away. After some time, if we notice that the
system is not balanced anymore we can just run the weight_tests.bash again to rebalance.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1323,2020-02-20T21:53:42Z,2020-02-20T22:34:46Z,2020-02-27T20:45:54Z,MERGED,True,46,46,11,https://github.com/otaviobp,Rename variable used to identify if tests are running in a CI,1,[],https://github.com/clearlinux/swupd-client/pull/1323,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1323,"Rename from TRAVIS to RUNNING_IN_CI
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Rename from TRAVIS to RUNNING_IN_CI
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1324,2020-02-20T21:54:17Z,2020-02-27T18:30:24Z,2020-02-27T20:45:47Z,MERGED,True,324,326,51,https://github.com/otaviobp,Rename misleading function name free_string(),1,[],https://github.com/clearlinux/swupd-client/pull/1324,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1324,"Free string function has a misleading name and usage all over swupd.
This function was proably created to make sure global strings were
set to NULL after a free to prevent double free and invalid access
memory. But there's absolutly nothing in this function that makes it
exclusive or mandatory to free strings. The same argument could be
used to force users to set any pointer to NULL after freeing. Because
of that I'm prosing to rename it to free_and_clear_pointer() and making
it compatible to any pointer (void *).
As we don't set any other local pointer to NULL after a free(), I don't see
a reason to do that for strings. For global or local pointer that are reused,
I'm open to explictly set that to NULL or to use the free_and_clear_pointer()
helper, but I don't see why different pointers type should be treated differently.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Free string function has a misleading name and usage all over swupd.
This function was proably created to make sure global strings were
set to NULL after a free to prevent double free and invalid access
memory. But there's absolutly nothing in this function that makes it
exclusive or mandatory to free strings. The same argument could be
used to force users to set any pointer to NULL after freeing. Because
of that I'm prosing to rename it to free_and_clear_pointer() and making
it compatible to any pointer (void *).
As we don't set any other local pointer to NULL after a free(), I don't see
a reason to do that for strings. For global or local pointer that are reused,
I'm open to explictly set that to NULL or to use the free_and_clear_pointer()
helper, but I don't see why different pointers type should be treated differently.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1326,2020-02-26T00:31:34Z,2020-02-26T20:52:58Z,2020-02-26T20:52:58Z,MERGED,True,329,60,12,https://github.com/castulo,Handle conflicting 3rd-party binaries,1,[],https://github.com/clearlinux/swupd-client/pull/1326,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1326,"When in a 3rd-party repository one bundle has one binary file that
is exported, and the same file is included in another bundle, only
it is not exported in this bundle, when we remove the bundle that
exports the file, the file should be unexported regardless of the file
still being installed since the bundle that is still in the system is
not exporting it.
Closes #1322
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When in a 3rd-party repository one bundle has one binary file that
is exported, and the same file is included in another bundle, only
it is not exported in this bundle, when we remove the bundle that
exports the file, the file should be unexported regardless of the file
still being installed since the bundle that is still in the system is
not exporting it.
Closes #1322
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1326,2020-02-26T00:31:34Z,2020-02-26T20:52:58Z,2020-02-26T20:52:58Z,MERGED,True,329,60,12,https://github.com/castulo,Handle conflicting 3rd-party binaries,1,[],https://github.com/clearlinux/swupd-client/pull/1326,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1326#issuecomment-591541196,"When in a 3rd-party repository one bundle has one binary file that
is exported, and the same file is included in another bundle, only
it is not exported in this bundle, when we remove the bundle that
exports the file, the file should be unexported regardless of the file
still being installed since the bundle that is still in the system is
not exporting it.
Closes #1322
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",LGTM with maybe one fix to a comment.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1328,2020-02-26T22:21:18Z,2020-02-27T17:32:16Z,2020-02-27T19:09:16Z,MERGED,True,103,138,27,https://github.com/castulo,Move 3rd-party repo.ini out of the state directory,2,[],https://github.com/clearlinux/swupd-client/pull/1328,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1328,"The repo.ini file was being created in the swupd state directory, this
was not ideal since it prevented the state directory from being used for
multiple target paths.
This commit moves the repo.ini file out of the state directory and into
the 3rd-party content directory.","The repo.ini file was being created in the swupd state directory, this
was not ideal since it prevented the state directory from being used for
multiple target paths.
This commit moves the repo.ini file out of the state directory and into
the 3rd-party content directory.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1328,2020-02-26T22:21:18Z,2020-02-27T17:32:16Z,2020-02-27T19:09:16Z,MERGED,True,103,138,27,https://github.com/castulo,Move 3rd-party repo.ini out of the state directory,2,[],https://github.com/clearlinux/swupd-client/pull/1328,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1328#issuecomment-591709645,"The repo.ini file was being created in the swupd state directory, this
was not ideal since it prevented the state directory from being used for
multiple target paths.
This commit moves the repo.ini file out of the state directory and into
the 3rd-party content directory.","My thinking this through means that if you give --path=/foo for third party operations then the structure looks like /foo/opt/3rd-party/{bin,bundles,repo.ini} with the statedir still under /var/lib/swupd (I forget how third party state is namespaced). Before you would get repo.ini under /var/lib/swupd still. This enables multiple roots each with their own 3rd-party configurations with passing only --path= where as before you'd need --statedir= as well and for them to stay in sync. Seems like a usability win and if there is oddly statedir type conflicts that can still be passed separately as well.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1328,2020-02-26T22:21:18Z,2020-02-27T17:32:16Z,2020-02-27T19:09:16Z,MERGED,True,103,138,27,https://github.com/castulo,Move 3rd-party repo.ini out of the state directory,2,[],https://github.com/clearlinux/swupd-client/pull/1328,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1328#issuecomment-592081149,"The repo.ini file was being created in the swupd state directory, this
was not ideal since it prevented the state directory from being used for
multiple target paths.
This commit moves the repo.ini file out of the state directory and into
the 3rd-party content directory.",@bryteise My plan was to keep the statedir only for cache files and save everything else relative to the path. Right now the only other thing that is not cache that lives in the statedir is the list of tracked bundles and it's very hard to reuse the statedir for multiple paths because of that. Do you have any restriction on moving that from statedir to a path relative dir?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1328,2020-02-26T22:21:18Z,2020-02-27T17:32:16Z,2020-02-27T19:09:16Z,MERGED,True,103,138,27,https://github.com/castulo,Move 3rd-party repo.ini out of the state directory,2,[],https://github.com/clearlinux/swupd-client/pull/1328,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/1328#issuecomment-592126701,"The repo.ini file was being created in the swupd state directory, this
was not ideal since it prevented the state directory from being used for
multiple target paths.
This commit moves the repo.ini file out of the state directory and into
the 3rd-party content directory.","As long as swupd knows where to find tracking files, it is fine with me =).",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1331,2020-02-27T20:05:55Z,2020-02-27T21:14:04Z,2020-02-27T21:14:05Z,MERGED,True,6,2,1,https://github.com/castulo,Make sure the path for repo.ini always exist,1,[],https://github.com/clearlinux/swupd-client/pull/1331,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1331,"If the path for the repo.ini file doesn't exist, create it.
Closes #1329
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","If the path for the repo.ini file doesn't exist, create it.
Closes #1329
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1333,2020-02-27T21:12:15Z,2020-02-27T23:35:53Z,2020-02-27T23:35:53Z,MERGED,True,72,1,3,https://github.com/otaviobp,3rd-party: Support adding symlinks to 3rd party repositories,1,[],https://github.com/clearlinux/swupd-client/pull/1333,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1333,"When a symlink is added to a 3rd-party repository it will be broken
on the statedir and stat command will fail. We need to use lstat, to
get information about the symlink and not the file that it's pointing
to.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When a symlink is added to a 3rd-party repository it will be broken
on the statedir and stat command will fail. We need to use lstat, to
get information about the symlink and not the file that it's pointing
to.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1334,2020-02-27T22:40:00Z,2020-02-28T00:51:29Z,2020-02-28T16:35:24Z,MERGED,True,6,4,1,https://github.com/castulo,Multi-repo operations skip bad repo,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1334,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1334,"When running an operation that should run in all the 3rd-party repos
installed, if one repo fails to set up, the process is aborted and the
operation is never performed in the repos after the failed repo.
This PR changes the proces so if one repo fails to set up it is just
skipped so the operation is attempted in the other repos.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When running an operation that should run in all the 3rd-party repos
installed, if one repo fails to set up, the process is aborted and the
operation is never performed in the repos after the failed repo.
This PR changes the proces so if one repo fails to set up it is just
skipped so the operation is attempted in the other repos.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1335,2020-02-27T23:36:19Z,2020-02-28T20:56:24Z,2020-04-03T19:34:07Z,MERGED,True,16,0,1,https://github.com/otaviobp,scripts: Always run ld_config before running any update scripts,1,[],https://github.com/clearlinux/swupd-client/pull/1335,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1335,"It's possible to create a post_update script to run ld_config, but we
had problems with this in the past, so it was decided to hardcode that
on swupd instead of relying on scripts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","It's possible to create a post_update script to run ld_config, but we
had problems with this in the past, so it was decided to hardcode that
on swupd instead of relying on scripts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1335,2020-02-27T23:36:19Z,2020-02-28T20:56:24Z,2020-04-03T19:34:07Z,MERGED,True,16,0,1,https://github.com/otaviobp,scripts: Always run ld_config before running any update scripts,1,[],https://github.com/clearlinux/swupd-client/pull/1335,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1335#issuecomment-592258220,"It's possible to create a post_update script to run ld_config, but we
had problems with this in the past, so it was decided to hardcode that
on swupd instead of relying on scripts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",I'm curious if there will be improvements to clearlinux/distribution#1765 with this change.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1335,2020-02-27T23:36:19Z,2020-02-28T20:56:24Z,2020-04-03T19:34:07Z,MERGED,True,16,0,1,https://github.com/otaviobp,scripts: Always run ld_config before running any update scripts,1,[],https://github.com/clearlinux/swupd-client/pull/1335,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1335#issuecomment-592647371,"It's possible to create a post_update script to run ld_config, but we
had problems with this in the past, so it was decided to hardcode that
on swupd instead of relying on scripts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",V2: Fixed the minor problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1335,2020-02-27T23:36:19Z,2020-02-28T20:56:24Z,2020-04-03T19:34:07Z,MERGED,True,16,0,1,https://github.com/otaviobp,scripts: Always run ld_config before running any update scripts,1,[],https://github.com/clearlinux/swupd-client/pull/1335,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1335#issuecomment-592717197,"It's possible to create a post_update script to run ld_config, but we
had problems with this in the past, so it was decided to hardcode that
on swupd instead of relying on scripts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Sorry, I didn't add that to the commit",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1335,2020-02-27T23:36:19Z,2020-02-28T20:56:24Z,2020-04-03T19:34:07Z,MERGED,True,16,0,1,https://github.com/otaviobp,scripts: Always run ld_config before running any update scripts,1,[],https://github.com/clearlinux/swupd-client/pull/1335,https://github.com/mythi,5,https://github.com/clearlinux/swupd-client/pull/1335#issuecomment-593366275,"It's possible to create a post_update script to run ld_config, but we
had problems with this in the past, so it was decided to hardcode that
on swupd instead of relying on scripts.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","I'm curious if there will be improvements to clearlinux/distribution#1765 with this change.

I tried adding RUN ldconfig next to swupd commands in my Dockerfile and the image still fails.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1336,2020-02-28T17:15:31Z,2020-03-19T17:52:25Z,2020-04-03T19:34:05Z,CLOSED,False,2419,530,108,https://github.com/otaviobp,PoC: Make tests 10x faster by saving a cache,5,[],https://github.com/clearlinux/swupd-client/pull/1336,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1336,"I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository","I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1336,2020-02-28T17:15:31Z,2020-03-19T17:52:25Z,2020-04-03T19:34:05Z,CLOSED,False,2419,530,108,https://github.com/otaviobp,PoC: Make tests 10x faster by saving a cache,5,[],https://github.com/clearlinux/swupd-client/pull/1336,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1336#issuecomment-592767204,"I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository",What is the process for generating the test tarballs? Generally I don't like checking in binaries to the repo itself especially if they change and this is a lot of them.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1336,2020-02-28T17:15:31Z,2020-03-19T17:52:25Z,2020-04-03T19:34:05Z,CLOSED,False,2419,530,108,https://github.com/otaviobp,PoC: Make tests 10x faster by saving a cache,5,[],https://github.com/clearlinux/swupd-client/pull/1336,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1336#issuecomment-592772008,"I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository","What is the process for generating the test tarballs? Generally I don't like checking in binaries to the repo itself especially if they change and this is a lot of them.

I made a hack script to generate them. We need a better script. The only reason it's a tarball and not a text file is root permissions. We could change the permissions and fix them before running the test if we prefer to keep them as text files.
We also use a random file generator to create the text files. If we want to commit them as files it would be ideal to have a fixed seed so they wouldn't change every execution.
Another possible option would be to save this tarballs somewhere else and download them to run the tests. The major reason I created this PoC is to show that it's possible to have way faster tests by saving the metadata.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1336,2020-02-28T17:15:31Z,2020-03-19T17:52:25Z,2020-04-03T19:34:05Z,CLOSED,False,2419,530,108,https://github.com/otaviobp,PoC: Make tests 10x faster by saving a cache,5,[],https://github.com/clearlinux/swupd-client/pull/1336,https://github.com/bryteise,4,https://github.com/clearlinux/swupd-client/pull/1336#issuecomment-592775119,"I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository","I think saving the generated content for reuse is definitely a win (as this PoC demonstrates). Since the how is open, I would be interested in testing storing the text and seeing how much of a performance difference that makes. Storing the tarballs elsewhere is an interesting option but I think the logistics are a bit more difficult.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1336,2020-02-28T17:15:31Z,2020-03-19T17:52:25Z,2020-04-03T19:34:05Z,CLOSED,False,2419,530,108,https://github.com/otaviobp,PoC: Make tests 10x faster by saving a cache,5,[],https://github.com/clearlinux/swupd-client/pull/1336,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1336#issuecomment-593610462,"I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository",I think this idea could work,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1336,2020-02-28T17:15:31Z,2020-03-19T17:52:25Z,2020-04-03T19:34:05Z,CLOSED,False,2419,530,108,https://github.com/otaviobp,PoC: Make tests 10x faster by saving a cache,5,[],https://github.com/clearlinux/swupd-client/pull/1336,https://github.com/otaviobp,6,https://github.com/clearlinux/swupd-client/pull/1336#issuecomment-601325658,"I wrote a PoC to show how it's possible to make the swupd tests 10x faster by saving all generated files between one execution to the other. There's still room for improvements and I made some hacks to implement the PoC faster so I can have some feedback to make sure it's worth pursuing this changes.
The basic idea of this PR is to run everything on test_setup() and save the results in tarballs to be committed to the repository. So when we need to run the tests we don't need to execute test_setup() again. We just extract the tarballs to the correct location and uses it to execute the tests.
For comparison reasons I created 2 jobs on github actions to run in serial all repair tests using the new approach and the old approach. Tests using the tarball cache are around 10 times faster than tests that generate all the data. I have tested that only with repair tests.
Some improvements necessary:

Instead of having specific generate scripts we could keep the generation code in bats file
Create a script to automatically clean and regenerate the cache
Check if we can reuse the web-dir for multiple tests (there's one  tests that breaks if we do that)
Check if there's a better place to put the tarballs other than the git repository",Closing in favor of #1385,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1337,2020-02-28T18:25:39Z,2020-02-28T22:16:13Z,2020-02-28T22:16:33Z,MERGED,True,2,8,1,https://github.com/castulo,Use of --assume and --yes flags to confirm a cert,1,[],https://github.com/clearlinux/swupd-client/pull/1337,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1337,"When users add a 3rd-party repository they are asked if they want to
trust the certificate, this commit makes possible to use the
--assume flag to answer that question.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When users add a 3rd-party repository they are asked if they want to
trust the certificate, this commit makes possible to use the
--assume flag to answer that question.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1337,2020-02-28T18:25:39Z,2020-02-28T22:16:13Z,2020-02-28T22:16:33Z,MERGED,True,2,8,1,https://github.com/castulo,Use of --assume and --yes flags to confirm a cert,1,[],https://github.com/clearlinux/swupd-client/pull/1337,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1337#issuecomment-592751630,"When users add a 3rd-party repository they are asked if they want to
trust the certificate, this commit makes possible to use the
--assume flag to answer that question.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",V3: Addressed review comments,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1338,2020-02-28T18:48:15Z,2020-02-28T19:53:33Z,2020-02-28T20:13:16Z,MERGED,True,1,1,1,https://github.com/castulo,Rewording the 3rd-party menu details,1,[],https://github.com/clearlinux/swupd-client/pull/1338,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1338,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1339,2020-02-28T22:08:04Z,2020-02-28T22:26:41Z,2020-02-28T22:26:45Z,MERGED,True,0,1,1,https://github.com/castulo,Removing extra step from 3rd-party remove,1,[],https://github.com/clearlinux/swupd-client/pull/1339,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1339,"This extra step was causing the percentage to be printed twice:
$ sudo ./swupd 3rd-party remove swupd-master
Loading required manifests...
 [100%]

Removing repository swupd-master...

Removing 3rd-party bundle binaries...
 [100%]

 [100%]

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This extra step was causing the percentage to be printed twice:
$ sudo ./swupd 3rd-party remove swupd-master
Loading required manifests...
 [100%]

Removing repository swupd-master...

Removing 3rd-party bundle binaries...
 [100%]

 [100%]

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1340,2020-03-02T19:59:20Z,2020-03-02T23:22:02Z,2020-03-02T23:22:02Z,MERGED,True,3,4,1,https://github.com/otaviobp,tests: Remove test leftovers when the directory is incomplete,1,[],https://github.com/clearlinux/swupd-client/pull/1340,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1340,"Sometimes a test fails before finisihing to create all the required
directories under the testdir. So destroy_environment thinks this is
not a valid test environment.
Touching a dot file to show that the directory is a test environment
instead on counting on its content.
Fixes bug #1135
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Sometimes a test fails before finisihing to create all the required
directories under the testdir. So destroy_environment thinks this is
not a valid test environment.
Touching a dot file to show that the directory is a test environment
instead on counting on its content.
Fixes bug #1135
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1344,2020-03-03T21:39:49Z,2020-03-04T00:40:16Z,2020-03-04T17:16:01Z,MERGED,True,77,17,3,https://github.com/castulo,Do not apply heuristics to 3rd-party files,1,[],https://github.com/clearlinux/swupd-client/pull/1344,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1344,"When adding an upstream bundle, we apply some heuristics to the bundle
files and based on that some files are skipped from being installed.
These heuristics don't apply to 3rd-party bundles.
This commit skips running heuristics when adding 3rd-party bundles.
Closes #1342
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When adding an upstream bundle, we apply some heuristics to the bundle
files and based on that some files are skipped from being installed.
These heuristics don't apply to 3rd-party bundles.
This commit skips running heuristics when adding 3rd-party bundles.
Closes #1342
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1344,2020-03-03T21:39:49Z,2020-03-04T00:40:16Z,2020-03-04T17:16:01Z,MERGED,True,77,17,3,https://github.com/castulo,Do not apply heuristics to 3rd-party files,1,[],https://github.com/clearlinux/swupd-client/pull/1344,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1344#issuecomment-594204963,"When adding an upstream bundle, we apply some heuristics to the bundle
files and based on that some files are skipped from being installed.
These heuristics don't apply to 3rd-party bundles.
This commit skips running heuristics when adding 3rd-party bundles.
Closes #1342
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","LGTM, I like the test change quite a bit too. We may come to a point where those pre/post/val functions would be better as a function list that are applied in order but not something to consider at this point.",True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1345,2020-03-04T00:40:39Z,2020-03-04T20:04:06Z,2020-03-04T20:04:06Z,MERGED,True,70,32,6,https://github.com/otaviobp,Sys: Prefer to use functions from sys than stat,2,[],https://github.com/clearlinux/swupd-client/pull/1345,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1345,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1348,2020-03-04T18:04:26Z,2020-03-05T00:03:25Z,2020-03-05T00:07:29Z,MERGED,True,134,15,6,https://github.com/castulo,Forcing the removal of corrupt 3rd-party repos,1,[],https://github.com/clearlinux/swupd-client/pull/1348,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1348,"This commit allow users to force the deletion of corrupt 3rd-party repos
which will end up deleting most of the repo's files, except for the
scripts that exported files from that repo.
Closes #1343
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit allow users to force the deletion of corrupt 3rd-party repos
which will end up deleting most of the repo's files, except for the
scripts that exported files from that repo.
Closes #1343
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1348,2020-03-04T18:04:26Z,2020-03-05T00:03:25Z,2020-03-05T00:07:29Z,MERGED,True,134,15,6,https://github.com/castulo,Forcing the removal of corrupt 3rd-party repos,1,[],https://github.com/clearlinux/swupd-client/pull/1348,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1348#issuecomment-594734939,"This commit allow users to force the deletion of corrupt 3rd-party repos
which will end up deleting most of the repo's files, except for the
scripts that exported files from that repo.
Closes #1343
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",@otaviobp please check the messages I'm printing and let me know if we need to provide more information to the user.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1350,2020-03-04T21:38:28Z,2020-03-05T00:03:33Z,2020-03-05T00:07:15Z,MERGED,True,5,2,1,https://github.com/castulo,Adding draft for the 3rd-party release notes,1,[],https://github.com/clearlinux/swupd-client/pull/1350,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1350,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1351,2020-03-05T18:40:30Z,2020-03-05T20:07:48Z,2020-04-03T19:34:10Z,MERGED,True,7,1,1,https://github.com/otaviobp,time: stop using deprecated function stime(),1,[],https://github.com/clearlinux/swupd-client/pull/1351,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1351,"stime is deprecated in newer versions of glibc, so using the recommended
clock_settime() instead.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","stime is deprecated in newer versions of glibc, so using the recommended
clock_settime() instead.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1352,2020-03-05T22:08:55Z,2020-03-19T19:52:35Z,2020-04-03T19:33:44Z,MERGED,True,197,7,3,https://github.com/otaviobp,Staging: Don't create hardlinks when installing symlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1352,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1352,"Staging: Don't create hardlinks when installing symlinks

Alternative solution to solution proposed on #1318

Instead of trying to create a link just don't try to link symlinks.
Tested patch using bsdtar and implemented automated testing to
validate solution.

Signed-off-by: Otavio Pontes <otavio.pontes@intel.com>","Staging: Don't create hardlinks when installing symlinks

Alternative solution to solution proposed on #1318

Instead of trying to create a link just don't try to link symlinks.
Tested patch using bsdtar and implemented automated testing to
validate solution.

Signed-off-by: Otavio Pontes <otavio.pontes@intel.com>",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1352,2020-03-05T22:08:55Z,2020-03-19T19:52:35Z,2020-04-03T19:33:44Z,MERGED,True,197,7,3,https://github.com/otaviobp,Staging: Don't create hardlinks when installing symlinks,1,[],https://github.com/clearlinux/swupd-client/pull/1352,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1352#issuecomment-597358783,"Staging: Don't create hardlinks when installing symlinks

Alternative solution to solution proposed on #1318

Instead of trying to create a link just don't try to link symlinks.
Tested patch using bsdtar and implemented automated testing to
validate solution.

Signed-off-by: Otavio Pontes <otavio.pontes@intel.com>",PR reworked and ready to be reviewed now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1355,2020-03-06T21:38:34Z,2020-03-06T22:54:25Z,2020-03-06T23:09:11Z,MERGED,True,200,3,10,https://github.com/castulo,Implementing the 3rd-party info command,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1355,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1355,"Implementation of the 3rd-party info command to show the version of the
3rd-party repository along with the update URL.
Closes #1354
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Implementation of the 3rd-party info command to show the version of the
3rd-party repository along with the update URL.
Closes #1354
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1356,2020-03-06T23:03:52Z,2020-03-06T23:08:36Z,2020-03-06T23:08:56Z,MERGED,True,57,4,2,https://github.com/castulo,Reordering 3rd-party subcommands in help,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1356,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1356,"Reordering so it matches the order of the regular swupd commands. Also
adding missing values to config file.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Reordering so it matches the order of the regular swupd commands. Also
adding missing values to config file.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1357,2020-03-07T00:18:12Z,2020-03-07T00:58:23Z,2020-03-07T00:58:23Z,CLOSED,False,7,4,1,https://github.com/otaviobp,3rd-party: Fixing some error handling problems on 3rd_party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1357,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1357,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1359,2020-03-09T19:48:50Z,2020-03-09T21:10:53Z,2020-04-03T19:34:12Z,MERGED,True,1,117,9,https://github.com/otaviobp,service: Remove check-update service,1,[],https://github.com/clearlinux/swupd-client/pull/1359,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1359,"Clear Linux isn't using the check-update service anymore for a long time
and there's no other known uses for those scripts. So there's no reason to
keep them.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Clear Linux isn't using the check-update service anymore for a long time
and there's no other known uses for those scripts. So there's no reason to
keep them.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1360,2020-03-10T16:35:54Z,2020-03-10T17:17:35Z,2020-03-10T17:17:35Z,MERGED,True,1,1,1,https://github.com/otaviobp,Some improvements for make check-functional,2,[],https://github.com/clearlinux/swupd-client/pull/1360,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1360,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1361,2020-03-10T16:51:04Z,2020-03-10T17:19:24Z,2020-03-10T17:24:04Z,MERGED,True,2,2,1,https://github.com/castulo,Do not follow links when validating staged files,1,[],https://github.com/clearlinux/swupd-client/pull/1361,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1361,"When updating 3rd-party bundles, swupd validates the files to be updated
to make sure there were no changes in file permissions that could be
risky for the system, it uses stat to get the file permissions. The
problem is that stat follows links, and while the files are in staging,
the links are really pointing to invalid locations so stat will always
fail.
This commit fixes the problem by not following links when validating
file permissions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When updating 3rd-party bundles, swupd validates the files to be updated
to make sure there were no changes in file permissions that could be
risky for the system, it uses stat to get the file permissions. The
problem is that stat follows links, and while the files are in staging,
the links are really pointing to invalid locations so stat will always
fail.
This commit fixes the problem by not following links when validating
file permissions.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1362,2020-03-10T17:18:55Z,2020-03-10T17:43:02Z,2020-04-03T19:34:03Z,MERGED,True,1,10,2,https://github.com/otaviobp,Remove some leftovers from IManifests,2,[],https://github.com/clearlinux/swupd-client/pull/1362,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1362,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1363,2020-03-10T17:38:03Z,2020-03-10T17:57:32Z,2020-03-10T17:57:32Z,MERGED,True,4,4,2,https://github.com/otaviobp,3rd-party: Make 3rd-party default in the build,1,[],https://github.com/clearlinux/swupd-client/pull/1363,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1363,"Instead of requiring an --enable-third-party, as 3rd-party was already
released, we can make it default.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Instead of requiring an --enable-third-party, as 3rd-party was already
released, we can make it default.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1364,2020-03-10T17:38:24Z,2020-03-10T18:00:44Z,2020-04-03T19:34:02Z,MERGED,True,5,0,1,https://github.com/otaviobp,signature: Dummy signature_verify_data() function missing,1,[],https://github.com/clearlinux/swupd-client/pull/1364,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1364,"When building swupd with --disable-signature we need to have all
signature functions with a dummy implementation that doesn't validate
the signature.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When building swupd with --disable-signature we need to have all
signature functions with a dummy implementation that doesn't validate
the signature.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1365,2020-03-10T17:41:54Z,2020-03-10T18:09:48Z,2020-03-10T18:09:51Z,MERGED,True,7,55,1,https://github.com/castulo,Remove iterative manifest support from testlib,1,[],https://github.com/clearlinux/swupd-client/pull/1365,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1365,"The iterative manifest effort was droped so this commit removes the
iterative manifest support from testlib.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The iterative manifest effort was droped so this commit removes the
iterative manifest support from testlib.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1366,2020-03-10T17:49:59Z,2020-03-13T21:49:58Z,2020-04-03T19:33:57Z,MERGED,True,43,0,1,https://github.com/otaviobp,scripts: Add a script to run swupd basic tests,1,[],https://github.com/clearlinux/swupd-client/pull/1366,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1366,"Besides having a script that is used to run tests on github
actions CI, adding another script that can be used in any
system to build swupd with different configurations and
run all needed tests.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Besides having a script that is used to run tests on github
actions CI, adding another script that can be used in any
system to build swupd with different configurations and
run all needed tests.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1367,2020-03-10T18:45:02Z,2020-03-10T19:12:02Z,2020-03-10T21:19:18Z,MERGED,True,47,12,1,https://github.com/castulo,Updating testlib README,1,[],https://github.com/clearlinux/swupd-client/pull/1367,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1367,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1370,2020-03-11T19:30:27Z,2020-03-13T15:04:39Z,2020-04-03T19:33:59Z,MERGED,True,19,19,8,https://github.com/otaviobp,docs: Replace vi with vim,1,[],https://github.com/clearlinux/swupd-client/pull/1370,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1370,"Vi isn't a bundle anymore. Replacing all examples to vim.
Related to #1369
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Vi isn't a bundle anymore. Replacing all examples to vim.
Related to #1369
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1370,2020-03-11T19:30:27Z,2020-03-13T15:04:39Z,2020-04-03T19:33:59Z,MERGED,True,19,19,8,https://github.com/otaviobp,docs: Replace vi with vim,1,[],https://github.com/clearlinux/swupd-client/pull/1370,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1370#issuecomment-598387204,"Vi isn't a bundle anymore. Replacing all examples to vim.
Related to #1369
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",V2: Reported problems fixed.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1370,2020-03-11T19:30:27Z,2020-03-13T15:04:39Z,2020-04-03T19:33:59Z,MERGED,True,19,19,8,https://github.com/otaviobp,docs: Replace vi with vim,1,[],https://github.com/clearlinux/swupd-client/pull/1370,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1370#issuecomment-598473775,"Vi isn't a bundle anymore. Replacing all examples to vim.
Related to #1369
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",v3: Replacing os-core to xterm,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1371,2020-03-12T18:42:47Z,2020-03-13T17:03:33Z,2020-03-13T17:10:33Z,MERGED,True,46,5,3,https://github.com/castulo,Bug fix: os-install --bundles with os-core fails,1,[],https://github.com/clearlinux/swupd-client/pull/1371,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1371,"When doing a system install with ""os-install --bundles"" if the list of
bundles to install includes only ""os-core"" the install fails.
This commit fixes the issue.
Closes #1369
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When doing a system install with ""os-install --bundles"" if the list of
bundles to install includes only ""os-core"" the install fails.
This commit fixes the issue.
Closes #1369
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1371,2020-03-12T18:42:47Z,2020-03-13T17:03:33Z,2020-03-13T17:10:33Z,MERGED,True,46,5,3,https://github.com/castulo,Bug fix: os-install --bundles with os-core fails,1,[],https://github.com/clearlinux/swupd-client/pull/1371,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1371#issuecomment-598792101,"When doing a system install with ""os-install --bundles"" if the list of
bundles to install includes only ""os-core"" the install fails.
This commit fixes the issue.
Closes #1369
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2: I just tested the fix as @otaviobp suggested just by allowing os-core to be added to the bundles list when requested, and it works fine. So this update includes that change.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1372,2020-03-12T20:07:23Z,2020-03-12T22:37:29Z,2020-04-03T19:34:00Z,MERGED,True,7,1,1,https://github.com/otaviobp,build_opts: Print third party build info on swupd -v,1,[],https://github.com/clearlinux/swupd-client/pull/1372,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1372,"We print all flags selected on build time on swupd -v. This is useful
to check if an specific swupd binary has one specific feature enabled.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We print all flags selected on build time on swupd -v. This is useful
to check if an specific swupd binary has one specific feature enabled.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1373,2020-03-13T02:34:13Z,2020-03-13T16:55:00Z,2020-03-13T16:55:00Z,CLOSED,False,321,317,1,https://github.com/lebensterben,Fixed bug,1,[],https://github.com/clearlinux/swupd-client/pull/1373,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1373,"Currently when you type swupd and press tab, it shows you a warning on parsing error.
Huge amount of changes are due to re-formatting. There are only four actual
changes:

Added a ')' on line 203, 211, and 219.
Changed line 280 from
'(help --status)'[Show the installation status of the listed bundles'
to
'(help --status)--status[Show the installation status of the listed bundles]'","Currently when you type swupd and press tab, it shows you a warning on parsing error.
Huge amount of changes are due to re-formatting. There are only four actual
changes:

Added a ')' on line 203, 211, and 219.
Changed line 280 from
'(help --status)'[Show the installation status of the listed bundles'
to
'(help --status)--status[Show the installation status of the listed bundles]'",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1373,2020-03-13T02:34:13Z,2020-03-13T16:55:00Z,2020-03-13T16:55:00Z,CLOSED,False,321,317,1,https://github.com/lebensterben,Fixed bug,1,[],https://github.com/clearlinux/swupd-client/pull/1373,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1373#issuecomment-598818972,"Currently when you type swupd and press tab, it shows you a warning on parsing error.
Huge amount of changes are due to re-formatting. There are only four actual
changes:

Added a ')' on line 203, 211, and 219.
Changed line 280 from
'(help --status)'[Show the installation status of the listed bundles'
to
'(help --status)--status[Show the installation status of the listed bundles]'",Rebased manually and pushed to master,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1374,2020-03-13T21:01:58Z,2020-03-19T16:53:41Z,2020-03-19T16:53:41Z,MERGED,True,85,56,15,https://github.com/otaviobp,Shellcheck-all: Run shellcheck all on new commits on master,3,[],https://github.com/clearlinux/swupd-client/pull/1374,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1374,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1374,2020-03-13T21:01:58Z,2020-03-19T16:53:41Z,2020-03-19T16:53:41Z,MERGED,True,85,56,15,https://github.com/otaviobp,Shellcheck-all: Run shellcheck all on new commits on master,3,[],https://github.com/clearlinux/swupd-client/pull/1374,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1374#issuecomment-598910265,,As job doesn't run on pull requests there's no run status for this PR. If you want to check the action performed you can look at my repo: https://github.com/otaviobp/swupd-client/actions/runs/55271759,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1374,2020-03-13T21:01:58Z,2020-03-19T16:53:41Z,2020-03-19T16:53:41Z,MERGED,True,85,56,15,https://github.com/otaviobp,Shellcheck-all: Run shellcheck all on new commits on master,3,[],https://github.com/clearlinux/swupd-client/pull/1374,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1374#issuecomment-601295568,,"Nice one, the only comment I have is that it may be worth adding .sh files to be checked by shellcheck, also in case at some point someone adds one. Anyway I'm approving this PR since we don't really have .sh files so it is just a nice to have.

I'll address that in a new PR",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1375,2020-03-13T23:10:15Z,2020-03-19T15:55:04Z,2020-04-03T19:33:41Z,MERGED,True,4,4,3,https://github.com/otaviobp,Curl: Fixing progress report functions,2,[],https://github.com/clearlinux/swupd-client/pull/1375,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1375,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1378,2020-03-17T16:40:00Z,2020-03-17T20:32:16Z,2020-04-03T19:33:37Z,MERGED,True,56,18,3,https://github.com/otaviobp,Script: Some improvements in the test script,4,[],https://github.com/clearlinux/swupd-client/pull/1378,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1378,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1379,2020-03-17T18:31:43Z,2020-03-17T21:01:11Z,2020-04-03T19:33:39Z,MERGED,True,25,0,1,https://github.com/otaviobp,sys: Improve debug when running external scripts,1,[],https://github.com/clearlinux/swupd-client/pull/1379,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1379,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1380,2020-03-17T19:33:51Z,2020-04-01T20:28:22Z,2020-04-01T23:01:57Z,MERGED,True,494,39,1,https://github.com/castulo,Testlib: add support to create and update bundles based on content from a directory,7,[],https://github.com/clearlinux/swupd-client/pull/1380,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1380,"This PR adds support to create and update bundles based on the content of a directory. The idea of these improvements is to facilitate the creation of more complex test scenarios.
The PR also includes a few bug fixes in the test library.","This PR adds support to create and update bundles based on the content of a directory. The idea of these improvements is to facilitate the creation of more complex test scenarios.
The PR also includes a few bug fixes in the test library.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1380,2020-03-17T19:33:51Z,2020-04-01T20:28:22Z,2020-04-01T23:01:57Z,MERGED,True,494,39,1,https://github.com/castulo,Testlib: add support to create and update bundles based on content from a directory,7,[],https://github.com/clearlinux/swupd-client/pull/1380,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1380#issuecomment-603943688,"This PR adds support to create and update bundles based on the content of a directory. The idea of these improvements is to facilitate the creation of more complex test scenarios.
The PR also includes a few bug fixes in the test library.","V2 addresses all requested changes:

stop adding files pointed by links when adding symlinks to a manifest, they will have to be added explicitly
using find when collecting the content of a directory during add_content_to_bundle() instead of traversing the directories
using get_latest_version() to retrieve version numbers
Refactored update_bundle_from_content() to remove steps it did not need",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1382,2020-03-18T11:57:03Z,2020-03-26T16:57:20Z,2020-03-26T23:54:51Z,MERGED,True,5,1,3,https://github.com/chenming1986,curl: Don't resume download in case of HTTP 416 error,1,[],https://github.com/clearlinux/swupd-client/pull/1382,https://github.com/chenming1986,1,https://github.com/clearlinux/swupd-client/pull/1382,"When tens of thousands of files are transferred (eg. update/repair to a
recent build from a very old one), there are chances that curl returns
CURLE_RECV_ERROR when downloading some of the files even if those files
are already successfully downloaded. In such cases resuming download
will always fail with HTTP 416 error - requested range not satisfiable.
This change adds a new download status for HTTP 416 and in case of that
status, start the download from the beginning all over again for the
affected files.
Signed-off-by: Ming Chen ming.a.chen@intel.com","When tens of thousands of files are transferred (eg. update/repair to a
recent build from a very old one), there are chances that curl returns
CURLE_RECV_ERROR when downloading some of the files even if those files
are already successfully downloaded. In such cases resuming download
will always fail with HTTP 416 error - requested range not satisfiable.
This change adds a new download status for HTTP 416 and in case of that
status, start the download from the beginning all over again for the
affected files.
Signed-off-by: Ming Chen ming.a.chen@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1382,2020-03-18T11:57:03Z,2020-03-26T16:57:20Z,2020-03-26T23:54:51Z,MERGED,True,5,1,3,https://github.com/chenming1986,curl: Don't resume download in case of HTTP 416 error,1,[],https://github.com/clearlinux/swupd-client/pull/1382,https://github.com/chenming1986,2,https://github.com/clearlinux/swupd-client/pull/1382#issuecomment-600582956,"When tens of thousands of files are transferred (eg. update/repair to a
recent build from a very old one), there are chances that curl returns
CURLE_RECV_ERROR when downloading some of the files even if those files
are already successfully downloaded. In such cases resuming download
will always fail with HTTP 416 error - requested range not satisfiable.
This change adds a new download status for HTTP 416 and in case of that
status, start the download from the beginning all over again for the
affected files.
Signed-off-by: Ming Chen ming.a.chen@intel.com","Attaching the log when I was attempting to repair to Clear Linux 32400 from 32610. Private mirror url was hidden in the log. Updating to the latest version from an very old one also experienced the same issue.
swupd.log",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1382,2020-03-18T11:57:03Z,2020-03-26T16:57:20Z,2020-03-26T23:54:51Z,MERGED,True,5,1,3,https://github.com/chenming1986,curl: Don't resume download in case of HTTP 416 error,1,[],https://github.com/clearlinux/swupd-client/pull/1382,https://github.com/chenming1986,3,https://github.com/clearlinux/swupd-client/pull/1382#issuecomment-604745152,"When tens of thousands of files are transferred (eg. update/repair to a
recent build from a very old one), there are chances that curl returns
CURLE_RECV_ERROR when downloading some of the files even if those files
are already successfully downloaded. In such cases resuming download
will always fail with HTTP 416 error - requested range not satisfiable.
This change adds a new download status for HTTP 416 and in case of that
status, start the download from the beginning all over again for the
affected files.
Signed-off-by: Ming Chen ming.a.chen@intel.com",Thanks for merging!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1383,2020-03-18T21:00:25Z,2020-03-18T22:51:28Z,2020-03-18T22:51:28Z,MERGED,True,8,8,1,https://github.com/otaviobp,tests: On mirror tests don't use possible real server names,1,[],https://github.com/clearlinux/swupd-client/pull/1383,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1383,"On proxy envs we may need to wait for a timeout before proceeding and
this can slow tests down.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","On proxy envs we may need to wait for a timeout before proceeding and
this can slow tests down.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1385,2020-03-19T17:42:17Z,2020-04-02T15:16:28Z,2020-04-03T19:33:43Z,CLOSED,False,812,1234,214,https://github.com/otaviobp,Test cache: First batch of changes to support test caching,8,[],https://github.com/clearlinux/swupd-client/pull/1385,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1385,"This PR isn't adding the caching capabilities yet, but it is introducing one step used to create metadata in a way that can be cached.","This PR isn't adding the caching capabilities yet, but it is introducing one step used to create metadata in a way that can be cached.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1385,2020-03-19T17:42:17Z,2020-04-02T15:16:28Z,2020-04-03T19:33:43Z,CLOSED,False,812,1234,214,https://github.com/otaviobp,Test cache: First batch of changes to support test caching,8,[],https://github.com/clearlinux/swupd-client/pull/1385,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1385#issuecomment-605287221,"This PR isn't adding the caching capabilities yet, but it is introducing one step used to create metadata in a way that can be cached.","Let me try to explain a bit here the overall idea of the major changes in this PR. btw, if when it's good to merge, we need to document that better on testlib doc.
Today files are created for tests in 2 different moments. On global_setup() or test_setup(). And we support just one of those cases. If global_setup() is used all tests are running with the same environment (what's bad) and the result of one test impact the other. If test_setup() is used the environment is recreated for every test. global_setup() and test_setup() are also used to start/stop services that may be needed by the test (like the webserver).
The major proposal of this PR is to create another step that is used to generate any file that would be reused by all tests on the test file in a way that it could be cached. I called this step metadata_setup(). Metadata_setup is called only once for each test file and all generated files are copied to the specific test directory to be reused by the test.
Changes made to accomplish that:

Separate the creation of a test directory from the creation of a mix. We may want to use the testlib for tests that doesn't require any mix to be created.
Explicit mix creation. Instead of creating an env on test_setup with default parameters, it's up to the user to define how to create the environment. This prevents us to need override test_setup() with an empty body. Directory for the test data is still created and mandatory. It's cheap and it can be used by testlib to store any file needed.
Create keys to sign the release on testlib and not in another test. Now we are creating one key for each test file because it's easier to cache.
Create a step to be used to create metadata and copy it to every test.

So now, if we have 3 tests in a example.bats file we will have the following workflow:

global_setup() #TEST_NAME=example
metadata_setup() #TEST_NAME=example_META
test_setup() #TEST_NAME=example_001 and everything saved to example_META is copied to example_001 before starting
test_teardown() #TEST_NAME=example_001
test_setup() #TEST_NAME=example_002 and everything saved to example_META is copied to example_002 before starting
test_teardown() #TEST_NAME=example_002
test_setup() #TEST_NAME=example_003 and everything saved to example_META is copied to example_003 before starting
test_teardown() #TEST_NAME=example_003
global_teardown() # TEST_NAME=example",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1385,2020-03-19T17:42:17Z,2020-04-02T15:16:28Z,2020-04-03T19:33:43Z,CLOSED,False,812,1234,214,https://github.com/otaviobp,Test cache: First batch of changes to support test caching,8,[],https://github.com/clearlinux/swupd-client/pull/1385,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1385#issuecomment-606750520,"This PR isn't adding the caching capabilities yet, but it is introducing one step used to create metadata in a way that can be cached.","Today files are created for tests in 2 different moments. On global_setup() or test_setup().

Yes, and this the way all other test frameworks work

And we support just one of those cases.

What do you mean we only support one of those cases? You can use both if you want in a test at the same time. This would be the workflow of a test file if all setups and teardown are used (assuming we have 2 tests in the file):
global setup

test setup
test 1 runs
test teardown

test setup
test 2 runs
test teardown

global teardown

And again, this is pretty standard of any test framework.

If global_setup() is used all tests are running with the same environment (what's bad) and the result of one test impact the other. If test_setup() is used the environment is recreated for every test.

I disagree with this statement, whatever is done in the global_setup() impacts all the tests, but that is definitely not bad, you only have to choose the right actions to run there (if any). For example in an application that needs the user to authenticate you may want to use the global setup to login to the application that is going to be tested so you don't have to do it for every test. In our case, global setups are really not that useful because of the nature of our application and our tests, most of the times we don't want to use it precisely because we use global_setup and test_setup to create environments that we modify with tests, and we cannot really reuse an environment if it was already modified by another test or we would have the conflict you talk about where one test could impact the result of the next. I still think global_setup is useful for a few of our tests, for example tests that only list things without changing anything, we can create only one environment and reuse it in all tests, that makes the test faster.

global_setup() and test_setup() are also used to start/stop services that may be needed by the test (like the webserver).


The major proposal of this PR is to create another step that is used to generate any file that would be reused by all tests on the test file in a way that it could be cached. I called this step metadata_setup(). Metadata_setup is called only once for each test file and all generated files are copied to the specific test directory to be reused by the test.

I'm all about saving execution time by caching stuff that we create over and over, specially since the creation of that test data consumes most of the time of the test. I think it is a good idea. I just want us to be careful about it so we don't impact the experience of using the test library when run locally and interactively. I'm not sure how you use the test library, but I use it a lot interactively for debugging. Also I wouldn't want the library to divert from what is expected from a test library, for example as I said a ""global setup"" is pretty standard in any test framework, so I would expect it to behave similarly to a global setup in other frameworks.

Changes made to accomplish that:

Separate the creation of a test directory from the creation of a mix. We may want to use the testlib for tests that doesn't require any mix to be created.
Explicit mix creation. Instead of creating an env on test_setup with default parameters, it's up to the user to define how to create the environment. This prevents us to need override test_setup() with an empty body. Directory for the test data is still created and mandatory. It's cheap and it can be used by testlib to store any file needed.


I'm ok with this, in fact, I also prefer it this way. I ended up adding the default actions in test_setup and test_teardown as a result of a direct request when folks were reviewing the implementation of the test library.


Create keys to sign the release on testlib and not in another test. Now we are creating one key for each test file because it's easier to cache.
Create a step to be used to create metadata and copy it to every test.



So now, if we have 3 tests in a example.bats file we will have the following workflow:

global_setup() #TEST_NAME=example
metadata_setup() #TEST_NAME=example_META
test_setup() #TEST_NAME=example_001 and everything saved to example_META is copied to example_001 before starting
test_teardown() #TEST_NAME=example_001
test_setup() #TEST_NAME=example_002 and everything saved to example_META is copied to example_002 before starting
test_teardown() #TEST_NAME=example_002
test_setup() #TEST_NAME=example_003 and everything saved to example_META is copied to example_003 before starting
test_teardown() #TEST_NAME=example_003
global_teardown() # TEST_NAME=example


I'm a little confused in this workflow. If you are creating metadata_setup between global setup and test setup... does that mean that metadata will only contain stuff that otherwise would have been created during the global setup?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1385,2020-03-19T17:42:17Z,2020-04-02T15:16:28Z,2020-04-03T19:33:43Z,CLOSED,False,812,1234,214,https://github.com/otaviobp,Test cache: First batch of changes to support test caching,8,[],https://github.com/clearlinux/swupd-client/pull/1385,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1385#issuecomment-606918894,"This PR isn't adding the caching capabilities yet, but it is introducing one step used to create metadata in a way that can be cached.","As there are many topics here that we are not on the same page, I'll open issues and pull request for the points that it looks like there is an agreement and we can discuss them on a different PR. Most of the changes here are bug fixes or enhancements on the workflow that were needed by my proposed change to cache metadata files. I think most of those changes are possible to be made on different PRs, so I'll also open tickets for them.
I'll try to answer here though some of your questions.

And we support just one of those cases.

I read again what I wrote and it's hard to understand. I'll try to explain my point here with examples. Maybe it's not really a missing feature, it's just something I didn't know how to do.
For example, if I use global_setup() to create my environment I have changes persisted from test to test (https://gist.github.com/otaviobp/18c7ccc01720864780c01ed6e0f4c28b), as I would expect. If I use test_setup (https://gist.github.com/otaviobp/8f1c0a344701a2859adc3542ad3ee9d4), changes are not persisted, as I would expect. What I don't know how to do and I think it is a testlib limitation is to do both in the same test. I tried it here (https://gist.github.com/otaviobp/3d8fe8d5bf75c57b55e954b063389f72). If there's a way to do it, let me know.
When I said that the user needs to choose one, I meant that the user needs to choose to create the mix for global or for local.

I'm a little confused in this workflow. If you are creating metadata_setup between global setup and test setup... does that mean that metadata will only contain stuff that otherwise would have been created during the global setup?

metadata will contain only things generated in metadata_setup(). nothing from global_setup() or test_setup(). metadata_setup() is a new step to create/consume any data that you want to cache/restore in multiple executions. Maybe cache_setup() would be a better name",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1385,2020-03-19T17:42:17Z,2020-04-02T15:16:28Z,2020-04-03T19:33:43Z,CLOSED,False,812,1234,214,https://github.com/otaviobp,Test cache: First batch of changes to support test caching,8,[],https://github.com/clearlinux/swupd-client/pull/1385,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1385#issuecomment-606927313,"This PR isn't adding the caching capabilities yet, but it is introducing one step used to create metadata in a way that can be cached.","As there are many topics here that we are not on the same page, I'll open issues and pull request for the points that it looks like there is an agreement and we can discuss them on a different PR. Most of the changes here are bug fixes or enhancements on the workflow that were needed by my proposed change to cache metadata files. I think most of those changes are possible to be made on different PRs, so I'll also open tickets for them.

I think it is a good idea to try to split this PR in many smaller ones, that way it would be easier to discuss each topic separately.

I'll try to answer here though some of your questions.

And we support just one of those cases.

I read again what I wrote and it's hard to understand. I'll try to explain my point here with examples. Maybe it's not really a missing feature, it's just something I didn't know how to do.
For example, if I use global_setup() to create my environment I have changes persisted from test to test (https://gist.github.com/otaviobp/18c7ccc01720864780c01ed6e0f4c28b), as I would expect. If I use test_setup (https://gist.github.com/otaviobp/8f1c0a344701a2859adc3542ad3ee9d4), changes are not persisted, as I would expect. What I don't know how to do and I think it is a testlib limitation is to do both in the same test. I tried it here (https://gist.github.com/otaviobp/3d8fe8d5bf75c57b55e954b063389f72). If there's a way to do it, let me know.

I understand your point now, and yes, currently there is no way to safely create a test environment in a global_setup and then create bundles in a test_setup. To do something like that, we would need to implement a destroy_bundle function that would revert whatever we did with create_bundle and call that function in the test_teardown, similar to what I did with the tests in add-basics.bats: https://github.com/clearlinux/swupd-client/blob/master/test/functional/bundleadd/add-basics.bats#L22

When I said that the user needs to choose one, I meant that the user needs to choose to create the mix for global or for local.

Yeah, this is true with the current capabilities of testlib without implementing more functions to destroy/revert test resources


I'm a little confused in this workflow. If you are creating metadata_setup between global setup and test setup... does that mean that metadata will only contain stuff that otherwise would have been created during the global setup?

metadata will contain only things generated in metadata_setup(). nothing from global_setup() or test_setup(). metadata_setup() is a new step to create/consume any data that you want to cache/restore in multiple executions. Maybe cache_setup() would be a better name

That sounds good ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1386,2020-03-19T20:36:33Z,2020-03-20T21:31:26Z,2020-03-20T22:05:15Z,MERGED,True,93,63,7,https://github.com/castulo,3rd-party:bug_fix: don't add unreachable repos,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1386,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1386,"When adding a 3rd-party repo, if the repo cannot be added it is reverted
back. However if a user uses an incorrect URL that hangs and the user
cancels the process, the repo add is never rolled back, which will cause
the invalid repo to be left in the system.
This commit fixes the issue by making sure the repo is reachable and
somewhat valid before adding it to the config file.
Closes #1384
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When adding a 3rd-party repo, if the repo cannot be added it is reverted
back. However if a user uses an incorrect URL that hangs and the user
cancels the process, the repo add is never rolled back, which will cause
the invalid repo to be left in the system.
This commit fixes the issue by making sure the repo is reachable and
somewhat valid before adding it to the config file.
Closes #1384
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1386,2020-03-19T20:36:33Z,2020-03-20T21:31:26Z,2020-03-20T22:05:15Z,MERGED,True,93,63,7,https://github.com/castulo,3rd-party:bug_fix: don't add unreachable repos,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1386,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1386#issuecomment-601899338,"When adding a 3rd-party repo, if the repo cannot be added it is reverted
back. However if a user uses an incorrect URL that hangs and the user
cancels the process, the repo add is never rolled back, which will cause
the invalid repo to be left in the system.
This commit fixes the issue by making sure the repo is reachable and
somewhat valid before adding it to the config file.
Closes #1384
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

Add the repo to repo.ini as the last step of the process
Make sure the repo doesn't exist already as first step
Make sure a leftover content directory doesn't already exist for the repo as one of the initial steps",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1386,2020-03-19T20:36:33Z,2020-03-20T21:31:26Z,2020-03-20T22:05:15Z,MERGED,True,93,63,7,https://github.com/castulo,3rd-party:bug_fix: don't add unreachable repos,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1386,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1386#issuecomment-601907670,"When adding a 3rd-party repo, if the repo cannot be added it is reverted
back. However if a user uses an incorrect URL that hangs and the user
cancels the process, the repo add is never rolled back, which will cause
the invalid repo to be left in the system.
This commit fixes the issue by making sure the repo is reachable and
somewhat valid before adding it to the config file.
Closes #1384
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3:

fixed broken test",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1387,2020-03-19T22:53:16Z,2020-03-23T21:51:59Z,2020-03-23T21:51:59Z,MERGED,True,315,75,22,https://github.com/otaviobp,Enforcing signature verification even when signature is missing,6,[],https://github.com/clearlinux/swupd-client/pull/1387,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1387,Also adding more tests and other fixes,Also adding more tests and other fixes,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1387,2020-03-19T22:53:16Z,2020-03-23T21:51:59Z,2020-03-23T21:51:59Z,MERGED,True,315,75,22,https://github.com/otaviobp,Enforcing signature verification even when signature is missing,6,[],https://github.com/clearlinux/swupd-client/pull/1387,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1387#issuecomment-601455385,Also adding more tests and other fixes,"@bryteise After this PR signature verification for latest file is going to be completely enforced. If signature is missing or incorrect, any swupd operation will be aborted. If user wants to proceed there's a new flag --nosigcheck-latest that will ignore latest signature, but continue to check Manifests, so it's safer than --nosigcheck.
On an update, if there is a mirror set we always check if the mirror is out of sync with upstream. In the case where signature for mirror is invalid or missing, we consider the mirror out of sync and update will proceed using the default url (upstream).
Does this approach looks good to you? This code is still aborting in the case where signature is expired. This fix will come next.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1387,2020-03-19T22:53:16Z,2020-03-23T21:51:59Z,2020-03-23T21:51:59Z,MERGED,True,315,75,22,https://github.com/otaviobp,Enforcing signature verification even when signature is missing,6,[],https://github.com/clearlinux/swupd-client/pull/1387,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1387#issuecomment-601888040,Also adding more tests and other fixes,"V2

Fixing all reported problems
Adding another commit changing phrasing of --nosigcheck",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1387,2020-03-19T22:53:16Z,2020-03-23T21:51:59Z,2020-03-23T21:51:59Z,MERGED,True,315,75,22,https://github.com/otaviobp,Enforcing signature verification even when signature is missing,6,[],https://github.com/clearlinux/swupd-client/pull/1387,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1387#issuecomment-602729837,Also adding more tests and other fixes,V3: Fixing comment - s/will compromises/compromises/,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1389,2020-03-20T22:49:16Z,2020-03-24T22:00:12Z,2020-03-24T22:35:38Z,MERGED,True,82,69,19,https://github.com/castulo,Remove extra slash from path in 3rd-party funcs,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1389,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1389,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1389,2020-03-20T22:49:16Z,2020-03-24T22:00:12Z,2020-03-24T22:35:38Z,MERGED,True,82,69,19,https://github.com/castulo,Remove extra slash from path in 3rd-party funcs,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1389,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1389#issuecomment-602786762,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,"@otaviobp take a look at this PR and let me know what you think. I'm unsure about two things:

the name of the function sys_path
if the function should live in sys.c or in helpers.c",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1389,2020-03-20T22:49:16Z,2020-03-24T22:00:12Z,2020-03-24T22:35:38Z,MERGED,True,82,69,19,https://github.com/castulo,Remove extra slash from path in 3rd-party funcs,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1389,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1389#issuecomment-602897092,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,"V2, addressed all the comments from review:

replaced the current sys_path_join function with the new implementation that can join many paths
fixed the arguments of the function everywhere where the function was already being used to match the new arguments",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1390,2020-03-20T23:37:27Z,2020-03-25T16:11:25Z,2020-03-25T16:42:54Z,MERGED,True,147,7,6,https://github.com/castulo,"3rd-party: add force option to ""3rd-party add""",1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1390,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1390,"When swupd is adding a 3rd-party repo and it finds a non empty directory
that matches the repo's name in the content path it warns the user and
aborts. This may have been caused by a corrupt repo.
This commit adds a --force flag to allow users to instruct swupd to
remove the existing directory and its conent and continue adding the
3rd-party repo.
Closes #1388
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When swupd is adding a 3rd-party repo and it finds a non empty directory
that matches the repo's name in the content path it warns the user and
aborts. This may have been caused by a corrupt repo.
This commit adds a --force flag to allow users to instruct swupd to
remove the existing directory and its conent and continue adding the
3rd-party repo.
Closes #1388
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1391,2020-03-24T17:28:17Z,2020-03-24T18:48:44Z,2020-03-24T18:48:50Z,MERGED,True,4,6,2,https://github.com/castulo,Testlib: Fixing the absolute path of a mirror test,1,[],https://github.com/clearlinux/swupd-client/pull/1391,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1391,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1391,2020-03-24T17:28:17Z,2020-03-24T18:48:44Z,2020-03-24T18:48:50Z,MERGED,True,4,6,2,https://github.com/castulo,Testlib: Fixing the absolute path of a mirror test,1,[],https://github.com/clearlinux/swupd-client/pull/1391,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1391#issuecomment-603396981,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,remove from testlib,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1391,2020-03-24T17:28:17Z,2020-03-24T18:48:44Z,2020-03-24T18:48:50Z,MERGED,True,4,6,2,https://github.com/castulo,Testlib: Fixing the absolute path of a mirror test,1,[],https://github.com/clearlinux/swupd-client/pull/1391,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1391#issuecomment-603415503,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,"V2:

removing SWUPD_DIR_ABS from testlib",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1395,2020-03-25T17:33:10Z,2020-03-26T16:54:34Z,2020-04-03T19:33:47Z,MERGED,True,25,1,4,https://github.com/otaviobp,mixin: Print deprecation warning,1,[],https://github.com/clearlinux/swupd-client/pull/1395,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1395,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1396,2020-03-25T19:03:51Z,2020-03-27T01:57:22Z,2020-04-03T19:33:34Z,MERGED,True,123,7,3,https://github.com/otaviobp,delta: Don't retry to use manifest deltas,1,[],https://github.com/clearlinux/swupd-client/pull/1396,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1396,"When a manifest delta was incorrect, the full manifest was used. But in the
case of a correct delta that produces an invalid manifest, swupd was never
trying to download the full manifest.
Changing code to try to use deltas only once. On first error, always retry
downloading the full manifest.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When a manifest delta was incorrect, the full manifest was used. But in the
case of a correct delta that produces an invalid manifest, swupd was never
trying to download the full manifest.
Changing code to try to use deltas only once. On first error, always retry
downloading the full manifest.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{'THUMBS_UP': ['https://github.com/mbelluzzo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1396,2020-03-25T19:03:51Z,2020-03-27T01:57:22Z,2020-04-03T19:33:34Z,MERGED,True,123,7,3,https://github.com/otaviobp,delta: Don't retry to use manifest deltas,1,[],https://github.com/clearlinux/swupd-client/pull/1396,https://github.com/phmccarty,2,https://github.com/clearlinux/swupd-client/pull/1396#issuecomment-604168731,"When a manifest delta was incorrect, the full manifest was used. But in the
case of a correct delta that produces an invalid manifest, swupd was never
trying to download the full manifest.
Changing code to try to use deltas only once. On first error, always retry
downloading the full manifest.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Under what circumstance would a correct delta produce an invalid manifest? If you have encountered this case in the wild, please let me know so that I can investigate.
The intent of this PR looks good, I just wanted to know if this change is in response to a bsdiff bug, for example.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1396,2020-03-25T19:03:51Z,2020-03-27T01:57:22Z,2020-04-03T19:33:34Z,MERGED,True,123,7,3,https://github.com/otaviobp,delta: Don't retry to use manifest deltas,1,[],https://github.com/clearlinux/swupd-client/pull/1396,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1396#issuecomment-604504425,"When a manifest delta was incorrect, the full manifest was used. But in the
case of a correct delta that produces an invalid manifest, swupd was never
trying to download the full manifest.
Changing code to try to use deltas only once. On first error, always retry
downloading the full manifest.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Under what circumstance would a correct delta produce an invalid manifest? If you have encountered this case in the wild, please let me know so that I can investigate.

This could be caused by a bug on mixer or invalid usage of mixer. This should never happen in production, but if it does, we can try to update anyway.

The intent of this PR looks good, I just wanted to know if this change is in response to a bsdiff bug, for example.

I don't know any bsdiff bug that could cause that. I'll let you know if I see any bsdiff problem happening.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1396,2020-03-25T19:03:51Z,2020-03-27T01:57:22Z,2020-04-03T19:33:34Z,MERGED,True,123,7,3,https://github.com/otaviobp,delta: Don't retry to use manifest deltas,1,[],https://github.com/clearlinux/swupd-client/pull/1396,https://github.com/phmccarty,4,https://github.com/clearlinux/swupd-client/pull/1396#issuecomment-604567597,"When a manifest delta was incorrect, the full manifest was used. But in the
case of a correct delta that produces an invalid manifest, swupd was never
trying to download the full manifest.
Changing code to try to use deltas only once. On first error, always retry
downloading the full manifest.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","@otaviobp Thanks, that makes more sense to me now. Glad to hear it's not a problem with bsdiff :-P",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1396,2020-03-25T19:03:51Z,2020-03-27T01:57:22Z,2020-04-03T19:33:34Z,MERGED,True,123,7,3,https://github.com/otaviobp,delta: Don't retry to use manifest deltas,1,[],https://github.com/clearlinux/swupd-client/pull/1396,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1396#issuecomment-604575973,"When a manifest delta was incorrect, the full manifest was used. But in the
case of a correct delta that produces an invalid manifest, swupd was never
trying to download the full manifest.
Changing code to try to use deltas only once. On first error, always retry
downloading the full manifest.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",v2: Updated comments and using -V on tests,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1397,2020-03-25T20:11:22Z,2020-03-25T20:31:26Z,2020-03-25T20:31:30Z,MERGED,True,2,2,1,https://github.com/castulo,"Tests: Fix path with extra ""/"" in tests",1,[],https://github.com/clearlinux/swupd-client/pull/1397,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1397,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1400,2020-03-26T17:41:48Z,2020-04-01T15:38:16Z,2020-04-03T19:33:20Z,MERGED,True,369,35,23,https://github.com/otaviobp,Accept expired signatures for latest file,4,[],https://github.com/clearlinux/swupd-client/pull/1400,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1400,"It is considered safe to accept expired signatures to validate the latest
file because we are always checking again the signature of the MoM file.

Adding tests to validate that:
 - Expired signatures for latest file works
 - Expired signatures for MoM fails even when latest signature is correct","It is considered safe to accept expired signatures to validate the latest
file because we are always checking again the signature of the MoM file.

Adding tests to validate that:
 - Expired signatures for latest file works
 - Expired signatures for MoM fails even when latest signature is correct",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1401,2020-03-26T19:32:34Z,2020-03-26T22:49:13Z,2020-03-26T22:49:13Z,CLOSED,False,0,0,0,https://github.com/otaviobp,actions: Only run shellcheck-all on pushes to master branch,0,[],https://github.com/clearlinux/swupd-client/pull/1401,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1401,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1402,2020-03-26T20:36:07Z,2020-03-26T22:44:06Z,2020-04-03T19:33:35Z,MERGED,True,37,27,6,https://github.com/otaviobp,Actions: Some improvements in github actions,4,[],https://github.com/clearlinux/swupd-client/pull/1402,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1402,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1403,2020-03-27T02:02:57Z,2020-03-27T16:38:56Z,2020-04-03T19:33:33Z,MERGED,True,2,1,1,https://github.com/otaviobp,README: Update badge to use information from github actions,1,[],https://github.com/clearlinux/swupd-client/pull/1403,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1403,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1404,2020-03-27T02:11:48Z,2020-03-27T22:34:42Z,2020-04-03T19:33:31Z,MERGED,True,164,15,4,https://github.com/otaviobp,actions: cache dependencies for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/1404,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1404,"Some packages we need to build swupd are not available on ubunutu-latest
so we need to download and build from source. This process is slow and
caching can save us some significant time on build.","Some packages we need to build swupd are not available on ubunutu-latest
so we need to download and build from source. This process is slow and
caching can save us some significant time on build.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1404,2020-03-27T02:11:48Z,2020-03-27T22:34:42Z,2020-04-03T19:33:31Z,MERGED,True,164,15,4,https://github.com/otaviobp,actions: cache dependencies for swupd,1,[],https://github.com/clearlinux/swupd-client/pull/1404,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1404#issuecomment-605288904,"Some packages we need to build swupd are not available on ubunutu-latest
so we need to download and build from source. This process is slow and
caching can save us some significant time on build.","v2: Added "" around variable",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1405,2020-03-27T16:36:18Z,2020-03-27T17:00:09Z,2020-03-27T17:19:43Z,MERGED,True,3,7,2,https://github.com/castulo,Bug_fix: Fixing memory leaks,1,[],https://github.com/clearlinux/swupd-client/pull/1405,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1405,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1406,2020-03-27T17:19:28Z,2020-03-30T20:39:05Z,2020-03-30T20:45:47Z,MERGED,True,45,9,6,https://github.com/castulo,Remove extra slash from paths,1,[],https://github.com/clearlinux/swupd-client/pull/1406,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1406,"This commit removes the extra slash '/' from the path from:

the update_boot function
the verifytime script

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit removes the extra slash '/' from the path from:

the update_boot function
the verifytime script

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1406,2020-03-27T17:19:28Z,2020-03-30T20:39:05Z,2020-03-30T20:45:47Z,MERGED,True,45,9,6,https://github.com/castulo,Remove extra slash from paths,1,[],https://github.com/clearlinux/swupd-client/pull/1406,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1406#issuecomment-606138415,"This commit removes the extra slash '/' from the path from:

the update_boot function
the verifytime script

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

copied sys_path_join() to verifytime.c to fix the path of he versionstamp file.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1406,2020-03-27T17:19:28Z,2020-03-30T20:39:05Z,2020-03-30T20:45:47Z,MERGED,True,45,9,6,https://github.com/castulo,Remove extra slash from paths,1,[],https://github.com/clearlinux/swupd-client/pull/1406,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1406#issuecomment-606233601,"This commit removes the extra slash '/' from the path from:

the update_boot function
the verifytime script

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3:

defining PATH_SEPARATOR in verifytime.c
added comment showing the path_join() is a copy of sys_path_join()",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1407,2020-03-27T19:16:09Z,2020-03-27T19:53:12Z,2020-04-03T19:33:32Z,MERGED,True,1,1,1,https://github.com/otaviobp,tests: Fix shellcheck-all reported problem,1,[],https://github.com/clearlinux/swupd-client/pull/1407,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1407,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1408,2020-03-30T16:55:21Z,2020-04-02T17:11:11Z,2020-04-02T17:11:11Z,MERGED,True,415,18,7,https://github.com/castulo,Bug_fix: Do not follow symlinks when removing files during staging or update can end up removing incorrect files,2,[],https://github.com/clearlinux/swupd-client/pull/1408,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1408,"When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.","When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1408,2020-03-30T16:55:21Z,2020-04-02T17:11:11Z,2020-04-02T17:11:11Z,MERGED,True,415,18,7,https://github.com/castulo,Bug_fix: Do not follow symlinks when removing files during staging or update can end up removing incorrect files,2,[],https://github.com/clearlinux/swupd-client/pull/1408,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1408#issuecomment-606129524,"When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.","Also this fix is independent from PR #1380, so you don't need to carry all it's commits

The problem is that the tests for this fix do need PR #1380",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1408,2020-03-30T16:55:21Z,2020-04-02T17:11:11Z,2020-04-02T17:11:11Z,MERGED,True,415,18,7,https://github.com/castulo,Bug_fix: Do not follow symlinks when removing files during staging or update can end up removing incorrect files,2,[],https://github.com/clearlinux/swupd-client/pull/1408,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1408#issuecomment-606277270,"When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.","V2:

Changed the name of the function to sys_path_is_absolute()
Fixed an error in the code caused by having an extra ""/"" in the path",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1408,2020-03-30T16:55:21Z,2020-04-02T17:11:11Z,2020-04-02T17:11:11Z,MERGED,True,415,18,7,https://github.com/castulo,Bug_fix: Do not follow symlinks when removing files during staging or update can end up removing incorrect files,2,[],https://github.com/clearlinux/swupd-client/pull/1408,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1408#issuecomment-607498644,"When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.",Can you rebase this?,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1408,2020-03-30T16:55:21Z,2020-04-02T17:11:11Z,2020-04-02T17:11:11Z,MERGED,True,415,18,7,https://github.com/castulo,Bug_fix: Do not follow symlinks when removing files during staging or update can end up removing incorrect files,2,[],https://github.com/clearlinux/swupd-client/pull/1408,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1408#issuecomment-607532412,"When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1408,2020-03-30T16:55:21Z,2020-04-02T17:11:11Z,2020-04-02T17:11:11Z,MERGED,True,415,18,7,https://github.com/castulo,Bug_fix: Do not follow symlinks when removing files during staging or update can end up removing incorrect files,2,[],https://github.com/clearlinux/swupd-client/pull/1408,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1408#issuecomment-607927758,"When during an update a directory was removed and replaced by a symlink to another directory that contains one or more files with the same name  as files in the directory that was removed, swupd will remove the directory from the target system and then it will try to remove each one     of the files that were contained in the directory. Since the directory is now a symlink to another existing directory, it may end up deleting the files from the other directory. swupd should not follow links when removing files during the staging process.
Closes #890
Note: for the tests in this PR to work #1380 needs to be reviewed and merged first.",Rebased again,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1409,2020-03-30T19:19:27Z,2020-03-30T20:59:45Z,2020-04-03T19:33:17Z,MERGED,True,17,4,4,https://github.com/otaviobp,swupd_init: Make sure swupd is always runnin in an existing path,1,[],https://github.com/clearlinux/swupd-client/pull/1409,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1409,"If the path where swupd is running is removed getcwd errors will occurs, mostly
because of multiple commands swupd executes. So move to directory ""/"", no mather
where swupd is going to be installed, to make sure the path is always existent.
Fixes #1078
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If the path where swupd is running is removed getcwd errors will occurs, mostly
because of multiple commands swupd executes. So move to directory ""/"", no mather
where swupd is going to be installed, to make sure the path is always existent.
Fixes #1078
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{'THUMBS_UP': ['https://github.com/xRiot']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1410,2020-03-30T20:39:02Z,2020-03-30T22:05:45Z,2020-03-30T22:06:47Z,MERGED,True,2,3,1,https://github.com/castulo,Correct the comment from sys_path_join(),1,[],https://github.com/clearlinux/swupd-client/pull/1410,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1410,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1412,2020-03-31T15:37:54Z,2020-03-31T21:41:13Z,2020-04-03T19:33:19Z,MERGED,True,17,6,2,https://github.com/otaviobp,3rd-party: Add 3rd-party share directories to XDG dirs,1,[],https://github.com/clearlinux/swupd-client/pull/1412,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1412,"When creating a wrapper for 3rd-party binaries, append relative
/usr/share and /usr/local/share to XDG_DATA_DIRS variable and /etc
to XDG_CONF_DIRS.
Fix #1411
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When creating a wrapper for 3rd-party binaries, append relative
/usr/share and /usr/local/share to XDG_DATA_DIRS variable and /etc
to XDG_CONF_DIRS.
Fix #1411
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1414,2020-03-31T19:06:26Z,2020-04-01T21:37:51Z,2020-04-01T23:01:42Z,MERGED,True,167,49,9,https://github.com/castulo,3rd-party: regenerate the wrapper script if a binary changes during an update,2,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1414,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1414,"When updating a 3rd-party bundle, if any of its binaries is modified,
or the binary is new swupd needs to recreate the wrapper script.
During a 3rd-party repair, the wrapper scripts of all binaries verified
should be regenerated regardless of if the binary was repaired or not.
Related to #1413
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When updating a 3rd-party bundle, if any of its binaries is modified,
or the binary is new swupd needs to recreate the wrapper script.
During a 3rd-party repair, the wrapper scripts of all binaries verified
should be regenerated regardless of if the binary was repaired or not.
Related to #1413
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1416,2020-04-01T17:40:35Z,2020-04-02T17:35:56Z,2020-04-03T19:33:13Z,MERGED,True,33,82,6,https://github.com/otaviobp,testlib: Generate swupd certificates for each test to be execute,2,[],https://github.com/clearlinux/swupd-client/pull/1416,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1416,"Instead of requiring an external script (.prereq) to generate the certificates
we can regenerate them before running each test.
Also removes completly the .prereq script","Instead of requiring an external script (.prereq) to generate the certificates
we can regenerate them before running each test.
Also removes completly the .prereq script",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1417,2020-04-01T21:41:08Z,2020-04-02T19:17:56Z,2020-04-03T19:33:14Z,MERGED,True,144,112,25,https://github.com/otaviobp,Strings: some improvements in string usage on swupd,7,[],https://github.com/clearlinux/swupd-client/pull/1417,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1417,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1417,2020-04-01T21:41:08Z,2020-04-02T19:17:56Z,2020-04-03T19:33:14Z,MERGED,True,144,112,25,https://github.com/otaviobp,Strings: some improvements in string usage on swupd,7,[],https://github.com/clearlinux/swupd-client/pull/1417,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1417#issuecomment-607972292,,V2: Removing 'a' and fixing strlen comment,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1418,2020-04-02T00:06:40Z,2020-04-02T15:00:31Z,2020-04-02T15:46:05Z,MERGED,True,5,3,1,https://github.com/castulo,Testlib: keep the current status on type change,1,[],https://github.com/clearlinux/swupd-client/pull/1418,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1418,"When updating a bundle using testlib, if the file is updated, and the
update includes a file type change, testlib was updating the manifest
with the correct type but was overwriting the other status flags, so if
a file was marked as 'x' (exported) before, that flag was being removed.
This commit fixes the issue by only updating the flag that relates to
the file type.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When updating a bundle using testlib, if the file is updated, and the
update includes a file type change, testlib was updating the manifest
with the correct type but was overwriting the other status flags, so if
a file was marked as 'x' (exported) before, that flag was being removed.
This commit fixes the issue by only updating the flag that relates to
the file type.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1422,2020-04-02T18:53:57Z,2020-04-02T19:17:38Z,2020-04-03T00:04:00Z,MERGED,True,1,0,1,https://github.com/castulo,Fix memory leak during do_staging(),1,[],https://github.com/clearlinux/swupd-client/pull/1422,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1422,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1423,2020-04-03T00:09:52Z,2020-04-03T15:09:05Z,2020-04-03T17:10:08Z,MERGED,True,3,3,1,https://github.com/castulo,Testlib: do not print the result of openssl,1,[],https://github.com/clearlinux/swupd-client/pull/1423,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1423,"When generating the certificate for tests, openssl is printing messages
to the terminal, we are already selecting what to print by using the
debug_msg() function, so these unwanted messages shouldnot be printed.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When generating the certificate for tests, openssl is printing messages
to the terminal, we are already selecting what to print by using the
debug_msg() function, so these unwanted messages shouldnot be printed.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1426,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413","When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1426#issuecomment-611159519,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413",V2: comments from review were addressed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/bryteise,3,https://github.com/clearlinux/swupd-client/pull/1426#issuecomment-611166221,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413",LGTM,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1426#issuecomment-611203907,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413",It's worth adding a test to check if the template was update correctly too. There's one test generating an incorrect template/,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1426#issuecomment-611773338,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413",V3: addressed all new comments in the review.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/castulo,6,https://github.com/clearlinux/swupd-client/pull/1426#issuecomment-612135282,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413","V4, rebased and addressed new issues:

used strncmp to compare the template
returning NULL when sys_mmap_file encounter errors",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1426,2020-04-03T22:44:04Z,2020-04-10T18:08:17Z,2020-04-10T18:08:21Z,MERGED,True,701,88,14,https://github.com/castulo,3rd-party: Regenerate wrapper on template change,3,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1426,https://github.com/castulo,7,https://github.com/clearlinux/swupd-client/pull/1426#issuecomment-612136761,"When the template used for creating the wrapper scripts changes, all
exported binaries should have the scripts regenerated during updates
regardless of if the binary changed.
Closes #1413","looks good now :)

thanks for the reviews, you caught many things I overlooked ",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1427,2020-04-04T02:37:27Z,2020-04-06T21:45:34Z,2020-04-06T21:55:52Z,MERGED,True,4,1,1,https://github.com/castulo,"Bug_fix: Check if directory is absolute, not file",1,[],https://github.com/clearlinux/swupd-client/pull/1427,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1427,"During staging, if a file is marked for deletion, and the path to
the file, or the file istelf is a simlink, then it is not removed. This
is incorrect, if the file itself is a symlink it is fine to remove it,
the only case when it should not be removed is when the path to it
contain a symlink.
Closes #1424
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","During staging, if a file is marked for deletion, and the path to
the file, or the file istelf is a simlink, then it is not removed. This
is incorrect, if the file itself is a symlink it is fine to remove it,
the only case when it should not be removed is when the path to it
contain a symlink.
Closes #1424
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1429,2020-04-06T16:06:41Z,2020-04-07T20:52:50Z,2020-04-27T16:08:59Z,MERGED,True,32,634,48,https://github.com/otaviobp,Changing the way we create and destroy environments,2,[],https://github.com/clearlinux/swupd-client/pull/1429,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1429,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1429,2020-04-06T16:06:41Z,2020-04-07T20:52:50Z,2020-04-27T16:08:59Z,MERGED,True,32,634,48,https://github.com/otaviobp,Changing the way we create and destroy environments,2,[],https://github.com/clearlinux/swupd-client/pull/1429,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1429#issuecomment-610522415,,V2: Rebasing and fixing comment.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1430,2020-04-06T16:44:37Z,2020-04-10T16:58:47Z,2020-04-10T16:58:47Z,MERGED,True,173,102,2,https://github.com/otaviobp,actions: Validate if all tests are going to be executed,1,[],https://github.com/clearlinux/swupd-client/pull/1430,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1430,"Validate if we are really calling make check for all tests in
test/functional directory.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Validate if we are really calling make check for all tests in
test/functional directory.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1430,2020-04-06T16:44:37Z,2020-04-10T16:58:47Z,2020-04-10T16:58:47Z,MERGED,True,173,102,2,https://github.com/otaviobp,actions: Validate if all tests are going to be executed,1,[],https://github.com/clearlinux/swupd-client/pull/1430,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1430#issuecomment-612072365,"Validate if we are really calling make check for all tests in
test/functional directory.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",V2: Rebased and removing tarball added by accident,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1431,2020-04-06T19:48:14Z,2020-04-08T22:02:41Z,2020-04-08T22:27:47Z,MERGED,True,81,4,6,https://github.com/castulo,API: output for [3rd-party] info,1,[],https://github.com/clearlinux/swupd-client/pull/1431,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1431,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd info
swupd 3rd-party info

Related to #1393
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd info
swupd 3rd-party info

Related to #1393
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1432,2020-04-06T21:04:53Z,2020-04-06T21:57:19Z,2020-04-06T21:57:19Z,MERGED,True,4,4,1,https://github.com/otaviobp,mirror: Warning message should be printed only when theres' no defaul,1,[],https://github.com/clearlinux/swupd-client/pull/1432,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1432,"t url
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","t url
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1433,2020-04-07T17:54:29Z,2020-04-08T16:03:57Z,2020-04-27T16:08:59Z,MERGED,True,62,470,26,https://github.com/otaviobp,Mixin: Remove mixin from swupd,5,[],https://github.com/clearlinux/swupd-client/pull/1433,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1433,Fixes #1392,Fixes #1392,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1433,2020-04-07T17:54:29Z,2020-04-08T16:03:57Z,2020-04-27T16:08:59Z,MERGED,True,62,470,26,https://github.com/otaviobp,Mixin: Remove mixin from swupd,5,[],https://github.com/clearlinux/swupd-client/pull/1433,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1433#issuecomment-610615559,Fixes #1392,V2: Fixing typo,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1434,2020-04-07T18:04:27Z,2020-04-07T20:53:42Z,2020-04-07T20:53:42Z,CLOSED,False,6,0,2,https://github.com/castulo,Showing status after enabling/disabling autoupdate,1,[],https://github.com/clearlinux/swupd-client/pull/1434,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1434,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1434,2020-04-07T18:04:27Z,2020-04-07T20:53:42Z,2020-04-07T20:53:42Z,CLOSED,False,6,0,2,https://github.com/castulo,Showing status after enabling/disabling autoupdate,1,[],https://github.com/clearlinux/swupd-client/pull/1434,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1434#issuecomment-610614913,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Canceling this PR until we come up with a better solution,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1435,2020-04-08T15:41:44Z,2020-04-10T15:11:20Z,2020-04-27T16:08:57Z,MERGED,True,7,4,2,https://github.com/otaviobp,Improvements in build and test script,3,[],https://github.com/clearlinux/swupd-client/pull/1435,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1435,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1436,2020-04-08T20:31:45Z,2020-04-08T22:47:32Z,2020-04-08T22:47:35Z,MERGED,True,62,2,3,https://github.com/castulo,API: output for autoupdate,1,[],https://github.com/clearlinux/swupd-client/pull/1436,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1436,"This commit provides a minimal output to be displayed when the --quiet
flag is used for this command:

swupd autoupdate

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for this command:

swupd autoupdate

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1437,2020-04-08T20:48:39Z,2020-04-08T21:19:53Z,2020-04-08T21:19:54Z,MERGED,True,2,1,1,https://github.com/otaviobp,sys: Also remove trailing separators in sys_path_join(),1,[],https://github.com/clearlinux/swupd-client/pull/1437,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1437,"Always remove the last slash of a path when using sys_path_join().
This is needed because some functions compare different paths and the
trailing slash will lead to incorrect results.
For example:
- sys_path_is_absolute(sys_path_join(""/usr/"")) returns false.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Always remove the last slash of a path when using sys_path_join().
This is needed because some functions compare different paths and the
trailing slash will lead to incorrect results.
For example:
- sys_path_is_absolute(sys_path_join(""/usr/"")) returns false.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1438,2020-04-08T21:57:23Z,2020-04-09T16:56:18Z,2020-04-09T17:15:29Z,MERGED,True,114,5,7,https://github.com/castulo,API: output for [3rd-party] check-update,1,[],https://github.com/clearlinux/swupd-client/pull/1438,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1438,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd check-update
swupd 3rd-party check-update

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd check-update
swupd 3rd-party check-update

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1438,2020-04-08T21:57:23Z,2020-04-09T16:56:18Z,2020-04-09T17:15:29Z,MERGED,True,114,5,7,https://github.com/castulo,API: output for [3rd-party] check-update,1,[],https://github.com/clearlinux/swupd-client/pull/1438,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1438#issuecomment-611239870,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd check-update
swupd 3rd-party check-update

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2: addressed all the comments except the one regarding removing the [repo_name] from the repo that did not have output. As I said, I think this is a limitation, it would look better if we didn't print the repos that don't have output, but I don't think it can be done without having to do a big refactoring, and IMO is not worth it.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1439,2020-04-08T21:59:30Z,2020-04-10T16:59:23Z,2020-04-27T16:08:54Z,MERGED,True,309,237,11,https://github.com/otaviobp,Staging: Some improvements and reorganization of the staging module,7,[],https://github.com/clearlinux/swupd-client/pull/1439,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1439,"File installation and removal from system was spread in different parts of swupd. Grouping everything one module to make it easier to maintain.
I renamed this module from staging to system_root because all operations are relative to installing/removing files from the clear system installed. Let me know if you find this name confusing or if you have any other suggestion.","File installation and removal from system was spread in different parts of swupd. Grouping everything one module to make it easier to maintain.
I renamed this module from staging to system_root because all operations are relative to installing/removing files from the clear system installed. Let me know if you find this name confusing or if you have any other suggestion.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1439,2020-04-08T21:59:30Z,2020-04-10T16:59:23Z,2020-04-27T16:08:54Z,MERGED,True,309,237,11,https://github.com/otaviobp,Staging: Some improvements and reorganization of the staging module,7,[],https://github.com/clearlinux/swupd-client/pull/1439,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1439#issuecomment-612102361,"File installation and removal from system was spread in different parts of swupd. Grouping everything one module to make it easier to maintain.
I renamed this module from staging to system_root because all operations are relative to installing/removing files from the clear system installed. Let me know if you find this name confusing or if you have any other suggestion.","V3:

Using target_root instead of system_root as suggested.
Don't print warnings to user that doesn't make sense
Use sys_path_join() in more places
Handle return code on function",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1439,2020-04-08T21:59:30Z,2020-04-10T16:59:23Z,2020-04-27T16:08:54Z,MERGED,True,309,237,11,https://github.com/otaviobp,Staging: Some improvements and reorganization of the staging module,7,[],https://github.com/clearlinux/swupd-client/pull/1439,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1439#issuecomment-612107724,"File installation and removal from system was spread in different parts of swupd. Grouping everything one module to make it easier to maintain.
I renamed this module from staging to system_root because all operations are relative to installing/removing files from the clear system installed. Let me know if you find this name confusing or if you have any other suggestion.",V4: REmove rel_dir completly,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1440,2020-04-08T22:15:09Z,2020-04-10T15:10:57Z,2020-04-10T15:10:57Z,MERGED,True,2,2,2,https://github.com/otaviobp,Sys: copy should preserve symlinks and permissions,2,[],https://github.com/clearlinux/swupd-client/pull/1440,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1440,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1441,2020-04-09T15:41:06Z,2020-04-09T16:29:09Z,2020-04-27T16:08:56Z,MERGED,True,3,0,1,https://github.com/otaviobp,mirror: path_prefix is not processed before trying to set the mirror,1,[],https://github.com/clearlinux/swupd-client/pull/1441,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1441,"We need to call globals_init (called by swupd_init) before calling any
function that uses path_prefix.
mirror --set using the default path is failing.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We need to call globals_init (called by swupd_init) before calling any
function that uses path_prefix.
mirror --set using the default path is failing.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1442,2020-04-09T18:05:01Z,2020-04-09T20:45:50Z,2020-04-27T16:08:55Z,MERGED,True,7,9,3,https://github.com/otaviobp,signature: Use void pointer to store pointers to bytes in memory,1,[],https://github.com/clearlinux/swupd-client/pull/1442,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1442,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1444,2020-04-10T16:40:31Z,2020-04-10T17:15:28Z,2020-04-10T17:15:31Z,MERGED,True,89,3,3,https://github.com/castulo,API: output for [3rd-party] update,1,[],https://github.com/clearlinux/swupd-client/pull/1444,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1444,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd update
swupd 3rd-party update

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd update
swupd 3rd-party update

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1445,2020-04-10T17:14:38Z,2020-04-10T23:44:36Z,2020-04-10T23:44:40Z,MERGED,True,62,5,3,https://github.com/castulo,API: output for [3rd-party] bundle-add,1,[],https://github.com/clearlinux/swupd-client/pull/1445,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1445,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-add
swupd 3rd-party bundle-add

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-add
swupd 3rd-party bundle-add

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1446,2020-04-10T17:14:52Z,2020-04-10T23:01:12Z,2020-04-10T23:10:18Z,MERGED,True,1,1,1,https://github.com/castulo,Testlib: fix help menu from function,1,[],https://github.com/clearlinux/swupd-client/pull/1446,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1446,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1447,2020-04-10T17:50:37Z,2020-04-10T22:22:00Z,2020-04-10T22:33:11Z,MERGED,True,59,4,3,https://github.com/castulo,API: output for [3rd-party] bundle-remove,1,[],https://github.com/clearlinux/swupd-client/pull/1447,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1447,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-remove
swupd 3rd-party bundle-remove

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-remove
swupd 3rd-party bundle-remove

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1448,2020-04-10T21:36:06Z,2020-04-13T18:18:32Z,2020-04-27T16:08:45Z,MERGED,True,23,2,4,https://github.com/otaviobp,Suggestion WIP: Create UNEXPECTED() macro,2,[],https://github.com/clearlinux/swupd-client/pull/1448,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1448,"There are several points in swupd that we find conditions that should never
happen, but we try to correct them anyway to be more reliable. Because of that
we may hide programming mistakes that are corrected later.

So, to make sure we are going to catch those problems in debug mode in our development
machines and test environment, I am suggesting a UNEXPECTED() macro that aborts swupd
if --enable-debug was used to build swupd.

I am adding some examples on what we could do with that.

What are your opinions about that?","There are several points in swupd that we find conditions that should never
happen, but we try to correct them anyway to be more reliable. Because of that
we may hide programming mistakes that are corrected later.

So, to make sure we are going to catch those problems in debug mode in our development
machines and test environment, I am suggesting a UNEXPECTED() macro that aborts swupd
if --enable-debug was used to build swupd.

I am adding some examples on what we could do with that.

What are your opinions about that?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1448,2020-04-10T21:36:06Z,2020-04-13T18:18:32Z,2020-04-27T16:08:45Z,MERGED,True,23,2,4,https://github.com/otaviobp,Suggestion WIP: Create UNEXPECTED() macro,2,[],https://github.com/clearlinux/swupd-client/pull/1448,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1448#issuecomment-612231113,"There are several points in swupd that we find conditions that should never
happen, but we try to correct them anyway to be more reliable. Because of that
we may hide programming mistakes that are corrected later.

So, to make sure we are going to catch those problems in debug mode in our development
machines and test environment, I am suggesting a UNEXPECTED() macro that aborts swupd
if --enable-debug was used to build swupd.

I am adding some examples on what we could do with that.

What are your opinions about that?",Looks good to me =).,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1448,2020-04-10T21:36:06Z,2020-04-13T18:18:32Z,2020-04-27T16:08:45Z,MERGED,True,23,2,4,https://github.com/otaviobp,Suggestion WIP: Create UNEXPECTED() macro,2,[],https://github.com/clearlinux/swupd-client/pull/1448,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1448#issuecomment-612256847,"There are several points in swupd that we find conditions that should never
happen, but we try to correct them anyway to be more reliable. Because of that
we may hide programming mistakes that are corrected later.

So, to make sure we are going to catch those problems in debug mode in our development
machines and test environment, I am suggesting a UNEXPECTED() macro that aborts swupd
if --enable-debug was used to build swupd.

I am adding some examples on what we could do with that.

What are your opinions about that?",I am going to fix comments then before merging,True,{'THUMBS_UP': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1449,2020-04-10T22:36:20Z,2020-04-13T17:16:19Z,2020-04-13T18:41:16Z,MERGED,True,71,35,13,https://github.com/castulo,Testlib: including os-core in test bundles,1,['testing'],https://github.com/clearlinux/swupd-client/pull/1449,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1449,"When creating test bundles, we are not including os-core in them by
default. This is how it works in production so we should do it so it
resembles the real production environment more accurately.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When creating test bundles, we are not including os-core in them by
default. This is how it works in production so we should do it so it
resembles the real production environment more accurately.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1450,2020-04-10T23:50:01Z,2020-04-13T17:17:25Z,2020-04-13T18:41:07Z,MERGED,True,4,5,3,https://github.com/castulo,Show status for all bundles with --status,1,[],https://github.com/clearlinux/swupd-client/pull/1450,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1450,"When listing bundles using ""swupd bundle-list --status"" we were
distinguishing bundles that were explicitly installed, by marking them
as such and since bundle-list shows only bundles tha are installed, bundles
that were not marked as explicitelly installed were assumed to be
just installed.
When we use ""bundle-list --all --status"" (which shows installed and
uninstalled bundles), we were marking files as ""installed"", ""explicitly
installed"" and bundles without any of these distinctions were assumed to
be not installed. This could cause confusion.
This PR changes the ""bundle-list --status"" so we always label bundles
as either ""implicitly installed"" or ""installed"" (even though it couls
sound a little redundant) so it is consistent with the way they are
labeled during ""bundle-list --all --status"".
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When listing bundles using ""swupd bundle-list --status"" we were
distinguishing bundles that were explicitly installed, by marking them
as such and since bundle-list shows only bundles tha are installed, bundles
that were not marked as explicitelly installed were assumed to be
just installed.
When we use ""bundle-list --all --status"" (which shows installed and
uninstalled bundles), we were marking files as ""installed"", ""explicitly
installed"" and bundles without any of these distinctions were assumed to
be not installed. This could cause confusion.
This PR changes the ""bundle-list --status"" so we always label bundles
as either ""implicitly installed"" or ""installed"" (even though it couls
sound a little redundant) so it is consistent with the way they are
labeled during ""bundle-list --all --status"".
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1451,2020-04-13T18:45:29Z,2020-04-13T22:29:47Z,2020-04-13T22:46:24Z,MERGED,True,1,1,1,https://github.com/castulo,Testlib: fix bug regenerating hashes in MoM,1,['testing'],https://github.com/clearlinux/swupd-client/pull/1451,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1451,"When a MoM contains an experimental bundle and the hashes in the MoM are
regenerated, the experimental bundles are being skipped. This commit
fixes that issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When a MoM contains an experimental bundle and the hashes in the MoM are
regenerated, the experimental bundles are being skipped. This commit
fixes that issue.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1452,2020-04-13T22:01:34Z,2020-04-14T15:56:01Z,2020-04-14T16:07:53Z,MERGED,True,269,15,5,https://github.com/castulo,API: output for [3rd-party] bundle-list,1,[],https://github.com/clearlinux/swupd-client/pull/1452,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1452,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-list
swupd 3rd-party bundle-list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-list
swupd 3rd-party bundle-list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1453,2020-04-14T16:52:13Z,2020-04-15T15:47:58Z,2020-04-15T16:18:35Z,MERGED,True,294,3,4,https://github.com/castulo,API: output for [3rd-party] bundle-info,1,[],https://github.com/clearlinux/swupd-client/pull/1453,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1453,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-info
swupd 3rd-party bundle-info

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd bundle-info
swupd 3rd-party bundle-info

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1454,2020-04-14T17:41:34Z,2020-04-15T22:35:02Z,2020-04-15T22:35:05Z,MERGED,True,79,9,2,https://github.com/castulo,API: output for search-file,1,[],https://github.com/clearlinux/swupd-client/pull/1454,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1454,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd search-file

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd search-file

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1455,2020-04-14T19:33:25Z,2020-04-15T23:15:29Z,2020-04-15T23:15:32Z,MERGED,True,137,8,6,https://github.com/castulo,API: output for [3rd-party] diagnose,1,[],https://github.com/clearlinux/swupd-client/pull/1455,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1455,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd diagnose
swupd 3rd-party diagnose

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd diagnose
swupd 3rd-party diagnose

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1456,2020-04-15T18:54:06Z,2020-04-16T15:52:05Z,2020-04-16T15:52:05Z,MERGED,True,84,83,6,https://github.com/otaviobp,Sys: reorganizing some functions,3,[],https://github.com/clearlinux/swupd-client/pull/1456,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1456,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1457,2020-04-15T21:19:18Z,2020-04-17T22:20:11Z,2020-04-17T22:20:12Z,MERGED,True,276,127,5,https://github.com/otaviobp,Target root: Change the way we install directories and files,8,[],https://github.com/clearlinux/swupd-client/pull/1457,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1457,"Currently we install directories and files using a tar command piped to another tar command.
There are multiple problems related to that, like:

performance
dependency on tar binary
lack support on unusual characters on filenames

This pull request changes the way we install directories by creating them with mkdir and updating all attributes that we control on swupd, update directories by update all attributes and install files by using the cp binary, when link is not supported.
In some preliminary tests we got a nice improvement in installation speed, around 60~70% faster on big bundles, like desktop and os-clr-on-clr.
Related to #671 and  #640. Almost fixed and shouldn't be a problem anymore, but there are still changes required on install_dir_using_tar() and install_file_using_tar()","Currently we install directories and files using a tar command piped to another tar command.
There are multiple problems related to that, like:

performance
dependency on tar binary
lack support on unusual characters on filenames

This pull request changes the way we install directories by creating them with mkdir and updating all attributes that we control on swupd, update directories by update all attributes and install files by using the cp binary, when link is not supported.
In some preliminary tests we got a nice improvement in installation speed, around 60~70% faster on big bundles, like desktop and os-clr-on-clr.
Related to #671 and  #640. Almost fixed and shouldn't be a problem anymore, but there are still changes required on install_dir_using_tar() and install_file_using_tar()",True,"{'THUMBS_UP': ['https://github.com/phmccarty'], 'HOORAY': ['https://github.com/phmccarty', 'https://github.com/castulo']}"
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1457,2020-04-15T21:19:18Z,2020-04-17T22:20:11Z,2020-04-17T22:20:12Z,MERGED,True,276,127,5,https://github.com/otaviobp,Target root: Change the way we install directories and files,8,[],https://github.com/clearlinux/swupd-client/pull/1457,https://github.com/bryteise,2,https://github.com/clearlinux/swupd-client/pull/1457#issuecomment-614292538,"Currently we install directories and files using a tar command piped to another tar command.
There are multiple problems related to that, like:

performance
dependency on tar binary
lack support on unusual characters on filenames

This pull request changes the way we install directories by creating them with mkdir and updating all attributes that we control on swupd, update directories by update all attributes and install files by using the cp binary, when link is not supported.
In some preliminary tests we got a nice improvement in installation speed, around 60~70% faster on big bundles, like desktop and os-clr-on-clr.
Related to #671 and  #640. Almost fixed and shouldn't be a problem anymore, but there are still changes required on install_dir_using_tar() and install_file_using_tar()",I really like the direction of these changes!,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1457,2020-04-15T21:19:18Z,2020-04-17T22:20:11Z,2020-04-17T22:20:12Z,MERGED,True,276,127,5,https://github.com/otaviobp,Target root: Change the way we install directories and files,8,[],https://github.com/clearlinux/swupd-client/pull/1457,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1457#issuecomment-614806941,"Currently we install directories and files using a tar command piped to another tar command.
There are multiple problems related to that, like:

performance
dependency on tar binary
lack support on unusual characters on filenames

This pull request changes the way we install directories by creating them with mkdir and updating all attributes that we control on swupd, update directories by update all attributes and install files by using the cp binary, when link is not supported.
In some preliminary tests we got a nice improvement in installation speed, around 60~70% faster on big bundles, like desktop and os-clr-on-clr.
Related to #671 and  #640. Almost fixed and shouldn't be a problem anymore, but there are still changes required on install_dir_using_tar() and install_file_using_tar()",V2: Adding a test to validate if files with unusual filenames are successfully installed,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1458,2020-04-15T22:47:54Z,2020-04-16T20:52:30Z,2020-04-27T16:08:40Z,MERGED,True,112,2,2,https://github.com/otaviobp,Add test to check for file attributes changes on update,2,[],https://github.com/clearlinux/swupd-client/pull/1458,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1458,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1459,2020-04-16T17:02:05Z,2020-04-16T19:54:46Z,2020-04-16T19:54:52Z,MERGED,True,3,2,2,https://github.com/castulo,Fixing progress type on diagnosing extra files,1,[],https://github.com/clearlinux/swupd-client/pull/1459,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1459,"When dealing with extra files during a ""verify"" action, we cannot really
tell how far in the process we are, so we should be defining that step
as PROGRESS_UNDEFINED. Since we are using a PROGRESS_BAR, it is causing
to show an extra ""[100%]"" at the end of the diagnose process.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When dealing with extra files during a ""verify"" action, we cannot really
tell how far in the process we are, so we should be defining that step
as PROGRESS_UNDEFINED. Since we are using a PROGRESS_BAR, it is causing
to show an extra ""[100%]"" at the end of the diagnose process.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1460,2020-04-16T17:42:46Z,2020-04-16T20:25:05Z,2020-04-27T16:08:41Z,MERGED,True,3,3,3,https://github.com/otaviobp,3rd-party: xdg env variable has a wrong name,1,[],https://github.com/clearlinux/swupd-client/pull/1460,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1460,"XDG_CONFIG_DIRS variable was added with an incorrect name. XDG_CONF_DIRS was used instead.
Fixing that.
Fix #1443
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","XDG_CONFIG_DIRS variable was added with an incorrect name. XDG_CONF_DIRS was used instead.
Fixing that.
Fix #1443
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1461,2020-04-16T19:31:50Z,2020-04-17T17:37:27Z,2020-04-17T17:50:46Z,MERGED,True,324,56,11,https://github.com/castulo,API: output for [3rd-party] repair,1,[],https://github.com/clearlinux/swupd-client/pull/1461,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1461,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd repair
swupd 3rd-party repair","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd repair
swupd 3rd-party repair",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1462,2020-04-16T19:44:46Z,2020-04-17T17:39:27Z,2020-04-17T17:39:27Z,MERGED,True,348,58,12,https://github.com/castulo,API: output for os-install,2,[],https://github.com/clearlinux/swupd-client/pull/1462,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1462,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd os-install","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd os-install",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1465,2020-04-16T23:03:47Z,2020-04-17T18:43:33Z,2020-04-17T18:43:37Z,MERGED,True,120,7,4,https://github.com/castulo,API: output for [3rd-party] clean,1,[],https://github.com/clearlinux/swupd-client/pull/1465,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1465,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd clean
swupd 3rd-party clean

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd clean
swupd 3rd-party clean

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1465,2020-04-16T23:03:47Z,2020-04-17T18:43:33Z,2020-04-17T18:43:37Z,MERGED,True,120,7,4,https://github.com/castulo,API: output for [3rd-party] clean,1,[],https://github.com/clearlinux/swupd-client/pull/1465,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1465#issuecomment-615319118,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd clean
swupd 3rd-party clean

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","@otaviobp this PR should be good to be reviewed, again, the error shown is in the Tests IDs, they should be good once the other PRs opened with tests are merged and the code base is rebased.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1466,2020-04-17T15:58:33Z,2020-04-17T19:21:41Z,2020-04-17T19:21:45Z,MERGED,True,25,0,1,https://github.com/castulo,API: output for hashdump,1,[],https://github.com/clearlinux/swupd-client/pull/1466,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1466,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd hashdump

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd hashdump

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1467,2020-04-17T17:03:25Z,2020-04-20T16:51:24Z,2020-04-20T16:51:29Z,MERGED,True,171,12,8,https://github.com/castulo,"API: output for 3rd-party add, remove, list",1,[],https://github.com/clearlinux/swupd-client/pull/1467,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1467,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd 3rd-party add
swupd 3rd-party remove
swupd 3rd-party list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd 3rd-party add
swupd 3rd-party remove
swupd 3rd-party list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1467,2020-04-17T17:03:25Z,2020-04-20T16:51:24Z,2020-04-20T16:51:29Z,MERGED,True,171,12,8,https://github.com/castulo,"API: output for 3rd-party add, remove, list",1,[],https://github.com/clearlinux/swupd-client/pull/1467,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1467#issuecomment-615424661,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd 3rd-party add
swupd 3rd-party remove
swupd 3rd-party list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

The certificate was already being printed when --assume=yes was being used (as requested by @otaviobp )
Corrected a test that was wrong",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1467,2020-04-17T17:03:25Z,2020-04-20T16:51:24Z,2020-04-20T16:51:29Z,MERGED,True,171,12,8,https://github.com/castulo,"API: output for 3rd-party add, remove, list",1,[],https://github.com/clearlinux/swupd-client/pull/1467,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1467#issuecomment-615452786,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd 3rd-party add
swupd 3rd-party remove
swupd 3rd-party list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3:

Copying the certificate to the default location so we can use $SWUPD_OPTS_NO_CERT",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1467,2020-04-17T17:03:25Z,2020-04-20T16:51:24Z,2020-04-20T16:51:29Z,MERGED,True,171,12,8,https://github.com/castulo,"API: output for 3rd-party add, remove, list",1,[],https://github.com/clearlinux/swupd-client/pull/1467,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1467#issuecomment-616660838,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd 3rd-party add
swupd 3rd-party remove
swupd 3rd-party list

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V4:

Moved tests that should only run in CI to the functional/only_in_ci_system directory",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1468,2020-04-17T17:50:28Z,2020-04-20T17:52:15Z,2020-04-20T17:52:18Z,MERGED,True,72,3,2,https://github.com/castulo,API: output for mirror,1,[],https://github.com/clearlinux/swupd-client/pull/1468,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1468,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd mirror

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd mirror

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1468,2020-04-17T17:50:28Z,2020-04-20T17:52:15Z,2020-04-20T17:52:18Z,MERGED,True,72,3,2,https://github.com/castulo,API: output for mirror,1,[],https://github.com/clearlinux/swupd-client/pull/1468,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1468#issuecomment-615510622,"This commit provides a minimal output to be displayed when the --quiet
flag is used for these commands:

swupd mirror

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

using the log_is_quiet() function directly without storing the value in a variable",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1469,2020-04-17T18:09:19Z,2020-04-20T16:12:20Z,2020-04-27T16:08:25Z,MERGED,True,2,5,1,https://github.com/otaviobp,search_file: Don't store boolean just to be used in an if clause,1,[],https://github.com/clearlinux/swupd-client/pull/1469,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1469,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1470,2020-04-17T18:09:59Z,2020-04-17T23:36:07Z,2020-04-17T23:36:11Z,MERGED,True,5,2,2,https://github.com/castulo,swupd --quiet documentation update.,1,[],https://github.com/clearlinux/swupd-client/pull/1470,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1470,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1471,2020-04-17T22:27:02Z,2020-04-20T16:33:52Z,2020-04-27T16:08:15Z,MERGED,True,78,17,9,https://github.com/otaviobp,Telemetry: Some changes in the telemetry reports we create,5,[],https://github.com/clearlinux/swupd-client/pull/1471,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1471,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1471,2020-04-17T22:27:02Z,2020-04-20T16:33:52Z,2020-04-27T16:08:15Z,MERGED,True,78,17,9,https://github.com/otaviobp,Telemetry: Some changes in the telemetry reports we create,5,[],https://github.com/clearlinux/swupd-client/pull/1471,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1471#issuecomment-615493586,,"@mbelluzzo: following your suggestions and some other improvements.
@jurobystricky and @alexjch: This may interest you too. I am changing the severity of some telemetry records created by swupd, so if you are looking at some swupd records you may be affected by this PR.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1471,2020-04-17T22:27:02Z,2020-04-20T16:33:52Z,2020-04-27T16:08:15Z,MERGED,True,78,17,9,https://github.com/otaviobp,Telemetry: Some changes in the telemetry reports we create,5,[],https://github.com/clearlinux/swupd-client/pull/1471,https://github.com/alexjch,3,https://github.com/clearlinux/swupd-client/pull/1471#issuecomment-615890957,,"@otaviobp this is transparent to telemetry, the change is fine with me.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1475,2020-04-20T17:16:50Z,2020-04-22T16:38:00Z,2020-04-22T16:38:06Z,MERGED,True,78,5,7,https://github.com/castulo,Updating list to run clr-boot-manager,1,[],https://github.com/clearlinux/swupd-client/pull/1475,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1475,"This commit adds the following files to trigger the execution of
clr-boot-manager:

/usr/bin/clr-boot-manager
/usr/share/syslinux/ldlinux.c32

Closes #1415
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds the following files to trigger the execution of
clr-boot-manager:

/usr/bin/clr-boot-manager
/usr/share/syslinux/ldlinux.c32

Closes #1415
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1475,2020-04-20T17:16:50Z,2020-04-22T16:38:00Z,2020-04-22T16:38:06Z,MERGED,True,78,5,7,https://github.com/castulo,Updating list to run clr-boot-manager,1,[],https://github.com/clearlinux/swupd-client/pull/1475,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1475#issuecomment-617320820,"This commit adds the following files to trigger the execution of
clr-boot-manager:

/usr/bin/clr-boot-manager
/usr/share/syslinux/ldlinux.c32

Closes #1415
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

running clr-boot-manager when clr-boot-manager is updated but not marking it as is_boot.
Adding a test to make sure clr-boot-manager was updated and executed.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1476,2020-04-20T19:13:50Z,2020-04-22T17:12:13Z,2020-04-22T17:12:18Z,MERGED,True,17,0,3,https://github.com/castulo,3rd-party: do not report telemetry on 3rd-party,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1476,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1476,"Telemetry is used to report problems to main repository, so it doesn't
make sense to create telemetry report files for 3rd-party repositories.
Closes #1358
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Telemetry is used to report problems to main repository, so it doesn't
make sense to create telemetry report files for 3rd-party repositories.
Closes #1358
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1490,2020-04-21T16:26:29Z,2020-04-23T19:08:12Z,2020-04-27T16:05:30Z,MERGED,True,311,443,4,https://github.com/otaviobp,docs: Changes on man pages to make is similar to system man pages,1,[],https://github.com/clearlinux/swupd-client/pull/1490,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1490,"Using a man page formating similar to what other man pages in the system
uses.
Fixes #1285
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Using a man page formating similar to what other man pages in the system
uses.
Fixes #1285
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1490,2020-04-21T16:26:29Z,2020-04-23T19:08:12Z,2020-04-27T16:05:30Z,MERGED,True,311,443,4,https://github.com/otaviobp,docs: Changes on man pages to make is similar to system man pages,1,[],https://github.com/clearlinux/swupd-client/pull/1490,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1490#issuecomment-618489668,"Using a man page formating similar to what other man pages in the system
uses.
Fixes #1285
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",V2: Fixing incorrect parameters in doc,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1492,2020-04-21T16:44:21Z,2020-04-21T18:33:43Z,2020-04-21T18:33:43Z,MERGED,True,16,2,1,https://github.com/otaviobp,tests: Adding more attribute changes to test,1,[],https://github.com/clearlinux/swupd-client/pull/1492,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1492,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1493,2020-04-21T20:17:05Z,2020-04-22T22:21:09Z,2020-04-27T16:07:58Z,MERGED,True,10,126,75,https://github.com/otaviobp,Autotools: Some changes on how we handle config.h and _GNU_SOURCE define,2,[],https://github.com/clearlinux/swupd-client/pull/1493,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1493,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1495,2020-04-21T23:58:54Z,2020-04-22T17:47:01Z,2020-04-22T17:47:04Z,MERGED,True,293,7,11,https://github.com/castulo,Bug_fix: In closing steps in multi-repo ops,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1495,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1495,"Multi-repo operations can run in one or multiple repos, so that needs to
be taken in consideration when opening and closing progress steps.
Closes #1494
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Multi-repo operations can run in one or multiple repos, so that needs to
be taken in consideration when opening and closing progress steps.
Closes #1494
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1497,2020-04-22T17:38:46Z,2020-04-23T15:55:46Z,2020-04-27T16:07:48Z,MERGED,True,332,322,55,https://github.com/otaviobp,Strings: Improvements in str compare function,3,[],https://github.com/clearlinux/swupd-client/pull/1497,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1497,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1498,2020-04-22T19:39:13Z,2020-04-24T15:14:47Z,2020-04-24T15:51:22Z,MERGED,True,295,22,9,https://github.com/castulo,Adding a --3rd-party flag to update,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1498,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1498,"This commit adds a flag that can be used to update content from
3rd-party repositories after updating the regular content if
successfull.
Closes #1473
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit adds a flag that can be used to update content from
3rd-party repositories after updating the regular content if
successfull.
Closes #1473
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1498,2020-04-22T19:39:13Z,2020-04-24T15:14:47Z,2020-04-24T15:51:22Z,MERGED,True,295,22,9,https://github.com/castulo,Adding a --3rd-party flag to update,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1498,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1498#issuecomment-618594946,"This commit adds a flag that can be used to update content from
3rd-party repositories after updating the regular content if
successfull.
Closes #1473
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V2:

using the correct number of steps for 3rd-party update",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1498,2020-04-22T19:39:13Z,2020-04-24T15:14:47Z,2020-04-24T15:51:22Z,MERGED,True,295,22,9,https://github.com/castulo,Adding a --3rd-party flag to update,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1498,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1498#issuecomment-618711631,"This commit adds a flag that can be used to update content from
3rd-party repositories after updating the regular content if
successfull.
Closes #1473
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3:

Enabling the use of update --status --3rd-party
Calculating the number of steps in the 3rd-party update entirely within 3rd_party_update.c",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1498,2020-04-22T19:39:13Z,2020-04-24T15:14:47Z,2020-04-24T15:51:22Z,MERGED,True,295,22,9,https://github.com/castulo,Adding a --3rd-party flag to update,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1498,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1498#issuecomment-619072714,"This commit adds a flag that can be used to update content from
3rd-party repositories after updating the regular content if
successfull.
Closes #1473
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",looks good now,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1499,2020-04-22T20:36:59Z,2020-04-25T00:12:19Z,2020-04-25T00:12:23Z,MERGED,True,154,180,15,https://github.com/castulo,"3rd-party: using ""repository"" for headers",1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1499,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1499,"Headers are printed at the beginning of the output for every repository
in operations that run in multipl repos. This header was using the word
""repo"" but we are trying to use the whole ""repository"" word every time
we printed it to the user. This commit changes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Headers are printed at the beginning of the output for every repository
in operations that run in multipl repos. This header was using the word
""repo"" but we are trying to use the whole ""repository"" word every time
we printed it to the user. This commit changes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1499,2020-04-22T20:36:59Z,2020-04-25T00:12:19Z,2020-04-25T00:12:23Z,MERGED,True,154,180,15,https://github.com/castulo,"3rd-party: using ""repository"" for headers",1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1499,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1499#issuecomment-619213099,"Headers are printed at the beginning of the output for every repository
in operations that run in multipl repos. This header was using the word
""repo"" but we are trying to use the whole ""repository"" word every time
we printed it to the user. This commit changes that.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1500,2020-04-22T21:24:55Z,2020-04-22T22:20:56Z,2020-04-27T16:07:57Z,MERGED,True,5,2,1,https://github.com/otaviobp,"sys: sys_path_join() removes trailing '/' from ""/""",1,[],https://github.com/clearlinux/swupd-client/pull/1500,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1500,"Sys_path_join is removing trailing '/', but we shouldn't remove the last
'/' if path is ""/"". Right now sys_path_join(""/"") == """" and should be ""/"".
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Sys_path_join is removing trailing '/', but we shouldn't remove the last
'/' if path is ""/"". Right now sys_path_join(""/"") == """" and should be ""/"".
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1503,2020-04-23T10:04:20Z,2020-04-27T15:30:06Z,2020-04-27T15:30:06Z,MERGED,True,597,350,1,https://github.com/lebensterben,swupd.zsh: Updated to support 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1503,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1503,"Added supports to 3rd-party repos.
Added a new functionality to complete version number. For example
swupd update --version=VERSION_NUMBER
Updated descriptions for arguments/options.
Large amount of refactoring. Separation of data and logic.

Various completions for 3rd-party repo won't work with non-root users until we made /var/lib/swupd/ readable.
See #1496","Added supports to 3rd-party repos.
Added a new functionality to complete version number. For example
swupd update --version=VERSION_NUMBER
Updated descriptions for arguments/options.
Large amount of refactoring. Separation of data and logic.

Various completions for 3rd-party repo won't work with non-root users until we made /var/lib/swupd/ readable.
See #1496",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1503,2020-04-23T10:04:20Z,2020-04-27T15:30:06Z,2020-04-27T15:30:06Z,MERGED,True,597,350,1,https://github.com/lebensterben,swupd.zsh: Updated to support 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1503,https://github.com/lebensterben,2,https://github.com/clearlinux/swupd-client/pull/1503#issuecomment-619239927,"Added supports to 3rd-party repos.
Added a new functionality to complete version number. For example
swupd update --version=VERSION_NUMBER
Updated descriptions for arguments/options.
Large amount of refactoring. Separation of data and logic.

Various completions for 3rd-party repo won't work with non-root users until we made /var/lib/swupd/ readable.
See #1496",Hold on. I've another commit coming. I will probably close this one and made a PR from another branch.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1503,2020-04-23T10:04:20Z,2020-04-27T15:30:06Z,2020-04-27T15:30:06Z,MERGED,True,597,350,1,https://github.com/lebensterben,swupd.zsh: Updated to support 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1503,https://github.com/lebensterben,3,https://github.com/clearlinux/swupd-client/pull/1503#issuecomment-619338273,"Added supports to 3rd-party repos.
Added a new functionality to complete version number. For example
swupd update --version=VERSION_NUMBER
Updated descriptions for arguments/options.
Large amount of refactoring. Separation of data and logic.

Various completions for 3rd-party repo won't work with non-root users until we made /var/lib/swupd/ readable.
See #1496","@otaviobp
In this latest commit, I separated the data from the logic of the completion scripts.
Now the arguments, options, and their descriptions are declared in the beginning of the script.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1503,2020-04-23T10:04:20Z,2020-04-27T15:30:06Z,2020-04-27T15:30:06Z,MERGED,True,597,350,1,https://github.com/lebensterben,swupd.zsh: Updated to support 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1503,https://github.com/lebensterben,4,https://github.com/clearlinux/swupd-client/pull/1503#issuecomment-619427493,"Added supports to 3rd-party repos.
Added a new functionality to complete version number. For example
swupd update --version=VERSION_NUMBER
Updated descriptions for arguments/options.
Large amount of refactoring. Separation of data and logic.

Various completions for 3rd-party repo won't work with non-root users until we made /var/lib/swupd/ readable.
See #1496","@otaviobp
I'm considering to write a ""contribution guide"" for the shell completions of swupd-client. (Not in this PR). And it may fit into the wiki section of this repository.
This is especially helpful to prevent bugs when a maintainer update the zsh script, since it's becoming rather complex now.
What do you think?",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1503,2020-04-23T10:04:20Z,2020-04-27T15:30:06Z,2020-04-27T15:30:06Z,MERGED,True,597,350,1,https://github.com/lebensterben,swupd.zsh: Updated to support 3rd-party repo,1,[],https://github.com/clearlinux/swupd-client/pull/1503,https://github.com/otaviobp,5,https://github.com/clearlinux/swupd-client/pull/1503#issuecomment-620058747,"Added supports to 3rd-party repos.
Added a new functionality to complete version number. For example
swupd update --version=VERSION_NUMBER
Updated descriptions for arguments/options.
Large amount of refactoring. Separation of data and logic.

Various completions for 3rd-party repo won't work with non-root users until we made /var/lib/swupd/ readable.
See #1496","I'm considering to write a ""contribution guide"" for the shell completions of swupd-client. (Not in this PR). And it may fit into the wiki section of this repository.

Cool. that would be very nice",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1505,2020-04-23T17:06:09Z,2020-04-27T21:50:23Z,2020-04-29T17:31:31Z,MERGED,True,105,129,8,https://github.com/otaviobp,Target: refactoring function verify_fix_path,3,[],https://github.com/clearlinux/swupd-client/pull/1505,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1505,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1505,2020-04-23T17:06:09Z,2020-04-27T21:50:23Z,2020-04-29T17:31:31Z,MERGED,True,105,129,8,https://github.com/otaviobp,Target: refactoring function verify_fix_path,3,[],https://github.com/clearlinux/swupd-client/pull/1505,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1505#issuecomment-620078525,,V2: Fixing reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1506,2020-04-23T17:06:35Z,2020-04-23T19:07:52Z,2020-04-27T16:07:29Z,MERGED,True,4,4,2,https://github.com/otaviobp,compliant: Start using clang-format-10 to check for style problems,1,[],https://github.com/clearlinux/swupd-client/pull/1506,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1506,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1507,2020-04-23T17:36:24Z,2020-04-24T16:32:30Z,2020-04-24T16:32:36Z,MERGED,True,98,38,6,https://github.com/castulo,Bug_fix: Fixing bug in diagnose/repair using the `--file` option,3,[],https://github.com/clearlinux/swupd-client/pull/1507,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1507,"This PR fixes a couple of bugs found in the diagnose/repair functionality:

Diagnose should not use partial matches for the --file option
Swupd should still check for extra files even in no tracked files are found in the path specified by the user with the --file flag.

Closes #1472","This PR fixes a couple of bugs found in the diagnose/repair functionality:

Diagnose should not use partial matches for the --file option
Swupd should still check for extra files even in no tracked files are found in the path specified by the user with the --file flag.

Closes #1472",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1508,2020-04-23T17:36:45Z,2020-04-23T18:13:02Z,2020-04-23T18:13:07Z,MERGED,True,1,1,1,https://github.com/castulo,Fixing typo in helper description,1,[],https://github.com/clearlinux/swupd-client/pull/1508,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1508,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1510,2020-04-23T20:17:26Z,2020-04-23T22:20:52Z,2020-04-27T16:05:29Z,MERGED,True,9,9,2,https://github.com/otaviobp,header: Print the header decoration all at once,1,[],https://github.com/clearlinux/swupd-client/pull/1510,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1510,"When printing the header, print all '_' chars at once to prevent
json-output and --debug to print that in multiple lines.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When printing the header, print all '_' chars at once to prevent
json-output and --debug to print that in multiple lines.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1511,2020-04-23T23:06:56Z,2020-04-24T19:03:11Z,2020-04-27T16:05:14Z,MERGED,True,142,52,4,https://github.com/otaviobp,Tartar: reorganize tar | tar call in target_dir,4,[],https://github.com/clearlinux/swupd-client/pull/1511,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1511,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1512,2020-04-24T20:13:52Z,2020-04-27T23:04:06Z,2020-04-27T23:04:10Z,MERGED,True,23,31,3,https://github.com/castulo,API: Do not validate error messages in API tests,1,[],https://github.com/clearlinux/swupd-client/pull/1512,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1512,"The tests in test/functional/api are going to validate the --quiet
output is rarely changed, therefore only expected output should be
validated and not warnings or error messages.
Closes #1502
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The tests in test/functional/api are going to validate the --quiet
output is rarely changed, therefore only expected output should be
validated and not warnings or error messages.
Closes #1502
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1512,2020-04-24T20:13:52Z,2020-04-27T23:04:06Z,2020-04-27T23:04:10Z,MERGED,True,23,31,3,https://github.com/castulo,API: Do not validate error messages in API tests,1,[],https://github.com/clearlinux/swupd-client/pull/1512,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1512#issuecomment-620273841,"The tests in test/functional/api are going to validate the --quiet
output is rarely changed, therefore only expected output should be
validated and not warnings or error messages.
Closes #1502
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1513,2020-04-27T16:59:36Z,2020-04-27T20:59:08Z,2020-04-27T21:04:47Z,MERGED,True,42,2,3,https://github.com/otaviobp,"sys: sys_path_join was wrong for string ""//""",1,[],https://github.com/clearlinux/swupd-client/pull/1513,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1513,"When sys_path_join(""//"") was used, the result was """" instead of ""/""
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","When sys_path_join(""//"") was used, the result was """" instead of ""/""
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1514,2020-04-27T17:51:18Z,2020-05-05T19:22:50Z,2020-05-05T19:22:50Z,MERGED,True,97,25,5,https://github.com/otaviobp,target_root: Use run_commmand to execute tar|tar command,1,[],https://github.com/clearlinux/swupd-client/pull/1514,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1514,"Porting code to better way on interacting with system commands using the
run_command function. As run_command don't support multi-thread for
performance reasons, we are now using a file instead of a pipe. As tar|tar
is now a fallback, this won't have any performance impacts on any case
where with no problems and errors.
Fixes #640 and #671
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Porting code to better way on interacting with system commands using the
run_command function. As run_command don't support multi-thread for
performance reasons, we are now using a file instead of a pipe. As tar|tar
is now a fallback, this won't have any performance impacts on any case
where with no problems and errors.
Fixes #640 and #671
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1514,2020-04-27T17:51:18Z,2020-05-05T19:22:50Z,2020-05-05T19:22:50Z,MERGED,True,97,25,5,https://github.com/otaviobp,target_root: Use run_commmand to execute tar|tar command,1,[],https://github.com/clearlinux/swupd-client/pull/1514,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1514#issuecomment-620137991,"Porting code to better way on interacting with system commands using the
run_command function. As run_command don't support multi-thread for
performance reasons, we are now using a file instead of a pipe. As tar|tar
is now a fallback, this won't have any performance impacts on any case
where with no problems and errors.
Fixes #640 and #671
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",Blocking the merge of this PR before next release. I would like to give some time to check the results of using new implementation of install files before having this in.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1515,2020-04-27T17:57:54Z,2020-04-27T19:21:23Z,2020-04-27T19:21:23Z,MERGED,True,13,0,1,https://github.com/castulo,"Disable ""update --3rd-party"" when applicable",1,[],https://github.com/clearlinux/swupd-client/pull/1515,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1515,"There is a configuration option to build swupd without the 3rd-party
functionality, this commit adds a guard to disable the code that adds
the ""swupd update --3rd-party"" flag which should be only available if
3rd-party is enabled.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","There is a configuration option to build swupd without the 3rd-party
functionality, this commit adds a guard to disable the code that adds
the ""swupd update --3rd-party"" flag which should be only available if
3rd-party is enabled.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1515,2020-04-27T17:57:54Z,2020-04-27T19:21:23Z,2020-04-27T19:21:23Z,MERGED,True,13,0,1,https://github.com/castulo,"Disable ""update --3rd-party"" when applicable",1,[],https://github.com/clearlinux/swupd-client/pull/1515,https://github.com/lebensterben,2,https://github.com/clearlinux/swupd-client/pull/1515#issuecomment-620148525,"There is a configuration option to build swupd without the 3rd-party
functionality, this commit adds a guard to disable the code that adds
the ""swupd update --3rd-party"" flag which should be only available if
3rd-party is enabled.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I'll update the zsh completion to remove(not adding) ""3rd-party"" stuff when necessary.",True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1515,2020-04-27T17:57:54Z,2020-04-27T19:21:23Z,2020-04-27T19:21:23Z,MERGED,True,13,0,1,https://github.com/castulo,"Disable ""update --3rd-party"" when applicable",1,[],https://github.com/clearlinux/swupd-client/pull/1515,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1515#issuecomment-620149449,"There is a configuration option to build swupd without the 3rd-party
functionality, this commit adds a guard to disable the code that adds
the ""swupd update --3rd-party"" flag which should be only available if
3rd-party is enabled.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","I'll update the zsh completion to remove(not adding) ""3rd-party"" stuff when necessary.

cool",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1516,2020-04-27T19:39:05Z,2020-04-27T21:51:01Z,2020-04-30T22:05:26Z,MERGED,True,37,19,1,https://github.com/lebensterben,zsh-completions: Only add `3rd-party` when it's supported,1,[],https://github.com/clearlinux/swupd-client/pull/1516,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1516,"Added a new flag feature_thirdparty for whether 3rd-party operations
is supported.
Improved return code handling.

Additional notes for future references:
The test of 3rd-party feature solely relies on output of swupd --help.
Specifically, if the help message contains 3rd-party, it's determined that
3rd-party feature is supported.
So please don't mention 3rd-party in the help message in any future updates,
or otherwise we need alternative ways for this.","Added a new flag feature_thirdparty for whether 3rd-party operations
is supported.
Improved return code handling.

Additional notes for future references:
The test of 3rd-party feature solely relies on output of swupd --help.
Specifically, if the help message contains 3rd-party, it's determined that
3rd-party feature is supported.
So please don't mention 3rd-party in the help message in any future updates,
or otherwise we need alternative ways for this.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1517,2020-04-27T20:31:45Z,2020-04-28T17:56:40Z,2020-04-28T17:56:44Z,MERGED,True,966,811,2,https://github.com/castulo,Testlib: Improve the help description for all testlib functions/commands,2,[],https://github.com/clearlinux/swupd-client/pull/1517,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1517,"This PR improves the output of testlib functions so it is easier to use the library.
Closes #1477","This PR improves the output of testlib functions so it is easier to use the library.
Closes #1477",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1518,2020-04-27T21:57:15Z,2020-04-28T16:44:44Z,2020-04-29T17:31:10Z,MERGED,True,2,0,1,https://github.com/otaviobp,helpers: Add check for allocation errors,1,[],https://github.com/clearlinux/swupd-client/pull/1518,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1518,"Forgot to add the check after calloc
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Forgot to add the check after calloc
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1519,2020-04-27T23:12:14Z,2020-04-28T16:13:46Z,2020-04-28T16:13:50Z,MERGED,True,36,42,5,https://github.com/castulo,Reporting if a file was fixed or not with --quiet,1,[],https://github.com/clearlinux/swupd-client/pull/1519,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1519,"When using --quiet, there was no way of knowing if a file had been
successfully repaired or not. This commit fixes that.
Closes #1504
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When using --quiet, there was no way of knowing if a file had been
successfully repaired or not. This commit fixes that.
Closes #1504
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1521,2020-04-28T16:10:02Z,2020-04-28T16:17:55Z,2020-04-28T16:17:55Z,CLOSED,False,8,3,1,https://github.com/castulo,Fail if memory allocation fails during print_char,1,[],https://github.com/clearlinux/swupd-client/pull/1521,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1521,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1521,2020-04-28T16:10:02Z,2020-04-28T16:17:55Z,2020-04-28T16:17:55Z,CLOSED,False,8,3,1,https://github.com/castulo,Fail if memory allocation fails during print_char,1,[],https://github.com/clearlinux/swupd-client/pull/1521,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1521#issuecomment-620708733,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,There is another PR already fixing this. I'm closing this PR in favor of that one. (#1518),True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1522,2020-04-28T17:01:05Z,2020-04-28T21:19:59Z,2020-04-28T23:45:53Z,MERGED,True,19,0,2,https://github.com/castulo,Fail to be compliant if --quiet tests change,1,[],https://github.com/clearlinux/swupd-client/pull/1522,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1522,"We are aiming to provide a stable --quiet output, so forcing ""make
compliant"" to fail if there are changes in the test/functional/api
tests, which cover these scenarios will prevent us from unadvertedly
changing those tests.
Closes #1501
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","We are aiming to provide a stable --quiet output, so forcing ""make
compliant"" to fail if there are changes in the test/functional/api
tests, which cover these scenarios will prevent us from unadvertedly
changing those tests.
Closes #1501
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1523,2020-04-28T18:01:42Z,2020-04-29T17:20:51Z,2020-04-29T17:31:08Z,MERGED,True,429,414,64,https://github.com/otaviobp,Create a wrapper for free and enforece usage of some sys functions,2,[],https://github.com/clearlinux/swupd-client/pull/1523,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1523,"Creating a macro FREE to replace free_and_clear_pointer().
Enforce using sys_dirname() and sys_basename()","Creating a macro FREE to replace free_and_clear_pointer().
Enforce using sys_dirname() and sys_basename()",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1524,2020-04-28T22:26:34Z,2020-04-30T16:46:49Z,2020-04-30T16:46:49Z,CLOSED,False,509,139,40,https://github.com/otaviobp,Int: Multiple fixes on signed to unsigned conversions on several files,7,[],https://github.com/clearlinux/swupd-client/pull/1524,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1524,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1524,2020-04-28T22:26:34Z,2020-04-30T16:46:49Z,2020-04-30T16:46:49Z,CLOSED,False,509,139,40,https://github.com/otaviobp,Int: Multiple fixes on signed to unsigned conversions on several files,7,[],https://github.com/clearlinux/swupd-client/pull/1524,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1524#issuecomment-621971191,,I'm planning a different move for macros.h so I'll close this,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1525,2020-04-29T00:19:05Z,2020-04-29T16:03:35Z,2020-04-29T16:03:35Z,MERGED,True,3,0,1,https://github.com/castulo,curl: exit if the file cannot be created/appended,1,[],https://github.com/clearlinux/swupd-client/pull/1525,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1525,"If for some reason swupd fails to create or append the file it will
cause a segmentation fault. This, commit prevents this from happening.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","If for some reason swupd fails to create or append the file it will
cause a segmentation fault. This, commit prevents this from happening.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1526,2020-04-29T00:40:56Z,2020-04-29T16:04:14Z,2020-04-29T16:04:14Z,MERGED,True,4,0,4,https://github.com/castulo,Test: show_target shellcheck warning,1,[],https://github.com/clearlinux/swupd-client/pull/1526,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1526,"The show_target function shows a warning that is not applicable so this
commit ignores that warning wherever show_target is used.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","The show_target function shows a warning that is not applicable so this
commit ignores that warning wherever show_target is used.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1527,2020-04-29T17:22:55Z,2020-04-29T20:03:25Z,2020-04-29T20:03:25Z,MERGED,True,3,0,1,https://github.com/otaviobp,verify: Debug info for every checked file,1,[],https://github.com/clearlinux/swupd-client/pull/1527,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1527,"Print debug information for all file that is checked in repair/diagnose/os-install
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Print debug information for all file that is checked in repair/diagnose/os-install
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1528,2020-04-29T19:13:58Z,2020-04-30T15:50:49Z,2020-04-30T15:50:49Z,MERGED,True,35,16,9,https://github.com/otaviobp,Shellcheck,2,[],https://github.com/clearlinux/swupd-client/pull/1528,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1528,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1528,2020-04-29T19:13:58Z,2020-04-30T15:50:49Z,2020-04-30T15:50:49Z,MERGED,True,35,16,9,https://github.com/otaviobp,Shellcheck,2,[],https://github.com/clearlinux/swupd-client/pull/1528,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1528#issuecomment-621432685,,"V2:

Adding comment and updating all shellcheck bats scripts to use same code",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1531,2020-04-29T21:50:12Z,2020-04-30T19:26:30Z,2020-04-30T19:26:30Z,MERGED,True,143,10,5,https://github.com/otaviobp,Fix bugs on swupd repair when file type changes,3,[],https://github.com/clearlinux/swupd-client/pull/1531,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1531,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1532,2020-04-30T18:56:18Z,2020-04-30T21:01:17Z,2020-04-30T21:18:43Z,MERGED,True,12,12,12,https://github.com/castulo,Test: Use global_setup for bundle-list tests,1,[],https://github.com/clearlinux/swupd-client/pull/1532,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1532,"Use global_setup in all bundle-list tests so we can only generate the
test environment once and use it for multiple tests. The one exception
is if we need to modify the env for a specific test.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Use global_setup in all bundle-list tests so we can only generate the
test environment once and use it for multiple tests. The one exception
is if we need to modify the env for a specific test.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1533,2020-04-30T20:54:06Z,2020-05-05T19:14:55Z,2020-05-05T19:14:55Z,MERGED,True,190,65,6,https://github.com/otaviobp,Verifytime: Reduce dependencies from verify time binary,2,[],https://github.com/clearlinux/swupd-client/pull/1533,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1533,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1533,2020-04-30T20:54:06Z,2020-05-05T19:14:55Z,2020-05-05T19:14:55Z,MERGED,True,190,65,6,https://github.com/otaviobp,Verifytime: Reduce dependencies from verify time binary,2,[],https://github.com/clearlinux/swupd-client/pull/1533,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1533#issuecomment-624146608,,V2: Fixed the error/info messages,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1534,2020-04-30T23:29:07Z,2020-05-05T17:37:45Z,2020-05-05T17:37:50Z,MERGED,True,438,35,19,https://github.com/castulo,Add `--orphans` flag for bundle-list,3,[],https://github.com/clearlinux/swupd-client/pull/1534,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1534,"This commit adds the --orphans flag to bundle-list and 3rd-party bundle-list. This flag will list the bundles that are no longer required by any tracked bundles.
Closes #1530","This commit adds the --orphans flag to bundle-list and 3rd-party bundle-list. This flag will list the bundles that are no longer required by any tracked bundles.
Closes #1530",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1534,2020-04-30T23:29:07Z,2020-05-05T17:37:45Z,2020-05-05T17:37:50Z,MERGED,True,438,35,19,https://github.com/castulo,Add `--orphans` flag for bundle-list,3,[],https://github.com/clearlinux/swupd-client/pull/1534,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1534#issuecomment-622173553,"This commit adds the --orphans flag to bundle-list and 3rd-party bundle-list. This flag will list the bundles that are no longer required by any tracked bundles.
Closes #1530",@otaviobp this PR is going to fail because it adds tests to the api test suite.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1534,2020-04-30T23:29:07Z,2020-05-05T17:37:45Z,2020-05-05T17:37:50Z,MERGED,True,438,35,19,https://github.com/castulo,Add `--orphans` flag for bundle-list,3,[],https://github.com/clearlinux/swupd-client/pull/1534,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1534#issuecomment-622570833,"This commit adds the --orphans flag to bundle-list and 3rd-party bundle-list. This flag will list the bundles that are no longer required by any tracked bundles.
Closes #1530","V2:

Removed ""prefix"" from sys_ls()
Removed get_dir_files_sorted() in favor of using sys_ls()
Corrected usage of UNEXPECED()
Fixed a problem with showing a message even if swupd failed to list
Not using errno to check for errors",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1535,2020-05-01T06:45:35Z,2020-05-05T16:09:55Z,2020-05-05T16:09:55Z,MERGED,True,91,164,2,https://github.com/lebensterben,swupd.bash: Multiple improvements,2,[],https://github.com/clearlinux/swupd-client/pull/1535,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1535,"All options and subcommands are automatically generated from help messages.
Used _init_completion to set $cur, $prev, $words variables, which are
equivalent to $2, $3, $COMP_WORD, but far more readable.

It also allows possibility to use other functions provided in
/usr/share/bash-completion/bash_completion, for future


A minor change on getting current OS version via swupd info --quiet from
reading /var/lib/swupd/version, which is non-readable to non-root users

Though MoM file is still non-readable to non-root users


We only ship modern Bash, so the test on Bash version near the end of the
script is removed

This also closes #1520","All options and subcommands are automatically generated from help messages.
Used _init_completion to set $cur, $prev, $words variables, which are
equivalent to $2, $3, $COMP_WORD, but far more readable.

It also allows possibility to use other functions provided in
/usr/share/bash-completion/bash_completion, for future


A minor change on getting current OS version via swupd info --quiet from
reading /var/lib/swupd/version, which is non-readable to non-root users

Though MoM file is still non-readable to non-root users


We only ship modern Bash, so the test on Bash version near the end of the
script is removed

This also closes #1520",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1535,2020-05-01T06:45:35Z,2020-05-05T16:09:55Z,2020-05-05T16:09:55Z,MERGED,True,91,164,2,https://github.com/lebensterben,swupd.bash: Multiple improvements,2,[],https://github.com/clearlinux/swupd-client/pull/1535,https://github.com/lebensterben,2,https://github.com/clearlinux/swupd-client/pull/1535#issuecomment-622272771,"All options and subcommands are automatically generated from help messages.
Used _init_completion to set $cur, $prev, $words variables, which are
equivalent to $2, $3, $COMP_WORD, but far more readable.

It also allows possibility to use other functions provided in
/usr/share/bash-completion/bash_completion, for future


A minor change on getting current OS version via swupd info --quiet from
reading /var/lib/swupd/version, which is non-readable to non-root users

Though MoM file is still non-readable to non-root users


We only ship modern Bash, so the test on Bash version near the end of the
script is removed

This also closes #1520","The implication for this commit is, there's virtually no need to update this script if you just added some flags.",True,{'HOORAY': ['https://github.com/castulo']}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1535,2020-05-01T06:45:35Z,2020-05-05T16:09:55Z,2020-05-05T16:09:55Z,MERGED,True,91,164,2,https://github.com/lebensterben,swupd.bash: Multiple improvements,2,[],https://github.com/clearlinux/swupd-client/pull/1535,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1535#issuecomment-622440634,"All options and subcommands are automatically generated from help messages.
Used _init_completion to set $cur, $prev, $words variables, which are
equivalent to $2, $3, $COMP_WORD, but far more readable.

It also allows possibility to use other functions provided in
/usr/share/bash-completion/bash_completion, for future


A minor change on getting current OS version via swupd info --quiet from
reading /var/lib/swupd/version, which is non-readable to non-root users

Though MoM file is still non-readable to non-root users


We only ship modern Bash, so the test on Bash version near the end of the
script is removed

This also closes #1520",Looks like this is also related to #1064,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1535,2020-05-01T06:45:35Z,2020-05-05T16:09:55Z,2020-05-05T16:09:55Z,MERGED,True,91,164,2,https://github.com/lebensterben,swupd.bash: Multiple improvements,2,[],https://github.com/clearlinux/swupd-client/pull/1535,https://github.com/otaviobp,4,https://github.com/clearlinux/swupd-client/pull/1535#issuecomment-622543878,"All options and subcommands are automatically generated from help messages.
Used _init_completion to set $cur, $prev, $words variables, which are
equivalent to $2, $3, $COMP_WORD, but far more readable.

It also allows possibility to use other functions provided in
/usr/share/bash-completion/bash_completion, for future


A minor change on getting current OS version via swupd info --quiet from
reading /var/lib/swupd/version, which is non-readable to non-root users

Though MoM file is still non-readable to non-root users


We only ship modern Bash, so the test on Bash version near the end of the
script is removed

This also closes #1520",Pushed a commit fixing tests,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1536,2020-05-01T18:20:38Z,2020-05-01T20:02:22Z,2020-05-01T20:57:45Z,MERGED,True,106,68,1,https://github.com/castulo,Testlib: Fixing functions that use a test ID,1,[],https://github.com/clearlinux/swupd-client/pull/1536,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1536,"Instead of relying on all tests of the same group to exist in the same
directory, testlib should assume those tests could be scattered across
multiple directories.
Closes #1485
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Instead of relying on all tests of the same group to exist in the same
directory, testlib should assume those tests could be scattered across
multiple directories.
Closes #1485
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1543,2020-05-05T19:23:12Z,2020-05-05T20:20:17Z,2020-05-05T20:20:17Z,MERGED,True,3,1,1,https://github.com/otaviobp,sys: Fixing documentation of ls_sys,1,[],https://github.com/clearlinux/swupd-client/pull/1543,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1543,"To be parsed doc commend should start with **
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","To be parsed doc commend should start with **
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1544,2020-05-05T20:21:02Z,2020-05-06T16:54:25Z,2020-05-06T16:54:25Z,MERGED,True,53,78,25,https://github.com/otaviobp,macros: Create wrapper for malloc and calloc functions,1,[],https://github.com/clearlinux/swupd-client/pull/1544,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1544,"Use always calloc to allocate memory and abort on errors
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Use always calloc to allocate memory and abort on errors
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1546,2020-05-05T20:30:27Z,2020-05-05T21:29:56Z,2020-05-05T21:29:56Z,MERGED,True,1,1,1,https://github.com/otaviobp,config: CONFIG_FILE_PATH shouldn't be treated as a path,1,[],https://github.com/clearlinux/swupd-client/pull/1546,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1546,"CONFIG_FILE_PATH contains a list of paths not just one path. So
we shouldn't use realpath to point to it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","CONFIG_FILE_PATH contains a list of paths not just one path. So
we shouldn't use realpath to point to it.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1547,2020-05-05T20:40:49Z,2020-05-08T16:30:51Z,2020-05-08T16:30:55Z,MERGED,True,402,68,14,https://github.com/castulo,Add command to remove orphan bundles,2,[],https://github.com/clearlinux/swupd-client/pull/1547,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1547,"Dependencies of orphaned bundles can cause bloat and unexpected content to be on disk.
We need to remove all bundles that are not tracked or dependency of a tracked bundle.
This option should also be available for 3rd-party.
Closes #1529","Dependencies of orphaned bundles can cause bloat and unexpected content to be on disk.
We need to remove all bundles that are not tracked or dependency of a tracked bundle.
This option should also be available for 3rd-party.
Closes #1529",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1547,2020-05-05T20:40:49Z,2020-05-08T16:30:51Z,2020-05-08T16:30:55Z,MERGED,True,402,68,14,https://github.com/castulo,Add command to remove orphan bundles,2,[],https://github.com/clearlinux/swupd-client/pull/1547,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1547#issuecomment-624894824,"Dependencies of orphaned bundles can cause bloat and unexpected content to be on disk.
We need to remove all bundles that are not tracked or dependency of a tracked bundle.
This option should also be available for 3rd-party.
Closes #1529","@otaviobp I forgot to mention this, but the PR is ready for review regardless of the failing job. That is again because of new tests in the API tests.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1547,2020-05-05T20:40:49Z,2020-05-08T16:30:51Z,2020-05-08T16:30:55Z,MERGED,True,402,68,14,https://github.com/castulo,Add command to remove orphan bundles,2,[],https://github.com/clearlinux/swupd-client/pull/1547,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1547#issuecomment-625552630,"Dependencies of orphaned bundles can cause bloat and unexpected content to be on disk.
We need to remove all bundles that are not tracked or dependency of a tracked bundle.
This option should also be available for 3rd-party.
Closes #1529","V2:

Rebased
Used a new pointer to iterate over the bundles list
Removed the word ""orphaned"" from the bundle-remove summary so instead of saying: ""Successfully removed 1 orphaned bundle"" it will say ""Successfully removed 1 bundle""",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1547,2020-05-05T20:40:49Z,2020-05-08T16:30:51Z,2020-05-08T16:30:55Z,MERGED,True,402,68,14,https://github.com/castulo,Add command to remove orphan bundles,2,[],https://github.com/clearlinux/swupd-client/pull/1547,https://github.com/castulo,4,https://github.com/clearlinux/swupd-client/pull/1547#issuecomment-625553689,"Dependencies of orphaned bundles can cause bloat and unexpected content to be on disk.
We need to remove all bundles that are not tracked or dependency of a tracked bundle.
This option should also be available for 3rd-party.
Closes #1529","I didn't change the logic in the code to pass the list of orphaned bundles to execute_remove_bundles_extra() because this IMO has bigger disadvantages, like having to load the manifests outside a process step, and requiring more code duplication.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1547,2020-05-05T20:40:49Z,2020-05-08T16:30:51Z,2020-05-08T16:30:55Z,MERGED,True,402,68,14,https://github.com/castulo,Add command to remove orphan bundles,2,[],https://github.com/clearlinux/swupd-client/pull/1547,https://github.com/castulo,5,https://github.com/clearlinux/swupd-client/pull/1547#issuecomment-625882611,"Dependencies of orphaned bundles can cause bloat and unexpected content to be on disk.
We need to remove all bundles that are not tracked or dependency of a tracked bundle.
This option should also be available for 3rd-party.
Closes #1529",I forgot to push changes for a couple of tests after pushing V2. It should be good now.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1548,2020-05-05T21:28:30Z,2020-05-05T21:28:35Z,2020-05-05T21:28:35Z,CLOSED,False,192,65,6,https://github.com/otaviobp,Verifytime,3,[],https://github.com/clearlinux/swupd-client/pull/1548,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1548,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1549,2020-05-05T21:29:37Z,2020-05-06T16:06:56Z,2020-05-06T16:06:56Z,MERGED,True,2,0,2,https://github.com/otaviobp,verifytime: Missed a return on ENOENT error,1,[],https://github.com/clearlinux/swupd-client/pull/1549,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1549,"If the file doesn't exist in system, we can't proceed.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","If the file doesn't exist in system, we can't proceed.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1550,2020-05-05T21:30:39Z,2020-05-07T21:31:29Z,2020-05-07T21:31:29Z,MERGED,True,335,168,86,https://github.com/otaviobp,Group files: Reorganize files on source directory,5,[],https://github.com/clearlinux/swupd-client/pull/1550,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1550,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1551,2020-05-06T20:31:45Z,2020-05-07T20:28:36Z,2020-05-07T20:28:36Z,MERGED,True,52,53,9,https://github.com/otaviobp,Makefile: Adding -Wshadow to prevent accident shadowing,1,[],https://github.com/clearlinux/swupd-client/pull/1551,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1551,"Make sure we are not accidently using the incorrect variable
by not allowing 2 variables with the same name.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Make sure we are not accidently using the incorrect variable
by not allowing 2 variables with the same name.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1552,2020-05-06T21:16:52Z,2020-05-12T16:05:28Z,2020-05-12T16:05:28Z,MERGED,True,183,124,17,https://github.com/castulo,"Creating new module statedir, to group all functions related to handling of statedir (part 1)",4,[],https://github.com/clearlinux/swupd-client/pull/1552,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1552,"Create a statedir module with functions related operations exclusive to statedir, like cleaning staged dir, other cleaning operations and functions to build specific directories.
This is the first of a series of PRs aimed to complete that goal.
Relates #1538","Create a statedir module with functions related operations exclusive to statedir, like cleaning staged dir, other cleaning operations and functions to build specific directories.
This is the first of a series of PRs aimed to complete that goal.
Relates #1538",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1554,2020-05-07T16:31:56Z,2020-05-07T20:22:29Z,2020-05-07T20:22:29Z,MERGED,True,0,40,2,https://github.com/otaviobp,mixin: Remove some mixin leftovers,1,[],https://github.com/clearlinux/swupd-client/pull/1554,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1554,"Some manifest functions used by mixin were left behind
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Some manifest functions used by mixin were left behind
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1555,2020-05-07T21:33:45Z,2020-05-08T20:34:54Z,2020-05-08T20:34:54Z,MERGED,True,229,63,10,https://github.com/otaviobp,Heuristics: Some consolidation on heuristics module,5,[],https://github.com/clearlinux/swupd-client/pull/1555,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1555,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1555,2020-05-07T21:33:45Z,2020-05-08T20:34:54Z,2020-05-08T20:34:54Z,MERGED,True,229,63,10,https://github.com/otaviobp,Heuristics: Some consolidation on heuristics module,5,[],https://github.com/clearlinux/swupd-client/pull/1555,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1555#issuecomment-625913089,,v2: Adding tests and one improvement,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1555,2020-05-07T21:33:45Z,2020-05-08T20:34:54Z,2020-05-08T20:34:54Z,MERGED,True,229,63,10,https://github.com/otaviobp,Heuristics: Some consolidation on heuristics module,5,[],https://github.com/clearlinux/swupd-client/pull/1555,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1555#issuecomment-625923231,,V3: Fixing reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1556,2020-05-07T22:25:41Z,2020-05-12T19:27:08Z,2020-05-12T19:27:08Z,MERGED,True,756,114,39,https://github.com/otaviobp,Int: FIxing integer conversion problems,7,[],https://github.com/clearlinux/swupd-client/pull/1556,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1556,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1556,2020-05-07T22:25:41Z,2020-05-12T19:27:08Z,2020-05-12T19:27:08Z,MERGED,True,756,114,39,https://github.com/otaviobp,Int: FIxing integer conversion problems,7,[],https://github.com/clearlinux/swupd-client/pull/1556,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1556#issuecomment-627438180,,V2: Fixing reported problems,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1556,2020-05-07T22:25:41Z,2020-05-12T19:27:08Z,2020-05-12T19:27:08Z,MERGED,True,756,114,39,https://github.com/otaviobp,Int: FIxing integer conversion problems,7,[],https://github.com/clearlinux/swupd-client/pull/1556,https://github.com/otaviobp,3,https://github.com/clearlinux/swupd-client/pull/1556#issuecomment-627485382,,V3: Adding \n on debug messages,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1557,2020-05-08T20:04:30Z,2020-05-12T17:15:52Z,2020-05-12T17:15:56Z,MERGED,True,139,42,10,https://github.com/castulo,Grouping functions related to handling of statedir (part 2),3,[],https://github.com/clearlinux/swupd-client/pull/1557,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1557,"This commit continues where #1552 left off by providing more functions to handle files in directories from the statedir.
This PR includes functions to handle these directories:

delta
download

This PR is built on top of #1552 so that one needs to be reviewed first.
Related to #1538","This commit continues where #1552 left off by providing more functions to handle files in directories from the statedir.
This PR includes functions to handle these directories:

delta
download

This PR is built on top of #1552 so that one needs to be reviewed first.
Related to #1538",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1558,2020-05-08T23:02:09Z,2020-05-12T17:28:18Z,2020-05-12T17:28:18Z,CLOSED,False,321,165,20,https://github.com/castulo,Grouping functions related to handling of statedir (part 3),7,[],https://github.com/clearlinux/swupd-client/pull/1558,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1558,"This PR adds functions to get manifest files from the statedir.
This PR is built on top of #1552 and #1557 so they need to be reviewed first.
Related to #1538","This PR adds functions to get manifest files from the statedir.
This PR is built on top of #1552 and #1557 so they need to be reviewed first.
Related to #1538",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1558,2020-05-08T23:02:09Z,2020-05-12T17:28:18Z,2020-05-12T17:28:18Z,CLOSED,False,321,165,20,https://github.com/castulo,Grouping functions related to handling of statedir (part 3),7,[],https://github.com/clearlinux/swupd-client/pull/1558,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1558#issuecomment-627484282,"This PR adds functions to get manifest files from the statedir.
This PR is built on top of #1552 and #1557 so they need to be reviewed first.
Related to #1538","Looks like at some point I made a mistake with the rebasing and this PR only has commits that already merged. I must have overwritten one of the PRs at some point. 
Anyway, since all the commit in the PR are already merged I'm canceling this PR and will rename PR #1559 as (part 3)",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1559,2020-05-11T20:39:25Z,2020-05-12T21:21:12Z,2020-05-12T21:21:17Z,MERGED,True,184,145,17,https://github.com/castulo,Grouping functions related to handling of statedir (part 3),7,[],https://github.com/clearlinux/swupd-client/pull/1559,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1559,"This PR adds functions to get manifest files from the statedir.
This PR is built on top of #1552 and #1557 so they need to be reviewed first.
Closes #1538","This PR adds functions to get manifest files from the statedir.
This PR is built on top of #1552 and #1557 so they need to be reviewed first.
Closes #1538",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1559,2020-05-11T20:39:25Z,2020-05-12T21:21:12Z,2020-05-12T21:21:17Z,MERGED,True,184,145,17,https://github.com/castulo,Grouping functions related to handling of statedir (part 3),7,[],https://github.com/clearlinux/swupd-client/pull/1559,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1559#issuecomment-627573334,"This PR adds functions to get manifest files from the statedir.
This PR is built on top of #1552 and #1557 so they need to be reviewed first.
Closes #1538",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1560,2020-05-12T16:32:03Z,2020-05-12T19:26:17Z,2020-05-12T19:26:18Z,MERGED,True,1,25,5,https://github.com/otaviobp,motd: Remove motd code that was not being used,1,[],https://github.com/clearlinux/swupd-client/pull/1560,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1560,"check-update was trying to create a motd in a deprecated directory and
it was always failing.
Removing code for now.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","check-update was trying to create a motd in a deprecated directory and
it was always failing.
Removing code for now.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1561,2020-05-12T16:45:18Z,2020-05-12T17:37:38Z,2020-05-12T17:37:38Z,CLOSED,False,1,7,1,https://github.com/otaviobp,hashdump: Also sys_path_join when path_prefix is not set,1,[],https://github.com/clearlinux/swupd-client/pull/1561,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1561,"We don't need to prevent duplicating the ""/"" because sys_path_join()
removes that
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","We don't need to prevent duplicating the ""/"" because sys_path_join()
removes that
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1561,2020-05-12T16:45:18Z,2020-05-12T17:37:38Z,2020-05-12T17:37:38Z,CLOSED,False,1,7,1,https://github.com/otaviobp,hashdump: Also sys_path_join when path_prefix is not set,1,[],https://github.com/clearlinux/swupd-client/pull/1561,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1561#issuecomment-627489288,"We don't need to prevent duplicating the ""/"" because sys_path_join()
removes that
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",actually this PR doesn't make sense. I misunderstood the hashdump parameter when I wrote that.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1562,2020-05-12T17:31:07Z,2020-05-12T19:26:11Z,2020-05-12T19:26:11Z,MERGED,True,48,17,11,https://github.com/otaviobp,Log: Fix \n missing on log messages problem,2,[],https://github.com/clearlinux/swupd-client/pull/1562,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1562,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1563,2020-05-12T19:28:14Z,2020-05-13T15:24:38Z,2020-05-13T15:24:38Z,MERGED,True,49,1,2,https://github.com/otaviobp,verify: Don't apply heuristic to os-install,1,[],https://github.com/clearlinux/swupd-client/pull/1563,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1563,"Don't run heuristics for os-install or repair --quick.
On os-install we want all files to be always installed. On repair --quick
we don't process any do_not_update files
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Don't run heuristics for os-install or repair --quick.
On os-install we want all files to be always installed. On repair --quick
we don't process any do_not_update files
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1564,2020-05-12T19:34:30Z,2020-05-13T15:24:08Z,2020-05-13T15:24:08Z,MERGED,True,2,2,1,https://github.com/otaviobp,thread_pool: Number of threads can be zero,1,[],https://github.com/clearlinux/swupd-client/pull/1564,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1564,"Actually thread_pool supports zero threads, that means exactly running in
serial. So rolling back to what it was before the integer conversion fix of
commit 2a7f181.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Actually thread_pool supports zero threads, that means exactly running in
serial. So rolling back to what it was before the integer conversion fix of
commit 2a7f181.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1565,2020-05-12T22:44:43Z,2020-05-13T15:24:25Z,2020-05-13T15:24:25Z,MERGED,True,1,0,1,https://github.com/castulo,Fixing memory leak in delta.c,1,[],https://github.com/clearlinux/swupd-client/pull/1565,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1565,"Fixing:

Memory leak delta.c
Dead code in thread_pool.c

Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Fixing:

Memory leak delta.c
Dead code in thread_pool.c

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1565,2020-05-12T22:44:43Z,2020-05-13T15:24:25Z,2020-05-13T15:24:25Z,MERGED,True,1,0,1,https://github.com/castulo,Fixing memory leak in delta.c,1,[],https://github.com/clearlinux/swupd-client/pull/1565,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1565#issuecomment-627646339,"Fixing:

Memory leak delta.c
Dead code in thread_pool.c

Signed-off-by: Castulo Martinez castulo.martinez@intel.com",V: only fixing the memory leak,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1567,2020-05-13T17:54:27Z,2020-05-14T15:27:26Z,2020-05-14T15:44:47Z,MERGED,True,93,38,7,https://github.com/castulo,Moving some remaining functions to statedir.c,1,[],https://github.com/clearlinux/swupd-client/pull/1567,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1567,"Some of these references to statedir where left in the code, this commit
moves them to the statedir.c module so references to content of the
statedir are not hardcoded. Files in the statedir can move to different
locations freely this way.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Some of these references to statedir where left in the code, this commit
moves them to the statedir.c module so references to content of the
statedir are not hardcoded. Files in the statedir can move to different
locations freely this way.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1568,2020-05-14T00:17:29Z,2020-05-14T18:03:52Z,2020-05-14T18:03:54Z,MERGED,True,93,56,18,https://github.com/castulo,Group manifest artifacts under the same directory in the statedir,2,[],https://github.com/clearlinux/swupd-client/pull/1568,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1568,"This PR groups all the manifest-related artifacts that swupd downloads under the same ""manifest"" directory, so we keep a better consistency within the statedir.
This PR is built on top of #1567 and it needs to be merged first.
Related to #1539","This PR groups all the manifest-related artifacts that swupd downloads under the same ""manifest"" directory, so we keep a better consistency within the statedir.
This PR is built on top of #1567 and it needs to be merged first.
Related to #1539",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1568,2020-05-14T00:17:29Z,2020-05-14T18:03:52Z,2020-05-14T18:03:54Z,MERGED,True,93,56,18,https://github.com/castulo,Group manifest artifacts under the same directory in the statedir,2,[],https://github.com/clearlinux/swupd-client/pull/1568,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1568#issuecomment-628728005,"This PR groups all the manifest-related artifacts that swupd downloads under the same ""manifest"" directory, so we keep a better consistency within the statedir.
This PR is built on top of #1567 and it needs to be merged first.
Related to #1539","@otaviobp This PR should be ready for review, it has tests failing because there were some changes in the API tests. But the changes in the API tests tests are safe, the location where manifests are changed so things like this had to be changed:
from
sudo mkdir -p ""$STATE1""/10
to
sudo mkdir -p ""$STATE1""/manifest/10",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1568,2020-05-14T00:17:29Z,2020-05-14T18:03:52Z,2020-05-14T18:03:54Z,MERGED,True,93,56,18,https://github.com/castulo,Group manifest artifacts under the same directory in the statedir,2,[],https://github.com/clearlinux/swupd-client/pull/1568,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1568#issuecomment-628760543,"This PR groups all the manifest-related artifacts that swupd downloads under the same ""manifest"" directory, so we keep a better consistency within the statedir.
This PR is built on top of #1567 and it needs to be merged first.
Related to #1539",Rebased,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1569,2020-05-14T15:43:07Z,2020-05-14T16:26:13Z,2020-05-14T16:26:13Z,MERGED,True,3,3,1,https://github.com/otaviobp,curl: Remove '*' character in error output,1,[],https://github.com/clearlinux/swupd-client/pull/1569,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1569,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,Signed-off-by: Otavio Pontes otavio.pontes@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1570,2020-05-14T16:06:13Z,2020-05-14T20:42:01Z,2020-05-14T20:42:01Z,MERGED,True,11,12,3,https://github.com/otaviobp,delta: Improve message on delta errors,1,[],https://github.com/clearlinux/swupd-client/pull/1570,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1570,"Print a more useful error when we fail to locate a file to apply a
delta. Add a suggestion for the user to run swupd repair and make
it clear that the problem is in their system and not in the update
content.
Fixes #1425
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Print a more useful error when we fail to locate a file to apply a
delta. Add a suggestion for the user to run swupd repair and make
it clear that the problem is in their system and not in the update
content.
Fixes #1425
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1570,2020-05-14T16:06:13Z,2020-05-14T20:42:01Z,2020-05-14T20:42:01Z,MERGED,True,11,12,3,https://github.com/otaviobp,delta: Improve message on delta errors,1,[],https://github.com/clearlinux/swupd-client/pull/1570,https://github.com/otaviobp,2,https://github.com/clearlinux/swupd-client/pull/1570#issuecomment-628852593,"Print a more useful error when we fail to locate a file to apply a
delta. Add a suggestion for the user to run swupd repair and make
it clear that the problem is in their system and not in the update
content.
Fixes #1425
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","V3: Fixing typo and replacing ' by """,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1571,2020-05-14T16:37:50Z,2020-05-14T17:45:47Z,2020-05-14T17:45:47Z,MERGED,True,13,2,3,https://github.com/otaviobp,actions: Create another job to check for API changes,1,[],https://github.com/clearlinux/swupd-client/pull/1571,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1571,"Create another github job to check if the API has been changed in this
PR, so it will be easier to notice that a broken test is just an API
broken test
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Create another github job to check if the API has been changed in this
PR, so it will be easier to notice that a broken test is just an API
broken test
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1572,2020-05-14T16:52:51Z,2020-05-14T17:49:47Z,2020-05-14T17:49:47Z,MERGED,True,8,0,1,https://github.com/castulo,Bug_Fix: Only update templates if repos exist,1,['3rd-party'],https://github.com/clearlinux/swupd-client/pull/1572,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1572,"Closes #1566
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","Closes #1566
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1573,2020-05-14T20:58:05Z,2020-05-29T21:42:55Z,2020-05-29T21:42:55Z,MERGED,True,333,211,7,https://github.com/otaviobp,Heuristics performance improvements,4,[],https://github.com/clearlinux/swupd-client/pull/1573,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1573,,,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1574,2020-05-15T19:46:11Z,2020-06-05T19:27:19Z,2020-06-05T19:27:19Z,CLOSED,False,234,126,23,https://github.com/castulo,Separating cache from state files in statedir,1,[],https://github.com/clearlinux/swupd-client/pull/1574,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1574,"This commit moves the cache directories and files into their own ""cache""
directory in the statedir, that way it is separated from state files.
Related to #1539
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","This commit moves the cache directories and files into their own ""cache""
directory in the statedir, that way it is separated from state files.
Related to #1539
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1574,2020-05-15T19:46:11Z,2020-06-05T19:27:19Z,2020-06-05T19:27:19Z,CLOSED,False,234,126,23,https://github.com/castulo,Separating cache from state files in statedir,1,[],https://github.com/clearlinux/swupd-client/pull/1574,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1574#issuecomment-639742756,"This commit moves the cache directories and files into their own ""cache""
directory in the statedir, that way it is separated from state files.
Related to #1539
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",closing in favor of #1582,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1576,2020-05-18T21:13:26Z,2020-05-19T20:47:50Z,2020-05-19T20:47:50Z,MERGED,True,2,2,2,https://github.com/otaviobp,swupd.bash: Make swupd.bash sh compliant,1,[],https://github.com/clearlinux/swupd-client/pull/1576,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1576,"Clear requires that bash autocomplete scripts to be executable by sh
shell
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Clear requires that bash autocomplete scripts to be executable by sh
shell
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1577,2020-05-19T00:42:02Z,2020-06-05T19:27:08Z,2020-06-05T19:27:08Z,CLOSED,False,361,140,27,https://github.com/castulo,Save cached files in a path dependent on the URL,3,[],https://github.com/clearlinux/swupd-client/pull/1577,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1577,"When downloading files, store them in a path that is dependent on the
content url to make it easier to share them for more target systems.
This PR is built on top of #1574 and needs to be merged first.
Closes #1539
Closes #1540","When downloading files, store them in a path that is dependent on the
content url to make it easier to share them for more target systems.
This PR is built on top of #1574 and needs to be merged first.
Closes #1539
Closes #1540",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1577,2020-05-19T00:42:02Z,2020-06-05T19:27:08Z,2020-06-05T19:27:08Z,CLOSED,False,361,140,27,https://github.com/castulo,Save cached files in a path dependent on the URL,3,[],https://github.com/clearlinux/swupd-client/pull/1577,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1577#issuecomment-639742644,"When downloading files, store them in a path that is dependent on the
content url to make it easier to share them for more target systems.
This PR is built on top of #1574 and needs to be merged first.
Closes #1539
Closes #1540",closing in favor of #1582,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1578,2020-05-19T15:30:32Z,2020-05-19T20:47:38Z,2020-05-19T20:47:38Z,MERGED,True,7,0,1,https://github.com/otaviobp,clean: Clean manifests in deprecated location,1,[],https://github.com/clearlinux/swupd-client/pull/1578,https://github.com/otaviobp,1,https://github.com/clearlinux/swupd-client/pull/1578,"Manifest directory has moved and we need to clean manifests in previous location.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com","Manifest directory has moved and we need to clean manifests in previous location.
Signed-off-by: Otavio Pontes otavio.pontes@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1579,2020-05-19T21:43:01Z,2020-05-19T22:30:10Z,2020-05-20T00:33:27Z,MERGED,True,1,1,1,https://github.com/phmccarty,Fix syntax error in configure.ac,1,[],https://github.com/clearlinux/swupd-client/pull/1579,https://github.com/phmccarty,1,https://github.com/clearlinux/swupd-client/pull/1579,"The configure script generated from configure.ac tries to run a ]
command, but that command doesn't exist.
The root cause is a syntax issue configure.ac: there is a stray ] on
one of the lines.","The configure script generated from configure.ac tries to run a ]
command, but that command doesn't exist.
The root cause is a syntax issue configure.ac: there is a stray ] on
one of the lines.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1579,2020-05-19T21:43:01Z,2020-05-19T22:30:10Z,2020-05-20T00:33:27Z,MERGED,True,1,1,1,https://github.com/phmccarty,Fix syntax error in configure.ac,1,[],https://github.com/clearlinux/swupd-client/pull/1579,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1579#issuecomment-631109196,"The configure script generated from configure.ac tries to run a ]
command, but that command doesn't exist.
The root cause is a syntax issue configure.ac: there is a stray ] on
one of the lines.",,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1580,2020-05-21T19:36:20Z,2020-05-21T21:31:21Z,2020-05-21T21:31:22Z,MERGED,True,0,9,1,https://github.com/castulo,Removing dead code in clean.c,1,[],https://github.com/clearlinux/swupd-client/pull/1580,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1580,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,Signed-off-by: Castulo Martinez castulo.martinez@intel.com,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1582,2020-06-05T19:26:33Z,2020-06-08T19:10:41Z,2020-06-08T19:10:44Z,MERGED,True,1923,366,49,https://github.com/castulo,Separating the cache from the data used by swupd,3,[],https://github.com/clearlinux/swupd-client/pull/1582,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1582,"Currently there is only one location, known as ""statedir"", where swupd stores data and cache. Normally it make sense to keep the data in a path that is relative to the path prefix of the target system, since the data is specific to that system, but cache can be independent of the system, and that way it can be reused for other target systems if desired.
This PR includes the following changes to accomplish this:

It splits the cache and data in the internal memory into two different locations.
It stores the cache in a path that is dependent of the url of the update content server
Removes hardcoded references to files in the cache and data throughout the code so they can be relocated easily at any time if desired.
Sets the read permissions of the data directory to be world readable.
Sets the read permissions of all directories in the cache to be readable by root only with the exception of the manifest directory which is world readable.
Updates the swupd clean and swupd 3rd-party clean commands so they remove cache from the new location.
The swupd clean and swupd 3rd-party clean commands  will continue to clean cache from the old locations until the bump to format 31 to make sure we don't leave old files behind.
It introduces the --cachedir and --datadir which can be used to set the locations of the cache and data respectively. If users want to set both paths to the same location they can still use --statedir to set both paths at once.
Adds functional tests to validate the removal of cache from old and new locations.

Closes #1538
Closes #1539
Closes #1540
Closes #1541
Closes #490
Closes #1537","Currently there is only one location, known as ""statedir"", where swupd stores data and cache. Normally it make sense to keep the data in a path that is relative to the path prefix of the target system, since the data is specific to that system, but cache can be independent of the system, and that way it can be reused for other target systems if desired.
This PR includes the following changes to accomplish this:

It splits the cache and data in the internal memory into two different locations.
It stores the cache in a path that is dependent of the url of the update content server
Removes hardcoded references to files in the cache and data throughout the code so they can be relocated easily at any time if desired.
Sets the read permissions of the data directory to be world readable.
Sets the read permissions of all directories in the cache to be readable by root only with the exception of the manifest directory which is world readable.
Updates the swupd clean and swupd 3rd-party clean commands so they remove cache from the new location.
The swupd clean and swupd 3rd-party clean commands  will continue to clean cache from the old locations until the bump to format 31 to make sure we don't leave old files behind.
It introduces the --cachedir and --datadir which can be used to set the locations of the cache and data respectively. If users want to set both paths to the same location they can still use --statedir to set both paths at once.
Adds functional tests to validate the removal of cache from old and new locations.

Closes #1538
Closes #1539
Closes #1540
Closes #1541
Closes #490
Closes #1537",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1582,2020-06-05T19:26:33Z,2020-06-08T19:10:41Z,2020-06-08T19:10:44Z,MERGED,True,1923,366,49,https://github.com/castulo,Separating the cache from the data used by swupd,3,[],https://github.com/clearlinux/swupd-client/pull/1582,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1582#issuecomment-639778656,"Currently there is only one location, known as ""statedir"", where swupd stores data and cache. Normally it make sense to keep the data in a path that is relative to the path prefix of the target system, since the data is specific to that system, but cache can be independent of the system, and that way it can be reused for other target systems if desired.
This PR includes the following changes to accomplish this:

It splits the cache and data in the internal memory into two different locations.
It stores the cache in a path that is dependent of the url of the update content server
Removes hardcoded references to files in the cache and data throughout the code so they can be relocated easily at any time if desired.
Sets the read permissions of the data directory to be world readable.
Sets the read permissions of all directories in the cache to be readable by root only with the exception of the manifest directory which is world readable.
Updates the swupd clean and swupd 3rd-party clean commands so they remove cache from the new location.
The swupd clean and swupd 3rd-party clean commands  will continue to clean cache from the old locations until the bump to format 31 to make sure we don't leave old files behind.
It introduces the --cachedir and --datadir which can be used to set the locations of the cache and data respectively. If users want to set both paths to the same location they can still use --statedir to set both paths at once.
Adds functional tests to validate the removal of cache from old and new locations.

Closes #1538
Closes #1539
Closes #1540
Closes #1541
Closes #490
Closes #1537","It is expected to have the API job to fail because there were a couple of changes in the tests, the output hasn't changed though.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1583,2020-06-08T20:43:49Z,2020-06-08T22:40:30Z,2020-06-08T22:40:32Z,MERGED,True,17,11,1,https://github.com/castulo,"Fixing a false positive in a ""clean"" test",1,[],https://github.com/clearlinux/swupd-client/pull/1583,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1583,"When checking the output of the ""clean --dry-run"" command in the test,
we expect the output to be shown in a specific order, but the order can
change depending on the system since readdir doesn't warranty a specific
order when reading the content of a directory.
This commit fixes the test by only checking for the files we are
intereseted in, and it checks them with separate assertions to make sure
we don't have false positives due to the order.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When checking the output of the ""clean --dry-run"" command in the test,
we expect the output to be shown in a specific order, but the order can
change depending on the system since readdir doesn't warranty a specific
order when reading the content of a directory.
This commit fixes the test by only checking for the files we are
intereseted in, and it checks them with separate assertions to make sure
we don't have false positives due to the order.
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1584,2020-06-09T23:48:23Z,2020-06-15T22:24:36Z,2020-06-15T22:24:37Z,MERGED,True,63,5,4,https://github.com/castulo,Allow paths that contain symlinks for cachedir,1,[],https://github.com/clearlinux/swupd-client/pull/1584,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1584,"When the path provided by a user for the --statedir (or --cachedir)
contains a symlink swupd will fail to extrar tar files since
libarchive does not support extracting files through symlinks.
This commit fixes the issue allowing users to use symlinks in the
--statediri/--cachedir path.
Closes #1581
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","When the path provided by a user for the --statedir (or --cachedir)
contains a symlink swupd will fail to extrar tar files since
libarchive does not support extracting files through symlinks.
This commit fixes the issue allowing users to use symlinks in the
--statediri/--cachedir path.
Closes #1581
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1584,2020-06-09T23:48:23Z,2020-06-15T22:24:36Z,2020-06-15T22:24:37Z,MERGED,True,63,5,4,https://github.com/castulo,Allow paths that contain symlinks for cachedir,1,[],https://github.com/clearlinux/swupd-client/pull/1584,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1584#issuecomment-642148430,"When the path provided by a user for the --statedir (or --cachedir)
contains a symlink swupd will fail to extrar tar files since
libarchive does not support extracting files through symlinks.
This commit fixes the issue allowing users to use symlinks in the
--statediri/--cachedir path.
Closes #1581
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",V2: returning immediately if realpath fails to get the path where a tar is going to be extracted to.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1584,2020-06-09T23:48:23Z,2020-06-15T22:24:36Z,2020-06-15T22:24:37Z,MERGED,True,63,5,4,https://github.com/castulo,Allow paths that contain symlinks for cachedir,1,[],https://github.com/clearlinux/swupd-client/pull/1584,https://github.com/castulo,3,https://github.com/clearlinux/swupd-client/pull/1584#issuecomment-642925416,"When the path provided by a user for the --statedir (or --cachedir)
contains a symlink swupd will fail to extrar tar files since
libarchive does not support extracting files through symlinks.
This commit fixes the issue allowing users to use symlinks in the
--statediri/--cachedir path.
Closes #1581
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","V3:

checking for the realpath when setting the global statedir variable.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1585,2020-06-10T17:21:53Z,2020-06-10T19:11:03Z,2020-06-10T19:11:04Z,MERGED,True,35,4,1,https://github.com/castulo,Testlib: include important env variables in help,1,['testing'],https://github.com/clearlinux/swupd-client/pull/1585,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1585,"After sourcing testlib, if the user runs testlib from the terminal,
the help of the library is displayed which includes the list of
commands provided by the library.
Testlib uses some environment variables to modify the way tests are
run. This commit adds information about those env variables to the
testlib help.
Closes #1479
Signed-off-by: Castulo Martinez castulo.martinez@intel.com","After sourcing testlib, if the user runs testlib from the terminal,
the help of the library is displayed which includes the list of
commands provided by the library.
Testlib uses some environment variables to modify the way tests are
run. This commit adds information about those env variables to the
testlib help.
Closes #1479
Signed-off-by: Castulo Martinez castulo.martinez@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1586,2020-06-13T00:37:14Z,2020-06-16T18:42:14Z,2020-06-16T18:42:16Z,MERGED,True,2625,2392,220,https://github.com/castulo,Testlib env variables,8,['testing'],https://github.com/clearlinux/swupd-client/pull/1586,https://github.com/castulo,1,https://github.com/clearlinux/swupd-client/pull/1586,"This PR includes many updates for environment variables in testlib:

Adds information about BATS env variables
Makes variable names more consistent by following a local convention for variables
Moves the location where variables are set and exported so they are easily identified
Some environment variables were available to all tests within a test file while others were only available to the first test, this PR also makes all variables available to all tests within a file
Refactors a the setup of tests to make it more straightforward and corrects some loading problems it had

Closes #1479
Closes #1484
Closes #1489
It is still a work in progress. Not ready for review.","This PR includes many updates for environment variables in testlib:

Adds information about BATS env variables
Makes variable names more consistent by following a local convention for variables
Moves the location where variables are set and exported so they are easily identified
Some environment variables were available to all tests within a test file while others were only available to the first test, this PR also makes all variables available to all tests within a file
Refactors a the setup of tests to make it more straightforward and corrects some loading problems it had

Closes #1479
Closes #1484
Closes #1489
It is still a work in progress. Not ready for review.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1586,2020-06-13T00:37:14Z,2020-06-16T18:42:14Z,2020-06-16T18:42:16Z,MERGED,True,2625,2392,220,https://github.com/castulo,Testlib env variables,8,['testing'],https://github.com/clearlinux/swupd-client/pull/1586,https://github.com/castulo,2,https://github.com/clearlinux/swupd-client/pull/1586#issuecomment-644920389,"This PR includes many updates for environment variables in testlib:

Adds information about BATS env variables
Makes variable names more consistent by following a local convention for variables
Moves the location where variables are set and exported so they are easily identified
Some environment variables were available to all tests within a test file while others were only available to the first test, this PR also makes all variables available to all tests within a file
Refactors a the setup of tests to make it more straightforward and corrects some loading problems it had

Closes #1479
Closes #1484
Closes #1489
It is still a work in progress. Not ready for review.",I was thinking into adding one more commit to this PR but I think I'm going to merge this as it is and will consider opening a new PR with the other change.,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1590,2020-11-10T18:57:30Z,2020-11-10T20:06:17Z,2020-11-10T20:06:17Z,MERGED,True,2,2,1,https://github.com/mdhorn,Fixed typo in man page.,1,[],https://github.com/clearlinux/swupd-client/pull/1590,https://github.com/mdhorn,1,https://github.com/clearlinux/swupd-client/pull/1590,"Fixes: clearlinux/distribution#2189
Signed-off-by: Mark D Horn mark.d.horn@intel.com","Fixes: clearlinux/distribution#2189
Signed-off-by: Mark D Horn mark.d.horn@intel.com",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1593,2021-03-17T01:50:27Z,,2021-03-17T01:54:26Z,OPEN,False,1,1,1,https://github.com/lebensterben,Fix swupd.zsh,1,[],https://github.com/clearlinux/swupd-client/pull/1593,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1593,Surprisingly no one has reported this bug...,Surprisingly no one has reported this bug...,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1593,2021-03-17T01:50:27Z,,2021-03-17T01:54:26Z,OPEN,False,1,1,1,https://github.com/lebensterben,Fix swupd.zsh,1,[],https://github.com/clearlinux/swupd-client/pull/1593,https://github.com/lebensterben,2,https://github.com/clearlinux/swupd-client/pull/1593#issuecomment-800732977,Surprisingly no one has reported this bug...,BTW the CI is currently broken..,True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1594,2021-03-17T03:15:04Z,,2021-03-17T03:17:16Z,OPEN,False,87,74,1,https://github.com/lebensterben,swupd.bash: Fixed bugs,1,[],https://github.com/clearlinux/swupd-client/pull/1594,https://github.com/lebensterben,1,https://github.com/clearlinux/swupd-client/pull/1594,"Currently there's a unreported bug:

When the line is 'swupd 3rd-party -' or 'swupd -', pressing tab results in
an error.


This also fixes clearlinux/distribution#2241 by introducing a test first.
Users would be notified to install shells bundle, which includes the
required bash-completion function
Updated the header:

Used a more standard and robust shebang, namely /usr/bin/env bash. (Note
that before this PR we use /bin/bash where /bin is not standard binary
installation path accoring to Linxu Filesystem Specification)
The boilerplate of license notice is updated.","Currently there's a unreported bug:

When the line is 'swupd 3rd-party -' or 'swupd -', pressing tab results in
an error.


This also fixes clearlinux/distribution#2241 by introducing a test first.
Users would be notified to install shells bundle, which includes the
required bash-completion function
Updated the header:

Used a more standard and robust shebang, namely /usr/bin/env bash. (Note
that before this PR we use /bin/bash where /bin is not standard binary
installation path accoring to Linxu Filesystem Specification)
The boilerplate of license notice is updated.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1594,2021-03-17T03:15:04Z,,2021-03-17T03:17:16Z,OPEN,False,87,74,1,https://github.com/lebensterben,swupd.bash: Fixed bugs,1,[],https://github.com/clearlinux/swupd-client/pull/1594,https://github.com/lebensterben,2,https://github.com/clearlinux/swupd-client/pull/1594#issuecomment-800761220,"Currently there's a unreported bug:

When the line is 'swupd 3rd-party -' or 'swupd -', pressing tab results in
an error.


This also fixes clearlinux/distribution#2241 by introducing a test first.
Users would be notified to install shells bundle, which includes the
required bash-completion function
Updated the header:

Used a more standard and robust shebang, namely /usr/bin/env bash. (Note
that before this PR we use /bin/bash where /bin is not standard binary
installation path accoring to Linxu Filesystem Specification)
The boilerplate of license notice is updated.","It looks like there're many changes, actually not really.
https://github.com/lebensterben/swupd-client/blob/e19a957bbe76e506f3d3137f47c783ce4dab37dd/swupd.bash#L26-L29 is the new test introduced.
https://github.com/lebensterben/swupd-client/blob/e19a957bbe76e506f3d3137f47c783ce4dab37dd/swupd.bash#L59-L60 and https://github.com/lebensterben/swupd-client/blob/e19a957bbe76e506f3d3137f47c783ce4dab37dd/swupd.bash#L74-L75 are used to fix another bug.",True,{}
clearlinux/swupd-client,https://github.com/clearlinux/swupd-client,1600,2022-02-24T02:56:51Z,2022-02-27T09:51:20Z,2022-02-27T09:51:20Z,CLOSED,False,1,1,1,https://github.com/nobodyatandnothing,fix typo,1,[],https://github.com/clearlinux/swupd-client/pull/1600,https://github.com/nobodyatandnothing,1,https://github.com/clearlinux/swupd-client/pull/1600,,,True,{}
